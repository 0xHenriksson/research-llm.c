<!DOCTYPE html>
<html lang="en">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <title>Byte Latent Transformer: Patches Scale Better Than Tokens</title>
    <!--Generated on Fri Dec 13 05:28:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
    <!--Document created on December 13, 2024.-->
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        type="text/css" />
    <link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
    <script src="/static/browse/0.3.4/js/addons_new.js"></script>
    <script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
    <base href="/html/2412.09871v1/" />
</head>

<body>
    <nav class="ltx_page_navbar">
        <nav class="ltx_TOC">
            <ol class="ltx_toclist">
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S1"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1
                            </span>Introduction</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Patching: From
                            Individual Bytes to Groups of Bytes</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS1"
                                title="In 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Strided
                                    Patching Every K Bytes</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS2"
                                title="In 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Space
                                    Patching</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS3"
                                title="In 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Entropy
                                    Patching: Using Next-Byte Entropies from a Small Byte LM</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS4"
                                title="In 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>The
                                    Byte-Pair Encoding (BPE) Tokenizer and Incremental Patching</span></a></li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S3"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span><span
                                class="ltx_text ltx_font_smallcaps">B</span>LT Architecture</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S3.SS1"
                                title="In 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Latent
                                    Global Transformer Model</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection">
                            <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S3.SS2"
                                title="In 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Local
                                    Encoder</span></a>
                            <ol class="ltx_toclist ltx_toclist_subsection">
                                <li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S3.SS2.SSS1"
                                        title="In 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1
                                            </span>Encoder Hash n-gram Embeddings</span></a></li>
                                <li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S3.SS2.SSS2"
                                        title="In 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2
                                            </span>Encoder Multi-Headed Cross-Attention</span></a></li>
                            </ol>
                        </li>
                        <li class="ltx_tocentry ltx_tocentry_subsection">
                            <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S3.SS3"
                                title="In 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Local
                                    Decoder</span></a>
                            <ol class="ltx_toclist ltx_toclist_subsection">
                                <li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S3.SS3.SSS1"
                                        title="In 3.3 Local Decoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1
                                            </span>Decoder Multi-headed Cross-Attention</span></a></li>
                            </ol>
                        </li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S4"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental
                            Setup</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS1"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1
                                    </span>Pre-training Datasets</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS2"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Entropy
                                    Model</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS3"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Entropy
                                    Threshold and Equalizing Context Length</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS4"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Entropy
                                    Model Context</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS5"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>FLOPs
                                    Estimation</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS6"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6
                                    </span>Bits-Per-Byte Estimation</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS7"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7
                                    </span>Transformer Architecture Hyperparameters</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS8"
                                title="In 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span><span
                                        class="ltx_text ltx_font_smallcaps">B</span>LT-Specific
                                    Hyperparameters</span></a></li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Scaling
                            Trends</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S5.SS1"
                                title="In 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1
                                    </span>Parameter Matched Compute Optimal Scaling Trends</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_subsection">
                            <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5.SS2"
                                title="In 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Beyond
                                    Compute Optimal Task Evaluations</span></a>
                            <ol class="ltx_toclist ltx_toclist_subsection">
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.SS2.SSS0.Px1"
                                        title="In 5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">Classification tasks</span></a></li>
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.SS2.SSS0.Px2"
                                        title="In 5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">Coding related generation tasks:</span></a>
                                </li>
                            </ol>
                        </li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S5.SS3"
                                title="In 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Patches
                                    Scale Better Than Tokens</span></a></li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Byte Modeling
                            Improves Robustness</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_subsection">
                            <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6.SS1"
                                title="In 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1
                                    </span>Character-Level Tasks</span></a>
                            <ol class="ltx_toclist ltx_toclist_subsection">
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S6.SS1.SSS0.Px1"
                                        title="In 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">Noisy Data</span></a></li>
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S6.SS1.SSS0.Px2"
                                        title="In 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">Phonology - Grapheme-to-Phoneme
                                            (G2P)</span></a></li>
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S6.SS1.SSS0.Px3"
                                        title="In 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">CUTE</span></a></li>
                                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S6.SS1.SSS0.Px4"
                                        title="In 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_title">Low Resource Machine Translation</span></a>
                                </li>
                            </ol>
                        </li>
                        <li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S6.SS2"
                                title="In 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Training
                                    <span class="ltx_text ltx_font_smallcaps">B</span>LT from Llama 3</span></a></li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section">
                    <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S7"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Ablations and
                            Discussion</span></a>
                    <ol class="ltx_toclist ltx_toclist_section">
                        <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S7.SS0.SSS0.Px1"
                                title="In 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title">Entropy Model Hyper-parameters</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S7.SS0.SSS0.Px2"
                                title="In 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title">Types of Patching</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S7.SS0.SSS0.Px3"
                                title="In 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title">Cross-Attention</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S7.SS0.SSS0.Px4"
                                title="In 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title">n-gram Hash Embeddings</span></a></li>
                        <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S7.SS0.SSS0.Px5"
                                title="In 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_title">Local Model Hyperparamaters</span></a></li>
                    </ol>
                </li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S8"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Related
                            Work</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S9"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Limitations and
                            Future Work</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S10"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">10
                            </span>Conclusion</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#Sx2.SS0.SSS0.Px1"
                        title="In Contributors ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title">Core Contributors:</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#Sx2.SS0.SSS0.Px2"
                        title="In Contributors ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title">Core Advising Group:</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#Sx2.SS0.SSS0.Px3"
                        title="In Contributors ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title">Advisors and Contributors:</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S11"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">11 </span>Model Hyper
                            Parameters</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S12"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">12 </span>FLOPs
                            Equations</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S13"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">13 </span>Rolling
                            Polynomial Hashing</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S14"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Frequency-based
                            n-gram Embedddings</span></a></li>
                <li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref"
                        href="https://arxiv.org/html/2412.09871v1#S15"
                        title="In Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                            class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15 </span>Entropy Patching
                            Example from MMLU</span></a></li>
            </ol>
        </nav>
    </nav>
    <div class="ltx_page_main">
        <div class="ltx_page_content">
            <article class="ltx_document ltx_authors_1line" lang="en">
                <div class="ltx_para" id="p1">
                    <p class="ltx_p" id="p1.1">]FAIR at Meta
                        1]Paul G. Allen School of Computer Science &amp; Engineering, University of Washington
                        2]University of Chicago</p>
                </div>
                <div class="ltx_para" id="p2">
                    <span class="ltx_ERROR undefined" id="p2.1">\contribution</span>
                    <p class="ltx_p" id="p2.2">[‡]Joint second author
                        <span class="ltx_ERROR undefined" id="p2.2.1">\contribution</span>[†]Joint last author
                        <span class="ltx_ERROR undefined" id="p2.2.2">\contribution</span>[⋄]Work done at Meta
                    </p>
                </div>
                <h1 class="ltx_title ltx_title_document">Byte Latent Transformer: Patches Scale Better Than Tokens</h1>
                <div class="ltx_authors">
                    <span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Artidoro Pagnoni
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Ram Pasunuru
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Pedro Rodriguez
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">John Nguyen
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Benjamin Muller
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Margaret Li
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Chunting Zhou
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Lili Yu
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Jason Weston
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Luke Zettlemoyer
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Gargi Ghosh
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Mike Lewis
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Ari Holtzman
                        </span></span>
                    <span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
                        <span class="ltx_personname">Srinivasan Iyer
                        </span><span class="ltx_author_notes">
                            <span class="ltx_contact ltx_role_affiliation">[
                            </span>
                            <span class="ltx_contact ltx_role_affiliation">[
                            </span>
                            <span class="ltx_contact ltx_role_affiliation">[
                            </span>
                            <span class="ltx_contact ltx_role_email"><a
                                    href="mailto:cs.washington.edu">cs.washington.edu</a>
                            </span>
                            <span class="ltx_contact ltx_role_email"><a href="mailto:meta.com">meta.com</a>
                            </span></span></span>
                </div>
                <div class="ltx_dates">(<span class="ltx_text" id="1.1">December 13, 2024</span>)</div>
                <div class="ltx_abstract">
                    <h6 class="ltx_title ltx_title_abstract">Abstract</h6>
                    <p class="ltx_p" id="2.1"><span class="ltx_text" id="2.1.1">We introduce the Byte Latent Transformer
                            (<span class="ltx_text ltx_font_smallcaps" id="2.1.1.1">B</span>LT), a new byte-level LLM
                            architecture that, for the first time, matches tokenization-based LLM performance at scale
                            with significant improvements in inference efficiency and robustness.
                            <span class="ltx_text ltx_font_smallcaps" id="2.1.1.2">B</span>LT encodes bytes into
                            dynamically sized patches, which serve as the primary units of computation.
                            Patches are segmented based on the entropy of the next byte, allocating more compute and
                            model capacity where increased data complexity demands it.
                            We present the first <span class="ltx_text ltx_font_smallcaps" id="2.1.1.3">flop</span>
                            controlled scaling study of byte-level models up to 8B parameters and 4T training bytes. Our
                            results demonstrate the feasibility of scaling models trained on raw bytes without a fixed
                            vocabulary.
                            Both training and inference efficiency improve due to dynamically selecting long patches
                            when data is predictable, along with qualitative improvements on reasoning and long tail
                            generalization. Overall, for fixed inference costs, <span
                                class="ltx_text ltx_font_smallcaps" id="2.1.1.4">B</span>LT shows significantly better
                            scaling than tokenization-based models, by simultaneously growing both patch and model
                            size.</span></p>
                </div>
                <div class="ltx_para" id="p3">
                    <span class="ltx_ERROR undefined" id="p3.1">\correspondence</span>
                    <p class="ltx_p" id="p3.2">artidoro at , sviyer at</p>
                </div>
                <div class="ltx_para" id="p4">
                    <span class="ltx_ERROR undefined" id="p4.1">\metadata</span>
                    <p class="ltx_p" id="p4.2">[Code]<a class="ltx_ref ltx_url ltx_font_typewriter"
                            href="https://github.com/facebookresearch/blt"
                            title="">https://github.com/facebookresearch/blt</a></p>
                </div>
                <section class="ltx_section" id="S1">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">1 </span>Introduction
                    </h2>
                    <figure class="ltx_figure" id="S1.F1">
                        <div class="ltx_flex_figure">
                            <div class="ltx_flex_cell ltx_flex_size_2">
                                <div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle"
                                    id="S1.F1.1" style="width:216.8pt;">
                                    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="573"
                                        id="S1.F1.1.g1" src="x1.png" width="830" />
                                </div>
                            </div>
                            <div class="ltx_flex_cell ltx_flex_size_2">
                                <div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle"
                                    id="S1.F1.2" style="width:216.8pt;">
                                    <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="582"
                                        id="S1.F1.2.g1" src="x2.png" width="830" />
                                </div>
                            </div>
                        </div>
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S1.F1.7.1.1" style="font-size:90%;">Figure 1</span>:
                            </span><span class="ltx_text" id="S1.F1.8.2" style="font-size:90%;">
                                Scaling trends for fixed inference <span class="ltx_text ltx_font_smallcaps"
                                    id="S1.F1.8.2.1">flop</span> models (fully) trained with varying training budgets.
                                In token-based models, a fixed inference budget determines the model size.
                                In contrast, the BLT architecture provides a new scaling axis allowing simultaneous
                                increases in model and patch size while keeping the same training and inference budget.
                                <span class="ltx_text ltx_font_smallcaps" id="S1.F1.8.2.2">B</span>LT patch-size (ps) 6
                                and 8 models quickly overtake scaling trends of <span
                                    class="ltx_text ltx_font_smallcaps" id="S1.F1.8.2.3">bpe</span> Llama 2 and 3.
                                Moving to the larger inference budget makes the larger patch size 8 model more desirable
                                sooner. Both BPE compute-optimal point and crossover point are indicated with vertical
                                lines.
                            </span></figcaption>
                    </figure>
                    <figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption"
                            class="ltx_graphics ltx_centering ltx_img_landscape" height="497" id="S1.F2.g1" src="x3.png"
                            width="747" />
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S1.F2.9.2.1" style="font-size:90%;">Figure 2</span>:
                            </span><span class="ltx_text" id="S1.F2.2.1" style="font-size:90%;">
                                <span class="ltx_text ltx_font_smallcaps" id="S1.F2.2.1.1">B</span>LT comprises three
                                modules, a lightweight <span class="ltx_text ltx_font_italic" id="S1.F2.2.1.2">Local
                                    Encoder</span> that encodes input bytes into patch representations, a
                                computationally expensive Latent Transformer over patch representations, and a
                                lightweight <span class="ltx_text ltx_font_italic" id="S1.F2.2.1.3">Local Decoder</span>
                                to decode the next patch of bytes. <span class="ltx_text ltx_font_smallcaps"
                                    id="S1.F2.2.1.4">B</span>LT incorporates byte <math alttext="n" class="ltx_Math"
                                    display="inline" id="S1.F2.2.1.m1.1">
                                    <semantics id="S1.F2.2.1.m1.1b">
                                        <mi id="S1.F2.2.1.m1.1.1" xref="S1.F2.2.1.m1.1.1.cmml">n</mi><annotation-xml
                                            encoding="MathML-Content" id="S1.F2.2.1.m1.1c">
                                            <ci id="S1.F2.2.1.m1.1.1.cmml" xref="S1.F2.2.1.m1.1.1">𝑛</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S1.F2.2.1.m1.1d">n</annotation>
                                        <annotation encoding="application/x-llamapun" id="S1.F2.2.1.m1.1e">italic_n
                                        </annotation>
                                    </semantics>
                                </math>-gram embeddings and a cross-attention mechanism to maximize information flow
                                between the Latent Transformer and the byte-level modules (<a
                                    class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S3.F5"
                                    title="Figure 5 ‣ 3.2.1 Encoder Hash n-gram Embeddings ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 5</span></a>). Unlike fixed-vocabulary
                                tokenization, <span class="ltx_text ltx_font_smallcaps" id="S1.F2.2.1.5">B</span>LT
                                dynamically groups bytes into patches preserving access to the byte-level information.
                            </span></figcaption>
                    </figure>
                    <div class="ltx_para" id="S1.p1">
                        <p class="ltx_p" id="S1.p1.1">We introduce the Byte Latent Transformer (<span
                                class="ltx_text ltx_font_bold" id="S1.p1.1.1">BLT</span>), a tokenizer-free architecture
                            that learns from raw byte data and, for the first time, matches the performance of
                            tokenization-based models at scale, with significant improvements in efficiency and
                            robustness (§<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6"
                                title="6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">6</span></a>).
                            Existing large language models (<span class="ltx_text ltx_font_smallcaps"
                                id="S1.p1.1.2">llm</span>s) are trained almost entirely end-to-end, except for
                            tokenization—a heuristic pre-processing step that groups bytes into a static set of tokens.
                            Such tokens bias how a string is compressed, leading to shortcomings such as domain/modality
                            sensitivity <cite class="ltx_cite ltx_citemacro_citep">(Dagan et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib11" title="">2024</a>)</cite>,
                            sensitivity to input noise (§<a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S6"
                                title="6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">6</span></a>), a lack of orthographic knowledge <cite
                                class="ltx_cite ltx_citemacro_citep">(Edman et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib14" title="">2024</a>)</cite>, and
                            multilingual inequity <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib29"
                                    title="">2023</a>; Petrov et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib35" title="">2024</a>; Limisiewicz
                                et al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib30"
                                    title="">2024</a>)</cite>.</p>
                    </div>
                    <div class="ltx_para" id="S1.p2">
                        <p class="ltx_p" id="S1.p2.1">Tokenization has previously been essential because directly
                            training <span class="ltx_text ltx_font_smallcaps" id="S1.p2.1.1">llm</span>s on bytes is
                            prohibitively costly at scale due to long sequence lengths <cite
                                class="ltx_cite ltx_citemacro_citep">(Xue et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib47" title="">2022</a>)</cite>.
                            Prior works mitigate this by employing more efficient self-attention <cite
                                class="ltx_cite ltx_citemacro_citep">(El Boukkouri et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib15" title="">2020</a>; Clark et
                                al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib9"
                                    title="">2022</a>)</cite> or attention-free architectures <cite
                                class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib45" title="">2024</a>)</cite> (§<a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S8"
                                title="8 Related Work ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">8</span></a>). However, this primarily helps train
                            <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">small models</span>.
                            At scale, the computational cost of a Transformer is dominated by large feed-forward network
                            layers that run on every byte, not the cost of the attention mechanism.</p>
                    </div>
                    <div class="ltx_para" id="S1.p3">
                        <p class="ltx_p" id="S1.p3.1">To efficiently allocate compute, we propose a dynamic, learnable
                            method for grouping bytes into <span class="ltx_text ltx_font_italic"
                                id="S1.p3.1.1">patches</span> (§<a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2"
                                title="2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">2</span></a>) and a new model architecture that mixes
                            byte and patch information.
                            Unlike tokenization, <span class="ltx_text ltx_font_smallcaps" id="S1.p3.1.2">B</span>LT has
                            no fixed vocabulary for patches.
                            Arbitrary groups of bytes are mapped to latent patch representations via light-weight
                            learned encoder and decoder modules.
                            We show that this results in <span class="ltx_text ltx_font_italic"
                                id="S1.p3.1.3">more</span> efficient allocation of compute than tokenization-based
                            models.</p>
                    </div>
                    <div class="ltx_para" id="S1.p4">
                        <p class="ltx_p" id="S1.p4.1">Tokenization-based <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p4.1.1">llm</span>s allocate the same amount of compute to every token. This
                            trades efficiency for performance, since tokens are induced with compression heuristics that
                            are not always correlated with the complexity of predictions. Central to our architecture is
                            the idea that models should dynamically allocate compute where it is needed. For example, a
                            large transformer is not needed to predict the ending of most words, since these are
                            comparably easy, low-entropy decisions compared to choosing the first word of a new
                            sentence.
                            This is reflected in <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.2">B</span>LT’s
                            architecture (§<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S3"
                                title="3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">3</span></a>) where there are three transformer blocks:
                            two small byte-level <span class="ltx_text ltx_font_italic" id="S1.p4.1.3">local
                                models</span> and a large global <span class="ltx_text ltx_font_italic"
                                id="S1.p4.1.4">latent transformer</span> (<a class="ltx_ref ltx_refmacro_autoref"
                                href="https://arxiv.org/html/2412.09871v1#S1.F2"
                                title="Figure 2 ‣ 1 Introduction ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">Figure 2</span></a>).
                            To determine how to group bytes into patches and therefore how to dynamically allocate
                            compute, <span class="ltx_text ltx_font_smallcaps" id="S1.p4.1.5">B</span>LT
                            segments data based on the entropy of the next-byte prediction creating contextualized
                            groupings of bytes with relatively uniform information density.</p>
                    </div>
                    <div class="ltx_para" id="S1.p5">
                        <p class="ltx_p" id="S1.p5.1">We present the first <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p5.1.1">flop</span>-controlled scaling study of byte-level models up to 8B
                            parameters and 4T training bytes, showing that we can train a model end-to-end at scale from
                            bytes without fixed-vocabulary tokenization.
                            Overall, <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.2">B</span>LT matches
                            training <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.3">flop</span>-controlled
                            performance<span class="ltx_note ltx_role_footnote" id="footnote1"><sup
                                    class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span
                                        class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span
                                            class="ltx_tag ltx_tag_note">1</span>We calculate the computational cost of
                                        a model by counting the number of Floating Point OPerations (<span
                                            class="ltx_text ltx_font_smallcaps" id="footnote1.1">flop</span>s)
                                        needed.</span></span></span> of Llama 3 while using up to 50% fewer <span
                                class="ltx_text ltx_font_smallcaps" id="S1.p5.1.4">flop</span>s at inference (§<a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5"
                                title="5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">5</span></a>).
                            We also show that directly working with raw bytes provides significant improvements in
                            modeling the long-tail of the data. <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p5.1.5">B</span>LT models are more robust than tokenizer-based models to noisy
                            inputs and display enhanced character level understanding abilities demonstrated on
                            orthographic knowledge, phonology, and low-resource machine translation tasks (§<a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6"
                                title="6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">6</span></a>).
                            Finally, with <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.6">B</span>LT models, we
                            can simultaneously increase model size and patch size while maintaining the same inference
                            <span class="ltx_text ltx_font_smallcaps" id="S1.p5.1.7">flop</span> budget. Longer patch
                            sizes, on average, save compute which can be reallocated to grow the size of the global
                            latent transformer, because it is run less often. We conduct inference-<span
                                class="ltx_text ltx_font_smallcaps" id="S1.p5.1.8">flop</span> controlled scaling
                            experiments (<a class="ltx_ref ltx_refmacro_autoref"
                                href="https://arxiv.org/html/2412.09871v1#S1.F1"
                                title="Figure 1 ‣ 1 Introduction ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">Figure 1</span></a>), and observe significantly better
                            scaling trends than with tokenization-based architectures.</p>
                    </div>
                    <div class="ltx_para" id="S1.p6">
                        <p class="ltx_p" id="S1.p6.1">In summary, this paper makes the following contributions:
                            1) We introduce <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.1">B</span>LT, a byte
                            latent <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.2">llm</span> architecture that
                            dynamically allocates compute to improve <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p6.1.3">flop</span> efficiency,
                            2) We show that we achieve training <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p6.1.4">flop</span>-controlled parity with Llama 3 up to 8B scale while having
                            the option to trade minor losses in evaluation metrics for <span
                                class="ltx_text ltx_font_smallcaps" id="S1.p6.1.5">flop</span> efficiency gains of up to
                            50%, 3) <span class="ltx_text ltx_font_smallcaps" id="S1.p6.1.6">B</span>LT models unlock a
                            new dimension for scaling <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p6.1.7">llm</span>s, where model size can now be scaled while maintaining a
                            fixed-inference budget, 4) We demonstrate the improved robustness of <span
                                class="ltx_text ltx_font_smallcaps" id="S1.p6.1.8">B</span>LT models to input noise and
                            their awareness of sub-word aspects of input data that token-based <span
                                class="ltx_text ltx_font_smallcaps" id="S1.p6.1.9">llm</span>s miss.
                            We release the training and inference code for <span class="ltx_text ltx_font_smallcaps"
                                id="S1.p6.1.10">B</span>LT at <a class="ltx_ref ltx_url ltx_font_typewriter"
                                href="https://github.com/facebookresearch/blt"
                                title="">https://github.com/facebookresearch/blt</a>.</p>
                    </div>
                </section>
                <section class="ltx_section" id="S2">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">2 </span>Patching: From Individual Bytes to Groups of
                        Bytes
                    </h2>
                    <figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption"
                            class="ltx_graphics ltx_centering ltx_img_landscape" height="106" id="S2.F3.g1"
                            src="extracted/6066458/assets/patching_types.png" width="598" />
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S2.F3.4.1.1" style="font-size:90%;">Figure 3</span>:
                            </span><span class="ltx_text" id="S2.F3.5.2" style="font-size:90%;">
                                Patching schemes group bytes in different ways, each leading to a different number of
                                resulting patches.
                                Since each patch is processed using a large transformer step, the number of patches
                                directly determines the bulk of the compute expended in terms of <span
                                    class="ltx_text ltx_font_smallcaps" id="S2.F3.5.2.1">flop</span>s.
                                These schemes group bytes into patches by (a) striding every four bytes (§<a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2.SS1"
                                    title="2.1 Strided Patching Every K Bytes ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">2.1</span></a>) as in MegaByte <cite
                                    class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib48" title="">2023</a>)</cite>,
                                (b) tokenizing with Byte-Pair Encoding (<span class="ltx_text ltx_font_smallcaps"
                                    id="S2.F3.5.2.2">bpe</span>), in this case the Llama-3 <cite
                                    class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>
                                tokenizer, (c &amp; d) entropy-based patching as in this work (§<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S2.SS3"
                                    title="2.3 Entropy Patching: Using Next-Byte Entropies from a Small Byte LM ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">2.3</span></a>), (e) patching on space-bytes <cite
                                    class="ltx_cite ltx_citemacro_citep">(Slagle, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib39" title="">2024</a>)</cite>,
                                (f) and patching on entropy using a small CNN byte-level model with 2-byte
                                context.</span></figcaption>
                    </figure>
                    <div class="ltx_para" id="S2.p1">
                        <p class="ltx_p" id="S2.p1.6">Segmenting bytes into <span class="ltx_text ltx_font_italic"
                                id="S2.p1.6.1">patches</span> allows <span class="ltx_text ltx_font_smallcaps"
                                id="S2.p1.6.2">B</span>LT to dynamically allocate compute based on context.
                            Figure <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2.F3"
                                title="Figure 3 ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">3</span></a> shows several different methods for
                            segmenting bytes into patches.
                            Formally, a patching function <math alttext="f_{p}" class="ltx_Math" display="inline"
                                id="S2.p1.1.m1.1">
                                <semantics id="S2.p1.1.m1.1a">
                                    <msub id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">
                                        <mi id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">f</mi>
                                        <mi id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">p</mi>
                                    </msub><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b">
                                        <apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">
                                            <csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">
                                                subscript</csymbol>
                                            <ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝑓</ci>
                                            <ci id="S2.p1.1.m1.1.1.3.cmml" xref="S2.p1.1.m1.1.1.3">𝑝</ci>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">f_{p}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_f
                                        start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math> segments a sequence of bytes <math alttext="\boldsymbol{x}=\{x_{i},|i=1,\ldots n\}"
                                class="ltx_math_unparsed" display="inline" id="S2.p1.2.m2.1">
                                <semantics id="S2.p1.2.m2.1a">
                                    <mrow id="S2.p1.2.m2.1b">
                                        <mi id="S2.p1.2.m2.1.2">𝒙</mi>
                                        <mo id="S2.p1.2.m2.1.3">=</mo>
                                        <mrow id="S2.p1.2.m2.1.4">
                                            <mo id="S2.p1.2.m2.1.4.1" stretchy="false">{</mo>
                                            <msub id="S2.p1.2.m2.1.4.2">
                                                <mi id="S2.p1.2.m2.1.4.2.2">x</mi>
                                                <mi id="S2.p1.2.m2.1.4.2.3">i</mi>
                                            </msub>
                                            <mo id="S2.p1.2.m2.1.4.3">,</mo>
                                            <mo fence="false" id="S2.p1.2.m2.1.4.4" rspace="0.167em" stretchy="false">|
                                            </mo>
                                            <mi id="S2.p1.2.m2.1.4.5">i</mi>
                                            <mo id="S2.p1.2.m2.1.4.6">=</mo>
                                            <mn id="S2.p1.2.m2.1.1">1</mn>
                                            <mo id="S2.p1.2.m2.1.4.7">,</mo>
                                            <mi id="S2.p1.2.m2.1.4.8" mathvariant="normal">…</mi>
                                            <mi id="S2.p1.2.m2.1.4.9">n</mi>
                                            <mo id="S2.p1.2.m2.1.4.10" stretchy="false">}</mo>
                                        </mrow>
                                    </mrow>
                                    <annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">
                                        \boldsymbol{x}=\{x_{i},|i=1,\ldots n\}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">bold_italic_x = {
                                        italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , | italic_i = 1 , …
                                        italic_n }</annotation>
                                </semantics>
                            </math> of length <math alttext="n" class="ltx_Math" display="inline" id="S2.p1.3.m3.1">
                                <semantics id="S2.p1.3.m3.1a">
                                    <mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S2.p1.3.m3.1b">
                                        <ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math> into a sequence of <math alttext="m&lt;n" class="ltx_Math" display="inline"
                                id="S2.p1.4.m4.1">
                                <semantics id="S2.p1.4.m4.1a">
                                    <mrow id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">
                                        <mi id="S2.p1.4.m4.1.1.2" xref="S2.p1.4.m4.1.1.2.cmml">m</mi>
                                        <mo id="S2.p1.4.m4.1.1.1" xref="S2.p1.4.m4.1.1.1.cmml">&lt;</mo>
                                        <mi id="S2.p1.4.m4.1.1.3" xref="S2.p1.4.m4.1.1.3.cmml">n</mi>
                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b">
                                        <apply id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">
                                            <lt id="S2.p1.4.m4.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1"></lt>
                                            <ci id="S2.p1.4.m4.1.1.2.cmml" xref="S2.p1.4.m4.1.1.2">𝑚</ci>
                                            <ci id="S2.p1.4.m4.1.1.3.cmml" xref="S2.p1.4.m4.1.1.3">𝑛</ci>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">m&lt;n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_m &lt;
                                        italic_n</annotation>
                                </semantics>
                            </math> patches <math alttext="\boldsymbol{p}=\{p_{j}|j=1,\ldots,m\}" class="ltx_Math"
                                display="inline" id="S2.p1.5.m5.5">
                                <semantics id="S2.p1.5.m5.5a">
                                    <mrow id="S2.p1.5.m5.5.5" xref="S2.p1.5.m5.5.5.cmml">
                                        <mi id="S2.p1.5.m5.5.5.4" xref="S2.p1.5.m5.5.5.4.cmml">𝒑</mi>
                                        <mo id="S2.p1.5.m5.5.5.3" xref="S2.p1.5.m5.5.5.3.cmml">=</mo>
                                        <mrow id="S2.p1.5.m5.5.5.2.2" xref="S2.p1.5.m5.5.5.2.3.cmml">
                                            <mo id="S2.p1.5.m5.5.5.2.2.3" stretchy="false"
                                                xref="S2.p1.5.m5.5.5.2.3.1.cmml">{</mo>
                                            <msub id="S2.p1.5.m5.4.4.1.1.1" xref="S2.p1.5.m5.4.4.1.1.1.cmml">
                                                <mi id="S2.p1.5.m5.4.4.1.1.1.2" xref="S2.p1.5.m5.4.4.1.1.1.2.cmml">p
                                                </mi>
                                                <mi id="S2.p1.5.m5.4.4.1.1.1.3" xref="S2.p1.5.m5.4.4.1.1.1.3.cmml">j
                                                </mi>
                                            </msub>
                                            <mo id="S2.p1.5.m5.5.5.2.2.4" lspace="0em" rspace="0em"
                                                xref="S2.p1.5.m5.5.5.2.3.1.cmml">|</mo>
                                            <mrow id="S2.p1.5.m5.5.5.2.2.2" xref="S2.p1.5.m5.5.5.2.2.2.cmml">
                                                <mi id="S2.p1.5.m5.5.5.2.2.2.2" xref="S2.p1.5.m5.5.5.2.2.2.2.cmml">j
                                                </mi>
                                                <mo id="S2.p1.5.m5.5.5.2.2.2.1" xref="S2.p1.5.m5.5.5.2.2.2.1.cmml">=
                                                </mo>
                                                <mrow id="S2.p1.5.m5.5.5.2.2.2.3.2"
                                                    xref="S2.p1.5.m5.5.5.2.2.2.3.1.cmml">
                                                    <mn id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">1</mn>
                                                    <mo id="S2.p1.5.m5.5.5.2.2.2.3.2.1"
                                                        xref="S2.p1.5.m5.5.5.2.2.2.3.1.cmml">,</mo>
                                                    <mi id="S2.p1.5.m5.2.2" mathvariant="normal"
                                                        xref="S2.p1.5.m5.2.2.cmml">…</mi>
                                                    <mo id="S2.p1.5.m5.5.5.2.2.2.3.2.2"
                                                        xref="S2.p1.5.m5.5.5.2.2.2.3.1.cmml">,</mo>
                                                    <mi id="S2.p1.5.m5.3.3" xref="S2.p1.5.m5.3.3.cmml">m</mi>
                                                </mrow>
                                            </mrow>
                                            <mo id="S2.p1.5.m5.5.5.2.2.5" stretchy="false"
                                                xref="S2.p1.5.m5.5.5.2.3.1.cmml">}</mo>
                                        </mrow>
                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.5b">
                                        <apply id="S2.p1.5.m5.5.5.cmml" xref="S2.p1.5.m5.5.5">
                                            <eq id="S2.p1.5.m5.5.5.3.cmml" xref="S2.p1.5.m5.5.5.3"></eq>
                                            <ci id="S2.p1.5.m5.5.5.4.cmml" xref="S2.p1.5.m5.5.5.4">𝒑</ci>
                                            <apply id="S2.p1.5.m5.5.5.2.3.cmml" xref="S2.p1.5.m5.5.5.2.2">
                                                <csymbol cd="latexml" id="S2.p1.5.m5.5.5.2.3.1.cmml"
                                                    xref="S2.p1.5.m5.5.5.2.2.3">conditional-set</csymbol>
                                                <apply id="S2.p1.5.m5.4.4.1.1.1.cmml" xref="S2.p1.5.m5.4.4.1.1.1">
                                                    <csymbol cd="ambiguous" id="S2.p1.5.m5.4.4.1.1.1.1.cmml"
                                                        xref="S2.p1.5.m5.4.4.1.1.1">subscript</csymbol>
                                                    <ci id="S2.p1.5.m5.4.4.1.1.1.2.cmml" xref="S2.p1.5.m5.4.4.1.1.1.2">
                                                        𝑝</ci>
                                                    <ci id="S2.p1.5.m5.4.4.1.1.1.3.cmml" xref="S2.p1.5.m5.4.4.1.1.1.3">
                                                        𝑗</ci>
                                                </apply>
                                                <apply id="S2.p1.5.m5.5.5.2.2.2.cmml" xref="S2.p1.5.m5.5.5.2.2.2">
                                                    <eq id="S2.p1.5.m5.5.5.2.2.2.1.cmml" xref="S2.p1.5.m5.5.5.2.2.2.1">
                                                    </eq>
                                                    <ci id="S2.p1.5.m5.5.5.2.2.2.2.cmml" xref="S2.p1.5.m5.5.5.2.2.2.2">
                                                        𝑗</ci>
                                                    <list id="S2.p1.5.m5.5.5.2.2.2.3.1.cmml"
                                                        xref="S2.p1.5.m5.5.5.2.2.2.3.2">
                                                        <cn id="S2.p1.5.m5.1.1.cmml" type="integer"
                                                            xref="S2.p1.5.m5.1.1">1</cn>
                                                        <ci id="S2.p1.5.m5.2.2.cmml" xref="S2.p1.5.m5.2.2">…</ci>
                                                        <ci id="S2.p1.5.m5.3.3.cmml" xref="S2.p1.5.m5.3.3">𝑚</ci>
                                                    </list>
                                                </apply>
                                            </apply>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S2.p1.5.m5.5c">
                                        \boldsymbol{p}=\{p_{j}|j=1,\ldots,m\}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.5.m5.5d">bold_italic_p = {
                                        italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | italic_j = 1 , … ,
                                        italic_m }</annotation>
                                </semantics>
                            </math> by mapping each <math alttext="x_{i}" class="ltx_Math" display="inline"
                                id="S2.p1.6.m6.1">
                                <semantics id="S2.p1.6.m6.1a">
                                    <msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">
                                        <mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">x</mi>
                                        <mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">i</mi>
                                    </msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b">
                                        <apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">
                                            <csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">
                                                subscript</csymbol>
                                            <ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑥</ci>
                                            <ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑖</ci>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">x_{i}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_x
                                        start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math> to the set {0,1} where 1 indicates the start of a new patch.
                            For both token-based and patch-based models, the computational cost of processing data is
                            primarily determined by the number of steps executed by the main Transformer. In <span
                                class="ltx_text ltx_font_smallcaps" id="S2.p1.6.3">B</span>LT, this is the number of
                            patches needed to encode the data with a given patching function.
                            Consequently, the average size of a patch, or simply <span class="ltx_text ltx_font_italic"
                                id="S2.p1.6.4">patch size</span>, is the main factor for determining the cost of
                            processing data during both training and inference with a given patching function (§<a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S4.SS5"
                                title="4.5 FLOPs Estimation ‣ 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">4.5</span></a>).
                            Next, we introduce three patching functions: patching with a fixed number of bytes per patch
                            (§<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2.SS1"
                                title="2.1 Strided Patching Every K Bytes ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">2.1</span></a>), whitespace patching (§<a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2.SS2"
                                title="2.2 Space Patching ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">2.2</span></a>), and dynamically patching with
                            entropies from a small byte <span class="ltx_text ltx_font_smallcaps"
                                id="S2.p1.6.5">lm</span> (§<a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS3"
                                title="2.3 Entropy Patching: Using Next-Byte Entropies from a Small Byte LM ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">2.3</span></a>). Finally, we discuss incremental
                            patching and how tokenization is different from patching (§<a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S2.SS4"
                                title="2.4 The Byte-Pair Encoding (BPE) Tokenizer and Incremental Patching ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">2.4</span></a>).</p>
                    </div>
                    <section class="ltx_subsection" id="S2.SS1">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">2.1 </span>Strided Patching Every K Bytes
                        </h3>
                        <div class="ltx_para" id="S2.SS1.p1">
                            <p class="ltx_p" id="S2.SS1.p1.2">Perhaps the most straightforward way to group bytes is
                                into patches of fixed size <math alttext="k" class="ltx_Math" display="inline"
                                    id="S2.SS1.p1.1.m1.1">
                                    <semantics id="S2.SS1.p1.1.m1.1a">
                                        <mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml
                                            encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b">
                                            <ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑘</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">k</annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_k
                                        </annotation>
                                    </semantics>
                                </math> as done in MegaByte <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib48"
                                        title="">2023</a>)</cite>.
                                The fixed stride is easy to implement for training and inference, provides a
                                straightforward mechanism for changing the average patch size, and therefore makes it
                                easy to control the <span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS1.p1.2.1">flop</span> cost.
                                However, this patching function comes with significant downsides.
                                First, compute is not dynamically allocated to where it is needed most: one could be
                                either wasting a transformer step <math alttext="j" class="ltx_Math" display="inline"
                                    id="S2.SS1.p1.2.m2.1">
                                    <semantics id="S2.SS1.p1.2.m2.1a">
                                        <mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">j</mi><annotation-xml
                                            encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b">
                                            <ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑗</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">j</annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_j
                                        </annotation>
                                    </semantics>
                                </math> if only predicting whitespace in code, or not allocating sufficient compute for
                                bytes dense with information such as math.
                                Second, this leads to inconsistent and non-contextual patching of similar byte
                                sequences, such as the same word being split differently.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S2.SS2">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">2.2 </span>Space Patching
                        </h3>
                        <div class="ltx_para" id="S2.SS2.p1">
                            <p class="ltx_p" id="S2.SS2.p1.1"><cite class="ltx_cite ltx_citemacro_citet">Slagle (<a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib39"
                                        title="">2024</a>)</cite> proposes a simple yet effective
                                improvement over strided patching that creates new patches after any space-like
                                bytes<span class="ltx_note ltx_role_footnote" id="footnote2"><sup
                                        class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span
                                            class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span
                                                class="ltx_tag ltx_tag_note">2</span>
                                            Space-like bytes are defined as any byte that is not a latin character,
                                            digit, or <span class="ltx_text ltx_font_smallcaps"
                                                id="footnote2.1">utf</span>-8 continuation byte.
                                            In addition, each patch must contain at least one non space-like byte.
                                        </span></span></span>
                                which are natural boundaries for linguistic units in many languages.
                                In Space patching, a latent transformer step (i.e., more <span
                                    class="ltx_text ltx_font_smallcaps" id="S2.SS2.p1.1.1">flop</span>s) is allocated to
                                model every word.
                                This ensures words are patched in the same way across sequences and that flops are
                                allocated for hard predictions which often follow spaces. For example, predicting the
                                first byte of the answer to the question “Who composed the Magic Flute?<span
                                    class="ltx_text ltx_ulem_uline" id="S2.SS2.p1.1.2"> </span>” is much harder than
                                predicting the remaining bytes after “M” since the first character significantly reduces
                                the number of likely choices, making the completion “Mozart” comparatively easy to
                                predict.
                                However, space patching cannot gracefully handle all languages and domains, and most
                                importantly cannot vary the patch size.
                                Next, we introduce a new patching method that uses the insight that the first bytes in
                                words are typically most difficult to predict, but that provides a natural mechanism for
                                controlling patch size.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S2.SS3">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">2.3 </span>Entropy Patching: Using Next-Byte
                            Entropies from a Small Byte LM
                        </h3>
                        <div class="ltx_para" id="S2.SS3.p1">
                            <p class="ltx_p" id="S2.SS3.p1.1">Rather than relying on a rule-based heuristic such as
                                whitespace, we instead take a data-driven approach to identify high uncertainty
                                next-byte predictions.
                                We introduce <span class="ltx_text ltx_font_italic" id="S2.SS3.p1.1.1">entropy
                                    patching</span>, which uses entropy estimates to derive patch boundaries.</p>
                        </div>
                        <div class="ltx_para" id="S2.SS3.p2">
                            <p class="ltx_p" id="S2.SS3.p2.2">We train a small byte-level auto-regressive language model
                                on the training data for <span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS3.p2.2.1">B</span>LT and compute next byte entropies under the LM
                                distribution <math alttext="p_{e}" class="ltx_Math" display="inline"
                                    id="S2.SS3.p2.1.m1.1">
                                    <semantics id="S2.SS3.p2.1.m1.1a">
                                        <msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">
                                            <mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">p</mi>
                                            <mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">e</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b">
                                            <apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">
                                                <csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml"
                                                    xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol>
                                                <ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝑝</ci>
                                                <ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑒</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">p_{e}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_p
                                            start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> over the byte vocabulary <math alttext="\mathcal{V}" class="ltx_Math"
                                    display="inline" id="S2.SS3.p2.2.m2.1">
                                    <semantics id="S2.SS3.p2.2.m2.1a">
                                        <mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.2.m2.1.1"
                                            xref="S2.SS3.p2.2.m2.1.1.cmml">𝒱</mi><annotation-xml
                                            encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b">
                                            <ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝒱</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\mathcal{V}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">
                                            caligraphic_V</annotation>
                                    </semantics>
                                </math>:</p>
                            <table class="ltx_equation ltx_eqn_table" id="S2.E1">
                                <tbody>
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_eqn_cell ltx_align_center"><math alttext="H(x_{i})=\sum_{v\in\mathcal{V}}p_{e}(x_{i}=v|\boldsymbol{x}_{&lt;i})\log p_{e}(x_%
{i}=v|\boldsymbol{x}_{&lt;i})" class="ltx_Math" display="block" id="S2.E1.m1.3">
                                                <semantics id="S2.E1.m1.3a">
                                                    <mrow id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">
                                                        <mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml">
                                                            <mi id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml">H
                                                            </mi>
                                                            <mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">⁢
                                                            </mo>
                                                            <mrow id="S2.E1.m1.1.1.1.1.1"
                                                                xref="S2.E1.m1.1.1.1.1.1.1.cmml">
                                                                <mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false"
                                                                    xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo>
                                                                <msub id="S2.E1.m1.1.1.1.1.1.1"
                                                                    xref="S2.E1.m1.1.1.1.1.1.1.cmml">
                                                                    <mi id="S2.E1.m1.1.1.1.1.1.1.2"
                                                                        xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">x</mi>
                                                                    <mi id="S2.E1.m1.1.1.1.1.1.1.3"
                                                                        xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">i</mi>
                                                                </msub>
                                                                <mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false"
                                                                    xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo>
                                                            </mrow>
                                                        </mrow>
                                                        <mo id="S2.E1.m1.3.3.4" rspace="0.111em"
                                                            xref="S2.E1.m1.3.3.4.cmml">=</mo>
                                                        <mrow id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml">
                                                            <munder id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml">
                                                                <mo id="S2.E1.m1.3.3.3.3.2" movablelimits="false"
                                                                    xref="S2.E1.m1.3.3.3.3.2.cmml">∑</mo>
                                                                <mrow id="S2.E1.m1.3.3.3.3.3"
                                                                    xref="S2.E1.m1.3.3.3.3.3.cmml">
                                                                    <mi id="S2.E1.m1.3.3.3.3.3.2"
                                                                        xref="S2.E1.m1.3.3.3.3.3.2.cmml">v</mi>
                                                                    <mo id="S2.E1.m1.3.3.3.3.3.1"
                                                                        xref="S2.E1.m1.3.3.3.3.3.1.cmml">∈</mo>
                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                        id="S2.E1.m1.3.3.3.3.3.3"
                                                                        xref="S2.E1.m1.3.3.3.3.3.3.cmml">𝒱</mi>
                                                                </mrow>
                                                            </munder>
                                                            <mrow id="S2.E1.m1.3.3.3.2" xref="S2.E1.m1.3.3.3.2.cmml">
                                                                <msub id="S2.E1.m1.3.3.3.2.4"
                                                                    xref="S2.E1.m1.3.3.3.2.4.cmml">
                                                                    <mi id="S2.E1.m1.3.3.3.2.4.2"
                                                                        xref="S2.E1.m1.3.3.3.2.4.2.cmml">p</mi>
                                                                    <mi id="S2.E1.m1.3.3.3.2.4.3"
                                                                        xref="S2.E1.m1.3.3.3.2.4.3.cmml">e</mi>
                                                                </msub>
                                                                <mo id="S2.E1.m1.3.3.3.2.3"
                                                                    xref="S2.E1.m1.3.3.3.2.3.cmml">⁢</mo>
                                                                <mrow id="S2.E1.m1.2.2.2.1.1.1"
                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.cmml">
                                                                    <mo id="S2.E1.m1.2.2.2.1.1.1.2" stretchy="false"
                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.cmml">(</mo>
                                                                    <mrow id="S2.E1.m1.2.2.2.1.1.1.1"
                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.cmml">
                                                                        <msub id="S2.E1.m1.2.2.2.1.1.1.1.2"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.2.cmml">
                                                                            <mi id="S2.E1.m1.2.2.2.1.1.1.1.2.2"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.2.2.cmml">x
                                                                            </mi>
                                                                            <mi id="S2.E1.m1.2.2.2.1.1.1.1.2.3"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.2.3.cmml">i
                                                                            </mi>
                                                                        </msub>
                                                                        <mo id="S2.E1.m1.2.2.2.1.1.1.1.1"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.1.cmml">=</mo>
                                                                        <mrow id="S2.E1.m1.2.2.2.1.1.1.1.3"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.3.cmml">
                                                                            <mi id="S2.E1.m1.2.2.2.1.1.1.1.3.2"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.2.cmml">v
                                                                            </mi>
                                                                            <mo fence="false"
                                                                                id="S2.E1.m1.2.2.2.1.1.1.1.3.1"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.1.cmml">|
                                                                            </mo>
                                                                            <msub id="S2.E1.m1.2.2.2.1.1.1.1.3.3"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.cmml">
                                                                                <mi id="S2.E1.m1.2.2.2.1.1.1.1.3.3.2"
                                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.2.cmml">
                                                                                    𝒙</mi>
                                                                                <mrow id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3"
                                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.cmml">
                                                                                    <mi id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.2"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.2.cmml">
                                                                                    </mi>
                                                                                    <mo id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.1"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.1.cmml">
                                                                                        &lt;</mo>
                                                                                    <mi id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.3"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.3.cmml">
                                                                                        i</mi>
                                                                                </mrow>
                                                                            </msub>
                                                                        </mrow>
                                                                    </mrow>
                                                                    <mo id="S2.E1.m1.2.2.2.1.1.1.3" stretchy="false"
                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.cmml">)</mo>
                                                                </mrow>
                                                                <mo id="S2.E1.m1.3.3.3.2.3a" lspace="0.167em"
                                                                    xref="S2.E1.m1.3.3.3.2.3.cmml">⁢</mo>
                                                                <mrow id="S2.E1.m1.3.3.3.2.5"
                                                                    xref="S2.E1.m1.3.3.3.2.5.cmml">
                                                                    <mi id="S2.E1.m1.3.3.3.2.5.1"
                                                                        xref="S2.E1.m1.3.3.3.2.5.1.cmml">log</mi>
                                                                    <mo id="S2.E1.m1.3.3.3.2.5a" lspace="0.167em"
                                                                        xref="S2.E1.m1.3.3.3.2.5.cmml">⁡</mo>
                                                                    <msub id="S2.E1.m1.3.3.3.2.5.2"
                                                                        xref="S2.E1.m1.3.3.3.2.5.2.cmml">
                                                                        <mi id="S2.E1.m1.3.3.3.2.5.2.2"
                                                                            xref="S2.E1.m1.3.3.3.2.5.2.2.cmml">p</mi>
                                                                        <mi id="S2.E1.m1.3.3.3.2.5.2.3"
                                                                            xref="S2.E1.m1.3.3.3.2.5.2.3.cmml">e</mi>
                                                                    </msub>
                                                                </mrow>
                                                                <mo id="S2.E1.m1.3.3.3.2.3b"
                                                                    xref="S2.E1.m1.3.3.3.2.3.cmml">⁢</mo>
                                                                <mrow id="S2.E1.m1.3.3.3.2.2.1"
                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.cmml">
                                                                    <mo id="S2.E1.m1.3.3.3.2.2.1.2" stretchy="false"
                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.cmml">(</mo>
                                                                    <mrow id="S2.E1.m1.3.3.3.2.2.1.1"
                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.cmml">
                                                                        <msub id="S2.E1.m1.3.3.3.2.2.1.1.2"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.2.cmml">
                                                                            <mi id="S2.E1.m1.3.3.3.2.2.1.1.2.2"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.2.2.cmml">x
                                                                            </mi>
                                                                            <mi id="S2.E1.m1.3.3.3.2.2.1.1.2.3"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.2.3.cmml">i
                                                                            </mi>
                                                                        </msub>
                                                                        <mo id="S2.E1.m1.3.3.3.2.2.1.1.1"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.1.cmml">=</mo>
                                                                        <mrow id="S2.E1.m1.3.3.3.2.2.1.1.3"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.3.cmml">
                                                                            <mi id="S2.E1.m1.3.3.3.2.2.1.1.3.2"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.2.cmml">v
                                                                            </mi>
                                                                            <mo fence="false"
                                                                                id="S2.E1.m1.3.3.3.2.2.1.1.3.1"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.1.cmml">|
                                                                            </mo>
                                                                            <msub id="S2.E1.m1.3.3.3.2.2.1.1.3.3"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.cmml">
                                                                                <mi id="S2.E1.m1.3.3.3.2.2.1.1.3.3.2"
                                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.2.cmml">
                                                                                    𝒙</mi>
                                                                                <mrow id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3"
                                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.cmml">
                                                                                    <mi id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.2"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.2.cmml">
                                                                                    </mi>
                                                                                    <mo id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.1"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.1.cmml">
                                                                                        &lt;</mo>
                                                                                    <mi id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.3"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.3.cmml">
                                                                                        i</mi>
                                                                                </mrow>
                                                                            </msub>
                                                                        </mrow>
                                                                    </mrow>
                                                                    <mo id="S2.E1.m1.3.3.3.2.2.1.3" stretchy="false"
                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.cmml">)</mo>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b">
                                                        <apply id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">
                                                            <eq id="S2.E1.m1.3.3.4.cmml" xref="S2.E1.m1.3.3.4"></eq>
                                                            <apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1">
                                                                <times id="S2.E1.m1.1.1.1.2.cmml"
                                                                    xref="S2.E1.m1.1.1.1.2"></times>
                                                                <ci id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3">
                                                                    𝐻</ci>
                                                                <apply id="S2.E1.m1.1.1.1.1.1.1.cmml"
                                                                    xref="S2.E1.m1.1.1.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.E1.m1.1.1.1.1.1.1.1.cmml"
                                                                        xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol>
                                                                    <ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml"
                                                                        xref="S2.E1.m1.1.1.1.1.1.1.2">𝑥</ci>
                                                                    <ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml"
                                                                        xref="S2.E1.m1.1.1.1.1.1.1.3">𝑖</ci>
                                                                </apply>
                                                            </apply>
                                                            <apply id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3">
                                                                <apply id="S2.E1.m1.3.3.3.3.cmml"
                                                                    xref="S2.E1.m1.3.3.3.3">
                                                                    <csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.3.1.cmml"
                                                                        xref="S2.E1.m1.3.3.3.3">subscript</csymbol>
                                                                    <sum id="S2.E1.m1.3.3.3.3.2.cmml"
                                                                        xref="S2.E1.m1.3.3.3.3.2"></sum>
                                                                    <apply id="S2.E1.m1.3.3.3.3.3.cmml"
                                                                        xref="S2.E1.m1.3.3.3.3.3">
                                                                        <in id="S2.E1.m1.3.3.3.3.3.1.cmml"
                                                                            xref="S2.E1.m1.3.3.3.3.3.1"></in>
                                                                        <ci id="S2.E1.m1.3.3.3.3.3.2.cmml"
                                                                            xref="S2.E1.m1.3.3.3.3.3.2">𝑣</ci>
                                                                        <ci id="S2.E1.m1.3.3.3.3.3.3.cmml"
                                                                            xref="S2.E1.m1.3.3.3.3.3.3">𝒱</ci>
                                                                    </apply>
                                                                </apply>
                                                                <apply id="S2.E1.m1.3.3.3.2.cmml"
                                                                    xref="S2.E1.m1.3.3.3.2">
                                                                    <times id="S2.E1.m1.3.3.3.2.3.cmml"
                                                                        xref="S2.E1.m1.3.3.3.2.3"></times>
                                                                    <apply id="S2.E1.m1.3.3.3.2.4.cmml"
                                                                        xref="S2.E1.m1.3.3.3.2.4">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S2.E1.m1.3.3.3.2.4.1.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.4">subscript
                                                                        </csymbol>
                                                                        <ci id="S2.E1.m1.3.3.3.2.4.2.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.4.2">𝑝</ci>
                                                                        <ci id="S2.E1.m1.3.3.3.2.4.3.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.4.3">𝑒</ci>
                                                                    </apply>
                                                                    <apply id="S2.E1.m1.2.2.2.1.1.1.1.cmml"
                                                                        xref="S2.E1.m1.2.2.2.1.1.1">
                                                                        <eq id="S2.E1.m1.2.2.2.1.1.1.1.1.cmml"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.1"></eq>
                                                                        <apply id="S2.E1.m1.2.2.2.1.1.1.1.2.cmml"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.2">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S2.E1.m1.2.2.2.1.1.1.1.2.1.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.2">
                                                                                subscript</csymbol>
                                                                            <ci id="S2.E1.m1.2.2.2.1.1.1.1.2.2.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.2.2">𝑥
                                                                            </ci>
                                                                            <ci id="S2.E1.m1.2.2.2.1.1.1.1.2.3.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.2.3">𝑖
                                                                            </ci>
                                                                        </apply>
                                                                        <apply id="S2.E1.m1.2.2.2.1.1.1.1.3.cmml"
                                                                            xref="S2.E1.m1.2.2.2.1.1.1.1.3">
                                                                            <csymbol cd="latexml"
                                                                                id="S2.E1.m1.2.2.2.1.1.1.1.3.1.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.1">
                                                                                conditional</csymbol>
                                                                            <ci id="S2.E1.m1.2.2.2.1.1.1.1.3.2.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.2">𝑣
                                                                            </ci>
                                                                            <apply id="S2.E1.m1.2.2.2.1.1.1.1.3.3.cmml"
                                                                                xref="S2.E1.m1.2.2.2.1.1.1.1.3.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S2.E1.m1.2.2.2.1.1.1.1.3.3.1.cmml"
                                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.3.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S2.E1.m1.2.2.2.1.1.1.1.3.3.2.cmml"
                                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.2">
                                                                                    𝒙</ci>
                                                                                <apply
                                                                                    id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.cmml"
                                                                                    xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3">
                                                                                    <lt id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.1.cmml"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.1">
                                                                                    </lt>
                                                                                    <csymbol cd="latexml"
                                                                                        id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.2.cmml"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.2">
                                                                                        absent</csymbol>
                                                                                    <ci id="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.3.cmml"
                                                                                        xref="S2.E1.m1.2.2.2.1.1.1.1.3.3.3.3">
                                                                                        𝑖</ci>
                                                                                </apply>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S2.E1.m1.3.3.3.2.5.cmml"
                                                                        xref="S2.E1.m1.3.3.3.2.5">
                                                                        <log id="S2.E1.m1.3.3.3.2.5.1.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.5.1"></log>
                                                                        <apply id="S2.E1.m1.3.3.3.2.5.2.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.5.2">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S2.E1.m1.3.3.3.2.5.2.1.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.5.2">subscript
                                                                            </csymbol>
                                                                            <ci id="S2.E1.m1.3.3.3.2.5.2.2.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.5.2.2">𝑝</ci>
                                                                            <ci id="S2.E1.m1.3.3.3.2.5.2.3.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.5.2.3">𝑒</ci>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S2.E1.m1.3.3.3.2.2.1.1.cmml"
                                                                        xref="S2.E1.m1.3.3.3.2.2.1">
                                                                        <eq id="S2.E1.m1.3.3.3.2.2.1.1.1.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.1"></eq>
                                                                        <apply id="S2.E1.m1.3.3.3.2.2.1.1.2.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.2">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S2.E1.m1.3.3.3.2.2.1.1.2.1.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.2">
                                                                                subscript</csymbol>
                                                                            <ci id="S2.E1.m1.3.3.3.2.2.1.1.2.2.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.2.2">𝑥
                                                                            </ci>
                                                                            <ci id="S2.E1.m1.3.3.3.2.2.1.1.2.3.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.2.3">𝑖
                                                                            </ci>
                                                                        </apply>
                                                                        <apply id="S2.E1.m1.3.3.3.2.2.1.1.3.cmml"
                                                                            xref="S2.E1.m1.3.3.3.2.2.1.1.3">
                                                                            <csymbol cd="latexml"
                                                                                id="S2.E1.m1.3.3.3.2.2.1.1.3.1.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.1">
                                                                                conditional</csymbol>
                                                                            <ci id="S2.E1.m1.3.3.3.2.2.1.1.3.2.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.2">𝑣
                                                                            </ci>
                                                                            <apply id="S2.E1.m1.3.3.3.2.2.1.1.3.3.cmml"
                                                                                xref="S2.E1.m1.3.3.3.2.2.1.1.3.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S2.E1.m1.3.3.3.2.2.1.1.3.3.1.cmml"
                                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.3.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S2.E1.m1.3.3.3.2.2.1.1.3.3.2.cmml"
                                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.2">
                                                                                    𝒙</ci>
                                                                                <apply
                                                                                    id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.cmml"
                                                                                    xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3">
                                                                                    <lt id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.1.cmml"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.1">
                                                                                    </lt>
                                                                                    <csymbol cd="latexml"
                                                                                        id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.2.cmml"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.2">
                                                                                        absent</csymbol>
                                                                                    <ci id="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.3.cmml"
                                                                                        xref="S2.E1.m1.3.3.3.2.2.1.1.3.3.3.3">
                                                                                        𝑖</ci>
                                                                                </apply>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.E1.m1.3c">
                                                        H(x_{i})=\sum_{v\in\mathcal{V}}p_{e}(x_{i}=v|\boldsymbol{x}_{&lt;i})\log
                                                        p_{e}(x_%
                                                        {i}=v|\boldsymbol{x}_{&lt;i})</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">
                                                        italic_H ( italic_x start_POSTSUBSCRIPT italic_i
                                                        end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_v ∈
                                                        caligraphic_V end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT
                                                        italic_e end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT
                                                        italic_i end_POSTSUBSCRIPT = italic_v | bold_italic_x
                                                        start_POSTSUBSCRIPT &lt; italic_i end_POSTSUBSCRIPT ) roman_log
                                                        italic_p start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT (
                                                        italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT =
                                                        italic_v | bold_italic_x start_POSTSUBSCRIPT &lt; italic_i
                                                        end_POSTSUBSCRIPT )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption"
                                class="ltx_graphics ltx_centering ltx_img_landscape" height="126" id="S2.F4.g1"
                                src="x4.png" width="830" />
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                        class="ltx_text" id="S2.F4.12.6.1" style="font-size:90%;">Figure 4</span>:
                                </span><span class="ltx_text" id="S2.F4.10.5" style="font-size:90%;">
                                    This figure plots the entropy <math alttext="H(x_{i})" class="ltx_Math"
                                        display="inline" id="S2.F4.6.1.m1.1">
                                        <semantics id="S2.F4.6.1.m1.1b">
                                            <mrow id="S2.F4.6.1.m1.1.1" xref="S2.F4.6.1.m1.1.1.cmml">
                                                <mi id="S2.F4.6.1.m1.1.1.3" xref="S2.F4.6.1.m1.1.1.3.cmml">H</mi>
                                                <mo id="S2.F4.6.1.m1.1.1.2" xref="S2.F4.6.1.m1.1.1.2.cmml">⁢</mo>
                                                <mrow id="S2.F4.6.1.m1.1.1.1.1" xref="S2.F4.6.1.m1.1.1.1.1.1.cmml">
                                                    <mo id="S2.F4.6.1.m1.1.1.1.1.2" stretchy="false"
                                                        xref="S2.F4.6.1.m1.1.1.1.1.1.cmml">(</mo>
                                                    <msub id="S2.F4.6.1.m1.1.1.1.1.1"
                                                        xref="S2.F4.6.1.m1.1.1.1.1.1.cmml">
                                                        <mi id="S2.F4.6.1.m1.1.1.1.1.1.2"
                                                            xref="S2.F4.6.1.m1.1.1.1.1.1.2.cmml">x</mi>
                                                        <mi id="S2.F4.6.1.m1.1.1.1.1.1.3"
                                                            xref="S2.F4.6.1.m1.1.1.1.1.1.3.cmml">i</mi>
                                                    </msub>
                                                    <mo id="S2.F4.6.1.m1.1.1.1.1.3" stretchy="false"
                                                        xref="S2.F4.6.1.m1.1.1.1.1.1.cmml">)</mo>
                                                </mrow>
                                            </mrow><annotation-xml encoding="MathML-Content" id="S2.F4.6.1.m1.1c">
                                                <apply id="S2.F4.6.1.m1.1.1.cmml" xref="S2.F4.6.1.m1.1.1">
                                                    <times id="S2.F4.6.1.m1.1.1.2.cmml" xref="S2.F4.6.1.m1.1.1.2">
                                                    </times>
                                                    <ci id="S2.F4.6.1.m1.1.1.3.cmml" xref="S2.F4.6.1.m1.1.1.3">𝐻</ci>
                                                    <apply id="S2.F4.6.1.m1.1.1.1.1.1.cmml" xref="S2.F4.6.1.m1.1.1.1.1">
                                                        <csymbol cd="ambiguous" id="S2.F4.6.1.m1.1.1.1.1.1.1.cmml"
                                                            xref="S2.F4.6.1.m1.1.1.1.1">subscript</csymbol>
                                                        <ci id="S2.F4.6.1.m1.1.1.1.1.1.2.cmml"
                                                            xref="S2.F4.6.1.m1.1.1.1.1.1.2">𝑥</ci>
                                                        <ci id="S2.F4.6.1.m1.1.1.1.1.1.3.cmml"
                                                            xref="S2.F4.6.1.m1.1.1.1.1.1.3">𝑖</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S2.F4.6.1.m1.1d">H(x_{i})
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S2.F4.6.1.m1.1e">italic_H
                                                ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation>
                                        </semantics>
                                    </math> of each byte in “Daenerys Targeryen is in Game of Thrones, a fantasy epic by
                                    George R.R. Martin.” with spaces shown as underscores.
                                    Patches end when <math alttext="H(x_{i})" class="ltx_Math" display="inline"
                                        id="S2.F4.7.2.m2.1">
                                        <semantics id="S2.F4.7.2.m2.1b">
                                            <mrow id="S2.F4.7.2.m2.1.1" xref="S2.F4.7.2.m2.1.1.cmml">
                                                <mi id="S2.F4.7.2.m2.1.1.3" xref="S2.F4.7.2.m2.1.1.3.cmml">H</mi>
                                                <mo id="S2.F4.7.2.m2.1.1.2" xref="S2.F4.7.2.m2.1.1.2.cmml">⁢</mo>
                                                <mrow id="S2.F4.7.2.m2.1.1.1.1" xref="S2.F4.7.2.m2.1.1.1.1.1.cmml">
                                                    <mo id="S2.F4.7.2.m2.1.1.1.1.2" stretchy="false"
                                                        xref="S2.F4.7.2.m2.1.1.1.1.1.cmml">(</mo>
                                                    <msub id="S2.F4.7.2.m2.1.1.1.1.1"
                                                        xref="S2.F4.7.2.m2.1.1.1.1.1.cmml">
                                                        <mi id="S2.F4.7.2.m2.1.1.1.1.1.2"
                                                            xref="S2.F4.7.2.m2.1.1.1.1.1.2.cmml">x</mi>
                                                        <mi id="S2.F4.7.2.m2.1.1.1.1.1.3"
                                                            xref="S2.F4.7.2.m2.1.1.1.1.1.3.cmml">i</mi>
                                                    </msub>
                                                    <mo id="S2.F4.7.2.m2.1.1.1.1.3" stretchy="false"
                                                        xref="S2.F4.7.2.m2.1.1.1.1.1.cmml">)</mo>
                                                </mrow>
                                            </mrow><annotation-xml encoding="MathML-Content" id="S2.F4.7.2.m2.1c">
                                                <apply id="S2.F4.7.2.m2.1.1.cmml" xref="S2.F4.7.2.m2.1.1">
                                                    <times id="S2.F4.7.2.m2.1.1.2.cmml" xref="S2.F4.7.2.m2.1.1.2">
                                                    </times>
                                                    <ci id="S2.F4.7.2.m2.1.1.3.cmml" xref="S2.F4.7.2.m2.1.1.3">𝐻</ci>
                                                    <apply id="S2.F4.7.2.m2.1.1.1.1.1.cmml" xref="S2.F4.7.2.m2.1.1.1.1">
                                                        <csymbol cd="ambiguous" id="S2.F4.7.2.m2.1.1.1.1.1.1.cmml"
                                                            xref="S2.F4.7.2.m2.1.1.1.1">subscript</csymbol>
                                                        <ci id="S2.F4.7.2.m2.1.1.1.1.1.2.cmml"
                                                            xref="S2.F4.7.2.m2.1.1.1.1.1.2">𝑥</ci>
                                                        <ci id="S2.F4.7.2.m2.1.1.1.1.1.3.cmml"
                                                            xref="S2.F4.7.2.m2.1.1.1.1.1.3">𝑖</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S2.F4.7.2.m2.1d">H(x_{i})
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S2.F4.7.2.m2.1e">italic_H
                                                ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation>
                                        </semantics>
                                    </math> exceeds the global threshold <math alttext="\theta_{g}" class="ltx_Math"
                                        display="inline" id="S2.F4.8.3.m3.1">
                                        <semantics id="S2.F4.8.3.m3.1b">
                                            <msub id="S2.F4.8.3.m3.1.1" xref="S2.F4.8.3.m3.1.1.cmml">
                                                <mi id="S2.F4.8.3.m3.1.1.2" xref="S2.F4.8.3.m3.1.1.2.cmml">θ</mi>
                                                <mi id="S2.F4.8.3.m3.1.1.3" xref="S2.F4.8.3.m3.1.1.3.cmml">g</mi>
                                            </msub><annotation-xml encoding="MathML-Content" id="S2.F4.8.3.m3.1c">
                                                <apply id="S2.F4.8.3.m3.1.1.cmml" xref="S2.F4.8.3.m3.1.1">
                                                    <csymbol cd="ambiguous" id="S2.F4.8.3.m3.1.1.1.cmml"
                                                        xref="S2.F4.8.3.m3.1.1">subscript</csymbol>
                                                    <ci id="S2.F4.8.3.m3.1.1.2.cmml" xref="S2.F4.8.3.m3.1.1.2">𝜃</ci>
                                                    <ci id="S2.F4.8.3.m3.1.1.3.cmml" xref="S2.F4.8.3.m3.1.1.3">𝑔</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S2.F4.8.3.m3.1d">\theta_{g}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S2.F4.8.3.m3.1e">italic_θ
                                                start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, shown as a red horizontal line.
                                    The start of new patches are shown with vertical gray lines.
                                    For example, the entropies of “G” and “e” in “George R.R. Martin” exceed <math
                                        alttext="\theta_{g}" class="ltx_Math" display="inline" id="S2.F4.9.4.m4.1">
                                        <semantics id="S2.F4.9.4.m4.1b">
                                            <msub id="S2.F4.9.4.m4.1.1" xref="S2.F4.9.4.m4.1.1.cmml">
                                                <mi id="S2.F4.9.4.m4.1.1.2" xref="S2.F4.9.4.m4.1.1.2.cmml">θ</mi>
                                                <mi id="S2.F4.9.4.m4.1.1.3" xref="S2.F4.9.4.m4.1.1.3.cmml">g</mi>
                                            </msub><annotation-xml encoding="MathML-Content" id="S2.F4.9.4.m4.1c">
                                                <apply id="S2.F4.9.4.m4.1.1.cmml" xref="S2.F4.9.4.m4.1.1">
                                                    <csymbol cd="ambiguous" id="S2.F4.9.4.m4.1.1.1.cmml"
                                                        xref="S2.F4.9.4.m4.1.1">subscript</csymbol>
                                                    <ci id="S2.F4.9.4.m4.1.1.2.cmml" xref="S2.F4.9.4.m4.1.1.2">𝜃</ci>
                                                    <ci id="S2.F4.9.4.m4.1.1.3.cmml" xref="S2.F4.9.4.m4.1.1.3">𝑔</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S2.F4.9.4.m4.1d">\theta_{g}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S2.F4.9.4.m4.1e">italic_θ
                                                start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, so “G” is the start of a single byte patch and “e” of a larger patch
                                    extending to the end of the named entity as the entropy <math alttext="H(x_{i})"
                                        class="ltx_Math" display="inline" id="S2.F4.10.5.m5.1">
                                        <semantics id="S2.F4.10.5.m5.1b">
                                            <mrow id="S2.F4.10.5.m5.1.1" xref="S2.F4.10.5.m5.1.1.cmml">
                                                <mi id="S2.F4.10.5.m5.1.1.3" xref="S2.F4.10.5.m5.1.1.3.cmml">H</mi>
                                                <mo id="S2.F4.10.5.m5.1.1.2" xref="S2.F4.10.5.m5.1.1.2.cmml">⁢</mo>
                                                <mrow id="S2.F4.10.5.m5.1.1.1.1" xref="S2.F4.10.5.m5.1.1.1.1.1.cmml">
                                                    <mo id="S2.F4.10.5.m5.1.1.1.1.2" stretchy="false"
                                                        xref="S2.F4.10.5.m5.1.1.1.1.1.cmml">(</mo>
                                                    <msub id="S2.F4.10.5.m5.1.1.1.1.1"
                                                        xref="S2.F4.10.5.m5.1.1.1.1.1.cmml">
                                                        <mi id="S2.F4.10.5.m5.1.1.1.1.1.2"
                                                            xref="S2.F4.10.5.m5.1.1.1.1.1.2.cmml">x</mi>
                                                        <mi id="S2.F4.10.5.m5.1.1.1.1.1.3"
                                                            xref="S2.F4.10.5.m5.1.1.1.1.1.3.cmml">i</mi>
                                                    </msub>
                                                    <mo id="S2.F4.10.5.m5.1.1.1.1.3" stretchy="false"
                                                        xref="S2.F4.10.5.m5.1.1.1.1.1.cmml">)</mo>
                                                </mrow>
                                            </mrow><annotation-xml encoding="MathML-Content" id="S2.F4.10.5.m5.1c">
                                                <apply id="S2.F4.10.5.m5.1.1.cmml" xref="S2.F4.10.5.m5.1.1">
                                                    <times id="S2.F4.10.5.m5.1.1.2.cmml" xref="S2.F4.10.5.m5.1.1.2">
                                                    </times>
                                                    <ci id="S2.F4.10.5.m5.1.1.3.cmml" xref="S2.F4.10.5.m5.1.1.3">𝐻</ci>
                                                    <apply id="S2.F4.10.5.m5.1.1.1.1.1.cmml"
                                                        xref="S2.F4.10.5.m5.1.1.1.1">
                                                        <csymbol cd="ambiguous" id="S2.F4.10.5.m5.1.1.1.1.1.1.cmml"
                                                            xref="S2.F4.10.5.m5.1.1.1.1">subscript</csymbol>
                                                        <ci id="S2.F4.10.5.m5.1.1.1.1.1.2.cmml"
                                                            xref="S2.F4.10.5.m5.1.1.1.1.1.2">𝑥</ci>
                                                        <ci id="S2.F4.10.5.m5.1.1.1.1.1.3.cmml"
                                                            xref="S2.F4.10.5.m5.1.1.1.1.1.3">𝑖</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S2.F4.10.5.m5.1d">H(x_{i})
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S2.F4.10.5.m5.1e">italic_H
                                                ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation>
                                        </semantics>
                                    </math> stays low, resulting in no additional patches.
                                </span></figcaption>
                        </figure>
                        <div class="ltx_para" id="S2.SS3.p3">
                            <p class="ltx_p" id="S2.SS3.p3.1">We experiment with two methods to identify patch
                                boundaries given entropies <math alttext="H(x_{i})" class="ltx_Math" display="inline"
                                    id="S2.SS3.p3.1.m1.1">
                                    <semantics id="S2.SS3.p3.1.m1.1a">
                                        <mrow id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">
                                            <mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">H</mi>
                                            <mo id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">⁢</mo>
                                            <mrow id="S2.SS3.p3.1.m1.1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.1.1.cmml">
                                                <mo id="S2.SS3.p3.1.m1.1.1.1.1.2" stretchy="false"
                                                    xref="S2.SS3.p3.1.m1.1.1.1.1.1.cmml">(</mo>
                                                <msub id="S2.SS3.p3.1.m1.1.1.1.1.1"
                                                    xref="S2.SS3.p3.1.m1.1.1.1.1.1.cmml">
                                                    <mi id="S2.SS3.p3.1.m1.1.1.1.1.1.2"
                                                        xref="S2.SS3.p3.1.m1.1.1.1.1.1.2.cmml">x</mi>
                                                    <mi id="S2.SS3.p3.1.m1.1.1.1.1.1.3"
                                                        xref="S2.SS3.p3.1.m1.1.1.1.1.1.3.cmml">i</mi>
                                                </msub>
                                                <mo id="S2.SS3.p3.1.m1.1.1.1.1.3" stretchy="false"
                                                    xref="S2.SS3.p3.1.m1.1.1.1.1.1.cmml">)</mo>
                                            </mrow>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b">
                                            <apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">
                                                <times id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">
                                                </times>
                                                <ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝐻</ci>
                                                <apply id="S2.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1.1">
                                                    <csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.1.1.1.1.1.1.cmml"
                                                        xref="S2.SS3.p3.1.m1.1.1.1.1">subscript</csymbol>
                                                    <ci id="S2.SS3.p3.1.m1.1.1.1.1.1.2.cmml"
                                                        xref="S2.SS3.p3.1.m1.1.1.1.1.1.2">𝑥</ci>
                                                    <ci id="S2.SS3.p3.1.m1.1.1.1.1.1.3.cmml"
                                                        xref="S2.SS3.p3.1.m1.1.1.1.1.1.3">𝑖</ci>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">H(x_{i})
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.1d">italic_H (
                                            italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation>
                                    </semantics>
                                </math>. The first, finds points above a global entropy threshold, as illustrated in <a
                                    class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S2.F4"
                                    title="Figure 4 ‣ 2.3 Entropy Patching: Using Next-Byte Entropies from a Small Byte LM ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 4</span></a>. The second, identifies points
                                that are high relative to the previous entropy. The second approach can also be
                                interpreted as identifying points that break approximate monotonically decreasing
                                entropy withing the patch.</p>
                            <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx1">
                                <tbody id="S2.Ex1">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                alttext="\displaystyle\text{Global Constraint}\hskip 28.45274ptH(x_{t})"
                                                class="ltx_Math" display="inline" id="S2.Ex1.m1.2">
                                                <semantics id="S2.Ex1.m1.2a">
                                                    <mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.2.cmml">
                                                        <mtext id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1a.cmml">Global
                                                            Constraint</mtext>
                                                        <mspace id="S2.Ex1.m1.2.2.1.2" width="2.85em"
                                                            xref="S2.Ex1.m1.2.2.2.cmml"></mspace>
                                                        <mrow id="S2.Ex1.m1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.cmml">
                                                            <mi id="S2.Ex1.m1.2.2.1.1.3"
                                                                xref="S2.Ex1.m1.2.2.1.1.3.cmml">H</mi>
                                                            <mo id="S2.Ex1.m1.2.2.1.1.2"
                                                                xref="S2.Ex1.m1.2.2.1.1.2.cmml">⁢</mo>
                                                            <mrow id="S2.Ex1.m1.2.2.1.1.1.1"
                                                                xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml">
                                                                <mo id="S2.Ex1.m1.2.2.1.1.1.1.2" stretchy="false"
                                                                    xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml">(</mo>
                                                                <msub id="S2.Ex1.m1.2.2.1.1.1.1.1"
                                                                    xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml">
                                                                    <mi id="S2.Ex1.m1.2.2.1.1.1.1.1.2"
                                                                        xref="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml">x</mi>
                                                                    <mi id="S2.Ex1.m1.2.2.1.1.1.1.1.3"
                                                                        xref="S2.Ex1.m1.2.2.1.1.1.1.1.3.cmml">t</mi>
                                                                </msub>
                                                                <mo id="S2.Ex1.m1.2.2.1.1.1.1.3" stretchy="false"
                                                                    xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml">)</mo>
                                                            </mrow>
                                                        </mrow>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b">
                                                        <list id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1">
                                                            <ci id="S2.Ex1.m1.1.1a.cmml" xref="S2.Ex1.m1.1.1">
                                                                <mtext id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">
                                                                    Global Constraint</mtext>
                                                            </ci>
                                                            <apply id="S2.Ex1.m1.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1">
                                                                <times id="S2.Ex1.m1.2.2.1.1.2.cmml"
                                                                    xref="S2.Ex1.m1.2.2.1.1.2"></times>
                                                                <ci id="S2.Ex1.m1.2.2.1.1.3.cmml"
                                                                    xref="S2.Ex1.m1.2.2.1.1.3">𝐻</ci>
                                                                <apply id="S2.Ex1.m1.2.2.1.1.1.1.1.cmml"
                                                                    xref="S2.Ex1.m1.2.2.1.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"
                                                                        xref="S2.Ex1.m1.2.2.1.1.1.1">subscript</csymbol>
                                                                    <ci id="S2.Ex1.m1.2.2.1.1.1.1.1.2.cmml"
                                                                        xref="S2.Ex1.m1.2.2.1.1.1.1.1.2">𝑥</ci>
                                                                    <ci id="S2.Ex1.m1.2.2.1.1.1.1.1.3.cmml"
                                                                        xref="S2.Ex1.m1.2.2.1.1.1.1.1.3">𝑡</ci>
                                                                </apply>
                                                            </apply>
                                                        </list>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">
                                                        \displaystyle\text{Global Constraint}\hskip 28.45274ptH(x_{t})
                                                    </annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">
                                                        Global Constraint italic_H ( italic_x start_POSTSUBSCRIPT
                                                        italic_t end_POSTSUBSCRIPT )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                alttext="\displaystyle&gt;\theta_{g}" class="ltx_Math" display="inline"
                                                id="S2.Ex1.m2.1">
                                                <semantics id="S2.Ex1.m2.1a">
                                                    <mrow id="S2.Ex1.m2.1.1" xref="S2.Ex1.m2.1.1.cmml">
                                                        <mi id="S2.Ex1.m2.1.1.2" xref="S2.Ex1.m2.1.1.2.cmml"></mi>
                                                        <mo id="S2.Ex1.m2.1.1.1" xref="S2.Ex1.m2.1.1.1.cmml">&gt;</mo>
                                                        <msub id="S2.Ex1.m2.1.1.3" xref="S2.Ex1.m2.1.1.3.cmml">
                                                            <mi id="S2.Ex1.m2.1.1.3.2" xref="S2.Ex1.m2.1.1.3.2.cmml">θ
                                                            </mi>
                                                            <mi id="S2.Ex1.m2.1.1.3.3" xref="S2.Ex1.m2.1.1.3.3.cmml">g
                                                            </mi>
                                                        </msub>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m2.1b">
                                                        <apply id="S2.Ex1.m2.1.1.cmml" xref="S2.Ex1.m2.1.1">
                                                            <gt id="S2.Ex1.m2.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1"></gt>
                                                            <csymbol cd="latexml" id="S2.Ex1.m2.1.1.2.cmml"
                                                                xref="S2.Ex1.m2.1.1.2">absent</csymbol>
                                                            <apply id="S2.Ex1.m2.1.1.3.cmml" xref="S2.Ex1.m2.1.1.3">
                                                                <csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.3.1.cmml"
                                                                    xref="S2.Ex1.m2.1.1.3">subscript</csymbol>
                                                                <ci id="S2.Ex1.m2.1.1.3.2.cmml"
                                                                    xref="S2.Ex1.m2.1.1.3.2">𝜃</ci>
                                                                <ci id="S2.Ex1.m2.1.1.3.3.cmml"
                                                                    xref="S2.Ex1.m2.1.1.3.3">𝑔</ci>
                                                            </apply>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.Ex1.m2.1c">
                                                        \displaystyle&gt;\theta_{g}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.Ex1.m2.1d">&gt;
                                                        italic_θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT
                                                    </annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    </tr>
                                </tbody>
                                <tbody id="S2.Ex2">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                alttext="\displaystyle\text{Approx. Monotonic Constraint}\hskip 28.45274ptH(x_{t})"
                                                class="ltx_Math" display="inline" id="S2.Ex2.m1.2">
                                                <semantics id="S2.Ex2.m1.2a">
                                                    <mrow id="S2.Ex2.m1.2.2.1" xref="S2.Ex2.m1.2.2.2.cmml">
                                                        <mtext id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1a.cmml">Approx.
                                                            Monotonic Constraint</mtext>
                                                        <mspace id="S2.Ex2.m1.2.2.1.2" width="2.85em"
                                                            xref="S2.Ex2.m1.2.2.2.cmml"></mspace>
                                                        <mrow id="S2.Ex2.m1.2.2.1.1" xref="S2.Ex2.m1.2.2.1.1.cmml">
                                                            <mi id="S2.Ex2.m1.2.2.1.1.3"
                                                                xref="S2.Ex2.m1.2.2.1.1.3.cmml">H</mi>
                                                            <mo id="S2.Ex2.m1.2.2.1.1.2"
                                                                xref="S2.Ex2.m1.2.2.1.1.2.cmml">⁢</mo>
                                                            <mrow id="S2.Ex2.m1.2.2.1.1.1.1"
                                                                xref="S2.Ex2.m1.2.2.1.1.1.1.1.cmml">
                                                                <mo id="S2.Ex2.m1.2.2.1.1.1.1.2" stretchy="false"
                                                                    xref="S2.Ex2.m1.2.2.1.1.1.1.1.cmml">(</mo>
                                                                <msub id="S2.Ex2.m1.2.2.1.1.1.1.1"
                                                                    xref="S2.Ex2.m1.2.2.1.1.1.1.1.cmml">
                                                                    <mi id="S2.Ex2.m1.2.2.1.1.1.1.1.2"
                                                                        xref="S2.Ex2.m1.2.2.1.1.1.1.1.2.cmml">x</mi>
                                                                    <mi id="S2.Ex2.m1.2.2.1.1.1.1.1.3"
                                                                        xref="S2.Ex2.m1.2.2.1.1.1.1.1.3.cmml">t</mi>
                                                                </msub>
                                                                <mo id="S2.Ex2.m1.2.2.1.1.1.1.3" stretchy="false"
                                                                    xref="S2.Ex2.m1.2.2.1.1.1.1.1.cmml">)</mo>
                                                            </mrow>
                                                        </mrow>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.2b">
                                                        <list id="S2.Ex2.m1.2.2.2.cmml" xref="S2.Ex2.m1.2.2.1">
                                                            <ci id="S2.Ex2.m1.1.1a.cmml" xref="S2.Ex2.m1.1.1">
                                                                <mtext id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">
                                                                    Approx. Monotonic Constraint</mtext>
                                                            </ci>
                                                            <apply id="S2.Ex2.m1.2.2.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1">
                                                                <times id="S2.Ex2.m1.2.2.1.1.2.cmml"
                                                                    xref="S2.Ex2.m1.2.2.1.1.2"></times>
                                                                <ci id="S2.Ex2.m1.2.2.1.1.3.cmml"
                                                                    xref="S2.Ex2.m1.2.2.1.1.3">𝐻</ci>
                                                                <apply id="S2.Ex2.m1.2.2.1.1.1.1.1.cmml"
                                                                    xref="S2.Ex2.m1.2.2.1.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex2.m1.2.2.1.1.1.1.1.1.cmml"
                                                                        xref="S2.Ex2.m1.2.2.1.1.1.1">subscript</csymbol>
                                                                    <ci id="S2.Ex2.m1.2.2.1.1.1.1.1.2.cmml"
                                                                        xref="S2.Ex2.m1.2.2.1.1.1.1.1.2">𝑥</ci>
                                                                    <ci id="S2.Ex2.m1.2.2.1.1.1.1.1.3.cmml"
                                                                        xref="S2.Ex2.m1.2.2.1.1.1.1.1.3">𝑡</ci>
                                                                </apply>
                                                            </apply>
                                                        </list>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.Ex2.m1.2c">
                                                        \displaystyle\text{Approx. Monotonic Constraint}\hskip
                                                        28.45274ptH(x_{t})</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.Ex2.m1.2d">
                                                        Approx. Monotonic Constraint italic_H ( italic_x
                                                        start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                alttext="\displaystyle-H(x_{t-1})&gt;\theta_{r}" class="ltx_Math"
                                                display="inline" id="S2.Ex2.m2.1">
                                                <semantics id="S2.Ex2.m2.1a">
                                                    <mrow id="S2.Ex2.m2.1.1" xref="S2.Ex2.m2.1.1.cmml">
                                                        <mrow id="S2.Ex2.m2.1.1.1" xref="S2.Ex2.m2.1.1.1.cmml">
                                                            <mo id="S2.Ex2.m2.1.1.1a" xref="S2.Ex2.m2.1.1.1.cmml">−</mo>
                                                            <mrow id="S2.Ex2.m2.1.1.1.1" xref="S2.Ex2.m2.1.1.1.1.cmml">
                                                                <mi id="S2.Ex2.m2.1.1.1.1.3"
                                                                    xref="S2.Ex2.m2.1.1.1.1.3.cmml">H</mi>
                                                                <mo id="S2.Ex2.m2.1.1.1.1.2"
                                                                    xref="S2.Ex2.m2.1.1.1.1.2.cmml">⁢</mo>
                                                                <mrow id="S2.Ex2.m2.1.1.1.1.1.1"
                                                                    xref="S2.Ex2.m2.1.1.1.1.1.1.1.cmml">
                                                                    <mo id="S2.Ex2.m2.1.1.1.1.1.1.2" stretchy="false"
                                                                        xref="S2.Ex2.m2.1.1.1.1.1.1.1.cmml">(</mo>
                                                                    <msub id="S2.Ex2.m2.1.1.1.1.1.1.1"
                                                                        xref="S2.Ex2.m2.1.1.1.1.1.1.1.cmml">
                                                                        <mi id="S2.Ex2.m2.1.1.1.1.1.1.1.2"
                                                                            xref="S2.Ex2.m2.1.1.1.1.1.1.1.2.cmml">x</mi>
                                                                        <mrow id="S2.Ex2.m2.1.1.1.1.1.1.1.3"
                                                                            xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.cmml">
                                                                            <mi id="S2.Ex2.m2.1.1.1.1.1.1.1.3.2"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.2.cmml">
                                                                                t</mi>
                                                                            <mo id="S2.Ex2.m2.1.1.1.1.1.1.1.3.1"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.1.cmml">
                                                                                −</mo>
                                                                            <mn id="S2.Ex2.m2.1.1.1.1.1.1.1.3.3"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.3.cmml">
                                                                                1</mn>
                                                                        </mrow>
                                                                    </msub>
                                                                    <mo id="S2.Ex2.m2.1.1.1.1.1.1.3" stretchy="false"
                                                                        xref="S2.Ex2.m2.1.1.1.1.1.1.1.cmml">)</mo>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow>
                                                        <mo id="S2.Ex2.m2.1.1.2" xref="S2.Ex2.m2.1.1.2.cmml">&gt;</mo>
                                                        <msub id="S2.Ex2.m2.1.1.3" xref="S2.Ex2.m2.1.1.3.cmml">
                                                            <mi id="S2.Ex2.m2.1.1.3.2" xref="S2.Ex2.m2.1.1.3.2.cmml">θ
                                                            </mi>
                                                            <mi id="S2.Ex2.m2.1.1.3.3" xref="S2.Ex2.m2.1.1.3.3.cmml">r
                                                            </mi>
                                                        </msub>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m2.1b">
                                                        <apply id="S2.Ex2.m2.1.1.cmml" xref="S2.Ex2.m2.1.1">
                                                            <gt id="S2.Ex2.m2.1.1.2.cmml" xref="S2.Ex2.m2.1.1.2"></gt>
                                                            <apply id="S2.Ex2.m2.1.1.1.cmml" xref="S2.Ex2.m2.1.1.1">
                                                                <minus id="S2.Ex2.m2.1.1.1.2.cmml"
                                                                    xref="S2.Ex2.m2.1.1.1"></minus>
                                                                <apply id="S2.Ex2.m2.1.1.1.1.cmml"
                                                                    xref="S2.Ex2.m2.1.1.1.1">
                                                                    <times id="S2.Ex2.m2.1.1.1.1.2.cmml"
                                                                        xref="S2.Ex2.m2.1.1.1.1.2"></times>
                                                                    <ci id="S2.Ex2.m2.1.1.1.1.3.cmml"
                                                                        xref="S2.Ex2.m2.1.1.1.1.3">𝐻</ci>
                                                                    <apply id="S2.Ex2.m2.1.1.1.1.1.1.1.cmml"
                                                                        xref="S2.Ex2.m2.1.1.1.1.1.1">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S2.Ex2.m2.1.1.1.1.1.1.1.1.cmml"
                                                                            xref="S2.Ex2.m2.1.1.1.1.1.1">subscript
                                                                        </csymbol>
                                                                        <ci id="S2.Ex2.m2.1.1.1.1.1.1.1.2.cmml"
                                                                            xref="S2.Ex2.m2.1.1.1.1.1.1.1.2">𝑥</ci>
                                                                        <apply id="S2.Ex2.m2.1.1.1.1.1.1.1.3.cmml"
                                                                            xref="S2.Ex2.m2.1.1.1.1.1.1.1.3">
                                                                            <minus id="S2.Ex2.m2.1.1.1.1.1.1.1.3.1.cmml"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.1">
                                                                            </minus>
                                                                            <ci id="S2.Ex2.m2.1.1.1.1.1.1.1.3.2.cmml"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.2">𝑡
                                                                            </ci>
                                                                            <cn id="S2.Ex2.m2.1.1.1.1.1.1.1.3.3.cmml"
                                                                                type="integer"
                                                                                xref="S2.Ex2.m2.1.1.1.1.1.1.1.3.3">1
                                                                            </cn>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                            <apply id="S2.Ex2.m2.1.1.3.cmml" xref="S2.Ex2.m2.1.1.3">
                                                                <csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.3.1.cmml"
                                                                    xref="S2.Ex2.m2.1.1.3">subscript</csymbol>
                                                                <ci id="S2.Ex2.m2.1.1.3.2.cmml"
                                                                    xref="S2.Ex2.m2.1.1.3.2">𝜃</ci>
                                                                <ci id="S2.Ex2.m2.1.1.3.3.cmml"
                                                                    xref="S2.Ex2.m2.1.1.3.3">𝑟</ci>
                                                            </apply>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.Ex2.m2.1c">
                                                        \displaystyle-H(x_{t-1})&gt;\theta_{r}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.Ex2.m2.1d">-
                                                        italic_H ( italic_x start_POSTSUBSCRIPT italic_t - 1
                                                        end_POSTSUBSCRIPT ) &gt; italic_θ start_POSTSUBSCRIPT italic_r
                                                        end_POSTSUBSCRIPT</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="ltx_p" id="S2.SS3.p3.2">Patch boundaries are identified during a lightweight
                                preprocessing step executed during dataloading. This is different from <cite
                                    class="ltx_cite ltx_citemacro_citet">Nawrot et al. (<a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib34" title="">2023</a>)</cite>
                                where classifier is trained to predict entropy-based patch boundaries.
                                In our experiments (§<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S4"
                                    title="4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">4</span></a>), we compare these two methods for
                                distinguishing between low and high entropy bytes.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S2.SS4">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">2.4 </span>The Byte-Pair Encoding (BPE) Tokenizer
                            and Incremental Patching
                        </h3>
                        <div class="ltx_para" id="S2.SS4.p1">
                            <p class="ltx_p" id="S2.SS4.p1.1">Many modern <span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS4.p1.1.1">llm</span>s, including our baseline Llama 3, use a subword
                                tokenizer like <span class="ltx_text ltx_font_smallcaps" id="S2.SS4.p1.1.2">bpe</span>
                                <cite class="ltx_cite ltx_citemacro_citep">(Gage, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib16" title="">1994</a>; Sennrich
                                    et al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib37"
                                        title="">2016</a>)</cite>.
                                We use “tokens” to refer to byte-groups drawn from a <span
                                    class="ltx_text ltx_font_italic" id="S2.SS4.p1.1.3">finite</span> vocabulary
                                determined prior to training as opposed to “patches” which refer to dynamically grouped
                                sequences without a fixed vocabulary.
                                A critical difference between patches and tokens is that with tokens, the model has no
                                direct access to the underlying byte features.</p>
                        </div>
                        <div class="ltx_para" id="S2.SS4.p2">
                            <p class="ltx_p" id="S2.SS4.p2.1">A crucial improvement of <span
                                    class="ltx_text ltx_font_smallcaps" id="S2.SS4.p2.1.1">B</span>LT over
                                tokenization-based models is that redefines the trade off between the vocabulary size
                                and compute. In standard <span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS4.p2.1.2">llm</span>s, increasing the size of the vocabulary means larger
                                tokens on average and therefore fewer steps for the model but also larger output
                                dimension for the final projection layer of the model. This trade off effectively leaves
                                little room for tokenization based approaches to achieve significant variations in token
                                size and inference cost. For example, Llama 3 increases the average token size from 3.7
                                to 4.4 bytes at the cost of increasing the size of its embedding table 4x compared to
                                Llama 2.</p>
                        </div>
                        <div class="ltx_para" id="S2.SS4.p3">
                            <p class="ltx_p" id="S2.SS4.p3.1">When generating, <span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS4.p3.1.1">B</span>LT needs to decide whether the current step in the byte
                                sequence is at a patch boundary or not as this determines whether more compute is
                                invoked via the Latent Transformer. This decision needs to occur independently of the
                                rest of the sequence which has yet to be generated. Thus patching cannot assume access
                                to future bytes in order to choose how to segment the byte sequence. Formally, a
                                patching scheme <math alttext="f_{p}" class="ltx_Math" display="inline"
                                    id="S2.SS4.p3.1.m1.1">
                                    <semantics id="S2.SS4.p3.1.m1.1a">
                                        <msub id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml">
                                            <mi id="S2.SS4.p3.1.m1.1.1.2" xref="S2.SS4.p3.1.m1.1.1.2.cmml">f</mi>
                                            <mi id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3.cmml">p</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b">
                                            <apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">
                                                <csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.1.cmml"
                                                    xref="S2.SS4.p3.1.m1.1.1">subscript</csymbol>
                                                <ci id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2">𝑓</ci>
                                                <ci id="S2.SS4.p3.1.m1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3">𝑝</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">f_{p}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.1d">italic_f
                                            start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> satisfies the property of incremental patching if it satisfies:</p>
                            <table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
                                <tbody>
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_eqn_cell ltx_align_center"><math
                                                alttext="f_{p}(\boldsymbol{x}_{&lt;i})=f_{p}(\boldsymbol{x})_{&lt;i}"
                                                class="ltx_Math" display="block" id="S2.Ex3.m1.2">
                                                <semantics id="S2.Ex3.m1.2a">
                                                    <mrow id="S2.Ex3.m1.2.2" xref="S2.Ex3.m1.2.2.cmml">
                                                        <mrow id="S2.Ex3.m1.2.2.1" xref="S2.Ex3.m1.2.2.1.cmml">
                                                            <msub id="S2.Ex3.m1.2.2.1.3" xref="S2.Ex3.m1.2.2.1.3.cmml">
                                                                <mi id="S2.Ex3.m1.2.2.1.3.2"
                                                                    xref="S2.Ex3.m1.2.2.1.3.2.cmml">f</mi>
                                                                <mi id="S2.Ex3.m1.2.2.1.3.3"
                                                                    xref="S2.Ex3.m1.2.2.1.3.3.cmml">p</mi>
                                                            </msub>
                                                            <mo id="S2.Ex3.m1.2.2.1.2" xref="S2.Ex3.m1.2.2.1.2.cmml">⁢
                                                            </mo>
                                                            <mrow id="S2.Ex3.m1.2.2.1.1.1"
                                                                xref="S2.Ex3.m1.2.2.1.1.1.1.cmml">
                                                                <mo id="S2.Ex3.m1.2.2.1.1.1.2" stretchy="false"
                                                                    xref="S2.Ex3.m1.2.2.1.1.1.1.cmml">(</mo>
                                                                <msub id="S2.Ex3.m1.2.2.1.1.1.1"
                                                                    xref="S2.Ex3.m1.2.2.1.1.1.1.cmml">
                                                                    <mi id="S2.Ex3.m1.2.2.1.1.1.1.2"
                                                                        xref="S2.Ex3.m1.2.2.1.1.1.1.2.cmml">𝒙</mi>
                                                                    <mrow id="S2.Ex3.m1.2.2.1.1.1.1.3"
                                                                        xref="S2.Ex3.m1.2.2.1.1.1.1.3.cmml">
                                                                        <mi id="S2.Ex3.m1.2.2.1.1.1.1.3.2"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.2.cmml"></mi>
                                                                        <mo id="S2.Ex3.m1.2.2.1.1.1.1.3.1"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.1.cmml">&lt;
                                                                        </mo>
                                                                        <mi id="S2.Ex3.m1.2.2.1.1.1.1.3.3"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.3.cmml">i</mi>
                                                                    </mrow>
                                                                </msub>
                                                                <mo id="S2.Ex3.m1.2.2.1.1.1.3" stretchy="false"
                                                                    xref="S2.Ex3.m1.2.2.1.1.1.1.cmml">)</mo>
                                                            </mrow>
                                                        </mrow>
                                                        <mo id="S2.Ex3.m1.2.2.2" xref="S2.Ex3.m1.2.2.2.cmml">=</mo>
                                                        <mrow id="S2.Ex3.m1.2.2.3" xref="S2.Ex3.m1.2.2.3.cmml">
                                                            <msub id="S2.Ex3.m1.2.2.3.2" xref="S2.Ex3.m1.2.2.3.2.cmml">
                                                                <mi id="S2.Ex3.m1.2.2.3.2.2"
                                                                    xref="S2.Ex3.m1.2.2.3.2.2.cmml">f</mi>
                                                                <mi id="S2.Ex3.m1.2.2.3.2.3"
                                                                    xref="S2.Ex3.m1.2.2.3.2.3.cmml">p</mi>
                                                            </msub>
                                                            <mo id="S2.Ex3.m1.2.2.3.1" xref="S2.Ex3.m1.2.2.3.1.cmml">⁢
                                                            </mo>
                                                            <msub id="S2.Ex3.m1.2.2.3.3" xref="S2.Ex3.m1.2.2.3.3.cmml">
                                                                <mrow id="S2.Ex3.m1.2.2.3.3.2.2"
                                                                    xref="S2.Ex3.m1.2.2.3.3.cmml">
                                                                    <mo id="S2.Ex3.m1.2.2.3.3.2.2.1" stretchy="false"
                                                                        xref="S2.Ex3.m1.2.2.3.3.cmml">(</mo>
                                                                    <mi id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml">𝒙
                                                                    </mi>
                                                                    <mo id="S2.Ex3.m1.2.2.3.3.2.2.2" stretchy="false"
                                                                        xref="S2.Ex3.m1.2.2.3.3.cmml">)</mo>
                                                                </mrow>
                                                                <mrow id="S2.Ex3.m1.2.2.3.3.3"
                                                                    xref="S2.Ex3.m1.2.2.3.3.3.cmml">
                                                                    <mi id="S2.Ex3.m1.2.2.3.3.3.2"
                                                                        xref="S2.Ex3.m1.2.2.3.3.3.2.cmml"></mi>
                                                                    <mo id="S2.Ex3.m1.2.2.3.3.3.1"
                                                                        xref="S2.Ex3.m1.2.2.3.3.3.1.cmml">&lt;</mo>
                                                                    <mi id="S2.Ex3.m1.2.2.3.3.3.3"
                                                                        xref="S2.Ex3.m1.2.2.3.3.3.3.cmml">i</mi>
                                                                </mrow>
                                                            </msub>
                                                        </mrow>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.2b">
                                                        <apply id="S2.Ex3.m1.2.2.cmml" xref="S2.Ex3.m1.2.2">
                                                            <eq id="S2.Ex3.m1.2.2.2.cmml" xref="S2.Ex3.m1.2.2.2"></eq>
                                                            <apply id="S2.Ex3.m1.2.2.1.cmml" xref="S2.Ex3.m1.2.2.1">
                                                                <times id="S2.Ex3.m1.2.2.1.2.cmml"
                                                                    xref="S2.Ex3.m1.2.2.1.2"></times>
                                                                <apply id="S2.Ex3.m1.2.2.1.3.cmml"
                                                                    xref="S2.Ex3.m1.2.2.1.3">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex3.m1.2.2.1.3.1.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.3">subscript</csymbol>
                                                                    <ci id="S2.Ex3.m1.2.2.1.3.2.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.3.2">𝑓</ci>
                                                                    <ci id="S2.Ex3.m1.2.2.1.3.3.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.3.3">𝑝</ci>
                                                                </apply>
                                                                <apply id="S2.Ex3.m1.2.2.1.1.1.1.cmml"
                                                                    xref="S2.Ex3.m1.2.2.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex3.m1.2.2.1.1.1.1.1.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.1.1">subscript</csymbol>
                                                                    <ci id="S2.Ex3.m1.2.2.1.1.1.1.2.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.1.1.1.2">𝒙</ci>
                                                                    <apply id="S2.Ex3.m1.2.2.1.1.1.1.3.cmml"
                                                                        xref="S2.Ex3.m1.2.2.1.1.1.1.3">
                                                                        <lt id="S2.Ex3.m1.2.2.1.1.1.1.3.1.cmml"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.1"></lt>
                                                                        <csymbol cd="latexml"
                                                                            id="S2.Ex3.m1.2.2.1.1.1.1.3.2.cmml"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.2">absent
                                                                        </csymbol>
                                                                        <ci id="S2.Ex3.m1.2.2.1.1.1.1.3.3.cmml"
                                                                            xref="S2.Ex3.m1.2.2.1.1.1.1.3.3">𝑖</ci>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                            <apply id="S2.Ex3.m1.2.2.3.cmml" xref="S2.Ex3.m1.2.2.3">
                                                                <times id="S2.Ex3.m1.2.2.3.1.cmml"
                                                                    xref="S2.Ex3.m1.2.2.3.1"></times>
                                                                <apply id="S2.Ex3.m1.2.2.3.2.cmml"
                                                                    xref="S2.Ex3.m1.2.2.3.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex3.m1.2.2.3.2.1.cmml"
                                                                        xref="S2.Ex3.m1.2.2.3.2">subscript</csymbol>
                                                                    <ci id="S2.Ex3.m1.2.2.3.2.2.cmml"
                                                                        xref="S2.Ex3.m1.2.2.3.2.2">𝑓</ci>
                                                                    <ci id="S2.Ex3.m1.2.2.3.2.3.cmml"
                                                                        xref="S2.Ex3.m1.2.2.3.2.3">𝑝</ci>
                                                                </apply>
                                                                <apply id="S2.Ex3.m1.2.2.3.3.cmml"
                                                                    xref="S2.Ex3.m1.2.2.3.3">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S2.Ex3.m1.2.2.3.3.1.cmml"
                                                                        xref="S2.Ex3.m1.2.2.3.3">subscript</csymbol>
                                                                    <ci id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1">𝒙
                                                                    </ci>
                                                                    <apply id="S2.Ex3.m1.2.2.3.3.3.cmml"
                                                                        xref="S2.Ex3.m1.2.2.3.3.3">
                                                                        <lt id="S2.Ex3.m1.2.2.3.3.3.1.cmml"
                                                                            xref="S2.Ex3.m1.2.2.3.3.3.1"></lt>
                                                                        <csymbol cd="latexml"
                                                                            id="S2.Ex3.m1.2.2.3.3.3.2.cmml"
                                                                            xref="S2.Ex3.m1.2.2.3.3.3.2">absent
                                                                        </csymbol>
                                                                        <ci id="S2.Ex3.m1.2.2.3.3.3.3.cmml"
                                                                            xref="S2.Ex3.m1.2.2.3.3.3.3">𝑖</ci>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S2.Ex3.m1.2c">
                                                        f_{p}(\boldsymbol{x}_{&lt;i})=f_{p}(\boldsymbol{x})_{&lt;i}
                                                    </annotation>
                                                    <annotation encoding="application/x-llamapun" id="S2.Ex3.m1.2d">
                                                        italic_f start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT (
                                                        bold_italic_x start_POSTSUBSCRIPT &lt; italic_i
                                                        end_POSTSUBSCRIPT ) = italic_f start_POSTSUBSCRIPT italic_p
                                                        end_POSTSUBSCRIPT ( bold_italic_x ) start_POSTSUBSCRIPT &lt;
                                                        italic_i end_POSTSUBSCRIPT</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="ltx_p" id="S2.SS4.p3.2"><span class="ltx_text ltx_font_smallcaps"
                                    id="S2.SS4.p3.2.1">bpe</span> is not an incremental patching scheme as the same
                                prefix can be tokenized differently depending on the continuation sequence, and
                                therefore does not satisfy the property above<span class="ltx_note ltx_role_footnote"
                                    id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span
                                            class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span
                                                class="ltx_tag ltx_tag_note">3</span>Using a special delimiter token to
                                            indicate patch boundaries can turn <span class="ltx_text ltx_font_smallcaps"
                                                id="footnote3.1">bpe</span> into an incremental patching scheme but
                                            increases the byte-sequence length.</span></span></span>.</p>
                        </div>
                    </section>
                </section>
                <section class="ltx_section" id="S3">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">3 </span><span class="ltx_text ltx_font_smallcaps"
                            id="S3.1.1">B</span>LT Architecture
                    </h2>
                    <div class="ltx_para" id="S3.p1">
                        <p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_smallcaps"
                                id="S3.p1.1.1">B</span>LT is composed of a large global autoregressive language model
                            that operates on patch representations, along with two smaller local models that encode
                            sequences of bytes into patches and decode patch representations back into bytes (<a
                                class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2412.09871v1#S1.F2"
                                title="Figure 2 ‣ 1 Introduction ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">Figure 2</span></a>).</p>
                    </div>
                    <section class="ltx_subsection" id="S3.SS1">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">3.1 </span>Latent Global Transformer Model
                        </h3>
                        <div class="ltx_para" id="S3.SS1.p1">
                            <p class="ltx_p" id="S3.SS1.p1.6"><span class="ltx_text ltx_font_italic"
                                    id="S3.SS1.p1.6.1">The Latent Global Transformer</span> is an autoregressive
                                transformer model <math alttext="\mathcal{G}" class="ltx_Math" display="inline"
                                    id="S3.SS1.p1.1.m1.1">
                                    <semantics id="S3.SS1.p1.1.m1.1a">
                                        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1"
                                            xref="S3.SS1.p1.1.m1.1.1.cmml">𝒢</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b">
                                            <ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒢</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{G}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">
                                            caligraphic_G</annotation>
                                    </semantics>
                                </math> with <math alttext="l_{\mathcal{G}}" class="ltx_Math" display="inline"
                                    id="S3.SS1.p1.2.m2.1">
                                    <semantics id="S3.SS1.p1.2.m2.1a">
                                        <msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
                                            <mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">l</mi>
                                            <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1.3"
                                                xref="S3.SS1.p1.2.m2.1.1.3.cmml">𝒢</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
                                            <apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml"
                                                    xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol>
                                                <ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑙</ci>
                                                <ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝒢</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">l_{\mathcal{G}}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_l
                                            start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> layers, which maps a sequence of latent input patch representations, <math
                                    alttext="p_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1">
                                    <semantics id="S3.SS1.p1.3.m3.1a">
                                        <msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">
                                            <mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">p</mi>
                                            <mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">j</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b">
                                            <apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml"
                                                    xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol>
                                                <ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑝</ci>
                                                <ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑗</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">p_{j}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_p
                                            start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> into a sequence of output patch representations, <math alttext="o_{j}"
                                    class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1">
                                    <semantics id="S3.SS1.p1.4.m4.1a">
                                        <msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">
                                            <mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">o</mi>
                                            <mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">j</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b">
                                            <apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml"
                                                    xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol>
                                                <ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑜</ci>
                                                <ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑗</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">o_{j}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_o
                                            start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>. Throughout the paper, we use the subscript <math alttext="j" class="ltx_Math"
                                    display="inline" id="S3.SS1.p1.5.m5.1">
                                    <semantics id="S3.SS1.p1.5.m5.1a">
                                        <mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">j</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b">
                                            <ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑗</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">j</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_j
                                        </annotation>
                                    </semantics>
                                </math> to denote patches and <math alttext="i" class="ltx_Math" display="inline"
                                    id="S3.SS1.p1.6.m6.1">
                                    <semantics id="S3.SS1.p1.6.m6.1a">
                                        <mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b">
                                            <ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑖</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">i</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_i
                                        </annotation>
                                    </semantics>
                                </math> to denote bytes. The global model uses a block-causal attention mask <cite
                                    class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>,
                                which restricts attention to be up to and including the current patch within the current
                                document. This model consumes the bulk of the <span class="ltx_text ltx_font_smallcaps"
                                    id="S3.SS1.p1.6.2">flop</span>s during pre-training as well as inference, and thus,
                                choosing when to invoke it allows us to control and vary the amount of compute expended
                                for different portions of the input and output as a function of input/output complexity.
                            </p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S3.SS2">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">3.2 </span>Local Encoder
                        </h3>
                        <div class="ltx_para" id="S3.SS2.p1">
                            <p class="ltx_p" id="S3.SS2.p1.10"><span class="ltx_text ltx_font_italic"
                                    id="S3.SS2.p1.10.1">The Local Encoder Model</span>, denoted by <math
                                    alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1">
                                    <semantics id="S3.SS2.p1.1.m1.1a">
                                        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1"
                                            xref="S3.SS2.p1.1.m1.1.1.cmml">ℰ</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b">
                                            <ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">ℰ</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{E}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">
                                            caligraphic_E</annotation>
                                    </semantics>
                                </math>, is a lightweight transformer-based model with <math
                                    alttext="l_{\mathcal{E}}&lt;&lt;l_{\mathcal{G}}" class="ltx_Math" display="inline"
                                    id="S3.SS2.p1.2.m2.1">
                                    <semantics id="S3.SS2.p1.2.m2.1a">
                                        <mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">
                                            <msub id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">
                                                <mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">l
                                                </mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2.3"
                                                    xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">ℰ</mi>
                                            </msub>
                                            <mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">&lt;&lt;</mo>
                                            <msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">
                                                <mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">l
                                                </mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.3.3"
                                                    xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">𝒢</mi>
                                            </msub>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b">
                                            <apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">
                                                <csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.cmml"
                                                    xref="S3.SS2.p1.2.m2.1.1.1">much-less-than</csymbol>
                                                <apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">
                                                    <csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml"
                                                        xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol>
                                                    <ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">
                                                        𝑙</ci>
                                                    <ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">ℰ
                                                    </ci>
                                                </apply>
                                                <apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">
                                                    <csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml"
                                                        xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol>
                                                    <ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">
                                                        𝑙</ci>
                                                    <ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">
                                                        𝒢</ci>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">
                                            l_{\mathcal{E}}&lt;&lt;l_{\mathcal{G}}</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_l
                                            start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT &lt; &lt; italic_l
                                            start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> layers, whose main role is to efficiently map a sequence of input bytes <math
                                    alttext="b_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1">
                                    <semantics id="S3.SS2.p1.3.m3.1a">
                                        <msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">
                                            <mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">b</mi>
                                            <mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b">
                                            <apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml"
                                                    xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑏</ci>
                                                <ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">b_{i}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_b
                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>, into expressive patch representations, <math alttext="p_{j}" class="ltx_Math"
                                    display="inline" id="S3.SS2.p1.4.m4.1">
                                    <semantics id="S3.SS2.p1.4.m4.1a">
                                        <msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">
                                            <mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">p</mi>
                                            <mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">j</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b">
                                            <apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml"
                                                    xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑝</ci>
                                                <ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑗</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">p_{j}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_p
                                            start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>.
                                A primary departure from the transformer architecture is the addition of a
                                cross-attention layer after each transformer layer, whose function is to pool byte
                                representations into patch representations (<a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S3.F5"
                                    title="Figure 5 ‣ 3.2.1 Encoder Hash n-gram Embeddings ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 5</span></a>).
                                First, the input sequence of bytes, <math alttext="b_{i}" class="ltx_Math"
                                    display="inline" id="S3.SS2.p1.5.m5.1">
                                    <semantics id="S3.SS2.p1.5.m5.1a">
                                        <msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">
                                            <mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">b</mi>
                                            <mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">i</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b">
                                            <apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml"
                                                    xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑏</ci>
                                                <ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑖</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">b_{i}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_b
                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>, are embedded using a <math alttext="\mathbb{R}^{256\times h_{\mathcal{E}}}"
                                    class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1">
                                    <semantics id="S3.SS2.p1.6.m6.1a">
                                        <msup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">
                                            <mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">ℝ</mi>
                                            <mrow id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">
                                                <mn id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">256
                                                </mn>
                                                <mo id="S3.SS2.p1.6.m6.1.1.3.1" lspace="0.222em" rspace="0.222em"
                                                    xref="S3.SS2.p1.6.m6.1.1.3.1.cmml">×</mo>
                                                <msub id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">
                                                    <mi id="S3.SS2.p1.6.m6.1.1.3.3.2"
                                                        xref="S3.SS2.p1.6.m6.1.1.3.3.2.cmml">h</mi>
                                                    <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.3.3.3"
                                                        xref="S3.SS2.p1.6.m6.1.1.3.3.3.cmml">ℰ</mi>
                                                </msub>
                                            </mrow>
                                        </msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b">
                                            <apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml"
                                                    xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol>
                                                <ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">ℝ</ci>
                                                <apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">
                                                    <times id="S3.SS2.p1.6.m6.1.1.3.1.cmml"
                                                        xref="S3.SS2.p1.6.m6.1.1.3.1"></times>
                                                    <cn id="S3.SS2.p1.6.m6.1.1.3.2.cmml" type="integer"
                                                        xref="S3.SS2.p1.6.m6.1.1.3.2">256</cn>
                                                    <apply id="S3.SS2.p1.6.m6.1.1.3.3.cmml"
                                                        xref="S3.SS2.p1.6.m6.1.1.3.3">
                                                        <csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.3.1.cmml"
                                                            xref="S3.SS2.p1.6.m6.1.1.3.3">subscript</csymbol>
                                                        <ci id="S3.SS2.p1.6.m6.1.1.3.3.2.cmml"
                                                            xref="S3.SS2.p1.6.m6.1.1.3.3.2">ℎ</ci>
                                                        <ci id="S3.SS2.p1.6.m6.1.1.3.3.3.cmml"
                                                            xref="S3.SS2.p1.6.m6.1.1.3.3.3">ℰ</ci>
                                                    </apply>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">
                                            \mathbb{R}^{256\times h_{\mathcal{E}}}</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">
                                            blackboard_R start_POSTSUPERSCRIPT 256 × italic_h start_POSTSUBSCRIPT
                                            caligraphic_E end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation>
                                    </semantics>
                                </math> matrix, denoted as <math alttext="x_{i}" class="ltx_Math" display="inline"
                                    id="S3.SS2.p1.7.m7.1">
                                    <semantics id="S3.SS2.p1.7.m7.1a">
                                        <msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">
                                            <mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">x</mi>
                                            <mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">i</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b">
                                            <apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml"
                                                    xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑥</ci>
                                                <ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑖</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">x_{i}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_x
                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>.
                                These embeddings are then optionally augmented with additional information in the form
                                of hash-embeddings (§<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S3.SS2.SSS1"
                                    title="3.2.1 Encoder Hash n-gram Embeddings ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">3.2.1</span></a>).
                                A series of alternating transformer and cross-attention layers (§<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S3.SS2.SSS2"
                                    title="3.2.2 Encoder Multi-Headed Cross-Attention ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">3.2.2</span></a>) then transform these
                                representations into patch representations, <math alttext="p_{i}" class="ltx_Math"
                                    display="inline" id="S3.SS2.p1.8.m8.1">
                                    <semantics id="S3.SS2.p1.8.m8.1a">
                                        <msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">
                                            <mi id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">p</mi>
                                            <mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">i</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b">
                                            <apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml"
                                                    xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">𝑝</ci>
                                                <ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑖</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">p_{i}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_p
                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> that are processed by the global transformer, <math alttext="\mathcal{G}"
                                    class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1">
                                    <semantics id="S3.SS2.p1.9.m9.1a">
                                        <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.9.m9.1.1"
                                            xref="S3.SS2.p1.9.m9.1.1.cmml">𝒢</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b">
                                            <ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝒢</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\mathcal{G}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">
                                            caligraphic_G</annotation>
                                    </semantics>
                                </math>.
                                The transformer layers use a <span class="ltx_text ltx_font_italic"
                                    id="S3.SS2.p1.10.2">local block causal</span> attention mask; each byte attends to a
                                fixed window of <math alttext="w_{\mathcal{E}}" class="ltx_Math" display="inline"
                                    id="S3.SS2.p1.10.m10.1">
                                    <semantics id="S3.SS2.p1.10.m10.1a">
                                        <msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">
                                            <mi id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">w</mi>
                                            <mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.10.m10.1.1.3"
                                                xref="S3.SS2.p1.10.m10.1.1.3.cmml">ℰ</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b">
                                            <apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml"
                                                    xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol>
                                                <ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">𝑤
                                                </ci>
                                                <ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">ℰ
                                                </ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">
                                            w_{\mathcal{E}}</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_w
                                            start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> preceding bytes that in general can cross the dynamic patch boundaries but can
                                not cross document boundaries.
                                The following subsections describe details about the embeddings and the cross-attention
                                block.</p>
                        </div>
                        <section class="ltx_subsubsection" id="S3.SS2.SSS1">
                            <h4 class="ltx_title ltx_title_subsubsection">
                                <span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Encoder Hash n-gram Embeddings
                            </h4>
                            <div class="ltx_para" id="S3.SS2.SSS1.p1">
                                <p class="ltx_p" id="S3.SS2.SSS1.p1.3">A key component in creating robust, expressive
                                    representations at each step <math alttext="i" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p1.1.m1.1">
                                        <semantics id="S3.SS2.SSS1.p1.1.m1.1a">
                                            <mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">i</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b">
                                                <ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑖
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">i
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">
                                                italic_i</annotation>
                                        </semantics>
                                    </math> is to incorporate information about the preceding bytes.
                                    In <span class="ltx_text ltx_font_smallcaps" id="S3.SS2.SSS1.p1.3.1">B</span>LT, we
                                    achieve this by modeling both the byte <math alttext="b_{i}" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS1.p1.2.m2.1">
                                        <semantics id="S3.SS2.SSS1.p1.2.m2.1a">
                                            <msub id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">
                                                <mi id="S3.SS2.SSS1.p1.2.m2.1.1.2"
                                                    xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">b</mi>
                                                <mi id="S3.SS2.SSS1.p1.2.m2.1.1.3"
                                                    xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml">i</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS1.p1.2.m2.1b">
                                                <apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml"
                                                        xref="S3.SS2.SSS1.p1.2.m2.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml"
                                                        xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝑏</ci>
                                                    <ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"
                                                        xref="S3.SS2.SSS1.p1.2.m2.1.1.3">𝑖</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">b_{i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">
                                                italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> individually <span class="ltx_text ltx_font_italic"
                                        id="S3.SS2.SSS1.p1.3.2">and</span> as part of a byte n-gram.
                                    For each step <math alttext="i" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p1.3.m3.1">
                                        <semantics id="S3.SS2.SSS1.p1.3.m3.1a">
                                            <mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">i</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b">
                                                <ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝑖
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">i
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">
                                                italic_i</annotation>
                                        </semantics>
                                    </math>, we first construct byte-grams</p>
                                <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx2">
                                    <tbody id="S3.E2">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle g_{i,n}=\{b_{i-n+1},\ldots,b_{i}\}"
                                                    class="ltx_Math" display="inline" id="S3.E2.m1.5">
                                                    <semantics id="S3.E2.m1.5a">
                                                        <mrow id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">
                                                            <msub id="S3.E2.m1.5.5.4" xref="S3.E2.m1.5.5.4.cmml">
                                                                <mi id="S3.E2.m1.5.5.4.2" xref="S3.E2.m1.5.5.4.2.cmml">g
                                                                </mi>
                                                                <mrow id="S3.E2.m1.2.2.2.4"
                                                                    xref="S3.E2.m1.2.2.2.3.cmml">
                                                                    <mi id="S3.E2.m1.1.1.1.1"
                                                                        xref="S3.E2.m1.1.1.1.1.cmml">i</mi>
                                                                    <mo id="S3.E2.m1.2.2.2.4.1"
                                                                        xref="S3.E2.m1.2.2.2.3.cmml">,</mo>
                                                                    <mi id="S3.E2.m1.2.2.2.2"
                                                                        xref="S3.E2.m1.2.2.2.2.cmml">n</mi>
                                                                </mrow>
                                                            </msub>
                                                            <mo id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml">=</mo>
                                                            <mrow id="S3.E2.m1.5.5.2.2" xref="S3.E2.m1.5.5.2.3.cmml">
                                                                <mo id="S3.E2.m1.5.5.2.2.3" stretchy="false"
                                                                    xref="S3.E2.m1.5.5.2.3.cmml">{</mo>
                                                                <msub id="S3.E2.m1.4.4.1.1.1"
                                                                    xref="S3.E2.m1.4.4.1.1.1.cmml">
                                                                    <mi id="S3.E2.m1.4.4.1.1.1.2"
                                                                        xref="S3.E2.m1.4.4.1.1.1.2.cmml">b</mi>
                                                                    <mrow id="S3.E2.m1.4.4.1.1.1.3"
                                                                        xref="S3.E2.m1.4.4.1.1.1.3.cmml">
                                                                        <mrow id="S3.E2.m1.4.4.1.1.1.3.2"
                                                                            xref="S3.E2.m1.4.4.1.1.1.3.2.cmml">
                                                                            <mi id="S3.E2.m1.4.4.1.1.1.3.2.2"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.2.2.cmml">i
                                                                            </mi>
                                                                            <mo id="S3.E2.m1.4.4.1.1.1.3.2.1"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.2.1.cmml">−
                                                                            </mo>
                                                                            <mi id="S3.E2.m1.4.4.1.1.1.3.2.3"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.2.3.cmml">n
                                                                            </mi>
                                                                        </mrow>
                                                                        <mo id="S3.E2.m1.4.4.1.1.1.3.1"
                                                                            xref="S3.E2.m1.4.4.1.1.1.3.1.cmml">+</mo>
                                                                        <mn id="S3.E2.m1.4.4.1.1.1.3.3"
                                                                            xref="S3.E2.m1.4.4.1.1.1.3.3.cmml">1</mn>
                                                                    </mrow>
                                                                </msub>
                                                                <mo id="S3.E2.m1.5.5.2.2.4"
                                                                    xref="S3.E2.m1.5.5.2.3.cmml">,</mo>
                                                                <mi id="S3.E2.m1.3.3" mathvariant="normal"
                                                                    xref="S3.E2.m1.3.3.cmml">…</mi>
                                                                <mo id="S3.E2.m1.5.5.2.2.5"
                                                                    xref="S3.E2.m1.5.5.2.3.cmml">,</mo>
                                                                <msub id="S3.E2.m1.5.5.2.2.2"
                                                                    xref="S3.E2.m1.5.5.2.2.2.cmml">
                                                                    <mi id="S3.E2.m1.5.5.2.2.2.2"
                                                                        xref="S3.E2.m1.5.5.2.2.2.2.cmml">b</mi>
                                                                    <mi id="S3.E2.m1.5.5.2.2.2.3"
                                                                        xref="S3.E2.m1.5.5.2.2.2.3.cmml">i</mi>
                                                                </msub>
                                                                <mo id="S3.E2.m1.5.5.2.2.6" stretchy="false"
                                                                    xref="S3.E2.m1.5.5.2.3.cmml">}</mo>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E2.m1.5b">
                                                            <apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">
                                                                <eq id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3"></eq>
                                                                <apply id="S3.E2.m1.5.5.4.cmml" xref="S3.E2.m1.5.5.4">
                                                                    <csymbol cd="ambiguous" id="S3.E2.m1.5.5.4.1.cmml"
                                                                        xref="S3.E2.m1.5.5.4">subscript</csymbol>
                                                                    <ci id="S3.E2.m1.5.5.4.2.cmml"
                                                                        xref="S3.E2.m1.5.5.4.2">𝑔</ci>
                                                                    <list id="S3.E2.m1.2.2.2.3.cmml"
                                                                        xref="S3.E2.m1.2.2.2.4">
                                                                        <ci id="S3.E2.m1.1.1.1.1.cmml"
                                                                            xref="S3.E2.m1.1.1.1.1">𝑖</ci>
                                                                        <ci id="S3.E2.m1.2.2.2.2.cmml"
                                                                            xref="S3.E2.m1.2.2.2.2">𝑛</ci>
                                                                    </list>
                                                                </apply>
                                                                <set id="S3.E2.m1.5.5.2.3.cmml" xref="S3.E2.m1.5.5.2.2">
                                                                    <apply id="S3.E2.m1.4.4.1.1.1.cmml"
                                                                        xref="S3.E2.m1.4.4.1.1.1">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E2.m1.4.4.1.1.1.1.cmml"
                                                                            xref="S3.E2.m1.4.4.1.1.1">subscript
                                                                        </csymbol>
                                                                        <ci id="S3.E2.m1.4.4.1.1.1.2.cmml"
                                                                            xref="S3.E2.m1.4.4.1.1.1.2">𝑏</ci>
                                                                        <apply id="S3.E2.m1.4.4.1.1.1.3.cmml"
                                                                            xref="S3.E2.m1.4.4.1.1.1.3">
                                                                            <plus id="S3.E2.m1.4.4.1.1.1.3.1.cmml"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.1"></plus>
                                                                            <apply id="S3.E2.m1.4.4.1.1.1.3.2.cmml"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.2">
                                                                                <minus
                                                                                    id="S3.E2.m1.4.4.1.1.1.3.2.1.cmml"
                                                                                    xref="S3.E2.m1.4.4.1.1.1.3.2.1">
                                                                                </minus>
                                                                                <ci id="S3.E2.m1.4.4.1.1.1.3.2.2.cmml"
                                                                                    xref="S3.E2.m1.4.4.1.1.1.3.2.2">𝑖
                                                                                </ci>
                                                                                <ci id="S3.E2.m1.4.4.1.1.1.3.2.3.cmml"
                                                                                    xref="S3.E2.m1.4.4.1.1.1.3.2.3">𝑛
                                                                                </ci>
                                                                            </apply>
                                                                            <cn id="S3.E2.m1.4.4.1.1.1.3.3.cmml"
                                                                                type="integer"
                                                                                xref="S3.E2.m1.4.4.1.1.1.3.3">1</cn>
                                                                        </apply>
                                                                    </apply>
                                                                    <ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">…
                                                                    </ci>
                                                                    <apply id="S3.E2.m1.5.5.2.2.2.cmml"
                                                                        xref="S3.E2.m1.5.5.2.2.2">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E2.m1.5.5.2.2.2.1.cmml"
                                                                            xref="S3.E2.m1.5.5.2.2.2">subscript
                                                                        </csymbol>
                                                                        <ci id="S3.E2.m1.5.5.2.2.2.2.cmml"
                                                                            xref="S3.E2.m1.5.5.2.2.2.2">𝑏</ci>
                                                                        <ci id="S3.E2.m1.5.5.2.2.2.3.cmml"
                                                                            xref="S3.E2.m1.5.5.2.2.2.3">𝑖</ci>
                                                                    </apply>
                                                                </set>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E2.m1.5c">
                                                            \displaystyle g_{i,n}=\{b_{i-n+1},\ldots,b_{i}\}
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E2.m1.5d">
                                                            italic_g start_POSTSUBSCRIPT italic_i , italic_n
                                                            end_POSTSUBSCRIPT = { italic_b start_POSTSUBSCRIPT italic_i
                                                            - italic_n + 1 end_POSTSUBSCRIPT , … , italic_b
                                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p class="ltx_p" id="S3.SS2.SSS1.p1.5">for each byte position <math alttext="i"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m1.1">
                                        <semantics id="S3.SS2.SSS1.p1.4.m1.1a">
                                            <mi id="S3.SS2.SSS1.p1.4.m1.1.1" xref="S3.SS2.SSS1.p1.4.m1.1.1.cmml">i</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m1.1b">
                                                <ci id="S3.SS2.SSS1.p1.4.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m1.1.1">𝑖
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m1.1c">i
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m1.1d">
                                                italic_i</annotation>
                                        </semantics>
                                    </math> and <math alttext="n" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p1.5.m2.1">
                                        <semantics id="S3.SS2.SSS1.p1.5.m2.1a">
                                            <mi id="S3.SS2.SSS1.p1.5.m2.1.1" xref="S3.SS2.SSS1.p1.5.m2.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m2.1b">
                                                <ci id="S3.SS2.SSS1.p1.5.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m2.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m2.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m2.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math> from three to eight.<span class="ltx_note ltx_role_footnote"
                                        id="footnote4"><sup class="ltx_note_mark">4</sup><span
                                            class="ltx_note_outer"><span class="ltx_note_content"><sup
                                                    class="ltx_note_mark">4</sup><span
                                                    class="ltx_tag ltx_tag_note">4</span>
                                                We omit byte-grams of size <math alttext="n" class="ltx_Math"
                                                    display="inline" id="footnote4.m1.1">
                                                    <semantics id="footnote4.m1.1b">
                                                        <mi id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml">n</mi>
                                                        <annotation-xml encoding="MathML-Content" id="footnote4.m1.1c">
                                                            <ci id="footnote4.m1.1.1.cmml" xref="footnote4.m1.1.1">𝑛
                                                            </ci>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="footnote4.m1.1d">n
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="footnote4.m1.1e">italic_n</annotation>
                                                    </semantics>
                                                </math> or more when <math alttext="i&lt;n" class="ltx_Math"
                                                    display="inline" id="footnote4.m2.1">
                                                    <semantics id="footnote4.m2.1b">
                                                        <mrow id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml">
                                                            <mi id="footnote4.m2.1.1.2" xref="footnote4.m2.1.1.2.cmml">i
                                                            </mi>
                                                            <mo id="footnote4.m2.1.1.1" xref="footnote4.m2.1.1.1.cmml">
                                                                &lt;</mo>
                                                            <mi id="footnote4.m2.1.1.3" xref="footnote4.m2.1.1.3.cmml">n
                                                            </mi>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="footnote4.m2.1c">
                                                            <apply id="footnote4.m2.1.1.cmml" xref="footnote4.m2.1.1">
                                                                <lt id="footnote4.m2.1.1.1.cmml"
                                                                    xref="footnote4.m2.1.1.1"></lt>
                                                                <ci id="footnote4.m2.1.1.2.cmml"
                                                                    xref="footnote4.m2.1.1.2">𝑖</ci>
                                                                <ci id="footnote4.m2.1.1.3.cmml"
                                                                    xref="footnote4.m2.1.1.3">𝑛</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="footnote4.m2.1d">
                                                            i&lt;n</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="footnote4.m2.1e">italic_i &lt; italic_n</annotation>
                                                    </semantics>
                                                </math>.
                                            </span></span></span></p>
                            </div>
                            <div class="ltx_para" id="S3.SS2.SSS1.p2">
                                <p class="ltx_p" id="S3.SS2.SSS1.p2.4">We then introduce hash <math alttext="n"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1">
                                        <semantics id="S3.SS2.SSS1.p2.1.m1.1a">
                                            <mi id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b">
                                                <ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-gram embeddings, that map all byte <math alttext="n" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS1.p2.2.m2.1">
                                        <semantics id="S3.SS2.SSS1.p2.2.m2.1a">
                                            <mi id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b">
                                                <ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-grams via a hash function to an index in an embedding table <math
                                        alttext="E_{n}^{hash}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p2.3.m3.1">
                                        <semantics id="S3.SS2.SSS1.p2.3.m3.1a">
                                            <msubsup id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">
                                                <mi id="S3.SS2.SSS1.p2.3.m3.1.1.2.2"
                                                    xref="S3.SS2.SSS1.p2.3.m3.1.1.2.2.cmml">E</mi>
                                                <mi id="S3.SS2.SSS1.p2.3.m3.1.1.2.3"
                                                    xref="S3.SS2.SSS1.p2.3.m3.1.1.2.3.cmml">n</mi>
                                                <mrow id="S3.SS2.SSS1.p2.3.m3.1.1.3"
                                                    xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">
                                                    <mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.2"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.2.cmml">h</mi>
                                                    <mo id="S3.SS2.SSS1.p2.3.m3.1.1.3.1"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.3"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.3.cmml">a</mi>
                                                    <mo id="S3.SS2.SSS1.p2.3.m3.1.1.3.1a"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.4"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.4.cmml">s</mi>
                                                    <mo id="S3.SS2.SSS1.p2.3.m3.1.1.3.1b"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S3.SS2.SSS1.p2.3.m3.1.1.3.5"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3.5.cmml">h</mi>
                                                </mrow>
                                            </msubsup><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS1.p2.3.m3.1b">
                                                <apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1">superscript</csymbol>
                                                    <apply id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1">
                                                        <csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.2.1.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.2.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.2.2">𝐸</ci>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.3.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.2.3">𝑛</ci>
                                                    </apply>
                                                    <apply id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml"
                                                        xref="S3.SS2.SSS1.p2.3.m3.1.1.3">
                                                        <times id="S3.SS2.SSS1.p2.3.m3.1.1.3.1.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.3.1"></times>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.2.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.3.2">ℎ</ci>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.3.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.3.3">𝑎</ci>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.4.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.3.4">𝑠</ci>
                                                        <ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.5.cmml"
                                                            xref="S3.SS2.SSS1.p2.3.m3.1.1.3.5">ℎ</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">
                                                E_{n}^{hash}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">
                                                italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT
                                                start_POSTSUPERSCRIPT italic_h italic_a italic_s italic_h
                                                end_POSTSUPERSCRIPT</annotation>
                                        </semantics>
                                    </math> with a fixed size, for each size <math alttext="n\in\{3,4,5,6,7,8\}"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.6">
                                        <semantics id="S3.SS2.SSS1.p2.4.m4.6a">
                                            <mrow id="S3.SS2.SSS1.p2.4.m4.6.7" xref="S3.SS2.SSS1.p2.4.m4.6.7.cmml">
                                                <mi id="S3.SS2.SSS1.p2.4.m4.6.7.2"
                                                    xref="S3.SS2.SSS1.p2.4.m4.6.7.2.cmml">n</mi>
                                                <mo id="S3.SS2.SSS1.p2.4.m4.6.7.1"
                                                    xref="S3.SS2.SSS1.p2.4.m4.6.7.1.cmml">∈</mo>
                                                <mrow id="S3.SS2.SSS1.p2.4.m4.6.7.3.2"
                                                    xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.1" stretchy="false"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">{</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.1.1"
                                                        xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">3</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.2"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">,</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.2.2"
                                                        xref="S3.SS2.SSS1.p2.4.m4.2.2.cmml">4</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.3"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">,</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.3.3"
                                                        xref="S3.SS2.SSS1.p2.4.m4.3.3.cmml">5</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.4"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">,</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.4.4"
                                                        xref="S3.SS2.SSS1.p2.4.m4.4.4.cmml">6</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.5"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">,</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.5.5"
                                                        xref="S3.SS2.SSS1.p2.4.m4.5.5.cmml">7</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.6"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">,</mo>
                                                    <mn id="S3.SS2.SSS1.p2.4.m4.6.6"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.6.cmml">8</mn>
                                                    <mo id="S3.SS2.SSS1.p2.4.m4.6.7.3.2.7" stretchy="false"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml">}</mo>
                                                </mrow>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS1.p2.4.m4.6b">
                                                <apply id="S3.SS2.SSS1.p2.4.m4.6.7.cmml" xref="S3.SS2.SSS1.p2.4.m4.6.7">
                                                    <in id="S3.SS2.SSS1.p2.4.m4.6.7.1.cmml"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.1"></in>
                                                    <ci id="S3.SS2.SSS1.p2.4.m4.6.7.2.cmml"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.2">𝑛</ci>
                                                    <set id="S3.SS2.SSS1.p2.4.m4.6.7.3.1.cmml"
                                                        xref="S3.SS2.SSS1.p2.4.m4.6.7.3.2">
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.1.1">3</cn>
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.2.2.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.2.2">4</cn>
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.3.3.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.3.3">5</cn>
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.4.4.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.4.4">6</cn>
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.5.5.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.5.5">7</cn>
                                                        <cn id="S3.SS2.SSS1.p2.4.m4.6.6.cmml" type="integer"
                                                            xref="S3.SS2.SSS1.p2.4.m4.6.6">8</cn>
                                                    </set>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.6c">
                                                n\in\{3,4,5,6,7,8\}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.6d">
                                                italic_n ∈ { 3 , 4 , 5 , 6 , 7 , 8 }</annotation>
                                        </semantics>
                                    </math> <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib3"
                                            title="">2010</a>)</cite>.
                                    The resulting embedding is then added to the embedding of the byte before being
                                    normalized and passed as input to the local encoder model.
                                    We calculate the augmented embedding</p>
                                <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx3">
                                    <tbody id="S3.E3">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle e_{i}" class="ltx_Math" display="inline"
                                                    id="S3.E3.m1.1">
                                                    <semantics id="S3.E3.m1.1a">
                                                        <msub id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">
                                                            <mi id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">e</mi>
                                                            <mi id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">i</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E3.m1.1b">
                                                            <apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml"
                                                                    xref="S3.E3.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">𝑒
                                                                </ci>
                                                                <ci id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3">𝑖
                                                                </ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E3.m1.1c">
                                                            \displaystyle e_{i}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">
                                                            italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=x_{i}+\sum_{n=3,...,8}E_{n}^{hash}(\text{Hash}(g_{i,n}))"
                                                    class="ltx_Math" display="inline" id="S3.E3.m2.6">
                                                    <semantics id="S3.E3.m2.6a">
                                                        <mrow id="S3.E3.m2.6.6" xref="S3.E3.m2.6.6.cmml">
                                                            <mi id="S3.E3.m2.6.6.3" xref="S3.E3.m2.6.6.3.cmml"></mi>
                                                            <mo id="S3.E3.m2.6.6.2" xref="S3.E3.m2.6.6.2.cmml">=</mo>
                                                            <mrow id="S3.E3.m2.6.6.1" xref="S3.E3.m2.6.6.1.cmml">
                                                                <msub id="S3.E3.m2.6.6.1.3"
                                                                    xref="S3.E3.m2.6.6.1.3.cmml">
                                                                    <mi id="S3.E3.m2.6.6.1.3.2"
                                                                        xref="S3.E3.m2.6.6.1.3.2.cmml">x</mi>
                                                                    <mi id="S3.E3.m2.6.6.1.3.3"
                                                                        xref="S3.E3.m2.6.6.1.3.3.cmml">i</mi>
                                                                </msub>
                                                                <mo id="S3.E3.m2.6.6.1.2" xref="S3.E3.m2.6.6.1.2.cmml">+
                                                                </mo>
                                                                <mrow id="S3.E3.m2.6.6.1.1"
                                                                    xref="S3.E3.m2.6.6.1.1.cmml">
                                                                    <mstyle displaystyle="true" id="S3.E3.m2.6.6.1.1.2"
                                                                        xref="S3.E3.m2.6.6.1.1.2.cmml">
                                                                        <munder id="S3.E3.m2.6.6.1.1.2a"
                                                                            xref="S3.E3.m2.6.6.1.1.2.cmml">
                                                                            <mo id="S3.E3.m2.6.6.1.1.2.2"
                                                                                movablelimits="false"
                                                                                xref="S3.E3.m2.6.6.1.1.2.2.cmml">∑</mo>
                                                                            <mrow id="S3.E3.m2.3.3.3"
                                                                                xref="S3.E3.m2.3.3.3.cmml">
                                                                                <mi id="S3.E3.m2.3.3.3.5"
                                                                                    xref="S3.E3.m2.3.3.3.5.cmml">n</mi>
                                                                                <mo id="S3.E3.m2.3.3.3.4"
                                                                                    xref="S3.E3.m2.3.3.3.4.cmml">=</mo>
                                                                                <mrow id="S3.E3.m2.3.3.3.6.2"
                                                                                    xref="S3.E3.m2.3.3.3.6.1.cmml">
                                                                                    <mn id="S3.E3.m2.1.1.1.1"
                                                                                        xref="S3.E3.m2.1.1.1.1.cmml">3
                                                                                    </mn>
                                                                                    <mo id="S3.E3.m2.3.3.3.6.2.1"
                                                                                        xref="S3.E3.m2.3.3.3.6.1.cmml">,
                                                                                    </mo>
                                                                                    <mi id="S3.E3.m2.2.2.2.2"
                                                                                        mathvariant="normal"
                                                                                        xref="S3.E3.m2.2.2.2.2.cmml">…
                                                                                    </mi>
                                                                                    <mo id="S3.E3.m2.3.3.3.6.2.2"
                                                                                        xref="S3.E3.m2.3.3.3.6.1.cmml">,
                                                                                    </mo>
                                                                                    <mn id="S3.E3.m2.3.3.3.3"
                                                                                        xref="S3.E3.m2.3.3.3.3.cmml">8
                                                                                    </mn>
                                                                                </mrow>
                                                                            </mrow>
                                                                        </munder>
                                                                    </mstyle>
                                                                    <mrow id="S3.E3.m2.6.6.1.1.1"
                                                                        xref="S3.E3.m2.6.6.1.1.1.cmml">
                                                                        <msubsup id="S3.E3.m2.6.6.1.1.1.3"
                                                                            xref="S3.E3.m2.6.6.1.1.1.3.cmml">
                                                                            <mi id="S3.E3.m2.6.6.1.1.1.3.2.2"
                                                                                xref="S3.E3.m2.6.6.1.1.1.3.2.2.cmml">E
                                                                            </mi>
                                                                            <mi id="S3.E3.m2.6.6.1.1.1.3.2.3"
                                                                                xref="S3.E3.m2.6.6.1.1.1.3.2.3.cmml">n
                                                                            </mi>
                                                                            <mrow id="S3.E3.m2.6.6.1.1.1.3.3"
                                                                                xref="S3.E3.m2.6.6.1.1.1.3.3.cmml">
                                                                                <mi id="S3.E3.m2.6.6.1.1.1.3.3.2"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.2.cmml">
                                                                                    h</mi>
                                                                                <mo id="S3.E3.m2.6.6.1.1.1.3.3.1"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.1.cmml">
                                                                                    ⁢</mo>
                                                                                <mi id="S3.E3.m2.6.6.1.1.1.3.3.3"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.3.cmml">
                                                                                    a</mi>
                                                                                <mo id="S3.E3.m2.6.6.1.1.1.3.3.1a"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.1.cmml">
                                                                                    ⁢</mo>
                                                                                <mi id="S3.E3.m2.6.6.1.1.1.3.3.4"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.4.cmml">
                                                                                    s</mi>
                                                                                <mo id="S3.E3.m2.6.6.1.1.1.3.3.1b"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.1.cmml">
                                                                                    ⁢</mo>
                                                                                <mi id="S3.E3.m2.6.6.1.1.1.3.3.5"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3.5.cmml">
                                                                                    h</mi>
                                                                            </mrow>
                                                                        </msubsup>
                                                                        <mo id="S3.E3.m2.6.6.1.1.1.2"
                                                                            xref="S3.E3.m2.6.6.1.1.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E3.m2.6.6.1.1.1.1.1"
                                                                            xref="S3.E3.m2.6.6.1.1.1.1.1.1.cmml">
                                                                            <mo id="S3.E3.m2.6.6.1.1.1.1.1.2"
                                                                                stretchy="false"
                                                                                xref="S3.E3.m2.6.6.1.1.1.1.1.1.cmml">(
                                                                            </mo>
                                                                            <mrow id="S3.E3.m2.6.6.1.1.1.1.1.1"
                                                                                xref="S3.E3.m2.6.6.1.1.1.1.1.1.cmml">
                                                                                <mtext id="S3.E3.m2.6.6.1.1.1.1.1.1.3"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.3a.cmml">
                                                                                    Hash</mtext>
                                                                                <mo id="S3.E3.m2.6.6.1.1.1.1.1.1.2"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.2.cmml">
                                                                                    ⁢</mo>
                                                                                <mrow id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">
                                                                                    <mo id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.2"
                                                                                        stretchy="false"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        (</mo>
                                                                                    <msub
                                                                                        id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        <mi id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.2"
                                                                                            xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml">
                                                                                            g</mi>
                                                                                        <mrow id="S3.E3.m2.5.5.2.4"
                                                                                            xref="S3.E3.m2.5.5.2.3.cmml">
                                                                                            <mi id="S3.E3.m2.4.4.1.1"
                                                                                                xref="S3.E3.m2.4.4.1.1.cmml">
                                                                                                i</mi>
                                                                                            <mo id="S3.E3.m2.5.5.2.4.1"
                                                                                                xref="S3.E3.m2.5.5.2.3.cmml">
                                                                                                ,</mo>
                                                                                            <mi id="S3.E3.m2.5.5.2.2"
                                                                                                xref="S3.E3.m2.5.5.2.2.cmml">
                                                                                                n</mi>
                                                                                        </mrow>
                                                                                    </msub>
                                                                                    <mo id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.3"
                                                                                        stretchy="false"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        )</mo>
                                                                                </mrow>
                                                                            </mrow>
                                                                            <mo id="S3.E3.m2.6.6.1.1.1.1.1.3"
                                                                                stretchy="false"
                                                                                xref="S3.E3.m2.6.6.1.1.1.1.1.1.cmml">)
                                                                            </mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E3.m2.6b">
                                                            <apply id="S3.E3.m2.6.6.cmml" xref="S3.E3.m2.6.6">
                                                                <eq id="S3.E3.m2.6.6.2.cmml" xref="S3.E3.m2.6.6.2"></eq>
                                                                <csymbol cd="latexml" id="S3.E3.m2.6.6.3.cmml"
                                                                    xref="S3.E3.m2.6.6.3">absent</csymbol>
                                                                <apply id="S3.E3.m2.6.6.1.cmml" xref="S3.E3.m2.6.6.1">
                                                                    <plus id="S3.E3.m2.6.6.1.2.cmml"
                                                                        xref="S3.E3.m2.6.6.1.2"></plus>
                                                                    <apply id="S3.E3.m2.6.6.1.3.cmml"
                                                                        xref="S3.E3.m2.6.6.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E3.m2.6.6.1.3.1.cmml"
                                                                            xref="S3.E3.m2.6.6.1.3">subscript</csymbol>
                                                                        <ci id="S3.E3.m2.6.6.1.3.2.cmml"
                                                                            xref="S3.E3.m2.6.6.1.3.2">𝑥</ci>
                                                                        <ci id="S3.E3.m2.6.6.1.3.3.cmml"
                                                                            xref="S3.E3.m2.6.6.1.3.3">𝑖</ci>
                                                                    </apply>
                                                                    <apply id="S3.E3.m2.6.6.1.1.cmml"
                                                                        xref="S3.E3.m2.6.6.1.1">
                                                                        <apply id="S3.E3.m2.6.6.1.1.2.cmml"
                                                                            xref="S3.E3.m2.6.6.1.1.2">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E3.m2.6.6.1.1.2.1.cmml"
                                                                                xref="S3.E3.m2.6.6.1.1.2">subscript
                                                                            </csymbol>
                                                                            <sum id="S3.E3.m2.6.6.1.1.2.2.cmml"
                                                                                xref="S3.E3.m2.6.6.1.1.2.2"></sum>
                                                                            <apply id="S3.E3.m2.3.3.3.cmml"
                                                                                xref="S3.E3.m2.3.3.3">
                                                                                <eq id="S3.E3.m2.3.3.3.4.cmml"
                                                                                    xref="S3.E3.m2.3.3.3.4"></eq>
                                                                                <ci id="S3.E3.m2.3.3.3.5.cmml"
                                                                                    xref="S3.E3.m2.3.3.3.5">𝑛</ci>
                                                                                <list id="S3.E3.m2.3.3.3.6.1.cmml"
                                                                                    xref="S3.E3.m2.3.3.3.6.2">
                                                                                    <cn id="S3.E3.m2.1.1.1.1.cmml"
                                                                                        type="integer"
                                                                                        xref="S3.E3.m2.1.1.1.1">3</cn>
                                                                                    <ci id="S3.E3.m2.2.2.2.2.cmml"
                                                                                        xref="S3.E3.m2.2.2.2.2">…</ci>
                                                                                    <cn id="S3.E3.m2.3.3.3.3.cmml"
                                                                                        type="integer"
                                                                                        xref="S3.E3.m2.3.3.3.3">8</cn>
                                                                                </list>
                                                                            </apply>
                                                                        </apply>
                                                                        <apply id="S3.E3.m2.6.6.1.1.1.cmml"
                                                                            xref="S3.E3.m2.6.6.1.1.1">
                                                                            <times id="S3.E3.m2.6.6.1.1.1.2.cmml"
                                                                                xref="S3.E3.m2.6.6.1.1.1.2"></times>
                                                                            <apply id="S3.E3.m2.6.6.1.1.1.3.cmml"
                                                                                xref="S3.E3.m2.6.6.1.1.1.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E3.m2.6.6.1.1.1.3.1.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3">
                                                                                    superscript</csymbol>
                                                                                <apply id="S3.E3.m2.6.6.1.1.1.3.2.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E3.m2.6.6.1.1.1.3.2.1.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.2.2.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.2.2">
                                                                                        𝐸</ci>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.2.3.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.2.3">
                                                                                        𝑛</ci>
                                                                                </apply>
                                                                                <apply id="S3.E3.m2.6.6.1.1.1.3.3.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.3.3">
                                                                                    <times
                                                                                        id="S3.E3.m2.6.6.1.1.1.3.3.1.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.3.1">
                                                                                    </times>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.3.2.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.3.2">
                                                                                        ℎ</ci>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.3.3.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.3.3">
                                                                                        𝑎</ci>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.3.4.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.3.4">
                                                                                        𝑠</ci>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.3.3.5.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.3.3.5">
                                                                                        ℎ</ci>
                                                                                </apply>
                                                                            </apply>
                                                                            <apply id="S3.E3.m2.6.6.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E3.m2.6.6.1.1.1.1.1">
                                                                                <times
                                                                                    id="S3.E3.m2.6.6.1.1.1.1.1.1.2.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.2">
                                                                                </times>
                                                                                <ci id="S3.E3.m2.6.6.1.1.1.1.1.1.3a.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.3">
                                                                                    <mtext
                                                                                        id="S3.E3.m2.6.6.1.1.1.1.1.1.3.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.3">
                                                                                        Hash</mtext>
                                                                                </ci>
                                                                                <apply
                                                                                    id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.cmml"
                                                                                    xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.1.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.2.cmml"
                                                                                        xref="S3.E3.m2.6.6.1.1.1.1.1.1.1.1.1.2">
                                                                                        𝑔</ci>
                                                                                    <list id="S3.E3.m2.5.5.2.3.cmml"
                                                                                        xref="S3.E3.m2.5.5.2.4">
                                                                                        <ci id="S3.E3.m2.4.4.1.1.cmml"
                                                                                            xref="S3.E3.m2.4.4.1.1">𝑖
                                                                                        </ci>
                                                                                        <ci id="S3.E3.m2.5.5.2.2.cmml"
                                                                                            xref="S3.E3.m2.5.5.2.2">𝑛
                                                                                        </ci>
                                                                                    </list>
                                                                                </apply>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E3.m2.6c">
                                                            \displaystyle=x_{i}+\sum_{n=3,...,8}E_{n}^{hash}(\text{Hash}(g_{i,n}))
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E3.m2.6d">=
                                                            italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + ∑
                                                            start_POSTSUBSCRIPT italic_n = 3 , … , 8 end_POSTSUBSCRIPT
                                                            italic_E start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT
                                                            start_POSTSUPERSCRIPT italic_h italic_a italic_s italic_h
                                                            end_POSTSUPERSCRIPT ( Hash ( italic_g start_POSTSUBSCRIPT
                                                            italic_i , italic_n end_POSTSUBSCRIPT ) )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E4">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle\text{where, Hash}(g_{i,n})" class="ltx_Math"
                                                    display="inline" id="S3.E4.m1.3">
                                                    <semantics id="S3.E4.m1.3a">
                                                        <mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">
                                                            <mtext id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3a.cmml">
                                                                where, Hash</mtext>
                                                            <mo id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml">⁢</mo>
                                                            <mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">
                                                                <mo id="S3.E4.m1.3.3.1.1.2" stretchy="false"
                                                                    xref="S3.E4.m1.3.3.1.1.1.cmml">(</mo>
                                                                <msub id="S3.E4.m1.3.3.1.1.1"
                                                                    xref="S3.E4.m1.3.3.1.1.1.cmml">
                                                                    <mi id="S3.E4.m1.3.3.1.1.1.2"
                                                                        xref="S3.E4.m1.3.3.1.1.1.2.cmml">g</mi>
                                                                    <mrow id="S3.E4.m1.2.2.2.4"
                                                                        xref="S3.E4.m1.2.2.2.3.cmml">
                                                                        <mi id="S3.E4.m1.1.1.1.1"
                                                                            xref="S3.E4.m1.1.1.1.1.cmml">i</mi>
                                                                        <mo id="S3.E4.m1.2.2.2.4.1"
                                                                            xref="S3.E4.m1.2.2.2.3.cmml">,</mo>
                                                                        <mi id="S3.E4.m1.2.2.2.2"
                                                                            xref="S3.E4.m1.2.2.2.2.cmml">n</mi>
                                                                    </mrow>
                                                                </msub>
                                                                <mo id="S3.E4.m1.3.3.1.1.3" stretchy="false"
                                                                    xref="S3.E4.m1.3.3.1.1.1.cmml">)</mo>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E4.m1.3b">
                                                            <apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">
                                                                <times id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2">
                                                                </times>
                                                                <ci id="S3.E4.m1.3.3.3a.cmml" xref="S3.E4.m1.3.3.3">
                                                                    <mtext id="S3.E4.m1.3.3.3.cmml"
                                                                        xref="S3.E4.m1.3.3.3">where, Hash</mtext>
                                                                </ci>
                                                                <apply id="S3.E4.m1.3.3.1.1.1.cmml"
                                                                    xref="S3.E4.m1.3.3.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S3.E4.m1.3.3.1.1.1.1.cmml"
                                                                        xref="S3.E4.m1.3.3.1.1">subscript</csymbol>
                                                                    <ci id="S3.E4.m1.3.3.1.1.1.2.cmml"
                                                                        xref="S3.E4.m1.3.3.1.1.1.2">𝑔</ci>
                                                                    <list id="S3.E4.m1.2.2.2.3.cmml"
                                                                        xref="S3.E4.m1.2.2.2.4">
                                                                        <ci id="S3.E4.m1.1.1.1.1.cmml"
                                                                            xref="S3.E4.m1.1.1.1.1">𝑖</ci>
                                                                        <ci id="S3.E4.m1.2.2.2.2.cmml"
                                                                            xref="S3.E4.m1.2.2.2.2">𝑛</ci>
                                                                    </list>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E4.m1.3c">
                                                            \displaystyle\text{where, Hash}(g_{i,n})</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">
                                                            where, Hash ( italic_g start_POSTSUBSCRIPT italic_i ,
                                                            italic_n end_POSTSUBSCRIPT )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=\text{RollPolyHash}(g_{i,n})\%|E_{n}^{hash}|"
                                                    class="ltx_Math" display="inline" id="S3.E4.m2.4">
                                                    <semantics id="S3.E4.m2.4a">
                                                        <mrow id="S3.E4.m2.4.4" xref="S3.E4.m2.4.4.cmml">
                                                            <mi id="S3.E4.m2.4.4.4" xref="S3.E4.m2.4.4.4.cmml"></mi>
                                                            <mo id="S3.E4.m2.4.4.3" xref="S3.E4.m2.4.4.3.cmml">=</mo>
                                                            <mrow id="S3.E4.m2.4.4.2" xref="S3.E4.m2.4.4.2.cmml">
                                                                <mtext id="S3.E4.m2.4.4.2.4"
                                                                    xref="S3.E4.m2.4.4.2.4a.cmml">RollPolyHash</mtext>
                                                                <mo id="S3.E4.m2.4.4.2.3" xref="S3.E4.m2.4.4.2.3.cmml">⁢
                                                                </mo>
                                                                <mrow id="S3.E4.m2.3.3.1.1"
                                                                    xref="S3.E4.m2.3.3.1.1.cmml">
                                                                    <mrow id="S3.E4.m2.3.3.1.1.1.1"
                                                                        xref="S3.E4.m2.3.3.1.1.1.1.1.cmml">
                                                                        <mo id="S3.E4.m2.3.3.1.1.1.1.2" stretchy="false"
                                                                            xref="S3.E4.m2.3.3.1.1.1.1.1.cmml">(</mo>
                                                                        <msub id="S3.E4.m2.3.3.1.1.1.1.1"
                                                                            xref="S3.E4.m2.3.3.1.1.1.1.1.cmml">
                                                                            <mi id="S3.E4.m2.3.3.1.1.1.1.1.2"
                                                                                xref="S3.E4.m2.3.3.1.1.1.1.1.2.cmml">g
                                                                            </mi>
                                                                            <mrow id="S3.E4.m2.2.2.2.4"
                                                                                xref="S3.E4.m2.2.2.2.3.cmml">
                                                                                <mi id="S3.E4.m2.1.1.1.1"
                                                                                    xref="S3.E4.m2.1.1.1.1.cmml">i</mi>
                                                                                <mo id="S3.E4.m2.2.2.2.4.1"
                                                                                    xref="S3.E4.m2.2.2.2.3.cmml">,</mo>
                                                                                <mi id="S3.E4.m2.2.2.2.2"
                                                                                    xref="S3.E4.m2.2.2.2.2.cmml">n</mi>
                                                                            </mrow>
                                                                        </msub>
                                                                        <mo id="S3.E4.m2.3.3.1.1.1.1.3" stretchy="false"
                                                                            xref="S3.E4.m2.3.3.1.1.1.1.1.cmml">)</mo>
                                                                    </mrow>
                                                                    <mo id="S3.E4.m2.3.3.1.1.2"
                                                                        xref="S3.E4.m2.3.3.1.1.2.cmml">%</mo>
                                                                </mrow>
                                                                <mo id="S3.E4.m2.4.4.2.3a" xref="S3.E4.m2.4.4.2.3.cmml">
                                                                    ⁢</mo>
                                                                <mrow id="S3.E4.m2.4.4.2.2.1"
                                                                    xref="S3.E4.m2.4.4.2.2.2.cmml">
                                                                    <mo id="S3.E4.m2.4.4.2.2.1.2" stretchy="false"
                                                                        xref="S3.E4.m2.4.4.2.2.2.1.cmml">|</mo>
                                                                    <msubsup id="S3.E4.m2.4.4.2.2.1.1"
                                                                        xref="S3.E4.m2.4.4.2.2.1.1.cmml">
                                                                        <mi id="S3.E4.m2.4.4.2.2.1.1.2.2"
                                                                            xref="S3.E4.m2.4.4.2.2.1.1.2.2.cmml">E</mi>
                                                                        <mi id="S3.E4.m2.4.4.2.2.1.1.2.3"
                                                                            xref="S3.E4.m2.4.4.2.2.1.1.2.3.cmml">n</mi>
                                                                        <mrow id="S3.E4.m2.4.4.2.2.1.1.3"
                                                                            xref="S3.E4.m2.4.4.2.2.1.1.3.cmml">
                                                                            <mi id="S3.E4.m2.4.4.2.2.1.1.3.2"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.2.cmml">h
                                                                            </mi>
                                                                            <mo id="S3.E4.m2.4.4.2.2.1.1.3.1"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.1.cmml">⁢
                                                                            </mo>
                                                                            <mi id="S3.E4.m2.4.4.2.2.1.1.3.3"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.3.cmml">a
                                                                            </mi>
                                                                            <mo id="S3.E4.m2.4.4.2.2.1.1.3.1a"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.1.cmml">⁢
                                                                            </mo>
                                                                            <mi id="S3.E4.m2.4.4.2.2.1.1.3.4"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.4.cmml">s
                                                                            </mi>
                                                                            <mo id="S3.E4.m2.4.4.2.2.1.1.3.1b"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.1.cmml">⁢
                                                                            </mo>
                                                                            <mi id="S3.E4.m2.4.4.2.2.1.1.3.5"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3.5.cmml">h
                                                                            </mi>
                                                                        </mrow>
                                                                    </msubsup>
                                                                    <mo id="S3.E4.m2.4.4.2.2.1.3" stretchy="false"
                                                                        xref="S3.E4.m2.4.4.2.2.2.1.cmml">|</mo>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E4.m2.4b">
                                                            <apply id="S3.E4.m2.4.4.cmml" xref="S3.E4.m2.4.4">
                                                                <eq id="S3.E4.m2.4.4.3.cmml" xref="S3.E4.m2.4.4.3"></eq>
                                                                <csymbol cd="latexml" id="S3.E4.m2.4.4.4.cmml"
                                                                    xref="S3.E4.m2.4.4.4">absent</csymbol>
                                                                <apply id="S3.E4.m2.4.4.2.cmml" xref="S3.E4.m2.4.4.2">
                                                                    <times id="S3.E4.m2.4.4.2.3.cmml"
                                                                        xref="S3.E4.m2.4.4.2.3"></times>
                                                                    <ci id="S3.E4.m2.4.4.2.4a.cmml"
                                                                        xref="S3.E4.m2.4.4.2.4">
                                                                        <mtext id="S3.E4.m2.4.4.2.4.cmml"
                                                                            xref="S3.E4.m2.4.4.2.4">RollPolyHash</mtext>
                                                                    </ci>
                                                                    <apply id="S3.E4.m2.3.3.1.1.cmml"
                                                                        xref="S3.E4.m2.3.3.1.1">
                                                                        <csymbol cd="latexml"
                                                                            id="S3.E4.m2.3.3.1.1.2.cmml"
                                                                            xref="S3.E4.m2.3.3.1.1.2">percent</csymbol>
                                                                        <apply id="S3.E4.m2.3.3.1.1.1.1.1.cmml"
                                                                            xref="S3.E4.m2.3.3.1.1.1.1">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E4.m2.3.3.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E4.m2.3.3.1.1.1.1">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E4.m2.3.3.1.1.1.1.1.2.cmml"
                                                                                xref="S3.E4.m2.3.3.1.1.1.1.1.2">𝑔</ci>
                                                                            <list id="S3.E4.m2.2.2.2.3.cmml"
                                                                                xref="S3.E4.m2.2.2.2.4">
                                                                                <ci id="S3.E4.m2.1.1.1.1.cmml"
                                                                                    xref="S3.E4.m2.1.1.1.1">𝑖</ci>
                                                                                <ci id="S3.E4.m2.2.2.2.2.cmml"
                                                                                    xref="S3.E4.m2.2.2.2.2">𝑛</ci>
                                                                            </list>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E4.m2.4.4.2.2.2.cmml"
                                                                        xref="S3.E4.m2.4.4.2.2.1">
                                                                        <abs id="S3.E4.m2.4.4.2.2.2.1.cmml"
                                                                            xref="S3.E4.m2.4.4.2.2.1.2"></abs>
                                                                        <apply id="S3.E4.m2.4.4.2.2.1.1.cmml"
                                                                            xref="S3.E4.m2.4.4.2.2.1.1">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E4.m2.4.4.2.2.1.1.1.cmml"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1">superscript
                                                                            </csymbol>
                                                                            <apply id="S3.E4.m2.4.4.2.2.1.1.2.cmml"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E4.m2.4.4.2.2.1.1.2.1.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.2.2.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.2.2">𝐸
                                                                                </ci>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.2.3.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.2.3">𝑛
                                                                                </ci>
                                                                            </apply>
                                                                            <apply id="S3.E4.m2.4.4.2.2.1.1.3.cmml"
                                                                                xref="S3.E4.m2.4.4.2.2.1.1.3">
                                                                                <times
                                                                                    id="S3.E4.m2.4.4.2.2.1.1.3.1.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.3.1">
                                                                                </times>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.3.2.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.3.2">ℎ
                                                                                </ci>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.3.3.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.3.3">𝑎
                                                                                </ci>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.3.4.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.3.4">𝑠
                                                                                </ci>
                                                                                <ci id="S3.E4.m2.4.4.2.2.1.1.3.5.cmml"
                                                                                    xref="S3.E4.m2.4.4.2.2.1.1.3.5">ℎ
                                                                                </ci>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E4.m2.4c">
                                                            \displaystyle=\text{RollPolyHash}(g_{i,n})\%|E_{n}^{hash}|
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E4.m2.4d">=
                                                            RollPolyHash ( italic_g start_POSTSUBSCRIPT italic_i ,
                                                            italic_n end_POSTSUBSCRIPT ) % | italic_E
                                                            start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT
                                                            start_POSTSUPERSCRIPT italic_h italic_a italic_s italic_h
                                                            end_POSTSUPERSCRIPT |</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p class="ltx_p" id="S3.SS2.SSS1.p2.10">We normalize <math alttext="e_{i}"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.5.m1.1">
                                        <semantics id="S3.SS2.SSS1.p2.5.m1.1a">
                                            <msub id="S3.SS2.SSS1.p2.5.m1.1.1" xref="S3.SS2.SSS1.p2.5.m1.1.1.cmml">
                                                <mi id="S3.SS2.SSS1.p2.5.m1.1.1.2"
                                                    xref="S3.SS2.SSS1.p2.5.m1.1.1.2.cmml">e</mi>
                                                <mi id="S3.SS2.SSS1.p2.5.m1.1.1.3"
                                                    xref="S3.SS2.SSS1.p2.5.m1.1.1.3.cmml">i</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS1.p2.5.m1.1b">
                                                <apply id="S3.SS2.SSS1.p2.5.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m1.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m1.1.1.1.cmml"
                                                        xref="S3.SS2.SSS1.p2.5.m1.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS1.p2.5.m1.1.1.2.cmml"
                                                        xref="S3.SS2.SSS1.p2.5.m1.1.1.2">𝑒</ci>
                                                    <ci id="S3.SS2.SSS1.p2.5.m1.1.1.3.cmml"
                                                        xref="S3.SS2.SSS1.p2.5.m1.1.1.3">𝑖</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m1.1c">e_{i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.5.m1.1d">
                                                italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> by the number of <math alttext="n" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p2.6.m2.1">
                                        <semantics id="S3.SS2.SSS1.p2.6.m2.1a">
                                            <mi id="S3.SS2.SSS1.p2.6.m2.1.1" xref="S3.SS2.SSS1.p2.6.m2.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m2.1b">
                                                <ci id="S3.SS2.SSS1.p2.6.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m2.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m2.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.6.m2.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-grams sizes plus one and use RollPolyHash as defined in Appendix <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S13"
                                        title="13 Rolling Polynomial Hashing ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">13</span></a>.
                                    In Section <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S7"
                                        title="7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">7</span></a>, we ablate the effects of <math
                                        alttext="n" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.7.m3.1">
                                        <semantics id="S3.SS2.SSS1.p2.7.m3.1a">
                                            <mi id="S3.SS2.SSS1.p2.7.m3.1.1" xref="S3.SS2.SSS1.p2.7.m3.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m3.1b">
                                                <ci id="S3.SS2.SSS1.p2.7.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m3.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m3.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.7.m3.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-gram hash embeddings with different values for <math alttext="n"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.8.m4.1">
                                        <semantics id="S3.SS2.SSS1.p2.8.m4.1a">
                                            <mi id="S3.SS2.SSS1.p2.8.m4.1.1" xref="S3.SS2.SSS1.p2.8.m4.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m4.1b">
                                                <ci id="S3.SS2.SSS1.p2.8.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m4.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m4.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.8.m4.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math> and embedding table size on <span class="ltx_text ltx_font_smallcaps"
                                        id="S3.SS2.SSS1.p2.10.1">flop</span>-controlled scaling law trends.
                                    In addition to hash <math alttext="n" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS1.p2.9.m5.1">
                                        <semantics id="S3.SS2.SSS1.p2.9.m5.1a">
                                            <mi id="S3.SS2.SSS1.p2.9.m5.1.1" xref="S3.SS2.SSS1.p2.9.m5.1.1.cmml">n</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m5.1b">
                                                <ci id="S3.SS2.SSS1.p2.9.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m5.1.1">𝑛
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m5.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.9.m5.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-gram embeddings, we also experimented with frequency based <math alttext="n"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.10.m6.1">
                                        <semantics id="S3.SS2.SSS1.p2.10.m6.1a">
                                            <mi id="S3.SS2.SSS1.p2.10.m6.1.1" xref="S3.SS2.SSS1.p2.10.m6.1.1.cmml">n
                                            </mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.10.m6.1b">
                                                <ci id="S3.SS2.SSS1.p2.10.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.10.m6.1.1">
                                                    𝑛</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.10.m6.1c">n
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.10.m6.1d">
                                                italic_n</annotation>
                                        </semantics>
                                    </math>-gram embeddings, and we provide details of this exploration in Appendix <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S14"
                                        title="14 Frequency-based n-gram Embedddings ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">14</span></a>.</p>
                            </div>
                            <figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption"
                                    class="ltx_graphics ltx_centering ltx_img_landscape" height="319" id="S3.F5.g1"
                                    src="x5.png" width="830" />
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                            class="ltx_text" id="S3.F5.4.2.1" style="font-size:90%;">Figure 5</span>:
                                    </span><span class="ltx_text" id="S3.F5.2.1" style="font-size:90%;">The local
                                        encoder uses a cross-attention block with patch representations as queries, and
                                        byte representations as keys/values to encode byte representations into patch
                                        representations. The local decoder uses a similar block but with the roles
                                        reversed i.e. byte representations are now the queries and patch representations
                                        are the keys/values. Here we use Cross-Attn <math alttext="k=2" class="ltx_Math"
                                            display="inline" id="S3.F5.2.1.m1.1">
                                            <semantics id="S3.F5.2.1.m1.1b">
                                                <mrow id="S3.F5.2.1.m1.1.1" xref="S3.F5.2.1.m1.1.1.cmml">
                                                    <mi id="S3.F5.2.1.m1.1.1.2" xref="S3.F5.2.1.m1.1.1.2.cmml">k</mi>
                                                    <mo id="S3.F5.2.1.m1.1.1.1" xref="S3.F5.2.1.m1.1.1.1.cmml">=</mo>
                                                    <mn id="S3.F5.2.1.m1.1.1.3" xref="S3.F5.2.1.m1.1.1.3.cmml">2</mn>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.1c">
                                                    <apply id="S3.F5.2.1.m1.1.1.cmml" xref="S3.F5.2.1.m1.1.1">
                                                        <eq id="S3.F5.2.1.m1.1.1.1.cmml" xref="S3.F5.2.1.m1.1.1.1"></eq>
                                                        <ci id="S3.F5.2.1.m1.1.1.2.cmml" xref="S3.F5.2.1.m1.1.1.2">𝑘
                                                        </ci>
                                                        <cn id="S3.F5.2.1.m1.1.1.3.cmml" type="integer"
                                                            xref="S3.F5.2.1.m1.1.1.3">2</cn>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S3.F5.2.1.m1.1d">k=2
                                                </annotation>
                                                <annotation encoding="application/x-llamapun" id="S3.F5.2.1.m1.1e">
                                                    italic_k = 2</annotation>
                                            </semantics>
                                        </math>.
                                    </span></figcaption>
                            </figure>
                        </section>
                        <section class="ltx_subsubsection" id="S3.SS2.SSS2">
                            <h4 class="ltx_title ltx_title_subsubsection">
                                <span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Encoder Multi-Headed
                                Cross-Attention
                            </h4>
                            <div class="ltx_para" id="S3.SS2.SSS2.p1">
                                <p class="ltx_p" id="S3.SS2.SSS2.p1.6">We closely follow the input cross-attention
                                    module of the Perceiver architecture <cite
                                        class="ltx_cite ltx_citemacro_citep">(Jaegle et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib22"
                                            title="">2021</a>)</cite>, with the main difference being that latent
                                    representations correspond to variable patch representations as opposed to a fixed
                                    set of latent representations (<a class="ltx_ref ltx_refmacro_autoref"
                                        href="https://arxiv.org/html/2412.09871v1#S3.F5"
                                        title="Figure 5 ‣ 3.2.1 Encoder Hash n-gram Embeddings ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">Figure 5</span></a>), and only attend to the
                                    bytes that make up the respective patch.
                                    The module comprises a query vector, corresponding to each patch <math
                                        alttext="p_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1">
                                        <semantics id="S3.SS2.SSS2.p1.1.m1.1a">
                                            <msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.1.m1.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">p</mi>
                                                <mi id="S3.SS2.SSS2.p1.1.m1.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.1.m1.1b">
                                                <apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝑝</ci>
                                                    <ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">p_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">
                                                italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, which is initialized by pooling the byte representations corresponding to
                                    patch <math alttext="p_{j}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.2.m2.1">
                                        <semantics id="S3.SS2.SSS2.p1.2.m2.1a">
                                            <msub id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.2.m2.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">p</mi>
                                                <mi id="S3.SS2.SSS2.p1.2.m2.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.2.m2.1b">
                                                <apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.2.m2.1.1.2">𝑝</ci>
                                                    <ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">p_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">
                                                italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, followed by a linear projection, <math alttext="\mathcal{E}_{C}\in\mathbb{R}^{h_{\mathcal{E}}\times(h_{\mathcal{E}}\times U_{%
\mathcal{E}})}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1">
                                        <semantics id="S3.SS2.SSS2.p1.3.m3.1a">
                                            <mrow id="S3.SS2.SSS2.p1.3.m3.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.2.cmml">
                                                <msub id="S3.SS2.SSS2.p1.3.m3.1.2.2"
                                                    xref="S3.SS2.SSS2.p1.3.m3.1.2.2.cmml">
                                                    <mi class="ltx_font_mathcaligraphic"
                                                        id="S3.SS2.SSS2.p1.3.m3.1.2.2.2"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.2.2.cmml">ℰ</mi>
                                                    <mi id="S3.SS2.SSS2.p1.3.m3.1.2.2.3"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.2.3.cmml">C</mi>
                                                </msub>
                                                <mo id="S3.SS2.SSS2.p1.3.m3.1.2.1"
                                                    xref="S3.SS2.SSS2.p1.3.m3.1.2.1.cmml">∈</mo>
                                                <msup id="S3.SS2.SSS2.p1.3.m3.1.2.3"
                                                    xref="S3.SS2.SSS2.p1.3.m3.1.2.3.cmml">
                                                    <mi id="S3.SS2.SSS2.p1.3.m3.1.2.3.2"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.3.2.cmml">ℝ</mi>
                                                    <mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml">
                                                        <msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.3"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3.cmml">
                                                            <mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.2"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.3"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3.3.cmml">ℰ</mi>
                                                        </msub>
                                                        <mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.2" lspace="0.222em"
                                                            rspace="0.222em" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.2.cmml">×
                                                        </mo>
                                                        <mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml">
                                                            <mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" stretchy="false"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml">(</mo>
                                                            <mrow id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml">
                                                                <msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.cmml">
                                                                    <mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.2"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.2.cmml">
                                                                        h</mi>
                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                        id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.3"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.3.cmml">
                                                                        ℰ</mi>
                                                                </msub>
                                                                <mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.1"
                                                                    lspace="0.222em" rspace="0.222em"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml">×</mo>
                                                                <msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.cmml">
                                                                    <mi id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2.cmml">
                                                                        U</mi>
                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                        id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3.cmml">
                                                                        ℰ</mi>
                                                                </msub>
                                                            </mrow>
                                                            <mo id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" stretchy="false"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                </msup>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.3.m3.1b">
                                                <apply id="S3.SS2.SSS2.p1.3.m3.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.2">
                                                    <in id="S3.SS2.SSS2.p1.3.m3.1.2.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.1"></in>
                                                    <apply id="S3.SS2.SSS2.p1.3.m3.1.2.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.2">
                                                        <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.2.2.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.2.2">subscript</csymbol>
                                                        <ci id="S3.SS2.SSS2.p1.3.m3.1.2.2.2.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.2.2.2">ℰ</ci>
                                                        <ci id="S3.SS2.SSS2.p1.3.m3.1.2.2.3.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.2.2.3">𝐶</ci>
                                                    </apply>
                                                    <apply id="S3.SS2.SSS2.p1.3.m3.1.2.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.3.m3.1.2.3">
                                                        <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.2.3.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.2.3">superscript</csymbol>
                                                        <ci id="S3.SS2.SSS2.p1.3.m3.1.2.3.2.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.2.3.2">ℝ</ci>
                                                        <apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.3.m3.1.1.1">
                                                            <times id="S3.SS2.SSS2.p1.3.m3.1.1.1.2.cmml"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.2"></times>
                                                            <apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.cmml"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3">
                                                                <csymbol cd="ambiguous"
                                                                    id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.1.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3">subscript
                                                                </csymbol>
                                                                <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.2.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3.2">ℎ</ci>
                                                                <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.3.3.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.3.3">ℰ</ci>
                                                            </apply>
                                                            <apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml"
                                                                xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1">
                                                                <times id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.1"></times>
                                                                <apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.1.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2">
                                                                        subscript</csymbol>
                                                                    <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.2.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.2">ℎ
                                                                    </ci>
                                                                    <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.3.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.2.3">ℰ
                                                                    </ci>
                                                                </apply>
                                                                <apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.cmml"
                                                                    xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.1.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3">
                                                                        subscript</csymbol>
                                                                    <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.2">𝑈
                                                                    </ci>
                                                                    <ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3.cmml"
                                                                        xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.3.3">ℰ
                                                                    </ci>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">
                                                \mathcal{E}_{C}\in\mathbb{R}^{h_{\mathcal{E}}\times(h_{\mathcal{E}}\times
                                                U_{%
                                                \mathcal{E}})}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">
                                                caligraphic_E start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT ∈
                                                blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT
                                                caligraphic_E end_POSTSUBSCRIPT × ( italic_h start_POSTSUBSCRIPT
                                                caligraphic_E end_POSTSUBSCRIPT × italic_U start_POSTSUBSCRIPT
                                                caligraphic_E end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT</annotation>
                                        </semantics>
                                    </math>, where <math alttext="U_{\mathcal{E}}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.4.m4.1">
                                        <semantics id="S3.SS2.SSS2.p1.4.m4.1a">
                                            <msub id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.4.m4.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">U</mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.4.m4.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml">ℰ</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.4.m4.1b">
                                                <apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.4.m4.1.1.2">𝑈</ci>
                                                    <ci id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.4.m4.1.1.3">ℰ</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">
                                                U_{\mathcal{E}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">
                                                italic_U start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math> is the number of encoder cross-attention heads.
                                    Formally, if we let <math alttext="f_{\text{bytes}}(p_{j})" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS2.p1.5.m5.1">
                                        <semantics id="S3.SS2.SSS2.p1.5.m5.1a">
                                            <mrow id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml">
                                                <msub id="S3.SS2.SSS2.p1.5.m5.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml">
                                                    <mi id="S3.SS2.SSS2.p1.5.m5.1.1.3.2"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.3.2.cmml">f</mi>
                                                    <mtext id="S3.SS2.SSS2.p1.5.m5.1.1.3.3"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.3.3a.cmml">bytes</mtext>
                                                </msub>
                                                <mo id="S3.SS2.SSS2.p1.5.m5.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">⁢</mo>
                                                <mrow id="S3.SS2.SSS2.p1.5.m5.1.1.1.1"
                                                    xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.cmml">
                                                    <mo id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.2" stretchy="false"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.cmml">(</mo>
                                                    <msub id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.cmml">
                                                        <mi id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.2"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.2.cmml">p</mi>
                                                        <mi id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.3"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.3.cmml">j</mi>
                                                    </msub>
                                                    <mo id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.3" stretchy="false"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.cmml">)</mo>
                                                </mrow>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.5.m5.1b">
                                                <apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">
                                                    <times id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.2"></times>
                                                    <apply id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.3">
                                                        <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m5.1.1.3.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.3">subscript</csymbol>
                                                        <ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.2.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.3.2">𝑓</ci>
                                                        <ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.3a.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.3.3">
                                                            <mtext id="S3.SS2.SSS2.p1.5.m5.1.1.3.3.cmml" mathsize="70%"
                                                                xref="S3.SS2.SSS2.p1.5.m5.1.1.3.3">bytes</mtext>
                                                        </ci>
                                                    </apply>
                                                    <apply id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1">
                                                        <csymbol cd="ambiguous"
                                                            id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1">subscript</csymbol>
                                                        <ci id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.2.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.2">𝑝</ci>
                                                        <ci id="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.3.cmml"
                                                            xref="S3.SS2.SSS2.p1.5.m5.1.1.1.1.1.3">𝑗</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">
                                                f_{\text{bytes}}(p_{j})</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">
                                                italic_f start_POSTSUBSCRIPT bytes end_POSTSUBSCRIPT ( italic_p
                                                start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation>
                                        </semantics>
                                    </math> denote the sequence of bytes corresponding to patch, <math alttext="p_{j}"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.6.m6.1">
                                        <semantics id="S3.SS2.SSS2.p1.6.m6.1a">
                                            <msub id="S3.SS2.SSS2.p1.6.m6.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.6.m6.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.6.m6.1.1.2.cmml">p</mi>
                                                <mi id="S3.SS2.SSS2.p1.6.m6.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.6.m6.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.6.m6.1b">
                                                <apply id="S3.SS2.SSS2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.6.m6.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.6.m6.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.6.m6.1.1.2">𝑝</ci>
                                                    <ci id="S3.SS2.SSS2.p1.6.m6.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.6.m6.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.1c">p_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m6.1d">
                                                italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, then we calculate</p>
                                <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx4">
                                    <tbody id="S3.E5">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle P_{0,j}" class="ltx_Math" display="inline"
                                                    id="S3.E5.m1.2">
                                                    <semantics id="S3.E5.m1.2a">
                                                        <msub id="S3.E5.m1.2.3" xref="S3.E5.m1.2.3.cmml">
                                                            <mi id="S3.E5.m1.2.3.2" xref="S3.E5.m1.2.3.2.cmml">P</mi>
                                                            <mrow id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml">
                                                                <mn id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">0
                                                                </mn>
                                                                <mo id="S3.E5.m1.2.2.2.4.1"
                                                                    xref="S3.E5.m1.2.2.2.3.cmml">,</mo>
                                                                <mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">j
                                                                </mi>
                                                            </mrow>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E5.m1.2b">
                                                            <apply id="S3.E5.m1.2.3.cmml" xref="S3.E5.m1.2.3">
                                                                <csymbol cd="ambiguous" id="S3.E5.m1.2.3.1.cmml"
                                                                    xref="S3.E5.m1.2.3">subscript</csymbol>
                                                                <ci id="S3.E5.m1.2.3.2.cmml" xref="S3.E5.m1.2.3.2">𝑃
                                                                </ci>
                                                                <list id="S3.E5.m1.2.2.2.3.cmml"
                                                                    xref="S3.E5.m1.2.2.2.4">
                                                                    <cn id="S3.E5.m1.1.1.1.1.cmml" type="integer"
                                                                        xref="S3.E5.m1.1.1.1.1">0</cn>
                                                                    <ci id="S3.E5.m1.2.2.2.2.cmml"
                                                                        xref="S3.E5.m1.2.2.2.2">𝑗</ci>
                                                                </list>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E5.m1.2c">
                                                            \displaystyle P_{0,j}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">
                                                            italic_P start_POSTSUBSCRIPT 0 , italic_j end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathcal{E}_{C}(f_{\text{bytes}}((p_{j})),f\leavevmode\nobreak\ %
\text{is a pooling function}" class="ltx_math_unparsed" display="inline" id="S3.E5.m2.1">
                                                    <semantics id="S3.E5.m2.1a">
                                                        <mrow id="S3.E5.m2.1b">
                                                            <mo id="S3.E5.m2.1.1">=</mo>
                                                            <msub id="S3.E5.m2.1.2">
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S3.E5.m2.1.2.2">ℰ</mi>
                                                                <mi id="S3.E5.m2.1.2.3">C</mi>
                                                            </msub>
                                                            <mrow id="S3.E5.m2.1.3">
                                                                <mo id="S3.E5.m2.1.3.1" stretchy="false">(</mo>
                                                                <msub id="S3.E5.m2.1.3.2">
                                                                    <mi id="S3.E5.m2.1.3.2.2">f</mi>
                                                                    <mtext id="S3.E5.m2.1.3.2.3">bytes</mtext>
                                                                </msub>
                                                                <mrow id="S3.E5.m2.1.3.3">
                                                                    <mo id="S3.E5.m2.1.3.3.1" stretchy="false">(</mo>
                                                                    <mrow id="S3.E5.m2.1.3.3.2">
                                                                        <mo id="S3.E5.m2.1.3.3.2.1" stretchy="false">(
                                                                        </mo>
                                                                        <msub id="S3.E5.m2.1.3.3.2.2">
                                                                            <mi id="S3.E5.m2.1.3.3.2.2.2">p</mi>
                                                                            <mi id="S3.E5.m2.1.3.3.2.2.3">j</mi>
                                                                        </msub>
                                                                        <mo id="S3.E5.m2.1.3.3.2.3" stretchy="false">)
                                                                        </mo>
                                                                    </mrow>
                                                                    <mo id="S3.E5.m2.1.3.3.3" stretchy="false">)</mo>
                                                                </mrow>
                                                                <mo id="S3.E5.m2.1.3.4">,</mo>
                                                                <mi id="S3.E5.m2.1.3.5">f</mi>
                                                                <mtext id="S3.E5.m2.1.3.6">is a pooling function</mtext>
                                                            </mrow>
                                                        </mrow>
                                                        <annotation encoding="application/x-tex" id="S3.E5.m2.1c">
                                                            \displaystyle=\mathcal{E}_{C}(f_{\text{bytes}}((p_{j})),f\leavevmode\nobreak\
                                                            %
                                                            \text{is a pooling function}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E5.m2.1d">=
                                                            caligraphic_E start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT
                                                            ( italic_f start_POSTSUBSCRIPT bytes end_POSTSUBSCRIPT ( (
                                                            italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) )
                                                            , italic_f is a pooling function</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E6">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle P_{l}" class="ltx_Math" display="inline"
                                                    id="S3.E6.m1.1">
                                                    <semantics id="S3.E6.m1.1a">
                                                        <msub id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">
                                                            <mi id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">P</mi>
                                                            <mi id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">l</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E6.m1.1b">
                                                            <apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.cmml"
                                                                    xref="S3.E6.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2">𝑃
                                                                </ci>
                                                                <ci id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">𝑙
                                                                </ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E6.m1.1c">
                                                            \displaystyle P_{l}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">
                                                            italic_P start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=P_{l-1}+W_{o}\left(\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}%
}}\right)V\right)" class="ltx_Math" display="inline" id="S3.E6.m2.2">
                                                    <semantics id="S3.E6.m2.2a">
                                                        <mrow id="S3.E6.m2.2.2" xref="S3.E6.m2.2.2.cmml">
                                                            <mi id="S3.E6.m2.2.2.3" xref="S3.E6.m2.2.2.3.cmml"></mi>
                                                            <mo id="S3.E6.m2.2.2.2" xref="S3.E6.m2.2.2.2.cmml">=</mo>
                                                            <mrow id="S3.E6.m2.2.2.1" xref="S3.E6.m2.2.2.1.cmml">
                                                                <msub id="S3.E6.m2.2.2.1.3"
                                                                    xref="S3.E6.m2.2.2.1.3.cmml">
                                                                    <mi id="S3.E6.m2.2.2.1.3.2"
                                                                        xref="S3.E6.m2.2.2.1.3.2.cmml">P</mi>
                                                                    <mrow id="S3.E6.m2.2.2.1.3.3"
                                                                        xref="S3.E6.m2.2.2.1.3.3.cmml">
                                                                        <mi id="S3.E6.m2.2.2.1.3.3.2"
                                                                            xref="S3.E6.m2.2.2.1.3.3.2.cmml">l</mi>
                                                                        <mo id="S3.E6.m2.2.2.1.3.3.1"
                                                                            xref="S3.E6.m2.2.2.1.3.3.1.cmml">−</mo>
                                                                        <mn id="S3.E6.m2.2.2.1.3.3.3"
                                                                            xref="S3.E6.m2.2.2.1.3.3.3.cmml">1</mn>
                                                                    </mrow>
                                                                </msub>
                                                                <mo id="S3.E6.m2.2.2.1.2" xref="S3.E6.m2.2.2.1.2.cmml">+
                                                                </mo>
                                                                <mrow id="S3.E6.m2.2.2.1.1"
                                                                    xref="S3.E6.m2.2.2.1.1.cmml">
                                                                    <msub id="S3.E6.m2.2.2.1.1.3"
                                                                        xref="S3.E6.m2.2.2.1.1.3.cmml">
                                                                        <mi id="S3.E6.m2.2.2.1.1.3.2"
                                                                            xref="S3.E6.m2.2.2.1.1.3.2.cmml">W</mi>
                                                                        <mi id="S3.E6.m2.2.2.1.1.3.3"
                                                                            xref="S3.E6.m2.2.2.1.1.3.3.cmml">o</mi>
                                                                    </msub>
                                                                    <mo id="S3.E6.m2.2.2.1.1.2"
                                                                        xref="S3.E6.m2.2.2.1.1.2.cmml">⁢</mo>
                                                                    <mrow id="S3.E6.m2.2.2.1.1.1.1"
                                                                        xref="S3.E6.m2.2.2.1.1.1.1.1.cmml">
                                                                        <mo id="S3.E6.m2.2.2.1.1.1.1.2"
                                                                            xref="S3.E6.m2.2.2.1.1.1.1.1.cmml">(</mo>
                                                                        <mrow id="S3.E6.m2.2.2.1.1.1.1.1"
                                                                            xref="S3.E6.m2.2.2.1.1.1.1.1.cmml">
                                                                            <mtext id="S3.E6.m2.2.2.1.1.1.1.1.2"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.2a.cmml">
                                                                                softmax</mtext>
                                                                            <mo id="S3.E6.m2.2.2.1.1.1.1.1.1"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml">⁢
                                                                            </mo>
                                                                            <mrow id="S3.E6.m2.2.2.1.1.1.1.1.3.2"
                                                                                xref="S3.E6.m2.1.1.cmml">
                                                                                <mo id="S3.E6.m2.2.2.1.1.1.1.1.3.2.1"
                                                                                    xref="S3.E6.m2.1.1.cmml">(</mo>
                                                                                <mstyle displaystyle="true"
                                                                                    id="S3.E6.m2.1.1"
                                                                                    xref="S3.E6.m2.1.1.cmml">
                                                                                    <mfrac id="S3.E6.m2.1.1a"
                                                                                        xref="S3.E6.m2.1.1.cmml">
                                                                                        <mrow id="S3.E6.m2.1.1.2"
                                                                                            xref="S3.E6.m2.1.1.2.cmml">
                                                                                            <mi id="S3.E6.m2.1.1.2.2"
                                                                                                xref="S3.E6.m2.1.1.2.2.cmml">
                                                                                                Q</mi>
                                                                                            <mo id="S3.E6.m2.1.1.2.1"
                                                                                                xref="S3.E6.m2.1.1.2.1.cmml">
                                                                                                ⁢</mo>
                                                                                            <msup id="S3.E6.m2.1.1.2.3"
                                                                                                xref="S3.E6.m2.1.1.2.3.cmml">
                                                                                                <mi id="S3.E6.m2.1.1.2.3.2"
                                                                                                    xref="S3.E6.m2.1.1.2.3.2.cmml">
                                                                                                    K</mi>
                                                                                                <mi id="S3.E6.m2.1.1.2.3.3"
                                                                                                    xref="S3.E6.m2.1.1.2.3.3.cmml">
                                                                                                    T</mi>
                                                                                            </msup>
                                                                                        </mrow>
                                                                                        <msqrt id="S3.E6.m2.1.1.3"
                                                                                            xref="S3.E6.m2.1.1.3.cmml">
                                                                                            <msub id="S3.E6.m2.1.1.3.2"
                                                                                                xref="S3.E6.m2.1.1.3.2.cmml">
                                                                                                <mi id="S3.E6.m2.1.1.3.2.2"
                                                                                                    xref="S3.E6.m2.1.1.3.2.2.cmml">
                                                                                                    d</mi>
                                                                                                <mi id="S3.E6.m2.1.1.3.2.3"
                                                                                                    xref="S3.E6.m2.1.1.3.2.3.cmml">
                                                                                                    k</mi>
                                                                                            </msub>
                                                                                        </msqrt>
                                                                                    </mfrac>
                                                                                </mstyle>
                                                                                <mo id="S3.E6.m2.2.2.1.1.1.1.1.3.2.2"
                                                                                    xref="S3.E6.m2.1.1.cmml">)</mo>
                                                                            </mrow>
                                                                            <mo id="S3.E6.m2.2.2.1.1.1.1.1.1a"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.1.cmml">⁢
                                                                            </mo>
                                                                            <mi id="S3.E6.m2.2.2.1.1.1.1.1.4"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.4.cmml">V
                                                                            </mi>
                                                                        </mrow>
                                                                        <mo id="S3.E6.m2.2.2.1.1.1.1.3"
                                                                            xref="S3.E6.m2.2.2.1.1.1.1.1.cmml">)</mo>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E6.m2.2b">
                                                            <apply id="S3.E6.m2.2.2.cmml" xref="S3.E6.m2.2.2">
                                                                <eq id="S3.E6.m2.2.2.2.cmml" xref="S3.E6.m2.2.2.2"></eq>
                                                                <csymbol cd="latexml" id="S3.E6.m2.2.2.3.cmml"
                                                                    xref="S3.E6.m2.2.2.3">absent</csymbol>
                                                                <apply id="S3.E6.m2.2.2.1.cmml" xref="S3.E6.m2.2.2.1">
                                                                    <plus id="S3.E6.m2.2.2.1.2.cmml"
                                                                        xref="S3.E6.m2.2.2.1.2"></plus>
                                                                    <apply id="S3.E6.m2.2.2.1.3.cmml"
                                                                        xref="S3.E6.m2.2.2.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E6.m2.2.2.1.3.1.cmml"
                                                                            xref="S3.E6.m2.2.2.1.3">subscript</csymbol>
                                                                        <ci id="S3.E6.m2.2.2.1.3.2.cmml"
                                                                            xref="S3.E6.m2.2.2.1.3.2">𝑃</ci>
                                                                        <apply id="S3.E6.m2.2.2.1.3.3.cmml"
                                                                            xref="S3.E6.m2.2.2.1.3.3">
                                                                            <minus id="S3.E6.m2.2.2.1.3.3.1.cmml"
                                                                                xref="S3.E6.m2.2.2.1.3.3.1"></minus>
                                                                            <ci id="S3.E6.m2.2.2.1.3.3.2.cmml"
                                                                                xref="S3.E6.m2.2.2.1.3.3.2">𝑙</ci>
                                                                            <cn id="S3.E6.m2.2.2.1.3.3.3.cmml"
                                                                                type="integer"
                                                                                xref="S3.E6.m2.2.2.1.3.3.3">1</cn>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E6.m2.2.2.1.1.cmml"
                                                                        xref="S3.E6.m2.2.2.1.1">
                                                                        <times id="S3.E6.m2.2.2.1.1.2.cmml"
                                                                            xref="S3.E6.m2.2.2.1.1.2"></times>
                                                                        <apply id="S3.E6.m2.2.2.1.1.3.cmml"
                                                                            xref="S3.E6.m2.2.2.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E6.m2.2.2.1.1.3.1.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E6.m2.2.2.1.1.3.2.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.3.2">𝑊</ci>
                                                                            <ci id="S3.E6.m2.2.2.1.1.3.3.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.3.3">𝑜</ci>
                                                                        </apply>
                                                                        <apply id="S3.E6.m2.2.2.1.1.1.1.1.cmml"
                                                                            xref="S3.E6.m2.2.2.1.1.1.1">
                                                                            <times id="S3.E6.m2.2.2.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.1"></times>
                                                                            <ci id="S3.E6.m2.2.2.1.1.1.1.1.2a.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.2">
                                                                                <mtext
                                                                                    id="S3.E6.m2.2.2.1.1.1.1.1.2.cmml"
                                                                                    xref="S3.E6.m2.2.2.1.1.1.1.1.2">
                                                                                    softmax</mtext>
                                                                            </ci>
                                                                            <apply id="S3.E6.m2.1.1.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.3.2">
                                                                                <divide id="S3.E6.m2.1.1.1.cmml"
                                                                                    xref="S3.E6.m2.2.2.1.1.1.1.1.3.2">
                                                                                </divide>
                                                                                <apply id="S3.E6.m2.1.1.2.cmml"
                                                                                    xref="S3.E6.m2.1.1.2">
                                                                                    <times id="S3.E6.m2.1.1.2.1.cmml"
                                                                                        xref="S3.E6.m2.1.1.2.1"></times>
                                                                                    <ci id="S3.E6.m2.1.1.2.2.cmml"
                                                                                        xref="S3.E6.m2.1.1.2.2">𝑄</ci>
                                                                                    <apply id="S3.E6.m2.1.1.2.3.cmml"
                                                                                        xref="S3.E6.m2.1.1.2.3">
                                                                                        <csymbol cd="ambiguous"
                                                                                            id="S3.E6.m2.1.1.2.3.1.cmml"
                                                                                            xref="S3.E6.m2.1.1.2.3">
                                                                                            superscript</csymbol>
                                                                                        <ci id="S3.E6.m2.1.1.2.3.2.cmml"
                                                                                            xref="S3.E6.m2.1.1.2.3.2">𝐾
                                                                                        </ci>
                                                                                        <ci id="S3.E6.m2.1.1.2.3.3.cmml"
                                                                                            xref="S3.E6.m2.1.1.2.3.3">𝑇
                                                                                        </ci>
                                                                                    </apply>
                                                                                </apply>
                                                                                <apply id="S3.E6.m2.1.1.3.cmml"
                                                                                    xref="S3.E6.m2.1.1.3">
                                                                                    <root id="S3.E6.m2.1.1.3a.cmml"
                                                                                        xref="S3.E6.m2.1.1.3"></root>
                                                                                    <apply id="S3.E6.m2.1.1.3.2.cmml"
                                                                                        xref="S3.E6.m2.1.1.3.2">
                                                                                        <csymbol cd="ambiguous"
                                                                                            id="S3.E6.m2.1.1.3.2.1.cmml"
                                                                                            xref="S3.E6.m2.1.1.3.2">
                                                                                            subscript</csymbol>
                                                                                        <ci id="S3.E6.m2.1.1.3.2.2.cmml"
                                                                                            xref="S3.E6.m2.1.1.3.2.2">𝑑
                                                                                        </ci>
                                                                                        <ci id="S3.E6.m2.1.1.3.2.3.cmml"
                                                                                            xref="S3.E6.m2.1.1.3.2.3">𝑘
                                                                                        </ci>
                                                                                    </apply>
                                                                                </apply>
                                                                            </apply>
                                                                            <ci id="S3.E6.m2.2.2.1.1.1.1.1.4.cmml"
                                                                                xref="S3.E6.m2.2.2.1.1.1.1.1.4">𝑉</ci>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E6.m2.2c">
                                                            \displaystyle=P_{l-1}+W_{o}\left(\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}%
                                                            }}\right)V\right)</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E6.m2.2d">=
                                                            italic_P start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT
                                                            + italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT (
                                                            softmax ( divide start_ARG italic_Q italic_K
                                                            start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG
                                                            start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT
                                                            italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V )
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E7">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle\text{where }Q_{j}" class="ltx_Math"
                                                    display="inline" id="S3.E7.m1.1">
                                                    <semantics id="S3.E7.m1.1a">
                                                        <mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">
                                                            <mtext id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2a.cmml">where
                                                            </mtext>
                                                            <mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">⁢</mo>
                                                            <msub id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">
                                                                <mi id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml">Q
                                                                </mi>
                                                                <mi id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml">j
                                                                </mi>
                                                            </msub>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E7.m1.1b">
                                                            <apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">
                                                                <times id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1">
                                                                </times>
                                                                <ci id="S3.E7.m1.1.1.2a.cmml" xref="S3.E7.m1.1.1.2">
                                                                    <mtext id="S3.E7.m1.1.1.2.cmml"
                                                                        xref="S3.E7.m1.1.1.2">where </mtext>
                                                                </ci>
                                                                <apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">
                                                                    <csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.cmml"
                                                                        xref="S3.E7.m1.1.1.3">subscript</csymbol>
                                                                    <ci id="S3.E7.m1.1.1.3.2.cmml"
                                                                        xref="S3.E7.m1.1.1.3.2">𝑄</ci>
                                                                    <ci id="S3.E7.m1.1.1.3.3.cmml"
                                                                        xref="S3.E7.m1.1.1.3.3">𝑗</ci>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E7.m1.1c">
                                                            \displaystyle\text{where }Q_{j}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">
                                                            where italic_Q start_POSTSUBSCRIPT italic_j
                                                            end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=W_{q}(P_{l-1,j}),K_{i}=W_{k}(h_{l-1,i}),V_{i}=W_{v}(h_{l-1,i})"
                                                    class="ltx_Math" display="inline" id="S3.E7.m2.8">
                                                    <semantics id="S3.E7.m2.8a">
                                                        <mrow id="S3.E7.m2.8.8.2" xref="S3.E7.m2.8.8.3.cmml">
                                                            <mrow id="S3.E7.m2.7.7.1.1" xref="S3.E7.m2.7.7.1.1.cmml">
                                                                <mi id="S3.E7.m2.7.7.1.1.3"
                                                                    xref="S3.E7.m2.7.7.1.1.3.cmml"></mi>
                                                                <mo id="S3.E7.m2.7.7.1.1.2"
                                                                    xref="S3.E7.m2.7.7.1.1.2.cmml">=</mo>
                                                                <mrow id="S3.E7.m2.7.7.1.1.1"
                                                                    xref="S3.E7.m2.7.7.1.1.1.cmml">
                                                                    <msub id="S3.E7.m2.7.7.1.1.1.3"
                                                                        xref="S3.E7.m2.7.7.1.1.1.3.cmml">
                                                                        <mi id="S3.E7.m2.7.7.1.1.1.3.2"
                                                                            xref="S3.E7.m2.7.7.1.1.1.3.2.cmml">W</mi>
                                                                        <mi id="S3.E7.m2.7.7.1.1.1.3.3"
                                                                            xref="S3.E7.m2.7.7.1.1.1.3.3.cmml">q</mi>
                                                                    </msub>
                                                                    <mo id="S3.E7.m2.7.7.1.1.1.2"
                                                                        xref="S3.E7.m2.7.7.1.1.1.2.cmml">⁢</mo>
                                                                    <mrow id="S3.E7.m2.7.7.1.1.1.1.1"
                                                                        xref="S3.E7.m2.7.7.1.1.1.1.1.1.cmml">
                                                                        <mo id="S3.E7.m2.7.7.1.1.1.1.1.2"
                                                                            stretchy="false"
                                                                            xref="S3.E7.m2.7.7.1.1.1.1.1.1.cmml">(</mo>
                                                                        <msub id="S3.E7.m2.7.7.1.1.1.1.1.1"
                                                                            xref="S3.E7.m2.7.7.1.1.1.1.1.1.cmml">
                                                                            <mi id="S3.E7.m2.7.7.1.1.1.1.1.1.2"
                                                                                xref="S3.E7.m2.7.7.1.1.1.1.1.1.2.cmml">P
                                                                            </mi>
                                                                            <mrow id="S3.E7.m2.2.2.2.2"
                                                                                xref="S3.E7.m2.2.2.2.3.cmml">
                                                                                <mrow id="S3.E7.m2.2.2.2.2.1"
                                                                                    xref="S3.E7.m2.2.2.2.2.1.cmml">
                                                                                    <mi id="S3.E7.m2.2.2.2.2.1.2"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.2.cmml">
                                                                                        l</mi>
                                                                                    <mo id="S3.E7.m2.2.2.2.2.1.1"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.1.cmml">
                                                                                        −</mo>
                                                                                    <mn id="S3.E7.m2.2.2.2.2.1.3"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.3.cmml">
                                                                                        1</mn>
                                                                                </mrow>
                                                                                <mo id="S3.E7.m2.2.2.2.2.2"
                                                                                    xref="S3.E7.m2.2.2.2.3.cmml">,</mo>
                                                                                <mi id="S3.E7.m2.1.1.1.1"
                                                                                    xref="S3.E7.m2.1.1.1.1.cmml">j</mi>
                                                                            </mrow>
                                                                        </msub>
                                                                        <mo id="S3.E7.m2.7.7.1.1.1.1.1.3"
                                                                            stretchy="false"
                                                                            xref="S3.E7.m2.7.7.1.1.1.1.1.1.cmml">)</mo>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                            <mo id="S3.E7.m2.8.8.2.3" xref="S3.E7.m2.8.8.3a.cmml">,</mo>
                                                            <mrow id="S3.E7.m2.8.8.2.2.2"
                                                                xref="S3.E7.m2.8.8.2.2.3.cmml">
                                                                <mrow id="S3.E7.m2.8.8.2.2.1.1"
                                                                    xref="S3.E7.m2.8.8.2.2.1.1.cmml">
                                                                    <msub id="S3.E7.m2.8.8.2.2.1.1.3"
                                                                        xref="S3.E7.m2.8.8.2.2.1.1.3.cmml">
                                                                        <mi id="S3.E7.m2.8.8.2.2.1.1.3.2"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.3.2.cmml">K</mi>
                                                                        <mi id="S3.E7.m2.8.8.2.2.1.1.3.3"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.3.3.cmml">i</mi>
                                                                    </msub>
                                                                    <mo id="S3.E7.m2.8.8.2.2.1.1.2"
                                                                        xref="S3.E7.m2.8.8.2.2.1.1.2.cmml">=</mo>
                                                                    <mrow id="S3.E7.m2.8.8.2.2.1.1.1"
                                                                        xref="S3.E7.m2.8.8.2.2.1.1.1.cmml">
                                                                        <msub id="S3.E7.m2.8.8.2.2.1.1.1.3"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.1.3.cmml">
                                                                            <mi id="S3.E7.m2.8.8.2.2.1.1.1.3.2"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.3.2.cmml">W
                                                                            </mi>
                                                                            <mi id="S3.E7.m2.8.8.2.2.1.1.1.3.3"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.3.3.cmml">k
                                                                            </mi>
                                                                        </msub>
                                                                        <mo id="S3.E7.m2.8.8.2.2.1.1.1.2"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E7.m2.8.8.2.2.1.1.1.1.1"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.cmml">
                                                                            <mo id="S3.E7.m2.8.8.2.2.1.1.1.1.1.2"
                                                                                stretchy="false"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.cmml">
                                                                                (</mo>
                                                                            <msub id="S3.E7.m2.8.8.2.2.1.1.1.1.1.1"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.cmml">
                                                                                <mi id="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.2"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.2.cmml">
                                                                                    h</mi>
                                                                                <mrow id="S3.E7.m2.4.4.2.2"
                                                                                    xref="S3.E7.m2.4.4.2.3.cmml">
                                                                                    <mrow id="S3.E7.m2.4.4.2.2.1"
                                                                                        xref="S3.E7.m2.4.4.2.2.1.cmml">
                                                                                        <mi id="S3.E7.m2.4.4.2.2.1.2"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.2.cmml">
                                                                                            l</mi>
                                                                                        <mo id="S3.E7.m2.4.4.2.2.1.1"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.1.cmml">
                                                                                            −</mo>
                                                                                        <mn id="S3.E7.m2.4.4.2.2.1.3"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.3.cmml">
                                                                                            1</mn>
                                                                                    </mrow>
                                                                                    <mo id="S3.E7.m2.4.4.2.2.2"
                                                                                        xref="S3.E7.m2.4.4.2.3.cmml">,
                                                                                    </mo>
                                                                                    <mi id="S3.E7.m2.3.3.1.1"
                                                                                        xref="S3.E7.m2.3.3.1.1.cmml">i
                                                                                    </mi>
                                                                                </mrow>
                                                                            </msub>
                                                                            <mo id="S3.E7.m2.8.8.2.2.1.1.1.1.1.3"
                                                                                stretchy="false"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.cmml">
                                                                                )</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                                <mo id="S3.E7.m2.8.8.2.2.2.3"
                                                                    xref="S3.E7.m2.8.8.2.2.3a.cmml">,</mo>
                                                                <mrow id="S3.E7.m2.8.8.2.2.2.2"
                                                                    xref="S3.E7.m2.8.8.2.2.2.2.cmml">
                                                                    <msub id="S3.E7.m2.8.8.2.2.2.2.3"
                                                                        xref="S3.E7.m2.8.8.2.2.2.2.3.cmml">
                                                                        <mi id="S3.E7.m2.8.8.2.2.2.2.3.2"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.3.2.cmml">V</mi>
                                                                        <mi id="S3.E7.m2.8.8.2.2.2.2.3.3"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.3.3.cmml">i</mi>
                                                                    </msub>
                                                                    <mo id="S3.E7.m2.8.8.2.2.2.2.2"
                                                                        xref="S3.E7.m2.8.8.2.2.2.2.2.cmml">=</mo>
                                                                    <mrow id="S3.E7.m2.8.8.2.2.2.2.1"
                                                                        xref="S3.E7.m2.8.8.2.2.2.2.1.cmml">
                                                                        <msub id="S3.E7.m2.8.8.2.2.2.2.1.3"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.1.3.cmml">
                                                                            <mi id="S3.E7.m2.8.8.2.2.2.2.1.3.2"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.3.2.cmml">W
                                                                            </mi>
                                                                            <mi id="S3.E7.m2.8.8.2.2.2.2.1.3.3"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.3.3.cmml">v
                                                                            </mi>
                                                                        </msub>
                                                                        <mo id="S3.E7.m2.8.8.2.2.2.2.1.2"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E7.m2.8.8.2.2.2.2.1.1.1"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.cmml">
                                                                            <mo id="S3.E7.m2.8.8.2.2.2.2.1.1.1.2"
                                                                                stretchy="false"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.cmml">
                                                                                (</mo>
                                                                            <msub id="S3.E7.m2.8.8.2.2.2.2.1.1.1.1"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.cmml">
                                                                                <mi id="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.2"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.2.cmml">
                                                                                    h</mi>
                                                                                <mrow id="S3.E7.m2.6.6.2.2"
                                                                                    xref="S3.E7.m2.6.6.2.3.cmml">
                                                                                    <mrow id="S3.E7.m2.6.6.2.2.1"
                                                                                        xref="S3.E7.m2.6.6.2.2.1.cmml">
                                                                                        <mi id="S3.E7.m2.6.6.2.2.1.2"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.2.cmml">
                                                                                            l</mi>
                                                                                        <mo id="S3.E7.m2.6.6.2.2.1.1"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.1.cmml">
                                                                                            −</mo>
                                                                                        <mn id="S3.E7.m2.6.6.2.2.1.3"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.3.cmml">
                                                                                            1</mn>
                                                                                    </mrow>
                                                                                    <mo id="S3.E7.m2.6.6.2.2.2"
                                                                                        xref="S3.E7.m2.6.6.2.3.cmml">,
                                                                                    </mo>
                                                                                    <mi id="S3.E7.m2.5.5.1.1"
                                                                                        xref="S3.E7.m2.5.5.1.1.cmml">i
                                                                                    </mi>
                                                                                </mrow>
                                                                            </msub>
                                                                            <mo id="S3.E7.m2.8.8.2.2.2.2.1.1.1.3"
                                                                                stretchy="false"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.cmml">
                                                                                )</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E7.m2.8b">
                                                            <apply id="S3.E7.m2.8.8.3.cmml" xref="S3.E7.m2.8.8.2">
                                                                <csymbol cd="ambiguous" id="S3.E7.m2.8.8.3a.cmml"
                                                                    xref="S3.E7.m2.8.8.2.3">formulae-sequence</csymbol>
                                                                <apply id="S3.E7.m2.7.7.1.1.cmml"
                                                                    xref="S3.E7.m2.7.7.1.1">
                                                                    <eq id="S3.E7.m2.7.7.1.1.2.cmml"
                                                                        xref="S3.E7.m2.7.7.1.1.2"></eq>
                                                                    <csymbol cd="latexml" id="S3.E7.m2.7.7.1.1.3.cmml"
                                                                        xref="S3.E7.m2.7.7.1.1.3">absent</csymbol>
                                                                    <apply id="S3.E7.m2.7.7.1.1.1.cmml"
                                                                        xref="S3.E7.m2.7.7.1.1.1">
                                                                        <times id="S3.E7.m2.7.7.1.1.1.2.cmml"
                                                                            xref="S3.E7.m2.7.7.1.1.1.2"></times>
                                                                        <apply id="S3.E7.m2.7.7.1.1.1.3.cmml"
                                                                            xref="S3.E7.m2.7.7.1.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E7.m2.7.7.1.1.1.3.1.cmml"
                                                                                xref="S3.E7.m2.7.7.1.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E7.m2.7.7.1.1.1.3.2.cmml"
                                                                                xref="S3.E7.m2.7.7.1.1.1.3.2">𝑊</ci>
                                                                            <ci id="S3.E7.m2.7.7.1.1.1.3.3.cmml"
                                                                                xref="S3.E7.m2.7.7.1.1.1.3.3">𝑞</ci>
                                                                        </apply>
                                                                        <apply id="S3.E7.m2.7.7.1.1.1.1.1.1.cmml"
                                                                            xref="S3.E7.m2.7.7.1.1.1.1.1">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E7.m2.7.7.1.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E7.m2.7.7.1.1.1.1.1">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E7.m2.7.7.1.1.1.1.1.1.2.cmml"
                                                                                xref="S3.E7.m2.7.7.1.1.1.1.1.1.2">𝑃
                                                                            </ci>
                                                                            <list id="S3.E7.m2.2.2.2.3.cmml"
                                                                                xref="S3.E7.m2.2.2.2.2">
                                                                                <apply id="S3.E7.m2.2.2.2.2.1.cmml"
                                                                                    xref="S3.E7.m2.2.2.2.2.1">
                                                                                    <minus
                                                                                        id="S3.E7.m2.2.2.2.2.1.1.cmml"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.1">
                                                                                    </minus>
                                                                                    <ci id="S3.E7.m2.2.2.2.2.1.2.cmml"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.2">𝑙
                                                                                    </ci>
                                                                                    <cn id="S3.E7.m2.2.2.2.2.1.3.cmml"
                                                                                        type="integer"
                                                                                        xref="S3.E7.m2.2.2.2.2.1.3">1
                                                                                    </cn>
                                                                                </apply>
                                                                                <ci id="S3.E7.m2.1.1.1.1.cmml"
                                                                                    xref="S3.E7.m2.1.1.1.1">𝑗</ci>
                                                                            </list>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                                <apply id="S3.E7.m2.8.8.2.2.3.cmml"
                                                                    xref="S3.E7.m2.8.8.2.2.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S3.E7.m2.8.8.2.2.3a.cmml"
                                                                        xref="S3.E7.m2.8.8.2.2.2.3">formulae-sequence
                                                                    </csymbol>
                                                                    <apply id="S3.E7.m2.8.8.2.2.1.1.cmml"
                                                                        xref="S3.E7.m2.8.8.2.2.1.1">
                                                                        <eq id="S3.E7.m2.8.8.2.2.1.1.2.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.2"></eq>
                                                                        <apply id="S3.E7.m2.8.8.2.2.1.1.3.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E7.m2.8.8.2.2.1.1.3.1.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E7.m2.8.8.2.2.1.1.3.2.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.3.2">𝐾</ci>
                                                                            <ci id="S3.E7.m2.8.8.2.2.1.1.3.3.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.3.3">𝑖</ci>
                                                                        </apply>
                                                                        <apply id="S3.E7.m2.8.8.2.2.1.1.1.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.1.1.1">
                                                                            <times id="S3.E7.m2.8.8.2.2.1.1.1.2.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.2"></times>
                                                                            <apply id="S3.E7.m2.8.8.2.2.1.1.1.3.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E7.m2.8.8.2.2.1.1.1.3.1.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E7.m2.8.8.2.2.1.1.1.3.2.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.3.2">𝑊
                                                                                </ci>
                                                                                <ci id="S3.E7.m2.8.8.2.2.1.1.1.3.3.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.3.3">𝑘
                                                                                </ci>
                                                                            </apply>
                                                                            <apply
                                                                                id="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.1.1.1.1.1">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.1.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.1.1">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.2.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.1.1.1.1.1.1.2">
                                                                                    ℎ</ci>
                                                                                <list id="S3.E7.m2.4.4.2.3.cmml"
                                                                                    xref="S3.E7.m2.4.4.2.2">
                                                                                    <apply id="S3.E7.m2.4.4.2.2.1.cmml"
                                                                                        xref="S3.E7.m2.4.4.2.2.1">
                                                                                        <minus
                                                                                            id="S3.E7.m2.4.4.2.2.1.1.cmml"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.1">
                                                                                        </minus>
                                                                                        <ci id="S3.E7.m2.4.4.2.2.1.2.cmml"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.2">
                                                                                            𝑙</ci>
                                                                                        <cn id="S3.E7.m2.4.4.2.2.1.3.cmml"
                                                                                            type="integer"
                                                                                            xref="S3.E7.m2.4.4.2.2.1.3">
                                                                                            1</cn>
                                                                                    </apply>
                                                                                    <ci id="S3.E7.m2.3.3.1.1.cmml"
                                                                                        xref="S3.E7.m2.3.3.1.1">𝑖</ci>
                                                                                </list>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E7.m2.8.8.2.2.2.2.cmml"
                                                                        xref="S3.E7.m2.8.8.2.2.2.2">
                                                                        <eq id="S3.E7.m2.8.8.2.2.2.2.2.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.2"></eq>
                                                                        <apply id="S3.E7.m2.8.8.2.2.2.2.3.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E7.m2.8.8.2.2.2.2.3.1.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E7.m2.8.8.2.2.2.2.3.2.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.3.2">𝑉</ci>
                                                                            <ci id="S3.E7.m2.8.8.2.2.2.2.3.3.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.3.3">𝑖</ci>
                                                                        </apply>
                                                                        <apply id="S3.E7.m2.8.8.2.2.2.2.1.cmml"
                                                                            xref="S3.E7.m2.8.8.2.2.2.2.1">
                                                                            <times id="S3.E7.m2.8.8.2.2.2.2.1.2.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.2"></times>
                                                                            <apply id="S3.E7.m2.8.8.2.2.2.2.1.3.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E7.m2.8.8.2.2.2.2.1.3.1.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E7.m2.8.8.2.2.2.2.1.3.2.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.3.2">𝑊
                                                                                </ci>
                                                                                <ci id="S3.E7.m2.8.8.2.2.2.2.1.3.3.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.3.3">𝑣
                                                                                </ci>
                                                                            </apply>
                                                                            <apply
                                                                                id="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.cmml"
                                                                                xref="S3.E7.m2.8.8.2.2.2.2.1.1.1">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.1.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.1.1">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.2.cmml"
                                                                                    xref="S3.E7.m2.8.8.2.2.2.2.1.1.1.1.2">
                                                                                    ℎ</ci>
                                                                                <list id="S3.E7.m2.6.6.2.3.cmml"
                                                                                    xref="S3.E7.m2.6.6.2.2">
                                                                                    <apply id="S3.E7.m2.6.6.2.2.1.cmml"
                                                                                        xref="S3.E7.m2.6.6.2.2.1">
                                                                                        <minus
                                                                                            id="S3.E7.m2.6.6.2.2.1.1.cmml"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.1">
                                                                                        </minus>
                                                                                        <ci id="S3.E7.m2.6.6.2.2.1.2.cmml"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.2">
                                                                                            𝑙</ci>
                                                                                        <cn id="S3.E7.m2.6.6.2.2.1.3.cmml"
                                                                                            type="integer"
                                                                                            xref="S3.E7.m2.6.6.2.2.1.3">
                                                                                            1</cn>
                                                                                    </apply>
                                                                                    <ci id="S3.E7.m2.5.5.1.1.cmml"
                                                                                        xref="S3.E7.m2.5.5.1.1">𝑖</ci>
                                                                                </list>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E7.m2.8c">
                                                            \displaystyle=W_{q}(P_{l-1,j}),K_{i}=W_{k}(h_{l-1,i}),V_{i}=W_{v}(h_{l-1,i})
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E7.m2.8d">=
                                                            italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT (
                                                            italic_P start_POSTSUBSCRIPT italic_l - 1 , italic_j
                                                            end_POSTSUBSCRIPT ) , italic_K start_POSTSUBSCRIPT italic_i
                                                            end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_k
                                                            end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_l -
                                                            1 , italic_i end_POSTSUBSCRIPT ) , italic_V
                                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_W
                                                            start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT ( italic_h
                                                            start_POSTSUBSCRIPT italic_l - 1 , italic_i
                                                            end_POSTSUBSCRIPT )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E8">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle h_{l}" class="ltx_Math" display="inline"
                                                    id="S3.E8.m1.1">
                                                    <semantics id="S3.E8.m1.1a">
                                                        <msub id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">
                                                            <mi id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">h</mi>
                                                            <mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">l</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E8.m1.1b">
                                                            <apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.cmml"
                                                                    xref="S3.E8.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2">ℎ
                                                                </ci>
                                                                <ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">𝑙
                                                                </ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E8.m1.1c">
                                                            \displaystyle h_{l}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">
                                                            italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=\text{Encoder-Transformer-Layer}_{l}(h_{l-1})"
                                                    class="ltx_Math" display="inline" id="S3.E8.m2.1">
                                                    <semantics id="S3.E8.m2.1a">
                                                        <mrow id="S3.E8.m2.1.1" xref="S3.E8.m2.1.1.cmml">
                                                            <mi id="S3.E8.m2.1.1.3" xref="S3.E8.m2.1.1.3.cmml"></mi>
                                                            <mo id="S3.E8.m2.1.1.2" xref="S3.E8.m2.1.1.2.cmml">=</mo>
                                                            <mrow id="S3.E8.m2.1.1.1" xref="S3.E8.m2.1.1.1.cmml">
                                                                <msub id="S3.E8.m2.1.1.1.3"
                                                                    xref="S3.E8.m2.1.1.1.3.cmml">
                                                                    <mtext id="S3.E8.m2.1.1.1.3.2"
                                                                        xref="S3.E8.m2.1.1.1.3.2a.cmml">
                                                                        Encoder-Transformer-Layer</mtext>
                                                                    <mi id="S3.E8.m2.1.1.1.3.3"
                                                                        xref="S3.E8.m2.1.1.1.3.3.cmml">l</mi>
                                                                </msub>
                                                                <mo id="S3.E8.m2.1.1.1.2" xref="S3.E8.m2.1.1.1.2.cmml">⁢
                                                                </mo>
                                                                <mrow id="S3.E8.m2.1.1.1.1.1"
                                                                    xref="S3.E8.m2.1.1.1.1.1.1.cmml">
                                                                    <mo id="S3.E8.m2.1.1.1.1.1.2" stretchy="false"
                                                                        xref="S3.E8.m2.1.1.1.1.1.1.cmml">(</mo>
                                                                    <msub id="S3.E8.m2.1.1.1.1.1.1"
                                                                        xref="S3.E8.m2.1.1.1.1.1.1.cmml">
                                                                        <mi id="S3.E8.m2.1.1.1.1.1.1.2"
                                                                            xref="S3.E8.m2.1.1.1.1.1.1.2.cmml">h</mi>
                                                                        <mrow id="S3.E8.m2.1.1.1.1.1.1.3"
                                                                            xref="S3.E8.m2.1.1.1.1.1.1.3.cmml">
                                                                            <mi id="S3.E8.m2.1.1.1.1.1.1.3.2"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.2.cmml">l
                                                                            </mi>
                                                                            <mo id="S3.E8.m2.1.1.1.1.1.1.3.1"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.1.cmml">−
                                                                            </mo>
                                                                            <mn id="S3.E8.m2.1.1.1.1.1.1.3.3"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.3.cmml">1
                                                                            </mn>
                                                                        </mrow>
                                                                    </msub>
                                                                    <mo id="S3.E8.m2.1.1.1.1.1.3" stretchy="false"
                                                                        xref="S3.E8.m2.1.1.1.1.1.1.cmml">)</mo>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E8.m2.1b">
                                                            <apply id="S3.E8.m2.1.1.cmml" xref="S3.E8.m2.1.1">
                                                                <eq id="S3.E8.m2.1.1.2.cmml" xref="S3.E8.m2.1.1.2"></eq>
                                                                <csymbol cd="latexml" id="S3.E8.m2.1.1.3.cmml"
                                                                    xref="S3.E8.m2.1.1.3">absent</csymbol>
                                                                <apply id="S3.E8.m2.1.1.1.cmml" xref="S3.E8.m2.1.1.1">
                                                                    <times id="S3.E8.m2.1.1.1.2.cmml"
                                                                        xref="S3.E8.m2.1.1.1.2"></times>
                                                                    <apply id="S3.E8.m2.1.1.1.3.cmml"
                                                                        xref="S3.E8.m2.1.1.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E8.m2.1.1.1.3.1.cmml"
                                                                            xref="S3.E8.m2.1.1.1.3">subscript</csymbol>
                                                                        <ci id="S3.E8.m2.1.1.1.3.2a.cmml"
                                                                            xref="S3.E8.m2.1.1.1.3.2">
                                                                            <mtext id="S3.E8.m2.1.1.1.3.2.cmml"
                                                                                xref="S3.E8.m2.1.1.1.3.2">
                                                                                Encoder-Transformer-Layer</mtext>
                                                                        </ci>
                                                                        <ci id="S3.E8.m2.1.1.1.3.3.cmml"
                                                                            xref="S3.E8.m2.1.1.1.3.3">𝑙</ci>
                                                                    </apply>
                                                                    <apply id="S3.E8.m2.1.1.1.1.1.1.cmml"
                                                                        xref="S3.E8.m2.1.1.1.1.1">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E8.m2.1.1.1.1.1.1.1.cmml"
                                                                            xref="S3.E8.m2.1.1.1.1.1">subscript
                                                                        </csymbol>
                                                                        <ci id="S3.E8.m2.1.1.1.1.1.1.2.cmml"
                                                                            xref="S3.E8.m2.1.1.1.1.1.1.2">ℎ</ci>
                                                                        <apply id="S3.E8.m2.1.1.1.1.1.1.3.cmml"
                                                                            xref="S3.E8.m2.1.1.1.1.1.1.3">
                                                                            <minus id="S3.E8.m2.1.1.1.1.1.1.3.1.cmml"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.1"></minus>
                                                                            <ci id="S3.E8.m2.1.1.1.1.1.1.3.2.cmml"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.2">𝑙</ci>
                                                                            <cn id="S3.E8.m2.1.1.1.1.1.1.3.3.cmml"
                                                                                type="integer"
                                                                                xref="S3.E8.m2.1.1.1.1.1.1.3.3">1</cn>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E8.m2.1c">
                                                            \displaystyle=\text{Encoder-Transformer-Layer}_{l}(h_{l-1})
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E8.m2.1d">=
                                                            Encoder-Transformer-Layer start_POSTSUBSCRIPT italic_l
                                                            end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_l -
                                                            1 end_POSTSUBSCRIPT )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <p class="ltx_p" id="S3.SS2.SSS2.p1.25">where <math
                                        alttext="P\in\mathbb{R}^{n_{p}\times h_{\mathcal{G}}}" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS2.p1.7.m1.1">
                                        <semantics id="S3.SS2.SSS2.p1.7.m1.1a">
                                            <mrow id="S3.SS2.SSS2.p1.7.m1.1.1" xref="S3.SS2.SSS2.p1.7.m1.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.7.m1.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.2.cmml">P</mi>
                                                <mo id="S3.SS2.SSS2.p1.7.m1.1.1.1"
                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.1.cmml">∈</mo>
                                                <msup id="S3.SS2.SSS2.p1.7.m1.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.cmml">
                                                    <mi id="S3.SS2.SSS2.p1.7.m1.1.1.3.2"
                                                        xref="S3.SS2.SSS2.p1.7.m1.1.1.3.2.cmml">ℝ</mi>
                                                    <mrow id="S3.SS2.SSS2.p1.7.m1.1.1.3.3"
                                                        xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.cmml">
                                                        <msub id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2"
                                                            xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.cmml">
                                                            <mi id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.2"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.2.cmml">n</mi>
                                                            <mi id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.3"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.3.cmml">p</mi>
                                                        </msub>
                                                        <mo id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.1" lspace="0.222em"
                                                            rspace="0.222em" xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.1.cmml">×
                                                        </mo>
                                                        <msub id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3"
                                                            xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.cmml">
                                                            <mi id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.2"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.3"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.3.cmml">𝒢</mi>
                                                        </msub>
                                                    </mrow>
                                                </msup>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.7.m1.1b">
                                                <apply id="S3.SS2.SSS2.p1.7.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m1.1.1">
                                                    <in id="S3.SS2.SSS2.p1.7.m1.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.7.m1.1.1.1"></in>
                                                    <ci id="S3.SS2.SSS2.p1.7.m1.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.7.m1.1.1.2">𝑃</ci>
                                                    <apply id="S3.SS2.SSS2.p1.7.m1.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.7.m1.1.1.3">
                                                        <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.7.m1.1.1.3.1.cmml"
                                                            xref="S3.SS2.SSS2.p1.7.m1.1.1.3">superscript</csymbol>
                                                        <ci id="S3.SS2.SSS2.p1.7.m1.1.1.3.2.cmml"
                                                            xref="S3.SS2.SSS2.p1.7.m1.1.1.3.2">ℝ</ci>
                                                        <apply id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.cmml"
                                                            xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3">
                                                            <times id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.1.cmml"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.1"></times>
                                                            <apply id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.cmml"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2">
                                                                <csymbol cd="ambiguous"
                                                                    id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.1.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2">subscript
                                                                </csymbol>
                                                                <ci id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.2.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.2">𝑛</ci>
                                                                <ci id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.3.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.2.3">𝑝</ci>
                                                            </apply>
                                                            <apply id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.cmml"
                                                                xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3">
                                                                <csymbol cd="ambiguous"
                                                                    id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.1.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3">subscript
                                                                </csymbol>
                                                                <ci id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.2.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.2">ℎ</ci>
                                                                <ci id="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.3.cmml"
                                                                    xref="S3.SS2.SSS2.p1.7.m1.1.1.3.3.3.3">𝒢</ci>
                                                            </apply>
                                                        </apply>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m1.1c">
                                                P\in\mathbb{R}^{n_{p}\times h_{\mathcal{G}}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m1.1d">
                                                italic_P ∈ blackboard_R start_POSTSUPERSCRIPT italic_n
                                                start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT × italic_h
                                                start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT end_POSTSUPERSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math> represents <math alttext="n_{p}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.8.m2.1">
                                        <semantics id="S3.SS2.SSS2.p1.8.m2.1a">
                                            <msub id="S3.SS2.SSS2.p1.8.m2.1.1" xref="S3.SS2.SSS2.p1.8.m2.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.8.m2.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.8.m2.1.1.2.cmml">n</mi>
                                                <mi id="S3.SS2.SSS2.p1.8.m2.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.8.m2.1.1.3.cmml">p</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.8.m2.1b">
                                                <apply id="S3.SS2.SSS2.p1.8.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m2.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.8.m2.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.8.m2.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.8.m2.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.8.m2.1.1.2">𝑛</ci>
                                                    <ci id="S3.SS2.SSS2.p1.8.m2.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.8.m2.1.1.3">𝑝</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m2.1c">n_{p}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m2.1d">
                                                italic_n start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> patch representations to be processed by the global model, which is
                                    initialized by pooling together the byte embeddings <math alttext="e_{i}"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.9.m3.1">
                                        <semantics id="S3.SS2.SSS2.p1.9.m3.1a">
                                            <msub id="S3.SS2.SSS2.p1.9.m3.1.1" xref="S3.SS2.SSS2.p1.9.m3.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.9.m3.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.9.m3.1.1.2.cmml">e</mi>
                                                <mi id="S3.SS2.SSS2.p1.9.m3.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.9.m3.1.1.3.cmml">i</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.9.m3.1b">
                                                <apply id="S3.SS2.SSS2.p1.9.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m3.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.9.m3.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.9.m3.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.9.m3.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.9.m3.1.1.2">𝑒</ci>
                                                    <ci id="S3.SS2.SSS2.p1.9.m3.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.9.m3.1.1.3">𝑖</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m3.1c">e_{i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m3.1d">
                                                italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> corresponding to each patch <math alttext="p_{j}" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS2.p1.10.m4.1">
                                        <semantics id="S3.SS2.SSS2.p1.10.m4.1a">
                                            <msub id="S3.SS2.SSS2.p1.10.m4.1.1" xref="S3.SS2.SSS2.p1.10.m4.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.10.m4.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.10.m4.1.1.2.cmml">p</mi>
                                                <mi id="S3.SS2.SSS2.p1.10.m4.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.10.m4.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.10.m4.1b">
                                                <apply id="S3.SS2.SSS2.p1.10.m4.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.10.m4.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.10.m4.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.10.m4.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.10.m4.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.10.m4.1.1.2">𝑝</ci>
                                                    <ci id="S3.SS2.SSS2.p1.10.m4.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.10.m4.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.10.m4.1c">p_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.10.m4.1d">
                                                italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>.
                                    <math alttext="W_{q}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.11.m5.1">
                                        <semantics id="S3.SS2.SSS2.p1.11.m5.1a">
                                            <msub id="S3.SS2.SSS2.p1.11.m5.1.1" xref="S3.SS2.SSS2.p1.11.m5.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.11.m5.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.11.m5.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS2.SSS2.p1.11.m5.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.11.m5.1.1.3.cmml">q</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.11.m5.1b">
                                                <apply id="S3.SS2.SSS2.p1.11.m5.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.11.m5.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.11.m5.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.11.m5.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.11.m5.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.11.m5.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS2.SSS2.p1.11.m5.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.11.m5.1.1.3">𝑞</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.11.m5.1c">W_{q}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.11.m5.1d">
                                                italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, <math alttext="W_{k}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.12.m6.1">
                                        <semantics id="S3.SS2.SSS2.p1.12.m6.1a">
                                            <msub id="S3.SS2.SSS2.p1.12.m6.1.1" xref="S3.SS2.SSS2.p1.12.m6.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.12.m6.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.12.m6.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS2.SSS2.p1.12.m6.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.12.m6.1.1.3.cmml">k</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.12.m6.1b">
                                                <apply id="S3.SS2.SSS2.p1.12.m6.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.12.m6.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.12.m6.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.12.m6.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.12.m6.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.12.m6.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS2.SSS2.p1.12.m6.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.12.m6.1.1.3">𝑘</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.12.m6.1c">W_{k}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.12.m6.1d">
                                                italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>, <math alttext="W_{v}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.13.m7.1">
                                        <semantics id="S3.SS2.SSS2.p1.13.m7.1a">
                                            <msub id="S3.SS2.SSS2.p1.13.m7.1.1" xref="S3.SS2.SSS2.p1.13.m7.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.13.m7.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.13.m7.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS2.SSS2.p1.13.m7.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.13.m7.1.1.3.cmml">v</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.13.m7.1b">
                                                <apply id="S3.SS2.SSS2.p1.13.m7.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.13.m7.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.13.m7.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.13.m7.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.13.m7.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.13.m7.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS2.SSS2.p1.13.m7.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.13.m7.1.1.3">𝑣</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.13.m7.1c">W_{v}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.13.m7.1d">
                                                italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> and <math alttext="W_{o}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.14.m8.1">
                                        <semantics id="S3.SS2.SSS2.p1.14.m8.1a">
                                            <msub id="S3.SS2.SSS2.p1.14.m8.1.1" xref="S3.SS2.SSS2.p1.14.m8.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.14.m8.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.14.m8.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS2.SSS2.p1.14.m8.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.14.m8.1.1.3.cmml">o</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.14.m8.1b">
                                                <apply id="S3.SS2.SSS2.p1.14.m8.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.14.m8.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.14.m8.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.14.m8.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.14.m8.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.14.m8.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS2.SSS2.p1.14.m8.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.14.m8.1.1.3">𝑜</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.14.m8.1c">W_{o}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.14.m8.1d">
                                                italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> are the projections corresponding to the queries, keys, values, and output
                                    where the keys and values are projections of byte representations <math
                                        alttext="h_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.15.m9.1">
                                        <semantics id="S3.SS2.SSS2.p1.15.m9.1a">
                                            <msub id="S3.SS2.SSS2.p1.15.m9.1.1" xref="S3.SS2.SSS2.p1.15.m9.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.15.m9.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.15.m9.1.1.2.cmml">h</mi>
                                                <mi id="S3.SS2.SSS2.p1.15.m9.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.15.m9.1.1.3.cmml">i</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.15.m9.1b">
                                                <apply id="S3.SS2.SSS2.p1.15.m9.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.15.m9.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m9.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.15.m9.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.15.m9.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.15.m9.1.1.2">ℎ</ci>
                                                    <ci id="S3.SS2.SSS2.p1.15.m9.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.15.m9.1.1.3">𝑖</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.15.m9.1c">h_{i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.15.m9.1d">
                                                italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> from the previous layer (<math alttext="e_{i}" class="ltx_Math"
                                        display="inline" id="S3.SS2.SSS2.p1.16.m10.1">
                                        <semantics id="S3.SS2.SSS2.p1.16.m10.1a">
                                            <msub id="S3.SS2.SSS2.p1.16.m10.1.1" xref="S3.SS2.SSS2.p1.16.m10.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.16.m10.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.16.m10.1.1.2.cmml">e</mi>
                                                <mi id="S3.SS2.SSS2.p1.16.m10.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.16.m10.1.1.3.cmml">i</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.16.m10.1b">
                                                <apply id="S3.SS2.SSS2.p1.16.m10.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.16.m10.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m10.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.16.m10.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.16.m10.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.16.m10.1.1.2">𝑒</ci>
                                                    <ci id="S3.SS2.SSS2.p1.16.m10.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.16.m10.1.1.3">𝑖</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.16.m10.1c">e_{i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.16.m10.1d">
                                                italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> for the first layer).
                                    We use a masking strategy specific to patching where each query <math
                                        alttext="Q_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.17.m11.1">
                                        <semantics id="S3.SS2.SSS2.p1.17.m11.1a">
                                            <msub id="S3.SS2.SSS2.p1.17.m11.1.1" xref="S3.SS2.SSS2.p1.17.m11.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.17.m11.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.17.m11.1.1.2.cmml">Q</mi>
                                                <mi id="S3.SS2.SSS2.p1.17.m11.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.17.m11.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.17.m11.1b">
                                                <apply id="S3.SS2.SSS2.p1.17.m11.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.17.m11.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.17.m11.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.17.m11.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.17.m11.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.17.m11.1.1.2">𝑄</ci>
                                                    <ci id="S3.SS2.SSS2.p1.17.m11.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.17.m11.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.17.m11.1c">Q_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.17.m11.1d">
                                                italic_Q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> only attends to the keys and values that correspond to the bytes in patch
                                    <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.18.m12.1">
                                        <semantics id="S3.SS2.SSS2.p1.18.m12.1a">
                                            <mi id="S3.SS2.SSS2.p1.18.m12.1.1" xref="S3.SS2.SSS2.p1.18.m12.1.1.cmml">j
                                            </mi><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.18.m12.1b">
                                                <ci id="S3.SS2.SSS2.p1.18.m12.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.18.m12.1.1">𝑗</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.18.m12.1c">j
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.18.m12.1d">
                                                italic_j</annotation>
                                        </semantics>
                                    </math>. Because we use multi-headed attention over <math alttext="Q,K"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.19.m13.2">
                                        <semantics id="S3.SS2.SSS2.p1.19.m13.2a">
                                            <mrow id="S3.SS2.SSS2.p1.19.m13.2.3.2"
                                                xref="S3.SS2.SSS2.p1.19.m13.2.3.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.19.m13.1.1"
                                                    xref="S3.SS2.SSS2.p1.19.m13.1.1.cmml">Q</mi>
                                                <mo id="S3.SS2.SSS2.p1.19.m13.2.3.2.1"
                                                    xref="S3.SS2.SSS2.p1.19.m13.2.3.1.cmml">,</mo>
                                                <mi id="S3.SS2.SSS2.p1.19.m13.2.2"
                                                    xref="S3.SS2.SSS2.p1.19.m13.2.2.cmml">K</mi>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.19.m13.2b">
                                                <list id="S3.SS2.SSS2.p1.19.m13.2.3.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.19.m13.2.3.2">
                                                    <ci id="S3.SS2.SSS2.p1.19.m13.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.19.m13.1.1">𝑄</ci>
                                                    <ci id="S3.SS2.SSS2.p1.19.m13.2.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.19.m13.2.2">𝐾</ci>
                                                </list>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.19.m13.2c">Q,K
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.19.m13.2d">
                                                italic_Q , italic_K</annotation>
                                        </semantics>
                                    </math> and <math alttext="V" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.20.m14.1">
                                        <semantics id="S3.SS2.SSS2.p1.20.m14.1a">
                                            <mi id="S3.SS2.SSS2.p1.20.m14.1.1" xref="S3.SS2.SSS2.p1.20.m14.1.1.cmml">V
                                            </mi><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.20.m14.1b">
                                                <ci id="S3.SS2.SSS2.p1.20.m14.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.20.m14.1.1">𝑉</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.20.m14.1c">V
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.20.m14.1d">
                                                italic_V</annotation>
                                        </semantics>
                                    </math> and patch representations are typically of larger dimension (<math
                                        alttext="h_{\mathcal{G}}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.21.m15.1">
                                        <semantics id="S3.SS2.SSS2.p1.21.m15.1a">
                                            <msub id="S3.SS2.SSS2.p1.21.m15.1.1" xref="S3.SS2.SSS2.p1.21.m15.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.21.m15.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.21.m15.1.1.2.cmml">h</mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.21.m15.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.21.m15.1.1.3.cmml">𝒢</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.21.m15.1b">
                                                <apply id="S3.SS2.SSS2.p1.21.m15.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.21.m15.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.21.m15.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.21.m15.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.21.m15.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.21.m15.1.1.2">ℎ</ci>
                                                    <ci id="S3.SS2.SSS2.p1.21.m15.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.21.m15.1.1.3">𝒢</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.21.m15.1c">
                                                h_{\mathcal{G}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.21.m15.1d">
                                                italic_h start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math>) than <math alttext="h_{\mathcal{E}}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.22.m16.1">
                                        <semantics id="S3.SS2.SSS2.p1.22.m16.1a">
                                            <msub id="S3.SS2.SSS2.p1.22.m16.1.1" xref="S3.SS2.SSS2.p1.22.m16.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.22.m16.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.22.m16.1.1.2.cmml">h</mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.22.m16.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.22.m16.1.1.3.cmml">ℰ</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.22.m16.1b">
                                                <apply id="S3.SS2.SSS2.p1.22.m16.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.22.m16.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.22.m16.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.22.m16.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.22.m16.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.22.m16.1.1.2">ℎ</ci>
                                                    <ci id="S3.SS2.SSS2.p1.22.m16.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.22.m16.1.1.3">ℰ</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.22.m16.1c">
                                                h_{\mathcal{E}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.22.m16.1d">
                                                italic_h start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math>, we maintain <math alttext="P_{l}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.23.m17.1">
                                        <semantics id="S3.SS2.SSS2.p1.23.m17.1a">
                                            <msub id="S3.SS2.SSS2.p1.23.m17.1.1" xref="S3.SS2.SSS2.p1.23.m17.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.23.m17.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.23.m17.1.1.2.cmml">P</mi>
                                                <mi id="S3.SS2.SSS2.p1.23.m17.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.23.m17.1.1.3.cmml">l</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.23.m17.1b">
                                                <apply id="S3.SS2.SSS2.p1.23.m17.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.23.m17.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.23.m17.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.23.m17.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.23.m17.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.23.m17.1.1.2">𝑃</ci>
                                                    <ci id="S3.SS2.SSS2.p1.23.m17.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.23.m17.1.1.3">𝑙</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.23.m17.1c">P_{l}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.23.m17.1d">
                                                italic_P start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> as multiple heads of dimension <math alttext="h_{\mathcal{E}}"
                                        class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.24.m18.1">
                                        <semantics id="S3.SS2.SSS2.p1.24.m18.1a">
                                            <msub id="S3.SS2.SSS2.p1.24.m18.1.1" xref="S3.SS2.SSS2.p1.24.m18.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.24.m18.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.24.m18.1.1.2.cmml">h</mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.24.m18.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.24.m18.1.1.3.cmml">ℰ</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.24.m18.1b">
                                                <apply id="S3.SS2.SSS2.p1.24.m18.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.24.m18.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.24.m18.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.24.m18.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.24.m18.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.24.m18.1.1.2">ℎ</ci>
                                                    <ci id="S3.SS2.SSS2.p1.24.m18.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.24.m18.1.1.3">ℰ</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.24.m18.1c">
                                                h_{\mathcal{E}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.24.m18.1d">
                                                italic_h start_POSTSUBSCRIPT caligraphic_E end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math> when doing cross-attention, and later, concat these representations into
                                    <math alttext="h_{\mathcal{G}}" class="ltx_Math" display="inline"
                                        id="S3.SS2.SSS2.p1.25.m19.1">
                                        <semantics id="S3.SS2.SSS2.p1.25.m19.1a">
                                            <msub id="S3.SS2.SSS2.p1.25.m19.1.1" xref="S3.SS2.SSS2.p1.25.m19.1.1.cmml">
                                                <mi id="S3.SS2.SSS2.p1.25.m19.1.1.2"
                                                    xref="S3.SS2.SSS2.p1.25.m19.1.1.2.cmml">h</mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.25.m19.1.1.3"
                                                    xref="S3.SS2.SSS2.p1.25.m19.1.1.3.cmml">𝒢</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS2.SSS2.p1.25.m19.1b">
                                                <apply id="S3.SS2.SSS2.p1.25.m19.1.1.cmml"
                                                    xref="S3.SS2.SSS2.p1.25.m19.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.25.m19.1.1.1.cmml"
                                                        xref="S3.SS2.SSS2.p1.25.m19.1.1">subscript</csymbol>
                                                    <ci id="S3.SS2.SSS2.p1.25.m19.1.1.2.cmml"
                                                        xref="S3.SS2.SSS2.p1.25.m19.1.1.2">ℎ</ci>
                                                    <ci id="S3.SS2.SSS2.p1.25.m19.1.1.3.cmml"
                                                        xref="S3.SS2.SSS2.p1.25.m19.1.1.3">𝒢</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.25.m19.1c">
                                                h_{\mathcal{G}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.25.m19.1d">
                                                italic_h start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math> dimensions.
                                    Additionally, we use a pre-LayerNorm on the queries, keys and values and no
                                    positional embeddings are used in this cross-attention module.
                                    Finally, we use a residual connection around the cross-attention block.
                                </p>
                            </div>
                        </section>
                    </section>
                    <section class="ltx_subsection" id="S3.SS3">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">3.3 </span>Local Decoder
                        </h3>
                        <div class="ltx_para" id="S3.SS3.p1">
                            <p class="ltx_p" id="S3.SS3.p1.5">Similar to the local encoder, the local decoder <math
                                    alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1">
                                    <semantics id="S3.SS3.p1.1.m1.1a">
                                        <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1"
                                            xref="S3.SS3.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml
                                            encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b">
                                            <ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝒟</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{D}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">
                                            caligraphic_D</annotation>
                                    </semantics>
                                </math> is a lightweight transformer-based model with <math
                                    alttext="l_{\mathcal{D}}&lt;&lt;l_{\mathcal{G}}" class="ltx_Math" display="inline"
                                    id="S3.SS3.p1.2.m2.1">
                                    <semantics id="S3.SS3.p1.2.m2.1a">
                                        <mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">
                                            <msub id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">
                                                <mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">l
                                                </mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1.2.3"
                                                    xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">𝒟</mi>
                                            </msub>
                                            <mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">&lt;&lt;</mo>
                                            <msub id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">
                                                <mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">l
                                                </mi>
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1.3.3"
                                                    xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">𝒢</mi>
                                            </msub>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b">
                                            <apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">
                                                <csymbol cd="latexml" id="S3.SS3.p1.2.m2.1.1.1.cmml"
                                                    xref="S3.SS3.p1.2.m2.1.1.1">much-less-than</csymbol>
                                                <apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">
                                                    <csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml"
                                                        xref="S3.SS3.p1.2.m2.1.1.2">subscript</csymbol>
                                                    <ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">
                                                        𝑙</ci>
                                                    <ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">
                                                        𝒟</ci>
                                                </apply>
                                                <apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">
                                                    <csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.3.1.cmml"
                                                        xref="S3.SS3.p1.2.m2.1.1.3">subscript</csymbol>
                                                    <ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">
                                                        𝑙</ci>
                                                    <ci id="S3.SS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3">
                                                        𝒢</ci>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">
                                            l_{\mathcal{D}}&lt;&lt;l_{\mathcal{G}}</annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_l
                                            start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT &lt; &lt; italic_l
                                            start_POSTSUBSCRIPT caligraphic_G end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> layers, that decodes a sequence of global patch representations <math
                                    alttext="o_{j}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1">
                                    <semantics id="S3.SS3.p1.3.m3.1a">
                                        <msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">
                                            <mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">o</mi>
                                            <mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">j</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b">
                                            <apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml"
                                                    xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol>
                                                <ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑜</ci>
                                                <ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑗</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">o_{j}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_o
                                            start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>, into raw bytes, <math alttext="y_{i}" class="ltx_Math" display="inline"
                                    id="S3.SS3.p1.4.m4.1">
                                    <semantics id="S3.SS3.p1.4.m4.1a">
                                        <msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">
                                            <mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">y</mi>
                                            <mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">i</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b">
                                            <apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml"
                                                    xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol>
                                                <ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑦</ci>
                                                <ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑖</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">y_{i}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_y
                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math>. The local decoder predicts a sequence of raw bytes, as a function of previously
                                decoded bytes, and thus, takes as input the hidden representations produced by the local
                                encoder for the byte-sequence.
                                It applies a series of <math alttext="l_{\mathcal{D}}" class="ltx_Math" display="inline"
                                    id="S3.SS3.p1.5.m5.1">
                                    <semantics id="S3.SS3.p1.5.m5.1a">
                                        <msub id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">
                                            <mi id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">l</mi>
                                            <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1.3"
                                                xref="S3.SS3.p1.5.m5.1.1.3.cmml">𝒟</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b">
                                            <apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">
                                                <csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml"
                                                    xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol>
                                                <ci id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2">𝑙</ci>
                                                <ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝒟</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">l_{\mathcal{D}}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_l
                                            start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> alternating layers of cross attention and transformer layers. The
                                cross-attention layer in the decoder is applied before the transformer layer to first
                                create byte representations from the patch representations, and the local decoder
                                transformer layer operates on the resulting byte sequence.</p>
                        </div>
                        <section class="ltx_subsubsection" id="S3.SS3.SSS1">
                            <h4 class="ltx_title ltx_title_subsubsection">
                                <span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Decoder Multi-headed
                                Cross-Attention
                            </h4>
                            <div class="ltx_para" id="S3.SS3.SSS1.p1">
                                <p class="ltx_p" id="S3.SS3.SSS1.p1.3">In the decoder cross-attention, the roles of the
                                    queries and key/values are interchanged i.e. the byte-representations are now the
                                    queries, and the patch representations are now the key/values. The initial
                                    byte-representations for the cross-attention are initialized as the byte embeddings
                                    from the last encoder layer i.e. <math alttext="h_{l_{\mathcal{E}}}"
                                        class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1">
                                        <semantics id="S3.SS3.SSS1.p1.1.m1.1a">
                                            <msub id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p1.1.m1.1.1.2"
                                                    xref="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml">h</mi>
                                                <msub id="S3.SS3.SSS1.p1.1.m1.1.1.3"
                                                    xref="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml">
                                                    <mi id="S3.SS3.SSS1.p1.1.m1.1.1.3.2"
                                                        xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml">l</mi>
                                                    <mi class="ltx_font_mathcaligraphic"
                                                        id="S3.SS3.SSS1.p1.1.m1.1.1.3.3"
                                                        xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml">ℰ</mi>
                                                </msub>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p1.1.m1.1b">
                                                <apply id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p1.1.m1.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p1.1.m1.1.1.2">ℎ</ci>
                                                    <apply id="S3.SS3.SSS1.p1.1.m1.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p1.1.m1.1.1.3">
                                                        <csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.1.m1.1.1.3.1.cmml"
                                                            xref="S3.SS3.SSS1.p1.1.m1.1.1.3">subscript</csymbol>
                                                        <ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.2.cmml"
                                                            xref="S3.SS3.SSS1.p1.1.m1.1.1.3.2">𝑙</ci>
                                                        <ci id="S3.SS3.SSS1.p1.1.m1.1.1.3.3.cmml"
                                                            xref="S3.SS3.SSS1.p1.1.m1.1.1.3.3">ℰ</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">
                                                h_{l_{\mathcal{E}}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">
                                                italic_h start_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT caligraphic_E
                                                end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math>. The subsequent byte-representations for layer <math alttext="l"
                                        class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.2.m2.1">
                                        <semantics id="S3.SS3.SSS1.p1.2.m2.1a">
                                            <mi id="S3.SS3.SSS1.p1.2.m2.1.1" xref="S3.SS3.SSS1.p1.2.m2.1.1.cmml">l</mi>
                                            <annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m2.1b">
                                                <ci id="S3.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m2.1.1">𝑙
                                                </ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m2.1c">l
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.2.m2.1d">
                                                italic_l</annotation>
                                        </semantics>
                                    </math>, <math alttext="d_{l,i}" class="ltx_Math" display="inline"
                                        id="S3.SS3.SSS1.p1.3.m3.2">
                                        <semantics id="S3.SS3.SSS1.p1.3.m3.2a">
                                            <msub id="S3.SS3.SSS1.p1.3.m3.2.3" xref="S3.SS3.SSS1.p1.3.m3.2.3.cmml">
                                                <mi id="S3.SS3.SSS1.p1.3.m3.2.3.2"
                                                    xref="S3.SS3.SSS1.p1.3.m3.2.3.2.cmml">d</mi>
                                                <mrow id="S3.SS3.SSS1.p1.3.m3.2.2.2.4"
                                                    xref="S3.SS3.SSS1.p1.3.m3.2.2.2.3.cmml">
                                                    <mi id="S3.SS3.SSS1.p1.3.m3.1.1.1.1"
                                                        xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1.cmml">l</mi>
                                                    <mo id="S3.SS3.SSS1.p1.3.m3.2.2.2.4.1"
                                                        xref="S3.SS3.SSS1.p1.3.m3.2.2.2.3.cmml">,</mo>
                                                    <mi id="S3.SS3.SSS1.p1.3.m3.2.2.2.2"
                                                        xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2.cmml">i</mi>
                                                </mrow>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p1.3.m3.2b">
                                                <apply id="S3.SS3.SSS1.p1.3.m3.2.3.cmml" xref="S3.SS3.SSS1.p1.3.m3.2.3">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.3.m3.2.3.1.cmml"
                                                        xref="S3.SS3.SSS1.p1.3.m3.2.3">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p1.3.m3.2.3.2.cmml"
                                                        xref="S3.SS3.SSS1.p1.3.m3.2.3.2">𝑑</ci>
                                                    <list id="S3.SS3.SSS1.p1.3.m3.2.2.2.3.cmml"
                                                        xref="S3.SS3.SSS1.p1.3.m3.2.2.2.4">
                                                        <ci id="S3.SS3.SSS1.p1.3.m3.1.1.1.1.cmml"
                                                            xref="S3.SS3.SSS1.p1.3.m3.1.1.1.1">𝑙</ci>
                                                        <ci id="S3.SS3.SSS1.p1.3.m3.2.2.2.2.cmml"
                                                            xref="S3.SS3.SSS1.p1.3.m3.2.2.2.2">𝑖</ci>
                                                    </list>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m3.2c">d_{l,i}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.3.m3.2d">
                                                italic_d start_POSTSUBSCRIPT italic_l , italic_i end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math> are computed as:</p>
                            </div>
                            <div class="ltx_para" id="S3.SS3.SSS1.p2">
                                <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx5">
                                    <tbody id="S3.E9">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle D_{0}" class="ltx_Math" display="inline"
                                                    id="S3.E9.m1.1">
                                                    <semantics id="S3.E9.m1.1a">
                                                        <msub id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">
                                                            <mi id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">D</mi>
                                                            <mn id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml">0</mn>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E9.m1.1b">
                                                            <apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.cmml"
                                                                    xref="S3.E9.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2">𝐷
                                                                </ci>
                                                                <cn id="S3.E9.m1.1.1.3.cmml" type="integer"
                                                                    xref="S3.E9.m1.1.1.3">0</cn>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E9.m1.1c">
                                                            \displaystyle D_{0}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">
                                                            italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=h_{l_{\mathcal{E}}}" class="ltx_Math"
                                                    display="inline" id="S3.E9.m2.1">
                                                    <semantics id="S3.E9.m2.1a">
                                                        <mrow id="S3.E9.m2.1.1" xref="S3.E9.m2.1.1.cmml">
                                                            <mi id="S3.E9.m2.1.1.2" xref="S3.E9.m2.1.1.2.cmml"></mi>
                                                            <mo id="S3.E9.m2.1.1.1" xref="S3.E9.m2.1.1.1.cmml">=</mo>
                                                            <msub id="S3.E9.m2.1.1.3" xref="S3.E9.m2.1.1.3.cmml">
                                                                <mi id="S3.E9.m2.1.1.3.2" xref="S3.E9.m2.1.1.3.2.cmml">h
                                                                </mi>
                                                                <msub id="S3.E9.m2.1.1.3.3"
                                                                    xref="S3.E9.m2.1.1.3.3.cmml">
                                                                    <mi id="S3.E9.m2.1.1.3.3.2"
                                                                        xref="S3.E9.m2.1.1.3.3.2.cmml">l</mi>
                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                        id="S3.E9.m2.1.1.3.3.3"
                                                                        xref="S3.E9.m2.1.1.3.3.3.cmml">ℰ</mi>
                                                                </msub>
                                                            </msub>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E9.m2.1b">
                                                            <apply id="S3.E9.m2.1.1.cmml" xref="S3.E9.m2.1.1">
                                                                <eq id="S3.E9.m2.1.1.1.cmml" xref="S3.E9.m2.1.1.1"></eq>
                                                                <csymbol cd="latexml" id="S3.E9.m2.1.1.2.cmml"
                                                                    xref="S3.E9.m2.1.1.2">absent</csymbol>
                                                                <apply id="S3.E9.m2.1.1.3.cmml" xref="S3.E9.m2.1.1.3">
                                                                    <csymbol cd="ambiguous" id="S3.E9.m2.1.1.3.1.cmml"
                                                                        xref="S3.E9.m2.1.1.3">subscript</csymbol>
                                                                    <ci id="S3.E9.m2.1.1.3.2.cmml"
                                                                        xref="S3.E9.m2.1.1.3.2">ℎ</ci>
                                                                    <apply id="S3.E9.m2.1.1.3.3.cmml"
                                                                        xref="S3.E9.m2.1.1.3.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E9.m2.1.1.3.3.1.cmml"
                                                                            xref="S3.E9.m2.1.1.3.3">subscript</csymbol>
                                                                        <ci id="S3.E9.m2.1.1.3.3.2.cmml"
                                                                            xref="S3.E9.m2.1.1.3.3.2">𝑙</ci>
                                                                        <ci id="S3.E9.m2.1.1.3.3.3.cmml"
                                                                            xref="S3.E9.m2.1.1.3.3.3">ℰ</ci>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E9.m2.1c">
                                                            \displaystyle=h_{l_{\mathcal{E}}}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E9.m2.1d">=
                                                            italic_h start_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT
                                                            caligraphic_E end_POSTSUBSCRIPT end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E10">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle B_{l}" class="ltx_Math" display="inline"
                                                    id="S3.E10.m1.1">
                                                    <semantics id="S3.E10.m1.1a">
                                                        <msub id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">
                                                            <mi id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">B</mi>
                                                            <mi id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml">l</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E10.m1.1b">
                                                            <apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.cmml"
                                                                    xref="S3.E10.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2">𝐵
                                                                </ci>
                                                                <ci id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3">𝑙
                                                                </ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E10.m1.1c">
                                                            \displaystyle B_{l}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">
                                                            italic_B start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=D_{l-1}+W_{o}\left(\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}%
}}\right)V\right)," class="ltx_Math" display="inline" id="S3.E10.m2.2">
                                                    <semantics id="S3.E10.m2.2a">
                                                        <mrow id="S3.E10.m2.2.2.1" xref="S3.E10.m2.2.2.1.1.cmml">
                                                            <mrow id="S3.E10.m2.2.2.1.1" xref="S3.E10.m2.2.2.1.1.cmml">
                                                                <mi id="S3.E10.m2.2.2.1.1.3"
                                                                    xref="S3.E10.m2.2.2.1.1.3.cmml"></mi>
                                                                <mo id="S3.E10.m2.2.2.1.1.2"
                                                                    xref="S3.E10.m2.2.2.1.1.2.cmml">=</mo>
                                                                <mrow id="S3.E10.m2.2.2.1.1.1"
                                                                    xref="S3.E10.m2.2.2.1.1.1.cmml">
                                                                    <msub id="S3.E10.m2.2.2.1.1.1.3"
                                                                        xref="S3.E10.m2.2.2.1.1.1.3.cmml">
                                                                        <mi id="S3.E10.m2.2.2.1.1.1.3.2"
                                                                            xref="S3.E10.m2.2.2.1.1.1.3.2.cmml">D</mi>
                                                                        <mrow id="S3.E10.m2.2.2.1.1.1.3.3"
                                                                            xref="S3.E10.m2.2.2.1.1.1.3.3.cmml">
                                                                            <mi id="S3.E10.m2.2.2.1.1.1.3.3.2"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.2.cmml">l
                                                                            </mi>
                                                                            <mo id="S3.E10.m2.2.2.1.1.1.3.3.1"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.1.cmml">−
                                                                            </mo>
                                                                            <mn id="S3.E10.m2.2.2.1.1.1.3.3.3"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.3.cmml">1
                                                                            </mn>
                                                                        </mrow>
                                                                    </msub>
                                                                    <mo id="S3.E10.m2.2.2.1.1.1.2"
                                                                        xref="S3.E10.m2.2.2.1.1.1.2.cmml">+</mo>
                                                                    <mrow id="S3.E10.m2.2.2.1.1.1.1"
                                                                        xref="S3.E10.m2.2.2.1.1.1.1.cmml">
                                                                        <msub id="S3.E10.m2.2.2.1.1.1.1.3"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.3.cmml">
                                                                            <mi id="S3.E10.m2.2.2.1.1.1.1.3.2"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.3.2.cmml">W
                                                                            </mi>
                                                                            <mi id="S3.E10.m2.2.2.1.1.1.1.3.3"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.3.3.cmml">o
                                                                            </mi>
                                                                        </msub>
                                                                        <mo id="S3.E10.m2.2.2.1.1.1.1.2"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E10.m2.2.2.1.1.1.1.1.1"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.cmml">
                                                                            <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.2"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                (</mo>
                                                                            <mrow id="S3.E10.m2.2.2.1.1.1.1.1.1.1"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                <mtext
                                                                                    id="S3.E10.m2.2.2.1.1.1.1.1.1.1.2"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.2a.cmml">
                                                                                    softmax</mtext>
                                                                                <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.1.1"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.1.cmml">
                                                                                    ⁢</mo>
                                                                                <mrow
                                                                                    id="S3.E10.m2.2.2.1.1.1.1.1.1.1.3.2"
                                                                                    xref="S3.E10.m2.1.1.cmml">
                                                                                    <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.1.3.2.1"
                                                                                        xref="S3.E10.m2.1.1.cmml">(</mo>
                                                                                    <mstyle displaystyle="true"
                                                                                        id="S3.E10.m2.1.1"
                                                                                        xref="S3.E10.m2.1.1.cmml">
                                                                                        <mfrac id="S3.E10.m2.1.1a"
                                                                                            xref="S3.E10.m2.1.1.cmml">
                                                                                            <mrow id="S3.E10.m2.1.1.2"
                                                                                                xref="S3.E10.m2.1.1.2.cmml">
                                                                                                <mi id="S3.E10.m2.1.1.2.2"
                                                                                                    xref="S3.E10.m2.1.1.2.2.cmml">
                                                                                                    Q</mi>
                                                                                                <mo id="S3.E10.m2.1.1.2.1"
                                                                                                    xref="S3.E10.m2.1.1.2.1.cmml">
                                                                                                    ⁢</mo>
                                                                                                <msup
                                                                                                    id="S3.E10.m2.1.1.2.3"
                                                                                                    xref="S3.E10.m2.1.1.2.3.cmml">
                                                                                                    <mi id="S3.E10.m2.1.1.2.3.2"
                                                                                                        xref="S3.E10.m2.1.1.2.3.2.cmml">
                                                                                                        K</mi>
                                                                                                    <mi id="S3.E10.m2.1.1.2.3.3"
                                                                                                        xref="S3.E10.m2.1.1.2.3.3.cmml">
                                                                                                        T</mi>
                                                                                                </msup>
                                                                                            </mrow>
                                                                                            <msqrt id="S3.E10.m2.1.1.3"
                                                                                                xref="S3.E10.m2.1.1.3.cmml">
                                                                                                <msub
                                                                                                    id="S3.E10.m2.1.1.3.2"
                                                                                                    xref="S3.E10.m2.1.1.3.2.cmml">
                                                                                                    <mi id="S3.E10.m2.1.1.3.2.2"
                                                                                                        xref="S3.E10.m2.1.1.3.2.2.cmml">
                                                                                                        d</mi>
                                                                                                    <mi id="S3.E10.m2.1.1.3.2.3"
                                                                                                        xref="S3.E10.m2.1.1.3.2.3.cmml">
                                                                                                        k</mi>
                                                                                                </msub>
                                                                                            </msqrt>
                                                                                        </mfrac>
                                                                                    </mstyle>
                                                                                    <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.1.3.2.2"
                                                                                        xref="S3.E10.m2.1.1.cmml">)</mo>
                                                                                </mrow>
                                                                                <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.1.1a"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.1.cmml">
                                                                                    ⁢</mo>
                                                                                <mi id="S3.E10.m2.2.2.1.1.1.1.1.1.1.4"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.4.cmml">
                                                                                    V</mi>
                                                                            </mrow>
                                                                            <mo id="S3.E10.m2.2.2.1.1.1.1.1.1.3"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                )</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                            <mo id="S3.E10.m2.2.2.1.2" xref="S3.E10.m2.2.2.1.1.cmml">,
                                                            </mo>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E10.m2.2b">
                                                            <apply id="S3.E10.m2.2.2.1.1.cmml" xref="S3.E10.m2.2.2.1">
                                                                <eq id="S3.E10.m2.2.2.1.1.2.cmml"
                                                                    xref="S3.E10.m2.2.2.1.1.2"></eq>
                                                                <csymbol cd="latexml" id="S3.E10.m2.2.2.1.1.3.cmml"
                                                                    xref="S3.E10.m2.2.2.1.1.3">absent</csymbol>
                                                                <apply id="S3.E10.m2.2.2.1.1.1.cmml"
                                                                    xref="S3.E10.m2.2.2.1.1.1">
                                                                    <plus id="S3.E10.m2.2.2.1.1.1.2.cmml"
                                                                        xref="S3.E10.m2.2.2.1.1.1.2"></plus>
                                                                    <apply id="S3.E10.m2.2.2.1.1.1.3.cmml"
                                                                        xref="S3.E10.m2.2.2.1.1.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E10.m2.2.2.1.1.1.3.1.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.3">subscript
                                                                        </csymbol>
                                                                        <ci id="S3.E10.m2.2.2.1.1.1.3.2.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.3.2">𝐷</ci>
                                                                        <apply id="S3.E10.m2.2.2.1.1.1.3.3.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.3.3">
                                                                            <minus id="S3.E10.m2.2.2.1.1.1.3.3.1.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.1">
                                                                            </minus>
                                                                            <ci id="S3.E10.m2.2.2.1.1.1.3.3.2.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.2">𝑙</ci>
                                                                            <cn id="S3.E10.m2.2.2.1.1.1.3.3.3.cmml"
                                                                                type="integer"
                                                                                xref="S3.E10.m2.2.2.1.1.1.3.3.3">1</cn>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E10.m2.2.2.1.1.1.1.cmml"
                                                                        xref="S3.E10.m2.2.2.1.1.1.1">
                                                                        <times id="S3.E10.m2.2.2.1.1.1.1.2.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.2"></times>
                                                                        <apply id="S3.E10.m2.2.2.1.1.1.1.3.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E10.m2.2.2.1.1.1.1.3.1.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E10.m2.2.2.1.1.1.1.3.2.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.3.2">𝑊</ci>
                                                                            <ci id="S3.E10.m2.2.2.1.1.1.1.3.3.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.3.3">𝑜</ci>
                                                                        </apply>
                                                                        <apply id="S3.E10.m2.2.2.1.1.1.1.1.1.1.cmml"
                                                                            xref="S3.E10.m2.2.2.1.1.1.1.1.1">
                                                                            <times
                                                                                id="S3.E10.m2.2.2.1.1.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.1">
                                                                            </times>
                                                                            <ci id="S3.E10.m2.2.2.1.1.1.1.1.1.1.2a.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.2">
                                                                                <mtext
                                                                                    id="S3.E10.m2.2.2.1.1.1.1.1.1.1.2.cmml"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.2">
                                                                                    softmax</mtext>
                                                                            </ci>
                                                                            <apply id="S3.E10.m2.1.1.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.3.2">
                                                                                <divide id="S3.E10.m2.1.1.1.cmml"
                                                                                    xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.3.2">
                                                                                </divide>
                                                                                <apply id="S3.E10.m2.1.1.2.cmml"
                                                                                    xref="S3.E10.m2.1.1.2">
                                                                                    <times id="S3.E10.m2.1.1.2.1.cmml"
                                                                                        xref="S3.E10.m2.1.1.2.1">
                                                                                    </times>
                                                                                    <ci id="S3.E10.m2.1.1.2.2.cmml"
                                                                                        xref="S3.E10.m2.1.1.2.2">𝑄</ci>
                                                                                    <apply id="S3.E10.m2.1.1.2.3.cmml"
                                                                                        xref="S3.E10.m2.1.1.2.3">
                                                                                        <csymbol cd="ambiguous"
                                                                                            id="S3.E10.m2.1.1.2.3.1.cmml"
                                                                                            xref="S3.E10.m2.1.1.2.3">
                                                                                            superscript</csymbol>
                                                                                        <ci id="S3.E10.m2.1.1.2.3.2.cmml"
                                                                                            xref="S3.E10.m2.1.1.2.3.2">
                                                                                            𝐾</ci>
                                                                                        <ci id="S3.E10.m2.1.1.2.3.3.cmml"
                                                                                            xref="S3.E10.m2.1.1.2.3.3">
                                                                                            𝑇</ci>
                                                                                    </apply>
                                                                                </apply>
                                                                                <apply id="S3.E10.m2.1.1.3.cmml"
                                                                                    xref="S3.E10.m2.1.1.3">
                                                                                    <root id="S3.E10.m2.1.1.3a.cmml"
                                                                                        xref="S3.E10.m2.1.1.3"></root>
                                                                                    <apply id="S3.E10.m2.1.1.3.2.cmml"
                                                                                        xref="S3.E10.m2.1.1.3.2">
                                                                                        <csymbol cd="ambiguous"
                                                                                            id="S3.E10.m2.1.1.3.2.1.cmml"
                                                                                            xref="S3.E10.m2.1.1.3.2">
                                                                                            subscript</csymbol>
                                                                                        <ci id="S3.E10.m2.1.1.3.2.2.cmml"
                                                                                            xref="S3.E10.m2.1.1.3.2.2">
                                                                                            𝑑</ci>
                                                                                        <ci id="S3.E10.m2.1.1.3.2.3.cmml"
                                                                                            xref="S3.E10.m2.1.1.3.2.3">
                                                                                            𝑘</ci>
                                                                                    </apply>
                                                                                </apply>
                                                                            </apply>
                                                                            <ci id="S3.E10.m2.2.2.1.1.1.1.1.1.1.4.cmml"
                                                                                xref="S3.E10.m2.2.2.1.1.1.1.1.1.1.4">𝑉
                                                                            </ci>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E10.m2.2c">
                                                            \displaystyle=D_{l-1}+W_{o}\left(\text{softmax}\left(\frac{QK^{T}}{\sqrt{d_{k}%
                                                            }}\right)V\right),</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E10.m2.2d">
                                                            = italic_D start_POSTSUBSCRIPT italic_l - 1
                                                            end_POSTSUBSCRIPT + italic_W start_POSTSUBSCRIPT italic_o
                                                            end_POSTSUBSCRIPT ( softmax ( divide start_ARG italic_Q
                                                            italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT
                                                            end_ARG start_ARG square-root start_ARG italic_d
                                                            start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG
                                                            end_ARG ) italic_V ) ,</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E11">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_eqn_cell"></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\text{where }Q_{i}=W_{q}(d_{l-1,i}),K_{i}=W_{k}(\mathcal{D}_{C}(o%
_{j})),V_{i}=W_{v}(\mathcal{D}_{C}(o_{j}))" class="ltx_Math" display="inline" id="S3.E11.m1.4">
                                                    <semantics id="S3.E11.m1.4a">
                                                        <mrow id="S3.E11.m1.4.4.2" xref="S3.E11.m1.4.4.3.cmml">
                                                            <mrow id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml">
                                                                <mrow id="S3.E11.m1.3.3.1.1.3"
                                                                    xref="S3.E11.m1.3.3.1.1.3.cmml">
                                                                    <mtext id="S3.E11.m1.3.3.1.1.3.2"
                                                                        xref="S3.E11.m1.3.3.1.1.3.2a.cmml">where
                                                                    </mtext>
                                                                    <mo id="S3.E11.m1.3.3.1.1.3.1"
                                                                        xref="S3.E11.m1.3.3.1.1.3.1.cmml">⁢</mo>
                                                                    <msub id="S3.E11.m1.3.3.1.1.3.3"
                                                                        xref="S3.E11.m1.3.3.1.1.3.3.cmml">
                                                                        <mi id="S3.E11.m1.3.3.1.1.3.3.2"
                                                                            xref="S3.E11.m1.3.3.1.1.3.3.2.cmml">Q</mi>
                                                                        <mi id="S3.E11.m1.3.3.1.1.3.3.3"
                                                                            xref="S3.E11.m1.3.3.1.1.3.3.3.cmml">i</mi>
                                                                    </msub>
                                                                </mrow>
                                                                <mo id="S3.E11.m1.3.3.1.1.2"
                                                                    xref="S3.E11.m1.3.3.1.1.2.cmml">=</mo>
                                                                <mrow id="S3.E11.m1.3.3.1.1.1"
                                                                    xref="S3.E11.m1.3.3.1.1.1.cmml">
                                                                    <msub id="S3.E11.m1.3.3.1.1.1.3"
                                                                        xref="S3.E11.m1.3.3.1.1.1.3.cmml">
                                                                        <mi id="S3.E11.m1.3.3.1.1.1.3.2"
                                                                            xref="S3.E11.m1.3.3.1.1.1.3.2.cmml">W</mi>
                                                                        <mi id="S3.E11.m1.3.3.1.1.1.3.3"
                                                                            xref="S3.E11.m1.3.3.1.1.1.3.3.cmml">q</mi>
                                                                    </msub>
                                                                    <mo id="S3.E11.m1.3.3.1.1.1.2"
                                                                        xref="S3.E11.m1.3.3.1.1.1.2.cmml">⁢</mo>
                                                                    <mrow id="S3.E11.m1.3.3.1.1.1.1.1"
                                                                        xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">
                                                                        <mo id="S3.E11.m1.3.3.1.1.1.1.1.2"
                                                                            stretchy="false"
                                                                            xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">(</mo>
                                                                        <msub id="S3.E11.m1.3.3.1.1.1.1.1.1"
                                                                            xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">
                                                                            <mi id="S3.E11.m1.3.3.1.1.1.1.1.1.2"
                                                                                xref="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml">
                                                                                d</mi>
                                                                            <mrow id="S3.E11.m1.2.2.2.2"
                                                                                xref="S3.E11.m1.2.2.2.3.cmml">
                                                                                <mrow id="S3.E11.m1.2.2.2.2.1"
                                                                                    xref="S3.E11.m1.2.2.2.2.1.cmml">
                                                                                    <mi id="S3.E11.m1.2.2.2.2.1.2"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.2.cmml">
                                                                                        l</mi>
                                                                                    <mo id="S3.E11.m1.2.2.2.2.1.1"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.1.cmml">
                                                                                        −</mo>
                                                                                    <mn id="S3.E11.m1.2.2.2.2.1.3"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.3.cmml">
                                                                                        1</mn>
                                                                                </mrow>
                                                                                <mo id="S3.E11.m1.2.2.2.2.2"
                                                                                    xref="S3.E11.m1.2.2.2.3.cmml">,</mo>
                                                                                <mi id="S3.E11.m1.1.1.1.1"
                                                                                    xref="S3.E11.m1.1.1.1.1.cmml">i</mi>
                                                                            </mrow>
                                                                        </msub>
                                                                        <mo id="S3.E11.m1.3.3.1.1.1.1.1.3"
                                                                            stretchy="false"
                                                                            xref="S3.E11.m1.3.3.1.1.1.1.1.1.cmml">)</mo>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                            <mo id="S3.E11.m1.4.4.2.3" xref="S3.E11.m1.4.4.3a.cmml">,
                                                            </mo>
                                                            <mrow id="S3.E11.m1.4.4.2.2.2"
                                                                xref="S3.E11.m1.4.4.2.2.3.cmml">
                                                                <mrow id="S3.E11.m1.4.4.2.2.1.1"
                                                                    xref="S3.E11.m1.4.4.2.2.1.1.cmml">
                                                                    <msub id="S3.E11.m1.4.4.2.2.1.1.3"
                                                                        xref="S3.E11.m1.4.4.2.2.1.1.3.cmml">
                                                                        <mi id="S3.E11.m1.4.4.2.2.1.1.3.2"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.3.2.cmml">K</mi>
                                                                        <mi id="S3.E11.m1.4.4.2.2.1.1.3.3"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.3.3.cmml">i</mi>
                                                                    </msub>
                                                                    <mo id="S3.E11.m1.4.4.2.2.1.1.2"
                                                                        xref="S3.E11.m1.4.4.2.2.1.1.2.cmml">=</mo>
                                                                    <mrow id="S3.E11.m1.4.4.2.2.1.1.1"
                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.cmml">
                                                                        <msub id="S3.E11.m1.4.4.2.2.1.1.1.3"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1.3.cmml">
                                                                            <mi id="S3.E11.m1.4.4.2.2.1.1.1.3.2"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.3.2.cmml">
                                                                                W</mi>
                                                                            <mi id="S3.E11.m1.4.4.2.2.1.1.1.3.3"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.3.3.cmml">
                                                                                k</mi>
                                                                        </msub>
                                                                        <mo id="S3.E11.m1.4.4.2.2.1.1.1.2"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E11.m1.4.4.2.2.1.1.1.1.1"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml">
                                                                            <mo id="S3.E11.m1.4.4.2.2.1.1.1.1.1.2"
                                                                                stretchy="false"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml">
                                                                                (</mo>
                                                                            <mrow id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml">
                                                                                <msub
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.cmml">
                                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                                        id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.2"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.2.cmml">
                                                                                        𝒟</mi>
                                                                                    <mi id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.3"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.3.cmml">
                                                                                        C</mi>
                                                                                </msub>
                                                                                <mo id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.2"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.2.cmml">
                                                                                    ⁢</mo>
                                                                                <mrow
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml">
                                                                                    <mo id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.2"
                                                                                        stretchy="false"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        (</mo>
                                                                                    <msub
                                                                                        id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        <mi id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.2"
                                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.2.cmml">
                                                                                            o</mi>
                                                                                        <mi id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.3"
                                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.3.cmml">
                                                                                            j</mi>
                                                                                    </msub>
                                                                                    <mo id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.3"
                                                                                        stretchy="false"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml">
                                                                                        )</mo>
                                                                                </mrow>
                                                                            </mrow>
                                                                            <mo id="S3.E11.m1.4.4.2.2.1.1.1.1.1.3"
                                                                                stretchy="false"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml">
                                                                                )</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                                <mo id="S3.E11.m1.4.4.2.2.2.3"
                                                                    xref="S3.E11.m1.4.4.2.2.3a.cmml">,</mo>
                                                                <mrow id="S3.E11.m1.4.4.2.2.2.2"
                                                                    xref="S3.E11.m1.4.4.2.2.2.2.cmml">
                                                                    <msub id="S3.E11.m1.4.4.2.2.2.2.3"
                                                                        xref="S3.E11.m1.4.4.2.2.2.2.3.cmml">
                                                                        <mi id="S3.E11.m1.4.4.2.2.2.2.3.2"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.3.2.cmml">V</mi>
                                                                        <mi id="S3.E11.m1.4.4.2.2.2.2.3.3"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.3.3.cmml">i</mi>
                                                                    </msub>
                                                                    <mo id="S3.E11.m1.4.4.2.2.2.2.2"
                                                                        xref="S3.E11.m1.4.4.2.2.2.2.2.cmml">=</mo>
                                                                    <mrow id="S3.E11.m1.4.4.2.2.2.2.1"
                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.cmml">
                                                                        <msub id="S3.E11.m1.4.4.2.2.2.2.1.3"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1.3.cmml">
                                                                            <mi id="S3.E11.m1.4.4.2.2.2.2.1.3.2"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.3.2.cmml">
                                                                                W</mi>
                                                                            <mi id="S3.E11.m1.4.4.2.2.2.2.1.3.3"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.3.3.cmml">
                                                                                v</mi>
                                                                        </msub>
                                                                        <mo id="S3.E11.m1.4.4.2.2.2.2.1.2"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1.2.cmml">⁢</mo>
                                                                        <mrow id="S3.E11.m1.4.4.2.2.2.2.1.1.1"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.cmml">
                                                                            <mo id="S3.E11.m1.4.4.2.2.2.2.1.1.1.2"
                                                                                stretchy="false"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.cmml">
                                                                                (</mo>
                                                                            <mrow id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.cmml">
                                                                                <msub
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.cmml">
                                                                                    <mi class="ltx_font_mathcaligraphic"
                                                                                        id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.2"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.2.cmml">
                                                                                        𝒟</mi>
                                                                                    <mi id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.3"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.3.cmml">
                                                                                        C</mi>
                                                                                </msub>
                                                                                <mo id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.2"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.2.cmml">
                                                                                    ⁢</mo>
                                                                                <mrow
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                    <mo id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.2"
                                                                                        stretchy="false"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                        (</mo>
                                                                                    <msub
                                                                                        id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                        <mi id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2"
                                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2.cmml">
                                                                                            o</mi>
                                                                                        <mi id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3"
                                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3.cmml">
                                                                                            j</mi>
                                                                                    </msub>
                                                                                    <mo id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.3"
                                                                                        stretchy="false"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml">
                                                                                        )</mo>
                                                                                </mrow>
                                                                            </mrow>
                                                                            <mo id="S3.E11.m1.4.4.2.2.2.2.1.1.1.3"
                                                                                stretchy="false"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.cmml">
                                                                                )</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E11.m1.4b">
                                                            <apply id="S3.E11.m1.4.4.3.cmml" xref="S3.E11.m1.4.4.2">
                                                                <csymbol cd="ambiguous" id="S3.E11.m1.4.4.3a.cmml"
                                                                    xref="S3.E11.m1.4.4.2.3">formulae-sequence</csymbol>
                                                                <apply id="S3.E11.m1.3.3.1.1.cmml"
                                                                    xref="S3.E11.m1.3.3.1.1">
                                                                    <eq id="S3.E11.m1.3.3.1.1.2.cmml"
                                                                        xref="S3.E11.m1.3.3.1.1.2"></eq>
                                                                    <apply id="S3.E11.m1.3.3.1.1.3.cmml"
                                                                        xref="S3.E11.m1.3.3.1.1.3">
                                                                        <times id="S3.E11.m1.3.3.1.1.3.1.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.3.1"></times>
                                                                        <ci id="S3.E11.m1.3.3.1.1.3.2a.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.3.2">
                                                                            <mtext id="S3.E11.m1.3.3.1.1.3.2.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.3.2">where
                                                                            </mtext>
                                                                        </ci>
                                                                        <apply id="S3.E11.m1.3.3.1.1.3.3.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.3.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E11.m1.3.3.1.1.3.3.1.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.3.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E11.m1.3.3.1.1.3.3.2.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.3.3.2">𝑄</ci>
                                                                            <ci id="S3.E11.m1.3.3.1.1.3.3.3.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.3.3.3">𝑖</ci>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E11.m1.3.3.1.1.1.cmml"
                                                                        xref="S3.E11.m1.3.3.1.1.1">
                                                                        <times id="S3.E11.m1.3.3.1.1.1.2.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.1.2"></times>
                                                                        <apply id="S3.E11.m1.3.3.1.1.1.3.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E11.m1.3.3.1.1.1.3.1.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E11.m1.3.3.1.1.1.3.2.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.1.3.2">𝑊</ci>
                                                                            <ci id="S3.E11.m1.3.3.1.1.1.3.3.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.1.3.3">𝑞</ci>
                                                                        </apply>
                                                                        <apply id="S3.E11.m1.3.3.1.1.1.1.1.1.cmml"
                                                                            xref="S3.E11.m1.3.3.1.1.1.1.1">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.1.1.1">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E11.m1.3.3.1.1.1.1.1.1.2.cmml"
                                                                                xref="S3.E11.m1.3.3.1.1.1.1.1.1.2">𝑑
                                                                            </ci>
                                                                            <list id="S3.E11.m1.2.2.2.3.cmml"
                                                                                xref="S3.E11.m1.2.2.2.2">
                                                                                <apply id="S3.E11.m1.2.2.2.2.1.cmml"
                                                                                    xref="S3.E11.m1.2.2.2.2.1">
                                                                                    <minus
                                                                                        id="S3.E11.m1.2.2.2.2.1.1.cmml"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.1">
                                                                                    </minus>
                                                                                    <ci id="S3.E11.m1.2.2.2.2.1.2.cmml"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.2">𝑙
                                                                                    </ci>
                                                                                    <cn id="S3.E11.m1.2.2.2.2.1.3.cmml"
                                                                                        type="integer"
                                                                                        xref="S3.E11.m1.2.2.2.2.1.3">1
                                                                                    </cn>
                                                                                </apply>
                                                                                <ci id="S3.E11.m1.1.1.1.1.cmml"
                                                                                    xref="S3.E11.m1.1.1.1.1">𝑖</ci>
                                                                            </list>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                                <apply id="S3.E11.m1.4.4.2.2.3.cmml"
                                                                    xref="S3.E11.m1.4.4.2.2.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S3.E11.m1.4.4.2.2.3a.cmml"
                                                                        xref="S3.E11.m1.4.4.2.2.2.3">formulae-sequence
                                                                    </csymbol>
                                                                    <apply id="S3.E11.m1.4.4.2.2.1.1.cmml"
                                                                        xref="S3.E11.m1.4.4.2.2.1.1">
                                                                        <eq id="S3.E11.m1.4.4.2.2.1.1.2.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.2"></eq>
                                                                        <apply id="S3.E11.m1.4.4.2.2.1.1.3.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E11.m1.4.4.2.2.1.1.3.1.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E11.m1.4.4.2.2.1.1.3.2.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.3.2">𝐾</ci>
                                                                            <ci id="S3.E11.m1.4.4.2.2.1.1.3.3.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.3.3">𝑖</ci>
                                                                        </apply>
                                                                        <apply id="S3.E11.m1.4.4.2.2.1.1.1.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.1.1.1">
                                                                            <times id="S3.E11.m1.4.4.2.2.1.1.1.2.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.2">
                                                                            </times>
                                                                            <apply id="S3.E11.m1.4.4.2.2.1.1.1.3.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.3.1.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E11.m1.4.4.2.2.1.1.1.3.2.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.3.2">
                                                                                    𝑊</ci>
                                                                                <ci id="S3.E11.m1.4.4.2.2.1.1.1.3.3.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.3.3">
                                                                                    𝑘</ci>
                                                                            </apply>
                                                                            <apply
                                                                                id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.1.1.1.1.1">
                                                                                <times
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.2.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.2">
                                                                                </times>
                                                                                <apply
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.1.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.2.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.2">
                                                                                        𝒟</ci>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.3.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.3.3">
                                                                                        𝐶</ci>
                                                                                </apply>
                                                                                <apply
                                                                                    id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.1.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.2.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.2">
                                                                                        𝑜</ci>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.3.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.1.1.1.1.1.1.1.1.1.3">
                                                                                        𝑗</ci>
                                                                                </apply>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                    <apply id="S3.E11.m1.4.4.2.2.2.2.cmml"
                                                                        xref="S3.E11.m1.4.4.2.2.2.2">
                                                                        <eq id="S3.E11.m1.4.4.2.2.2.2.2.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.2"></eq>
                                                                        <apply id="S3.E11.m1.4.4.2.2.2.2.3.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.3">
                                                                            <csymbol cd="ambiguous"
                                                                                id="S3.E11.m1.4.4.2.2.2.2.3.1.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.3">subscript
                                                                            </csymbol>
                                                                            <ci id="S3.E11.m1.4.4.2.2.2.2.3.2.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.3.2">𝑉</ci>
                                                                            <ci id="S3.E11.m1.4.4.2.2.2.2.3.3.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.3.3">𝑖</ci>
                                                                        </apply>
                                                                        <apply id="S3.E11.m1.4.4.2.2.2.2.1.cmml"
                                                                            xref="S3.E11.m1.4.4.2.2.2.2.1">
                                                                            <times id="S3.E11.m1.4.4.2.2.2.2.1.2.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.2">
                                                                            </times>
                                                                            <apply id="S3.E11.m1.4.4.2.2.2.2.1.3.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.3">
                                                                                <csymbol cd="ambiguous"
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.3.1.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.3">
                                                                                    subscript</csymbol>
                                                                                <ci id="S3.E11.m1.4.4.2.2.2.2.1.3.2.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.3.2">
                                                                                    𝑊</ci>
                                                                                <ci id="S3.E11.m1.4.4.2.2.2.2.1.3.3.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.3.3">
                                                                                    𝑣</ci>
                                                                            </apply>
                                                                            <apply
                                                                                id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.cmml"
                                                                                xref="S3.E11.m1.4.4.2.2.2.2.1.1.1">
                                                                                <times
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.2.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.2">
                                                                                </times>
                                                                                <apply
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.1.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.2.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.2">
                                                                                        𝒟</ci>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.3.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.3.3">
                                                                                        𝐶</ci>
                                                                                </apply>
                                                                                <apply
                                                                                    id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml"
                                                                                    xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1">
                                                                                    <csymbol cd="ambiguous"
                                                                                        id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.1.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1">
                                                                                        subscript</csymbol>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.2">
                                                                                        𝑜</ci>
                                                                                    <ci id="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3.cmml"
                                                                                        xref="S3.E11.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.3">
                                                                                        𝑗</ci>
                                                                                </apply>
                                                                            </apply>
                                                                        </apply>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E11.m1.4c">
                                                            \displaystyle\text{where
                                                            }Q_{i}=W_{q}(d_{l-1,i}),K_{i}=W_{k}(\mathcal{D}_{C}(o%
                                                            _{j})),V_{i}=W_{v}(\mathcal{D}_{C}(o_{j}))</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">
                                                            where italic_Q start_POSTSUBSCRIPT italic_i
                                                            end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_q
                                                            end_POSTSUBSCRIPT ( italic_d start_POSTSUBSCRIPT italic_l -
                                                            1 , italic_i end_POSTSUBSCRIPT ) , italic_K
                                                            start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_W
                                                            start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT (
                                                            caligraphic_D start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT
                                                            ( italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )
                                                            ) , italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT
                                                            = italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT (
                                                            caligraphic_D start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT
                                                            ( italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )
                                                            )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
                                        </tr>
                                    </tbody>
                                    <tbody id="S3.E12">
                                        <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                            <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                            <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                    alttext="\displaystyle D_{l}" class="ltx_Math" display="inline"
                                                    id="S3.E12.m1.1">
                                                    <semantics id="S3.E12.m1.1a">
                                                        <msub id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">
                                                            <mi id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">D</mi>
                                                            <mi id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml">l</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S3.E12.m1.1b">
                                                            <apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">
                                                                <csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.cmml"
                                                                    xref="S3.E12.m1.1.1">subscript</csymbol>
                                                                <ci id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2">𝐷
                                                                </ci>
                                                                <ci id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">𝑙
                                                                </ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E12.m1.1c">
                                                            \displaystyle D_{l}</annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">
                                                            italic_D start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT
                                                        </annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                                    alttext="\displaystyle=\text{Decoder-Transformer-layer}_{l}(B_{l})"
                                                    class="ltx_Math" display="inline" id="S3.E12.m2.1">
                                                    <semantics id="S3.E12.m2.1a">
                                                        <mrow id="S3.E12.m2.1.1" xref="S3.E12.m2.1.1.cmml">
                                                            <mi id="S3.E12.m2.1.1.3" xref="S3.E12.m2.1.1.3.cmml"></mi>
                                                            <mo id="S3.E12.m2.1.1.2" xref="S3.E12.m2.1.1.2.cmml">=</mo>
                                                            <mrow id="S3.E12.m2.1.1.1" xref="S3.E12.m2.1.1.1.cmml">
                                                                <msub id="S3.E12.m2.1.1.1.3"
                                                                    xref="S3.E12.m2.1.1.1.3.cmml">
                                                                    <mtext id="S3.E12.m2.1.1.1.3.2"
                                                                        xref="S3.E12.m2.1.1.1.3.2a.cmml">
                                                                        Decoder-Transformer-layer</mtext>
                                                                    <mi id="S3.E12.m2.1.1.1.3.3"
                                                                        xref="S3.E12.m2.1.1.1.3.3.cmml">l</mi>
                                                                </msub>
                                                                <mo id="S3.E12.m2.1.1.1.2"
                                                                    xref="S3.E12.m2.1.1.1.2.cmml">⁢</mo>
                                                                <mrow id="S3.E12.m2.1.1.1.1.1"
                                                                    xref="S3.E12.m2.1.1.1.1.1.1.cmml">
                                                                    <mo id="S3.E12.m2.1.1.1.1.1.2" stretchy="false"
                                                                        xref="S3.E12.m2.1.1.1.1.1.1.cmml">(</mo>
                                                                    <msub id="S3.E12.m2.1.1.1.1.1.1"
                                                                        xref="S3.E12.m2.1.1.1.1.1.1.cmml">
                                                                        <mi id="S3.E12.m2.1.1.1.1.1.1.2"
                                                                            xref="S3.E12.m2.1.1.1.1.1.1.2.cmml">B</mi>
                                                                        <mi id="S3.E12.m2.1.1.1.1.1.1.3"
                                                                            xref="S3.E12.m2.1.1.1.1.1.1.3.cmml">l</mi>
                                                                    </msub>
                                                                    <mo id="S3.E12.m2.1.1.1.1.1.3" stretchy="false"
                                                                        xref="S3.E12.m2.1.1.1.1.1.1.cmml">)</mo>
                                                                </mrow>
                                                            </mrow>
                                                        </mrow><annotation-xml encoding="MathML-Content"
                                                            id="S3.E12.m2.1b">
                                                            <apply id="S3.E12.m2.1.1.cmml" xref="S3.E12.m2.1.1">
                                                                <eq id="S3.E12.m2.1.1.2.cmml" xref="S3.E12.m2.1.1.2">
                                                                </eq>
                                                                <csymbol cd="latexml" id="S3.E12.m2.1.1.3.cmml"
                                                                    xref="S3.E12.m2.1.1.3">absent</csymbol>
                                                                <apply id="S3.E12.m2.1.1.1.cmml" xref="S3.E12.m2.1.1.1">
                                                                    <times id="S3.E12.m2.1.1.1.2.cmml"
                                                                        xref="S3.E12.m2.1.1.1.2"></times>
                                                                    <apply id="S3.E12.m2.1.1.1.3.cmml"
                                                                        xref="S3.E12.m2.1.1.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E12.m2.1.1.1.3.1.cmml"
                                                                            xref="S3.E12.m2.1.1.1.3">subscript</csymbol>
                                                                        <ci id="S3.E12.m2.1.1.1.3.2a.cmml"
                                                                            xref="S3.E12.m2.1.1.1.3.2">
                                                                            <mtext id="S3.E12.m2.1.1.1.3.2.cmml"
                                                                                xref="S3.E12.m2.1.1.1.3.2">
                                                                                Decoder-Transformer-layer</mtext>
                                                                        </ci>
                                                                        <ci id="S3.E12.m2.1.1.1.3.3.cmml"
                                                                            xref="S3.E12.m2.1.1.1.3.3">𝑙</ci>
                                                                    </apply>
                                                                    <apply id="S3.E12.m2.1.1.1.1.1.1.cmml"
                                                                        xref="S3.E12.m2.1.1.1.1.1">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S3.E12.m2.1.1.1.1.1.1.1.cmml"
                                                                            xref="S3.E12.m2.1.1.1.1.1">subscript
                                                                        </csymbol>
                                                                        <ci id="S3.E12.m2.1.1.1.1.1.1.2.cmml"
                                                                            xref="S3.E12.m2.1.1.1.1.1.1.2">𝐵</ci>
                                                                        <ci id="S3.E12.m2.1.1.1.1.1.1.3.cmml"
                                                                            xref="S3.E12.m2.1.1.1.1.1.1.3">𝑙</ci>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex" id="S3.E12.m2.1c">
                                                            \displaystyle=\text{Decoder-Transformer-layer}_{l}(B_{l})
                                                        </annotation>
                                                        <annotation encoding="application/x-llamapun" id="S3.E12.m2.1d">
                                                            = Decoder-Transformer-layer start_POSTSUBSCRIPT italic_l
                                                            end_POSTSUBSCRIPT ( italic_B start_POSTSUBSCRIPT italic_l
                                                            end_POSTSUBSCRIPT )</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                            <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                                rowspan="1"><span
                                                    class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="ltx_para" id="S3.SS3.SSS1.p3">
                                <p class="ltx_p" id="S3.SS3.SSS1.p3.11">where once again, <math alttext="W_{k},W_{v}"
                                        class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.1.m1.2">
                                        <semantics id="S3.SS3.SSS1.p3.1.m1.2a">
                                            <mrow id="S3.SS3.SSS1.p3.1.m1.2.2.2" xref="S3.SS3.SSS1.p3.1.m1.2.2.3.cmml">
                                                <msub id="S3.SS3.SSS1.p3.1.m1.1.1.1.1"
                                                    xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1.cmml">
                                                    <mi id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.2"
                                                        xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1.2.cmml">W</mi>
                                                    <mi id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.3"
                                                        xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1.3.cmml">k</mi>
                                                </msub>
                                                <mo id="S3.SS3.SSS1.p3.1.m1.2.2.2.3"
                                                    xref="S3.SS3.SSS1.p3.1.m1.2.2.3.cmml">,</mo>
                                                <msub id="S3.SS3.SSS1.p3.1.m1.2.2.2.2"
                                                    xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2.cmml">
                                                    <mi id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.2"
                                                        xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2.2.cmml">W</mi>
                                                    <mi id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.3"
                                                        xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2.3.cmml">v</mi>
                                                </msub>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.1.m1.2b">
                                                <list id="S3.SS3.SSS1.p3.1.m1.2.2.3.cmml"
                                                    xref="S3.SS3.SSS1.p3.1.m1.2.2.2">
                                                    <apply id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1">
                                                        <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.1.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1">subscript</csymbol>
                                                        <ci id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.2.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1.2">𝑊</ci>
                                                        <ci id="S3.SS3.SSS1.p3.1.m1.1.1.1.1.3.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.1.1.1.1.3">𝑘</ci>
                                                    </apply>
                                                    <apply id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2">
                                                        <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.1.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2">subscript</csymbol>
                                                        <ci id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.2.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2.2">𝑊</ci>
                                                        <ci id="S3.SS3.SSS1.p3.1.m1.2.2.2.2.3.cmml"
                                                            xref="S3.SS3.SSS1.p3.1.m1.2.2.2.2.3">𝑣</ci>
                                                    </apply>
                                                </list>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.2c">
                                                W_{k},W_{v}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.1.m1.2d">
                                                italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_W
                                                start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> are key/value projection matrices that operate on a linear transformation
                                    and split operation <math alttext="\mathcal{D}_{C}" class="ltx_Math"
                                        display="inline" id="S3.SS3.SSS1.p3.2.m2.1">
                                        <semantics id="S3.SS3.SSS1.p3.2.m2.1a">
                                            <msub id="S3.SS3.SSS1.p3.2.m2.1.1" xref="S3.SS3.SSS1.p3.2.m2.1.1.cmml">
                                                <mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p3.2.m2.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.2.m2.1.1.2.cmml">𝒟</mi>
                                                <mi id="S3.SS3.SSS1.p3.2.m2.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml">C</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.2.m2.1b">
                                                <apply id="S3.SS3.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p3.2.m2.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.2.m2.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.2.m2.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.2.m2.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.2.m2.1.1.2">𝒟</ci>
                                                    <ci id="S3.SS3.SSS1.p3.2.m2.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.2.m2.1.1.3">𝐶</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.2.m2.1c">
                                                \mathcal{D}_{C}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.2.m2.1d">
                                                caligraphic_D start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math>, applied to the final patch representations <math alttext="o_{j}"
                                        class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.3.m3.1">
                                        <semantics id="S3.SS3.SSS1.p3.3.m3.1a">
                                            <msub id="S3.SS3.SSS1.p3.3.m3.1.1" xref="S3.SS3.SSS1.p3.3.m3.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.3.m3.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.3.m3.1.1.2.cmml">o</mi>
                                                <mi id="S3.SS3.SSS1.p3.3.m3.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.3.m3.1.1.3.cmml">j</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.3.m3.1b">
                                                <apply id="S3.SS3.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p3.3.m3.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.3.m3.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.3.m3.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.3.m3.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.3.m3.1.1.2">𝑜</ci>
                                                    <ci id="S3.SS3.SSS1.p3.3.m3.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.3.m3.1.1.3">𝑗</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.3.m3.1c">o_{j}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.3.m3.1d">
                                                italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> from the global model, <math alttext="W_{q}" class="ltx_Math"
                                        display="inline" id="S3.SS3.SSS1.p3.4.m4.1">
                                        <semantics id="S3.SS3.SSS1.p3.4.m4.1a">
                                            <msub id="S3.SS3.SSS1.p3.4.m4.1.1" xref="S3.SS3.SSS1.p3.4.m4.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.4.m4.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS3.SSS1.p3.4.m4.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml">q</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.4.m4.1b">
                                                <apply id="S3.SS3.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p3.4.m4.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.4.m4.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.4.m4.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.4.m4.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.4.m4.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS3.SSS1.p3.4.m4.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.4.m4.1.1.3">𝑞</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.4.m4.1c">W_{q}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.4.m4.1d">
                                                italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> is a query projection matrices operating on byte representations <math
                                        alttext="d_{l-1}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.5.m5.1">
                                        <semantics id="S3.SS3.SSS1.p3.5.m5.1a">
                                            <msub id="S3.SS3.SSS1.p3.5.m5.1.1" xref="S3.SS3.SSS1.p3.5.m5.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.5.m5.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.5.m5.1.1.2.cmml">d</mi>
                                                <mrow id="S3.SS3.SSS1.p3.5.m5.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.5.m5.1.1.3.cmml">
                                                    <mi id="S3.SS3.SSS1.p3.5.m5.1.1.3.2"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1.3.2.cmml">l</mi>
                                                    <mo id="S3.SS3.SSS1.p3.5.m5.1.1.3.1"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1.3.1.cmml">−</mo>
                                                    <mn id="S3.SS3.SSS1.p3.5.m5.1.1.3.3"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1.3.3.cmml">1</mn>
                                                </mrow>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.5.m5.1b">
                                                <apply id="S3.SS3.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p3.5.m5.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.5.m5.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.5.m5.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1.2">𝑑</ci>
                                                    <apply id="S3.SS3.SSS1.p3.5.m5.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.5.m5.1.1.3">
                                                        <minus id="S3.SS3.SSS1.p3.5.m5.1.1.3.1.cmml"
                                                            xref="S3.SS3.SSS1.p3.5.m5.1.1.3.1"></minus>
                                                        <ci id="S3.SS3.SSS1.p3.5.m5.1.1.3.2.cmml"
                                                            xref="S3.SS3.SSS1.p3.5.m5.1.1.3.2">𝑙</ci>
                                                        <cn id="S3.SS3.SSS1.p3.5.m5.1.1.3.3.cmml" type="integer"
                                                            xref="S3.SS3.SSS1.p3.5.m5.1.1.3.3">1</cn>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.5.m5.1c">d_{l-1}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.5.m5.1d">
                                                italic_d start_POSTSUBSCRIPT italic_l - 1 end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> from the previous decoder transformer layer (or <math
                                        alttext="h_{l_{\mathcal{E}}}" class="ltx_Math" display="inline"
                                        id="S3.SS3.SSS1.p3.6.m6.1">
                                        <semantics id="S3.SS3.SSS1.p3.6.m6.1a">
                                            <msub id="S3.SS3.SSS1.p3.6.m6.1.1" xref="S3.SS3.SSS1.p3.6.m6.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.6.m6.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml">h</mi>
                                                <msub id="S3.SS3.SSS1.p3.6.m6.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml">
                                                    <mi id="S3.SS3.SSS1.p3.6.m6.1.1.3.2"
                                                        xref="S3.SS3.SSS1.p3.6.m6.1.1.3.2.cmml">l</mi>
                                                    <mi class="ltx_font_mathcaligraphic"
                                                        id="S3.SS3.SSS1.p3.6.m6.1.1.3.3"
                                                        xref="S3.SS3.SSS1.p3.6.m6.1.1.3.3.cmml">ℰ</mi>
                                                </msub>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.6.m6.1b">
                                                <apply id="S3.SS3.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS3.SSS1.p3.6.m6.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.6.m6.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.6.m6.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.6.m6.1.1.2">ℎ</ci>
                                                    <apply id="S3.SS3.SSS1.p3.6.m6.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.6.m6.1.1.3">
                                                        <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.6.m6.1.1.3.1.cmml"
                                                            xref="S3.SS3.SSS1.p3.6.m6.1.1.3">subscript</csymbol>
                                                        <ci id="S3.SS3.SSS1.p3.6.m6.1.1.3.2.cmml"
                                                            xref="S3.SS3.SSS1.p3.6.m6.1.1.3.2">𝑙</ci>
                                                        <ci id="S3.SS3.SSS1.p3.6.m6.1.1.3.3.cmml"
                                                            xref="S3.SS3.SSS1.p3.6.m6.1.1.3.3">ℰ</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.6.m6.1c">
                                                h_{l_{\mathcal{E}}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.6.m6.1d">
                                                italic_h start_POSTSUBSCRIPT italic_l start_POSTSUBSCRIPT caligraphic_E
                                                end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> for the first layer), and <math alttext="W_{o}" class="ltx_Math"
                                        display="inline" id="S3.SS3.SSS1.p3.7.m7.1">
                                        <semantics id="S3.SS3.SSS1.p3.7.m7.1a">
                                            <msub id="S3.SS3.SSS1.p3.7.m7.1.1" xref="S3.SS3.SSS1.p3.7.m7.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.7.m7.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.7.m7.1.1.2.cmml">W</mi>
                                                <mi id="S3.SS3.SSS1.p3.7.m7.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.7.m7.1.1.3.cmml">o</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.7.m7.1b">
                                                <apply id="S3.SS3.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS3.SSS1.p3.7.m7.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.7.m7.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.7.m7.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.7.m7.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.7.m7.1.1.2">𝑊</ci>
                                                    <ci id="S3.SS3.SSS1.p3.7.m7.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.7.m7.1.1.3">𝑜</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.7.m7.1c">W_{o}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.7.m7.1d">
                                                italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> is the output projection matrix, thus making <math
                                        alttext="B\in\mathbb{R}^{h_{\mathcal{D}}\times n_{b}}" class="ltx_Math"
                                        display="inline" id="S3.SS3.SSS1.p3.8.m8.1">
                                        <semantics id="S3.SS3.SSS1.p3.8.m8.1a">
                                            <mrow id="S3.SS3.SSS1.p3.8.m8.1.1" xref="S3.SS3.SSS1.p3.8.m8.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.8.m8.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.2.cmml">B</mi>
                                                <mo id="S3.SS3.SSS1.p3.8.m8.1.1.1"
                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.1.cmml">∈</mo>
                                                <msup id="S3.SS3.SSS1.p3.8.m8.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.cmml">
                                                    <mi id="S3.SS3.SSS1.p3.8.m8.1.1.3.2"
                                                        xref="S3.SS3.SSS1.p3.8.m8.1.1.3.2.cmml">ℝ</mi>
                                                    <mrow id="S3.SS3.SSS1.p3.8.m8.1.1.3.3"
                                                        xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.cmml">
                                                        <msub id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2"
                                                            xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.cmml">
                                                            <mi id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.2"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.3"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.3.cmml">𝒟</mi>
                                                        </msub>
                                                        <mo id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.1" lspace="0.222em"
                                                            rspace="0.222em" xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.1.cmml">×
                                                        </mo>
                                                        <msub id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3"
                                                            xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.cmml">
                                                            <mi id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.2"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.2.cmml">n</mi>
                                                            <mi id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.3"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.3.cmml">b</mi>
                                                        </msub>
                                                    </mrow>
                                                </msup>
                                            </mrow><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.8.m8.1b">
                                                <apply id="S3.SS3.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS3.SSS1.p3.8.m8.1.1">
                                                    <in id="S3.SS3.SSS1.p3.8.m8.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.8.m8.1.1.1"></in>
                                                    <ci id="S3.SS3.SSS1.p3.8.m8.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.8.m8.1.1.2">𝐵</ci>
                                                    <apply id="S3.SS3.SSS1.p3.8.m8.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.8.m8.1.1.3">
                                                        <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.8.m8.1.1.3.1.cmml"
                                                            xref="S3.SS3.SSS1.p3.8.m8.1.1.3">superscript</csymbol>
                                                        <ci id="S3.SS3.SSS1.p3.8.m8.1.1.3.2.cmml"
                                                            xref="S3.SS3.SSS1.p3.8.m8.1.1.3.2">ℝ</ci>
                                                        <apply id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.cmml"
                                                            xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3">
                                                            <times id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.1.cmml"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.1"></times>
                                                            <apply id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.cmml"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2">
                                                                <csymbol cd="ambiguous"
                                                                    id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.1.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2">subscript
                                                                </csymbol>
                                                                <ci id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.2.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.2">ℎ</ci>
                                                                <ci id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.3.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.2.3">𝒟</ci>
                                                            </apply>
                                                            <apply id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.cmml"
                                                                xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3">
                                                                <csymbol cd="ambiguous"
                                                                    id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.1.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3">subscript
                                                                </csymbol>
                                                                <ci id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.2.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.2">𝑛</ci>
                                                                <ci id="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.3.cmml"
                                                                    xref="S3.SS3.SSS1.p3.8.m8.1.1.3.3.3.3">𝑏</ci>
                                                            </apply>
                                                        </apply>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.8.m8.1c">
                                                B\in\mathbb{R}^{h_{\mathcal{D}}\times n_{b}}</annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.8.m8.1d">
                                                italic_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_h
                                                start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT × italic_n
                                                start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT
                                            </annotation>
                                        </semantics>
                                    </math>, where <math alttext="n_{b}" class="ltx_Math" display="inline"
                                        id="S3.SS3.SSS1.p3.9.m9.1">
                                        <semantics id="S3.SS3.SSS1.p3.9.m9.1a">
                                            <msub id="S3.SS3.SSS1.p3.9.m9.1.1" xref="S3.SS3.SSS1.p3.9.m9.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.9.m9.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml">n</mi>
                                                <mi id="S3.SS3.SSS1.p3.9.m9.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml">b</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.9.m9.1b">
                                                <apply id="S3.SS3.SSS1.p3.9.m9.1.1.cmml" xref="S3.SS3.SSS1.p3.9.m9.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.9.m9.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.9.m9.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.9.m9.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.9.m9.1.1.2">𝑛</ci>
                                                    <ci id="S3.SS3.SSS1.p3.9.m9.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.9.m9.1.1.3">𝑏</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.9.m9.1c">n_{b}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.9.m9.1d">
                                                italic_n start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> is the number of output bytes. The next decoder representations <math
                                        alttext="D_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.10.m10.1">
                                        <semantics id="S3.SS3.SSS1.p3.10.m10.1a">
                                            <msub id="S3.SS3.SSS1.p3.10.m10.1.1" xref="S3.SS3.SSS1.p3.10.m10.1.1.cmml">
                                                <mi id="S3.SS3.SSS1.p3.10.m10.1.1.2"
                                                    xref="S3.SS3.SSS1.p3.10.m10.1.1.2.cmml">D</mi>
                                                <mi id="S3.SS3.SSS1.p3.10.m10.1.1.3"
                                                    xref="S3.SS3.SSS1.p3.10.m10.1.1.3.cmml">l</mi>
                                            </msub><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.10.m10.1b">
                                                <apply id="S3.SS3.SSS1.p3.10.m10.1.1.cmml"
                                                    xref="S3.SS3.SSS1.p3.10.m10.1.1">
                                                    <csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.10.m10.1.1.1.cmml"
                                                        xref="S3.SS3.SSS1.p3.10.m10.1.1">subscript</csymbol>
                                                    <ci id="S3.SS3.SSS1.p3.10.m10.1.1.2.cmml"
                                                        xref="S3.SS3.SSS1.p3.10.m10.1.1.2">𝐷</ci>
                                                    <ci id="S3.SS3.SSS1.p3.10.m10.1.1.3.cmml"
                                                        xref="S3.SS3.SSS1.p3.10.m10.1.1.3">𝑙</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.10.m10.1c">D_{l}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.10.m10.1d">
                                                italic_D start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> are computed using a decoder transformer layer on the output of the
                                    cross-attention block, <math alttext="B" class="ltx_Math" display="inline"
                                        id="S3.SS3.SSS1.p3.11.m11.1">
                                        <semantics id="S3.SS3.SSS1.p3.11.m11.1a">
                                            <mi id="S3.SS3.SSS1.p3.11.m11.1.1" xref="S3.SS3.SSS1.p3.11.m11.1.1.cmml">B
                                            </mi><annotation-xml encoding="MathML-Content"
                                                id="S3.SS3.SSS1.p3.11.m11.1b">
                                                <ci id="S3.SS3.SSS1.p3.11.m11.1.1.cmml"
                                                    xref="S3.SS3.SSS1.p3.11.m11.1.1">𝐵</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.11.m11.1c">B
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.11.m11.1d">
                                                italic_B</annotation>
                                        </semantics>
                                    </math>. As in the local encoder cross-attention, we use multiple heads in the
                                    attention, use pre LayerNorms, no positional embeddings, and a residual connection
                                    around the cross-attention module.</p>
                            </div>
                        </section>
                    </section>
                </section>
                <section class="ltx_section" id="S4">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">4 </span>Experimental Setup
                    </h2>
                    <div class="ltx_para" id="S4.p1">
                        <p class="ltx_p" id="S4.p1.1">We carefully design controlled experiments to compare <span
                                class="ltx_text ltx_font_smallcaps" id="S4.p1.1.1">B</span>LT with tokenization based
                            models with particular attention to not give <span class="ltx_text ltx_font_smallcaps"
                                id="S4.p1.1.2">B</span>LT any advantages from possibly using longer sequence contexts.
                        </p>
                    </div>
                    <section class="ltx_subsection" id="S4.SS1">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.1 </span>Pre-training Datasets
                        </h3>
                        <div class="ltx_para" id="S4.SS1.p1">
                            <p class="ltx_p" id="S4.SS1.p1.1">All model scales that we experiment in this paper are
                                pre-trained on two datasets: 1) The Llama 2 dataset <cite
                                    class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib43" title="">2023</a>)</cite>,
                                which comprises 2 trillion tokens collected from a variety of publicly available
                                sources, which are subsequently cleaned and filtered to improve quality; and 2) <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.1">B</span>LT-1T: A new dataset
                                with 1 trillion tokens gathered from various public sources, and also including a subset
                                of the pre-training data released by Datacomp-LM <cite
                                    class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib28" title="">2024</a>)</cite>.
                                The former is used for scaling law experiments on optimal number of tokens as determined
                                by <cite class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>
                                to determine the best architectural choices for <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS1.p1.1.2">B</span>LT, while the latter
                                is used for a complete pre-training run to compare with Llama 3 on downstream tasks.
                                Neither of these datasets include any data gathered from Meta products or services.
                                Furthermore, for baseline experiments for tokenizer-based models, we use the Llama 3
                                tokenizer with a vocabulary size of 128K tokens, which produced stronger baseline
                                performance that the Llama 2 tokenizer in our experiments.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS2">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.2 </span>Entropy Model
                        </h3>
                        <div class="ltx_para" id="S4.SS2.p1">
                            <p class="ltx_p" id="S4.SS2.p1.1">The entropy model in our experiments is a byte level
                                language model trained on the same training distribution as the full <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS2.p1.1.1">B</span>LT model. Unless
                                otherwise mentioned, we use a transformer with 100M parameters, 14 layers, and a hidden
                                dimensionality of 512, and sliding window attention of 512 bytes. The remaining
                                hyperparameters are the same as in our local and global transformers. We experimented
                                with different model sizes, receptive fields, and architectures as discussed in <a
                                    class="ltx_ref ltx_refmacro_autoref" href="https://arxiv.org/html/2412.09871v1#S7"
                                    title="7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">section 7</span></a>. In particular, when the
                                receptive field of the model is small enough, the trained entropy model can be encoded
                                in an efficient lookup table.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS3">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.3 </span>Entropy Threshold and Equalizing Context
                            Length
                        </h3>
                        <div class="ltx_para" id="S4.SS3.p1">
                            <p class="ltx_p" id="S4.SS3.p1.1">For models using entropy-based patching, we estimate a
                                patching threshold that achieves a desired average <span
                                    class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1">patch size</span> on the
                                pretraining data mix. In <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS3.p1.1.2">B</span>LT, unlike with tokenization, the <span
                                    class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.3">patch size</span> can be
                                arbitrarily chosen having significant implications on the context size used by the
                                model.
                                To maintain the same average context length and avoid giving larger patch sizes unfair
                                advantage, we ensure that the number of bytes in each batch remains constant in
                                expectation. This means that we reduce the sequence length of models with larger patch
                                sizes. On Llama 2 data, we use a 8k byte context while on the <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS3.p1.1.4">B</span>LT-1T dataset we
                                increase the context to 16k bytes on average while maintaining the same batch size of
                                16M bytes on average.</p>
                        </div>
                        <div class="ltx_para" id="S4.SS3.p2">
                            <p class="ltx_p" id="S4.SS3.p2.1">While the average batch size is constant, when loading
                                batches of data, dynamic patching methods yield different ratios of bytes to patches.
                                For efficiency reasons, our implementation of <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS3.p2.1.1">B</span>LT training packs batches of patches to avoid padding
                                steps in the more expensive latent transformer. This ensures that every batch has the
                                same number of patches. During training we pad and possibly truncate byte sequences to
                                12k and 24k bytes respectively for Llama 2 and <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS3.p2.1.2">B</span>LT-1T datasets, to avoid memory spikes from sequences
                                with unusually large patches.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS4">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.4 </span>Entropy Model Context
                        </h3>
                        <div class="ltx_para" id="S4.SS4.p1">
                            <p class="ltx_p" id="S4.SS4.p1.1">Empirically, we find that using entropy patching yields
                                progressively larger patches in structured content like multiple choice tasks (see
                                patching on an MMLU example in <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S15.F9"
                                    title="Figure 9 ‣ 15 Entropy Patching Example from MMLU ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 9</span></a>) which are often very
                                repetitive. These variations are caused by lower entropy on the repeated content found
                                in the entropy model context. So for the large scale run of <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS4.p1.1.1">B</span>LT-Entropy with patch
                                size 4.5, we reset the entropy context with new lines and use approximate monontonicity
                                constraint as it suffers less from "entropy drift" from changes in context length. This
                                change only affects how we compute entropies, but we still follow the same procedure to
                                identify the value of the entropy threshold.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS5">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.5 </span>FLOPs Estimation
                        </h3>
                        <div class="ltx_para" id="S4.SS5.p1">
                            <p class="ltx_p" id="S4.SS5.p1.1">We largely follow the equations for computation of
                                transformer <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.1">flop</span>s
                                from Chinchilla <cite class="ltx_cite ltx_citemacro_citep">(Hoffmann et al., <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib21"
                                        title="">2022</a>)</cite> comprising <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS5.p1.1.2">flop</span>s for the feed-forward layers, <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.3">qkvo</span> projections in
                                the self-attention layer, and computation of attention and output projection.
                                A notable difference is that we assume the input embedding layer is implemented as an
                                efficient lookup instead of a dense matrix multiplication, therefore becoming a 0-<span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.4">flop</span> operation.
                                Following previous work, we estimate that the backwards pass has twice the number of
                                <span class="ltx_text ltx_font_smallcaps" id="S4.SS5.p1.1.5">flop</span>s as the forward
                                pass.</p>
                        </div>
                        <div class="ltx_para" id="S4.SS5.p2">
                            <p class="ltx_p" id="S4.SS5.p2.1">To compute <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS5.p2.1.1">flop</span>s <span class="ltx_text ltx_font_italic"
                                    id="S4.SS5.p2.1.2">per byte</span> for <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS5.p2.1.3">B</span>LT models, we add up the <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS5.p2.1.4">flop</span>s for the local
                                encoder transformer, the global latent transformer, and the local decoder transformer,
                                together with the cross attention blocks in the encoder and the decoder:</p>
                        </div>
                        <div class="ltx_para" id="S4.SS5.p3">
                            <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx6">
                                <tbody id="S4.E13">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                alttext="\displaystyle\text{FL}_{\text{{{B}LT}{}}}" class="ltx_Math"
                                                display="inline" id="S4.E13.m1.1">
                                                <semantics id="S4.E13.m1.1a">
                                                    <msub id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml">
                                                        <mtext id="S4.E13.m1.1.1.2" xref="S4.E13.m1.1.1.2a.cmml">FL
                                                        </mtext>
                                                        <mrow id="S4.E13.m1.1.1.3" xref="S4.E13.m1.1.1.3c.cmml">
                                                            <mtext class="ltx_font_smallcaps" id="S4.E13.m1.1.1.3a"
                                                                xref="S4.E13.m1.1.1.3c.cmml">B</mtext>
                                                            <mtext id="S4.E13.m1.1.1.3b" xref="S4.E13.m1.1.1.3c.cmml">LT
                                                            </mtext>
                                                        </mrow>
                                                    </msub><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b">
                                                        <apply id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1">
                                                            <csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.cmml"
                                                                xref="S4.E13.m1.1.1">subscript</csymbol>
                                                            <ci id="S4.E13.m1.1.1.2a.cmml" xref="S4.E13.m1.1.1.2">
                                                                <mtext id="S4.E13.m1.1.1.2.cmml" xref="S4.E13.m1.1.1.2">
                                                                    FL</mtext>
                                                            </ci>
                                                            <ci id="S4.E13.m1.1.1.3c.cmml" xref="S4.E13.m1.1.1.3">
                                                                <mrow id="S4.E13.m1.1.1.3.cmml" xref="S4.E13.m1.1.1.3">
                                                                    <mtext class="ltx_font_smallcaps"
                                                                        id="S4.E13.m1.1.1.3a.cmml" mathsize="70%"
                                                                        xref="S4.E13.m1.1.1.3">B</mtext>
                                                                    <mtext id="S4.E13.m1.1.1.3b.cmml" mathsize="70%"
                                                                        xref="S4.E13.m1.1.1.3">LT</mtext>
                                                                </mrow>
                                                            </ci>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S4.E13.m1.1c">
                                                        \displaystyle\text{FL}_{\text{{{B}LT}{}}}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">FL
                                                        start_POSTSUBSCRIPT smallcaps_B LT end_POSTSUBSCRIPT
                                                    </annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Transf. FL}(h_{\mathcal{G}},l_{\mathcal{G}},m=n_{ctx}/n_{p%
},V=0)/n_{p}" class="ltx_math_unparsed" display="inline" id="S4.E13.m2.1">
                                                <semantics id="S4.E13.m2.1a">
                                                    <mrow id="S4.E13.m2.1b">
                                                        <mo id="S4.E13.m2.1.2">=</mo>
                                                        <mtext id="S4.E13.m2.1.3">Transf. FL</mtext>
                                                        <mrow id="S4.E13.m2.1.4">
                                                            <mo id="S4.E13.m2.1.4.1" stretchy="false">(</mo>
                                                            <msub id="S4.E13.m2.1.4.2">
                                                                <mi id="S4.E13.m2.1.4.2.2">h</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E13.m2.1.4.2.3">𝒢</mi>
                                                            </msub>
                                                            <mo id="S4.E13.m2.1.4.3">,</mo>
                                                            <msub id="S4.E13.m2.1.4.4">
                                                                <mi id="S4.E13.m2.1.4.4.2">l</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E13.m2.1.4.4.3">𝒢</mi>
                                                            </msub>
                                                            <mo id="S4.E13.m2.1.4.5">,</mo>
                                                            <mi id="S4.E13.m2.1.1">m</mi>
                                                            <mo id="S4.E13.m2.1.4.6">=</mo>
                                                            <msub id="S4.E13.m2.1.4.7">
                                                                <mi id="S4.E13.m2.1.4.7.2">n</mi>
                                                                <mrow id="S4.E13.m2.1.4.7.3">
                                                                    <mi id="S4.E13.m2.1.4.7.3.2">c</mi>
                                                                    <mo id="S4.E13.m2.1.4.7.3.1">⁢</mo>
                                                                    <mi id="S4.E13.m2.1.4.7.3.3">t</mi>
                                                                    <mo id="S4.E13.m2.1.4.7.3.1a">⁢</mo>
                                                                    <mi id="S4.E13.m2.1.4.7.3.4">x</mi>
                                                                </mrow>
                                                            </msub>
                                                            <mo id="S4.E13.m2.1.4.8">/</mo>
                                                            <msub id="S4.E13.m2.1.4.9">
                                                                <mi id="S4.E13.m2.1.4.9.2">n</mi>
                                                                <mi id="S4.E13.m2.1.4.9.3">p</mi>
                                                            </msub>
                                                            <mo id="S4.E13.m2.1.4.10">,</mo>
                                                            <mi id="S4.E13.m2.1.4.11">V</mi>
                                                            <mo id="S4.E13.m2.1.4.12">=</mo>
                                                            <mn id="S4.E13.m2.1.4.13">0</mn>
                                                            <mo id="S4.E13.m2.1.4.14" stretchy="false">)</mo>
                                                        </mrow>
                                                        <mo id="S4.E13.m2.1.5">/</mo>
                                                        <msub id="S4.E13.m2.1.6">
                                                            <mi id="S4.E13.m2.1.6.2">n</mi>
                                                            <mi id="S4.E13.m2.1.6.3">p</mi>
                                                        </msub>
                                                    </mrow>
                                                    <annotation encoding="application/x-tex" id="S4.E13.m2.1c">
                                                        \displaystyle=\text{Transf.
                                                        FL}(h_{\mathcal{G}},l_{\mathcal{G}},m=n_{ctx}/n_{p%
                                                        },V=0)/n_{p}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E13.m2.1d">=
                                                        Transf. FL ( italic_h start_POSTSUBSCRIPT caligraphic_G
                                                        end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT caligraphic_G
                                                        end_POSTSUBSCRIPT , italic_m = italic_n start_POSTSUBSCRIPT
                                                        italic_c italic_t italic_x end_POSTSUBSCRIPT / italic_n
                                                        start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT , italic_V = 0 )
                                                        / italic_n start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT
                                                    </annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
                                    </tr>
                                </tbody>
                                <tbody id="S4.E14">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_eqn_cell"></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\text{Transf. FL}(h_{\mathcal{E}},l_{\mathcal{E}},m=w_{\mathcal{%
E}},V=0)" class="ltx_math_unparsed" display="inline" id="S4.E14.m1.1">
                                                <semantics id="S4.E14.m1.1a">
                                                    <mrow id="S4.E14.m1.1b">
                                                        <mo id="S4.E14.m1.1.2">+</mo>
                                                        <mtext id="S4.E14.m1.1.3">Transf. FL</mtext>
                                                        <mrow id="S4.E14.m1.1.4">
                                                            <mo id="S4.E14.m1.1.4.1" stretchy="false">(</mo>
                                                            <msub id="S4.E14.m1.1.4.2">
                                                                <mi id="S4.E14.m1.1.4.2.2">h</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E14.m1.1.4.2.3">ℰ</mi>
                                                            </msub>
                                                            <mo id="S4.E14.m1.1.4.3">,</mo>
                                                            <msub id="S4.E14.m1.1.4.4">
                                                                <mi id="S4.E14.m1.1.4.4.2">l</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E14.m1.1.4.4.3">ℰ</mi>
                                                            </msub>
                                                            <mo id="S4.E14.m1.1.4.5">,</mo>
                                                            <mi id="S4.E14.m1.1.1">m</mi>
                                                            <mo id="S4.E14.m1.1.4.6">=</mo>
                                                            <msub id="S4.E14.m1.1.4.7">
                                                                <mi id="S4.E14.m1.1.4.7.2">w</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E14.m1.1.4.7.3">ℰ</mi>
                                                            </msub>
                                                            <mo id="S4.E14.m1.1.4.8">,</mo>
                                                            <mi id="S4.E14.m1.1.4.9">V</mi>
                                                            <mo id="S4.E14.m1.1.4.10">=</mo>
                                                            <mn id="S4.E14.m1.1.4.11">0</mn>
                                                            <mo id="S4.E14.m1.1.4.12" stretchy="false">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                    <annotation encoding="application/x-tex" id="S4.E14.m1.1c">
                                                        \displaystyle+\text{Transf.
                                                        FL}(h_{\mathcal{E}},l_{\mathcal{E}},m=w_{\mathcal{%
                                                        E}},V=0)</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">+
                                                        Transf. FL ( italic_h start_POSTSUBSCRIPT caligraphic_E
                                                        end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT caligraphic_E
                                                        end_POSTSUBSCRIPT , italic_m = italic_w start_POSTSUBSCRIPT
                                                        caligraphic_E end_POSTSUBSCRIPT , italic_V = 0 )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
                                    </tr>
                                </tbody>
                                <tbody id="S4.E15">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_eqn_cell"></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\text{Transf. FL}(h_{\mathcal{D}},l_{\mathcal{D}},m=w_{\mathcal{%
D}},V=256)" class="ltx_math_unparsed" display="inline" id="S4.E15.m1.1">
                                                <semantics id="S4.E15.m1.1a">
                                                    <mrow id="S4.E15.m1.1b">
                                                        <mo id="S4.E15.m1.1.2">+</mo>
                                                        <mtext id="S4.E15.m1.1.3">Transf. FL</mtext>
                                                        <mrow id="S4.E15.m1.1.4">
                                                            <mo id="S4.E15.m1.1.4.1" stretchy="false">(</mo>
                                                            <msub id="S4.E15.m1.1.4.2">
                                                                <mi id="S4.E15.m1.1.4.2.2">h</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E15.m1.1.4.2.3">𝒟</mi>
                                                            </msub>
                                                            <mo id="S4.E15.m1.1.4.3">,</mo>
                                                            <msub id="S4.E15.m1.1.4.4">
                                                                <mi id="S4.E15.m1.1.4.4.2">l</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E15.m1.1.4.4.3">𝒟</mi>
                                                            </msub>
                                                            <mo id="S4.E15.m1.1.4.5">,</mo>
                                                            <mi id="S4.E15.m1.1.1">m</mi>
                                                            <mo id="S4.E15.m1.1.4.6">=</mo>
                                                            <msub id="S4.E15.m1.1.4.7">
                                                                <mi id="S4.E15.m1.1.4.7.2">w</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E15.m1.1.4.7.3">𝒟</mi>
                                                            </msub>
                                                            <mo id="S4.E15.m1.1.4.8">,</mo>
                                                            <mi id="S4.E15.m1.1.4.9">V</mi>
                                                            <mo id="S4.E15.m1.1.4.10">=</mo>
                                                            <mn id="S4.E15.m1.1.4.11">256</mn>
                                                            <mo id="S4.E15.m1.1.4.12" stretchy="false">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                    <annotation encoding="application/x-tex" id="S4.E15.m1.1c">
                                                        \displaystyle+\text{Transf.
                                                        FL}(h_{\mathcal{D}},l_{\mathcal{D}},m=w_{\mathcal{%
                                                        D}},V=256)</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">+
                                                        Transf. FL ( italic_h start_POSTSUBSCRIPT caligraphic_D
                                                        end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT caligraphic_D
                                                        end_POSTSUBSCRIPT , italic_m = italic_w start_POSTSUBSCRIPT
                                                        caligraphic_D end_POSTSUBSCRIPT , italic_V = 256 )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
                                    </tr>
                                </tbody>
                                <tbody id="S4.E16">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_eqn_cell"></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\text{Cross Attn. FL}(h_{\mathcal{E}},l_{\mathcal{E}},m=n_{p},r=%
n_{p}/k)\times k/n_{p}" class="ltx_math_unparsed" display="inline" id="S4.E16.m1.1">
                                                <semantics id="S4.E16.m1.1a">
                                                    <mrow id="S4.E16.m1.1b">
                                                        <mo id="S4.E16.m1.1.2">+</mo>
                                                        <mtext id="S4.E16.m1.1.3">Cross Attn. FL</mtext>
                                                        <mrow id="S4.E16.m1.1.4">
                                                            <mo id="S4.E16.m1.1.4.1" stretchy="false">(</mo>
                                                            <msub id="S4.E16.m1.1.4.2">
                                                                <mi id="S4.E16.m1.1.4.2.2">h</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E16.m1.1.4.2.3">ℰ</mi>
                                                            </msub>
                                                            <mo id="S4.E16.m1.1.4.3">,</mo>
                                                            <msub id="S4.E16.m1.1.4.4">
                                                                <mi id="S4.E16.m1.1.4.4.2">l</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E16.m1.1.4.4.3">ℰ</mi>
                                                            </msub>
                                                            <mo id="S4.E16.m1.1.4.5">,</mo>
                                                            <mi id="S4.E16.m1.1.1">m</mi>
                                                            <mo id="S4.E16.m1.1.4.6">=</mo>
                                                            <msub id="S4.E16.m1.1.4.7">
                                                                <mi id="S4.E16.m1.1.4.7.2">n</mi>
                                                                <mi id="S4.E16.m1.1.4.7.3">p</mi>
                                                            </msub>
                                                            <mo id="S4.E16.m1.1.4.8">,</mo>
                                                            <mi id="S4.E16.m1.1.4.9">r</mi>
                                                            <mo id="S4.E16.m1.1.4.10">=</mo>
                                                            <msub id="S4.E16.m1.1.4.11">
                                                                <mi id="S4.E16.m1.1.4.11.2">n</mi>
                                                                <mi id="S4.E16.m1.1.4.11.3">p</mi>
                                                            </msub>
                                                            <mo id="S4.E16.m1.1.4.12">/</mo>
                                                            <mi id="S4.E16.m1.1.4.13">k</mi>
                                                            <mo id="S4.E16.m1.1.4.14" rspace="0.055em" stretchy="false">
                                                                )</mo>
                                                        </mrow>
                                                        <mo id="S4.E16.m1.1.5" rspace="0.222em">×</mo>
                                                        <mi id="S4.E16.m1.1.6">k</mi>
                                                        <mo id="S4.E16.m1.1.7">/</mo>
                                                        <msub id="S4.E16.m1.1.8">
                                                            <mi id="S4.E16.m1.1.8.2">n</mi>
                                                            <mi id="S4.E16.m1.1.8.3">p</mi>
                                                        </msub>
                                                    </mrow>
                                                    <annotation encoding="application/x-tex" id="S4.E16.m1.1c">
                                                        \displaystyle+\text{Cross Attn.
                                                        FL}(h_{\mathcal{E}},l_{\mathcal{E}},m=n_{p},r=%
                                                        n_{p}/k)\times k/n_{p}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E16.m1.1d">+
                                                        Cross Attn. FL ( italic_h start_POSTSUBSCRIPT caligraphic_E
                                                        end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT caligraphic_E
                                                        end_POSTSUBSCRIPT , italic_m = italic_n start_POSTSUBSCRIPT
                                                        italic_p end_POSTSUBSCRIPT , italic_r = italic_n
                                                        start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT / italic_k ) ×
                                                        italic_k / italic_n start_POSTSUBSCRIPT italic_p
                                                        end_POSTSUBSCRIPT</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
                                    </tr>
                                </tbody>
                                <tbody id="S4.E17">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_eqn_cell"></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle+\text{Cross Attn. FL}(h_{\mathcal{D}},l_{\mathcal{D}},m=k,r=k/n_%
{p})" class="ltx_math_unparsed" display="inline" id="S4.E17.m1.1">
                                                <semantics id="S4.E17.m1.1a">
                                                    <mrow id="S4.E17.m1.1b">
                                                        <mo id="S4.E17.m1.1.2">+</mo>
                                                        <mtext id="S4.E17.m1.1.3">Cross Attn. FL</mtext>
                                                        <mrow id="S4.E17.m1.1.4">
                                                            <mo id="S4.E17.m1.1.4.1" stretchy="false">(</mo>
                                                            <msub id="S4.E17.m1.1.4.2">
                                                                <mi id="S4.E17.m1.1.4.2.2">h</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E17.m1.1.4.2.3">𝒟</mi>
                                                            </msub>
                                                            <mo id="S4.E17.m1.1.4.3">,</mo>
                                                            <msub id="S4.E17.m1.1.4.4">
                                                                <mi id="S4.E17.m1.1.4.4.2">l</mi>
                                                                <mi class="ltx_font_mathcaligraphic"
                                                                    id="S4.E17.m1.1.4.4.3">𝒟</mi>
                                                            </msub>
                                                            <mo id="S4.E17.m1.1.4.5">,</mo>
                                                            <mi id="S4.E17.m1.1.1">m</mi>
                                                            <mo id="S4.E17.m1.1.4.6">=</mo>
                                                            <mi id="S4.E17.m1.1.4.7">k</mi>
                                                            <mo id="S4.E17.m1.1.4.8">,</mo>
                                                            <mi id="S4.E17.m1.1.4.9">r</mi>
                                                            <mo id="S4.E17.m1.1.4.10">=</mo>
                                                            <mi id="S4.E17.m1.1.4.11">k</mi>
                                                            <mo id="S4.E17.m1.1.4.12">/</mo>
                                                            <msub id="S4.E17.m1.1.4.13">
                                                                <mi id="S4.E17.m1.1.4.13.2">n</mi>
                                                                <mi id="S4.E17.m1.1.4.13.3">p</mi>
                                                            </msub>
                                                            <mo id="S4.E17.m1.1.4.14" stretchy="false">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                    <annotation encoding="application/x-tex" id="S4.E17.m1.1c">
                                                        \displaystyle+\text{Cross Attn.
                                                        FL}(h_{\mathcal{D}},l_{\mathcal{D}},m=k,r=k/n_%
                                                        {p})</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E17.m1.1d">+
                                                        Cross Attn. FL ( italic_h start_POSTSUBSCRIPT caligraphic_D
                                                        end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT caligraphic_D
                                                        end_POSTSUBSCRIPT , italic_m = italic_k , italic_r = italic_k /
                                                        italic_n start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT )
                                                    </annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="ltx_p" id="S4.SS5.p3.7">where <math alttext="n_{ctx}" class="ltx_Math"
                                    display="inline" id="S4.SS5.p3.1.m1.1">
                                    <semantics id="S4.SS5.p3.1.m1.1a">
                                        <msub id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml">
                                            <mi id="S4.SS5.p3.1.m1.1.1.2" xref="S4.SS5.p3.1.m1.1.1.2.cmml">n</mi>
                                            <mrow id="S4.SS5.p3.1.m1.1.1.3" xref="S4.SS5.p3.1.m1.1.1.3.cmml">
                                                <mi id="S4.SS5.p3.1.m1.1.1.3.2" xref="S4.SS5.p3.1.m1.1.1.3.2.cmml">c
                                                </mi>
                                                <mo id="S4.SS5.p3.1.m1.1.1.3.1" xref="S4.SS5.p3.1.m1.1.1.3.1.cmml">⁢
                                                </mo>
                                                <mi id="S4.SS5.p3.1.m1.1.1.3.3" xref="S4.SS5.p3.1.m1.1.1.3.3.cmml">t
                                                </mi>
                                                <mo id="S4.SS5.p3.1.m1.1.1.3.1a" xref="S4.SS5.p3.1.m1.1.1.3.1.cmml">⁢
                                                </mo>
                                                <mi id="S4.SS5.p3.1.m1.1.1.3.4" xref="S4.SS5.p3.1.m1.1.1.3.4.cmml">x
                                                </mi>
                                            </mrow>
                                        </msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b">
                                            <apply id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1">
                                                <csymbol cd="ambiguous" id="S4.SS5.p3.1.m1.1.1.1.cmml"
                                                    xref="S4.SS5.p3.1.m1.1.1">subscript</csymbol>
                                                <ci id="S4.SS5.p3.1.m1.1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2">𝑛</ci>
                                                <apply id="S4.SS5.p3.1.m1.1.1.3.cmml" xref="S4.SS5.p3.1.m1.1.1.3">
                                                    <times id="S4.SS5.p3.1.m1.1.1.3.1.cmml"
                                                        xref="S4.SS5.p3.1.m1.1.1.3.1"></times>
                                                    <ci id="S4.SS5.p3.1.m1.1.1.3.2.cmml" xref="S4.SS5.p3.1.m1.1.1.3.2">
                                                        𝑐</ci>
                                                    <ci id="S4.SS5.p3.1.m1.1.1.3.3.cmml" xref="S4.SS5.p3.1.m1.1.1.3.3">
                                                        𝑡</ci>
                                                    <ci id="S4.SS5.p3.1.m1.1.1.3.4.cmml" xref="S4.SS5.p3.1.m1.1.1.3.4">
                                                        𝑥</ci>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">n_{ctx}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.1.m1.1d">italic_n
                                            start_POSTSUBSCRIPT italic_c italic_t italic_x end_POSTSUBSCRIPT
                                        </annotation>
                                    </semantics>
                                </math> is the sequence length in bytes, <math alttext="n_{p}" class="ltx_Math"
                                    display="inline" id="S4.SS5.p3.2.m2.1">
                                    <semantics id="S4.SS5.p3.2.m2.1a">
                                        <msub id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml">
                                            <mi id="S4.SS5.p3.2.m2.1.1.2" xref="S4.SS5.p3.2.m2.1.1.2.cmml">n</mi>
                                            <mi id="S4.SS5.p3.2.m2.1.1.3" xref="S4.SS5.p3.2.m2.1.1.3.cmml">p</mi>
                                        </msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b">
                                            <apply id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1">
                                                <csymbol cd="ambiguous" id="S4.SS5.p3.2.m2.1.1.1.cmml"
                                                    xref="S4.SS5.p3.2.m2.1.1">subscript</csymbol>
                                                <ci id="S4.SS5.p3.2.m2.1.1.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2">𝑛</ci>
                                                <ci id="S4.SS5.p3.2.m2.1.1.3.cmml" xref="S4.SS5.p3.2.m2.1.1.3">𝑝</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">n_{p}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.2.m2.1d">italic_n
                                            start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> is the patch size, <math alttext="r" class="ltx_Math" display="inline"
                                    id="S4.SS5.p3.3.m3.1">
                                    <semantics id="S4.SS5.p3.3.m3.1a">
                                        <mi id="S4.SS5.p3.3.m3.1.1" xref="S4.SS5.p3.3.m3.1.1.cmml">r</mi><annotation-xml
                                            encoding="MathML-Content" id="S4.SS5.p3.3.m3.1b">
                                            <ci id="S4.SS5.p3.3.m3.1.1.cmml" xref="S4.SS5.p3.3.m3.1.1">𝑟</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.3.m3.1c">r</annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.3.m3.1d">italic_r
                                        </annotation>
                                    </semantics>
                                </math> is the ratio of queries to key/values, <math alttext="k" class="ltx_Math"
                                    display="inline" id="S4.SS5.p3.4.m4.1">
                                    <semantics id="S4.SS5.p3.4.m4.1a">
                                        <mi id="S4.SS5.p3.4.m4.1.1" xref="S4.SS5.p3.4.m4.1.1.cmml">k</mi><annotation-xml
                                            encoding="MathML-Content" id="S4.SS5.p3.4.m4.1b">
                                            <ci id="S4.SS5.p3.4.m4.1.1.cmml" xref="S4.SS5.p3.4.m4.1.1">𝑘</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.4.m4.1c">k</annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.4.m4.1d">italic_k
                                        </annotation>
                                    </semantics>
                                </math> is the ratio of patch-dimension to byte-dimension i.e. the number of local model
                                splits that concatenate to form a global model representation (<math alttext="k=2"
                                    class="ltx_Math" display="inline" id="S4.SS5.p3.5.m5.1">
                                    <semantics id="S4.SS5.p3.5.m5.1a">
                                        <mrow id="S4.SS5.p3.5.m5.1.1" xref="S4.SS5.p3.5.m5.1.1.cmml">
                                            <mi id="S4.SS5.p3.5.m5.1.1.2" xref="S4.SS5.p3.5.m5.1.1.2.cmml">k</mi>
                                            <mo id="S4.SS5.p3.5.m5.1.1.1" xref="S4.SS5.p3.5.m5.1.1.1.cmml">=</mo>
                                            <mn id="S4.SS5.p3.5.m5.1.1.3" xref="S4.SS5.p3.5.m5.1.1.3.cmml">2</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.5.m5.1b">
                                            <apply id="S4.SS5.p3.5.m5.1.1.cmml" xref="S4.SS5.p3.5.m5.1.1">
                                                <eq id="S4.SS5.p3.5.m5.1.1.1.cmml" xref="S4.SS5.p3.5.m5.1.1.1"></eq>
                                                <ci id="S4.SS5.p3.5.m5.1.1.2.cmml" xref="S4.SS5.p3.5.m5.1.1.2">𝑘</ci>
                                                <cn id="S4.SS5.p3.5.m5.1.1.3.cmml" type="integer"
                                                    xref="S4.SS5.p3.5.m5.1.1.3">2</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.5.m5.1c">k=2</annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.5.m5.1d">italic_k =
                                            2</annotation>
                                    </semantics>
                                </math> in <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S3.F5"
                                    title="Figure 5 ‣ 3.2.1 Encoder Hash n-gram Embeddings ‣ 3.2 Local Encoder ‣ 3 BLT Architecture ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 5</span></a>). <math alttext="V"
                                    class="ltx_Math" display="inline" id="S4.SS5.p3.6.m6.1">
                                    <semantics id="S4.SS5.p3.6.m6.1a">
                                        <mi id="S4.SS5.p3.6.m6.1.1" xref="S4.SS5.p3.6.m6.1.1.cmml">V</mi><annotation-xml
                                            encoding="MathML-Content" id="S4.SS5.p3.6.m6.1b">
                                            <ci id="S4.SS5.p3.6.m6.1.1.cmml" xref="S4.SS5.p3.6.m6.1.1">𝑉</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.6.m6.1c">V</annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.6.m6.1d">italic_V
                                        </annotation>
                                    </semantics>
                                </math> corresponds to the vocabulary size for the output projection, which is only used
                                in the local decoder.
                                Depending on whether a module is applied on the byte or patch sequence, the attention
                                uses a different context length, <math alttext="m" class="ltx_Math" display="inline"
                                    id="S4.SS5.p3.7.m7.1">
                                    <semantics id="S4.SS5.p3.7.m7.1a">
                                        <mi id="S4.SS5.p3.7.m7.1.1" xref="S4.SS5.p3.7.m7.1.1.cmml">m</mi><annotation-xml
                                            encoding="MathML-Content" id="S4.SS5.p3.7.m7.1b">
                                            <ci id="S4.SS5.p3.7.m7.1.1.cmml" xref="S4.SS5.p3.7.m7.1.1">𝑚</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS5.p3.7.m7.1c">m</annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS5.p3.7.m7.1d">italic_m
                                        </annotation>
                                    </semantics>
                                </math>. We modify the attention <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS5.p3.7.1">flop</span>s accordingly for each component.
                                The exact equations for <span class="ltx_text ltx_font_smallcaps"
                                    id="S4.SS5.p3.7.2">flop</span>s computation for Transformer-FLOPs and
                                Cross-Attention FLOPs are provided in Appendix <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S12"
                                    title="12 FLOPs Equations ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">12</span></a>.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS6">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.6 </span>Bits-Per-Byte Estimation
                        </h3>
                        <div class="ltx_para" id="S4.SS6.p1">
                            <p class="ltx_p" id="S4.SS6.p1.3">Perplexity only makes sense in the context of a fixed
                                tokenizer as it is a measure of the uncertainty for each token. When comparing byte and
                                token-level models, following previous work <cite
                                    class="ltx_cite ltx_citemacro_citep">(Xue et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib47" title="">2022</a>; Yu et
                                    al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib48"
                                        title="">2023</a>; Wang et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib45" title="">2024</a>)</cite>,
                                we instead report Bits-Per-Byte (BPB), a tokenizer independent version of perplexity.
                                Specifically:</p>
                            <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx7">
                                <tbody id="S4.E18">
                                    <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                        <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                        <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                                alttext="\displaystyle\text{BPB}(x)" class="ltx_Math" display="inline"
                                                id="S4.E18.m1.1">
                                                <semantics id="S4.E18.m1.1a">
                                                    <mrow id="S4.E18.m1.1.2" xref="S4.E18.m1.1.2.cmml">
                                                        <mtext id="S4.E18.m1.1.2.2" xref="S4.E18.m1.1.2.2a.cmml">BPB
                                                        </mtext>
                                                        <mo id="S4.E18.m1.1.2.1" xref="S4.E18.m1.1.2.1.cmml">⁢</mo>
                                                        <mrow id="S4.E18.m1.1.2.3.2" xref="S4.E18.m1.1.2.cmml">
                                                            <mo id="S4.E18.m1.1.2.3.2.1" stretchy="false"
                                                                xref="S4.E18.m1.1.2.cmml">(</mo>
                                                            <mi id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml">x</mi>
                                                            <mo id="S4.E18.m1.1.2.3.2.2" stretchy="false"
                                                                xref="S4.E18.m1.1.2.cmml">)</mo>
                                                        </mrow>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.1b">
                                                        <apply id="S4.E18.m1.1.2.cmml" xref="S4.E18.m1.1.2">
                                                            <times id="S4.E18.m1.1.2.1.cmml" xref="S4.E18.m1.1.2.1">
                                                            </times>
                                                            <ci id="S4.E18.m1.1.2.2a.cmml" xref="S4.E18.m1.1.2.2">
                                                                <mtext id="S4.E18.m1.1.2.2.cmml" xref="S4.E18.m1.1.2.2">
                                                                    BPB</mtext>
                                                            </ci>
                                                            <ci id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1">𝑥</ci>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S4.E18.m1.1c">
                                                        \displaystyle\text{BPB}(x)</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E18.m1.1d">BPB
                                                        ( italic_x )</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{\mathcal{L}_{CE}(\boldsymbol{x})}{\ln(2)\cdot n_{\text{%
bytes}}}" class="ltx_Math" display="inline" id="S4.E18.m2.3">
                                                <semantics id="S4.E18.m2.3a">
                                                    <mrow id="S4.E18.m2.3.4" xref="S4.E18.m2.3.4.cmml">
                                                        <mi id="S4.E18.m2.3.4.2" xref="S4.E18.m2.3.4.2.cmml"></mi>
                                                        <mo id="S4.E18.m2.3.4.1" xref="S4.E18.m2.3.4.1.cmml">=</mo>
                                                        <mstyle displaystyle="true" id="S4.E18.m2.3.3"
                                                            xref="S4.E18.m2.3.3.cmml">
                                                            <mfrac id="S4.E18.m2.3.3a" xref="S4.E18.m2.3.3.cmml">
                                                                <mrow id="S4.E18.m2.1.1.1" xref="S4.E18.m2.1.1.1.cmml">
                                                                    <msub id="S4.E18.m2.1.1.1.3"
                                                                        xref="S4.E18.m2.1.1.1.3.cmml">
                                                                        <mi class="ltx_font_mathcaligraphic"
                                                                            id="S4.E18.m2.1.1.1.3.2"
                                                                            xref="S4.E18.m2.1.1.1.3.2.cmml">ℒ</mi>
                                                                        <mrow id="S4.E18.m2.1.1.1.3.3"
                                                                            xref="S4.E18.m2.1.1.1.3.3.cmml">
                                                                            <mi id="S4.E18.m2.1.1.1.3.3.2"
                                                                                xref="S4.E18.m2.1.1.1.3.3.2.cmml">C</mi>
                                                                            <mo id="S4.E18.m2.1.1.1.3.3.1"
                                                                                xref="S4.E18.m2.1.1.1.3.3.1.cmml">⁢</mo>
                                                                            <mi id="S4.E18.m2.1.1.1.3.3.3"
                                                                                xref="S4.E18.m2.1.1.1.3.3.3.cmml">E</mi>
                                                                        </mrow>
                                                                    </msub>
                                                                    <mo id="S4.E18.m2.1.1.1.2"
                                                                        xref="S4.E18.m2.1.1.1.2.cmml">⁢</mo>
                                                                    <mrow id="S4.E18.m2.1.1.1.4.2"
                                                                        xref="S4.E18.m2.1.1.1.cmml">
                                                                        <mo id="S4.E18.m2.1.1.1.4.2.1" stretchy="false"
                                                                            xref="S4.E18.m2.1.1.1.cmml">(</mo>
                                                                        <mi id="S4.E18.m2.1.1.1.1"
                                                                            xref="S4.E18.m2.1.1.1.1.cmml">𝒙</mi>
                                                                        <mo id="S4.E18.m2.1.1.1.4.2.2" stretchy="false"
                                                                            xref="S4.E18.m2.1.1.1.cmml">)</mo>
                                                                    </mrow>
                                                                </mrow>
                                                                <mrow id="S4.E18.m2.3.3.3" xref="S4.E18.m2.3.3.3.cmml">
                                                                    <mrow id="S4.E18.m2.3.3.3.4.2"
                                                                        xref="S4.E18.m2.3.3.3.4.1.cmml">
                                                                        <mi id="S4.E18.m2.2.2.2.1"
                                                                            xref="S4.E18.m2.2.2.2.1.cmml">ln</mi>
                                                                        <mo id="S4.E18.m2.3.3.3.4.2a"
                                                                            xref="S4.E18.m2.3.3.3.4.1.cmml">⁡</mo>
                                                                        <mrow id="S4.E18.m2.3.3.3.4.2.1"
                                                                            xref="S4.E18.m2.3.3.3.4.1.cmml">
                                                                            <mo id="S4.E18.m2.3.3.3.4.2.1.1"
                                                                                stretchy="false"
                                                                                xref="S4.E18.m2.3.3.3.4.1.cmml">(</mo>
                                                                            <mn id="S4.E18.m2.3.3.3.2"
                                                                                xref="S4.E18.m2.3.3.3.2.cmml">2</mn>
                                                                            <mo id="S4.E18.m2.3.3.3.4.2.1.2"
                                                                                rspace="0.055em" stretchy="false"
                                                                                xref="S4.E18.m2.3.3.3.4.1.cmml">)</mo>
                                                                        </mrow>
                                                                    </mrow>
                                                                    <mo id="S4.E18.m2.3.3.3.3" rspace="0.222em"
                                                                        xref="S4.E18.m2.3.3.3.3.cmml">⋅</mo>
                                                                    <msub id="S4.E18.m2.3.3.3.5"
                                                                        xref="S4.E18.m2.3.3.3.5.cmml">
                                                                        <mi id="S4.E18.m2.3.3.3.5.2"
                                                                            xref="S4.E18.m2.3.3.3.5.2.cmml">n</mi>
                                                                        <mtext id="S4.E18.m2.3.3.3.5.3"
                                                                            xref="S4.E18.m2.3.3.3.5.3a.cmml">bytes
                                                                        </mtext>
                                                                    </msub>
                                                                </mrow>
                                                            </mfrac>
                                                        </mstyle>
                                                    </mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m2.3b">
                                                        <apply id="S4.E18.m2.3.4.cmml" xref="S4.E18.m2.3.4">
                                                            <eq id="S4.E18.m2.3.4.1.cmml" xref="S4.E18.m2.3.4.1"></eq>
                                                            <csymbol cd="latexml" id="S4.E18.m2.3.4.2.cmml"
                                                                xref="S4.E18.m2.3.4.2">absent</csymbol>
                                                            <apply id="S4.E18.m2.3.3.cmml" xref="S4.E18.m2.3.3">
                                                                <divide id="S4.E18.m2.3.3.4.cmml" xref="S4.E18.m2.3.3">
                                                                </divide>
                                                                <apply id="S4.E18.m2.1.1.1.cmml" xref="S4.E18.m2.1.1.1">
                                                                    <times id="S4.E18.m2.1.1.1.2.cmml"
                                                                        xref="S4.E18.m2.1.1.1.2"></times>
                                                                    <apply id="S4.E18.m2.1.1.1.3.cmml"
                                                                        xref="S4.E18.m2.1.1.1.3">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S4.E18.m2.1.1.1.3.1.cmml"
                                                                            xref="S4.E18.m2.1.1.1.3">subscript</csymbol>
                                                                        <ci id="S4.E18.m2.1.1.1.3.2.cmml"
                                                                            xref="S4.E18.m2.1.1.1.3.2">ℒ</ci>
                                                                        <apply id="S4.E18.m2.1.1.1.3.3.cmml"
                                                                            xref="S4.E18.m2.1.1.1.3.3">
                                                                            <times id="S4.E18.m2.1.1.1.3.3.1.cmml"
                                                                                xref="S4.E18.m2.1.1.1.3.3.1"></times>
                                                                            <ci id="S4.E18.m2.1.1.1.3.3.2.cmml"
                                                                                xref="S4.E18.m2.1.1.1.3.3.2">𝐶</ci>
                                                                            <ci id="S4.E18.m2.1.1.1.3.3.3.cmml"
                                                                                xref="S4.E18.m2.1.1.1.3.3.3">𝐸</ci>
                                                                        </apply>
                                                                    </apply>
                                                                    <ci id="S4.E18.m2.1.1.1.1.cmml"
                                                                        xref="S4.E18.m2.1.1.1.1">𝒙</ci>
                                                                </apply>
                                                                <apply id="S4.E18.m2.3.3.3.cmml" xref="S4.E18.m2.3.3.3">
                                                                    <ci id="S4.E18.m2.3.3.3.3.cmml"
                                                                        xref="S4.E18.m2.3.3.3.3">⋅</ci>
                                                                    <apply id="S4.E18.m2.3.3.3.4.1.cmml"
                                                                        xref="S4.E18.m2.3.3.3.4.2">
                                                                        <ln id="S4.E18.m2.2.2.2.1.cmml"
                                                                            xref="S4.E18.m2.2.2.2.1"></ln>
                                                                        <cn id="S4.E18.m2.3.3.3.2.cmml" type="integer"
                                                                            xref="S4.E18.m2.3.3.3.2">2</cn>
                                                                    </apply>
                                                                    <apply id="S4.E18.m2.3.3.3.5.cmml"
                                                                        xref="S4.E18.m2.3.3.3.5">
                                                                        <csymbol cd="ambiguous"
                                                                            id="S4.E18.m2.3.3.3.5.1.cmml"
                                                                            xref="S4.E18.m2.3.3.3.5">subscript</csymbol>
                                                                        <ci id="S4.E18.m2.3.3.3.5.2.cmml"
                                                                            xref="S4.E18.m2.3.3.3.5.2">𝑛</ci>
                                                                        <ci id="S4.E18.m2.3.3.3.5.3a.cmml"
                                                                            xref="S4.E18.m2.3.3.3.5.3">
                                                                            <mtext id="S4.E18.m2.3.3.3.5.3.cmml"
                                                                                mathsize="70%"
                                                                                xref="S4.E18.m2.3.3.3.5.3">bytes</mtext>
                                                                        </ci>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S4.E18.m2.3c">
                                                        \displaystyle=\frac{\mathcal{L}_{CE}(\boldsymbol{x})}{\ln(2)\cdot
                                                        n_{\text{%
                                                        bytes}}}</annotation>
                                                    <annotation encoding="application/x-llamapun" id="S4.E18.m2.3d">=
                                                        divide start_ARG caligraphic_L start_POSTSUBSCRIPT italic_C
                                                        italic_E end_POSTSUBSCRIPT ( bold_italic_x ) end_ARG start_ARG
                                                        roman_ln ( 2 ) ⋅ italic_n start_POSTSUBSCRIPT bytes
                                                        end_POSTSUBSCRIPT end_ARG</annotation>
                                                </semantics>
                                            </math></td>
                                        <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"
                                            rowspan="1"><span
                                                class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="ltx_p" id="S4.SS6.p1.2">where the uncertainty over the data <math
                                    alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1">
                                    <semantics id="S4.SS6.p1.1.m1.1a">
                                        <mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">𝒙</mi>
                                        <annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b">
                                            <ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝒙</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">\boldsymbol{x}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">
                                            bold_italic_x</annotation>
                                    </semantics>
                                </math> as measured by the sum of the cross-entropy loss is normalized by the total
                                number of bytes in <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline"
                                    id="S4.SS6.p1.2.m2.1">
                                    <semantics id="S4.SS6.p1.2.m2.1a">
                                        <mi id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml">𝒙</mi>
                                        <annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b">
                                            <ci id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">𝒙</ci>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\boldsymbol{x}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">
                                            bold_italic_x</annotation>
                                    </semantics>
                                </math> and a constant.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS7">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.7 </span>Transformer Architecture Hyperparameters
                        </h3>
                        <div class="ltx_para" id="S4.SS7.p1">
                            <p class="ltx_p" id="S4.SS7.p1.1">For all the transformer blocks in <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS7.p1.1.1">B</span>LT, i.e. both local
                                and global models, we largely follow the architecture of Llama 3 <cite
                                    class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>;
                                we use the SwiGLU activation function <cite
                                    class="ltx_cite ltx_citemacro_citep">(Shazeer, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib38" title="">2020</a>)</cite>
                                in the feed-forward layers, rotary positional embeddings (RoPE) <cite
                                    class="ltx_cite ltx_citemacro_citep">(Su et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib40" title="">2021</a>)</cite>
                                with <math alttext="\theta=500000" class="ltx_Math" display="inline"
                                    id="S4.SS7.p1.1.m1.1">
                                    <semantics id="S4.SS7.p1.1.m1.1a">
                                        <mrow id="S4.SS7.p1.1.m1.1.1" xref="S4.SS7.p1.1.m1.1.1.cmml">
                                            <mi id="S4.SS7.p1.1.m1.1.1.2" xref="S4.SS7.p1.1.m1.1.1.2.cmml">θ</mi>
                                            <mo id="S4.SS7.p1.1.m1.1.1.1" xref="S4.SS7.p1.1.m1.1.1.1.cmml">=</mo>
                                            <mn id="S4.SS7.p1.1.m1.1.1.3" xref="S4.SS7.p1.1.m1.1.1.3.cmml">500000</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS7.p1.1.m1.1b">
                                            <apply id="S4.SS7.p1.1.m1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1">
                                                <eq id="S4.SS7.p1.1.m1.1.1.1.cmml" xref="S4.SS7.p1.1.m1.1.1.1"></eq>
                                                <ci id="S4.SS7.p1.1.m1.1.1.2.cmml" xref="S4.SS7.p1.1.m1.1.1.2">𝜃</ci>
                                                <cn id="S4.SS7.p1.1.m1.1.1.3.cmml" type="integer"
                                                    xref="S4.SS7.p1.1.m1.1.1.3">500000</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS7.p1.1.m1.1c">\theta=500000
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS7.p1.1.m1.1d">italic_θ =
                                            500000</annotation>
                                    </semantics>
                                </math> <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib46" title="">2024</a>)</cite>
                                only in self-attention layers, and RMSNorm <cite
                                    class="ltx_cite ltx_citemacro_citep">(Zhang and Sennrich, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib50" title="">2019</a>)</cite>
                                for layer normalization. We use Flash attention <cite
                                    class="ltx_cite ltx_citemacro_citep">(Dao et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib12" title="">2022</a>)</cite>
                                for all self-attention layers that use fixed-standard attention masks such as <span
                                    class="ltx_text ltx_font_italic" id="S4.SS7.p1.1.2">block causal</span> or <span
                                    class="ltx_text ltx_font_italic" id="S4.SS7.p1.1.3">fixed-window block
                                    causal</span>, and a window size of 512 for fixed-width attention masks. Since our
                                cross-attention layers involve dynamic patch-dependent masks, we use Flex Attention<span
                                    class="ltx_note ltx_role_footnote" id="footnote5"><sup
                                        class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span
                                            class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span
                                                class="ltx_tag ltx_tag_note">5</span><a
                                                class="ltx_ref ltx_url ltx_font_typewriter"
                                                href="https://pytorch.org/blog/flexattention"
                                                title="">https://pytorch.org/blog/flexattention</a></span></span></span>
                                to produce fused implementations and significantly speed up training.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S4.SS8">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">4.8 </span><span
                                class="ltx_text ltx_font_smallcaps" id="S4.SS8.1.1">B</span>LT-Specific Hyperparameters
                        </h3>
                        <div class="ltx_para" id="S4.SS8.p1">
                            <p class="ltx_p" id="S4.SS8.p1.7">To study the effectiveness of <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.7.1">B</span>LT models, we conduct
                                experiments along two directions, scaling trends, and downstream task evaluations, and
                                we consider models at different scales: 400M, 1B, 2B, 4B and 8B for these experiments.
                                The architecture hyperparameters for these models are presented in Appendix Table <a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S11.T10"
                                    title="Table 10 ‣ 11 Model Hyper Parameters ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">10</span></a>.
                                We use max-pooling to initialize the queries for the first cross-attention layer in the
                                local encoder. We use <math alttext="500,000" class="ltx_Math" display="inline"
                                    id="S4.SS8.p1.1.m1.2">
                                    <semantics id="S4.SS8.p1.1.m1.2a">
                                        <mrow id="S4.SS8.p1.1.m1.2.3.2" xref="S4.SS8.p1.1.m1.2.3.1.cmml">
                                            <mn id="S4.SS8.p1.1.m1.1.1" xref="S4.SS8.p1.1.m1.1.1.cmml">500</mn>
                                            <mo id="S4.SS8.p1.1.m1.2.3.2.1" xref="S4.SS8.p1.1.m1.2.3.1.cmml">,</mo>
                                            <mn id="S4.SS8.p1.1.m1.2.2" xref="S4.SS8.p1.1.m1.2.2.cmml">000</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.1.m1.2b">
                                            <list id="S4.SS8.p1.1.m1.2.3.1.cmml" xref="S4.SS8.p1.1.m1.2.3.2">
                                                <cn id="S4.SS8.p1.1.m1.1.1.cmml" type="integer"
                                                    xref="S4.SS8.p1.1.m1.1.1">500</cn>
                                                <cn id="S4.SS8.p1.1.m1.2.2.cmml" type="integer"
                                                    xref="S4.SS8.p1.1.m1.2.2">000</cn>
                                            </list>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.1.m1.2c">500,000
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.1.m1.2d">500 , 000
                                        </annotation>
                                    </semantics>
                                </math> hashes with a single hash function, with n-gram sizes ranging from 3 to 8, for
                                all <span class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.7.2">B</span>LT models. We
                                use a learning rate of <math alttext="4e-4" class="ltx_Math" display="inline"
                                    id="S4.SS8.p1.2.m2.1">
                                    <semantics id="S4.SS8.p1.2.m2.1a">
                                        <mrow id="S4.SS8.p1.2.m2.1.1" xref="S4.SS8.p1.2.m2.1.1.cmml">
                                            <mrow id="S4.SS8.p1.2.m2.1.1.2" xref="S4.SS8.p1.2.m2.1.1.2.cmml">
                                                <mn id="S4.SS8.p1.2.m2.1.1.2.2" xref="S4.SS8.p1.2.m2.1.1.2.2.cmml">4
                                                </mn>
                                                <mo id="S4.SS8.p1.2.m2.1.1.2.1" xref="S4.SS8.p1.2.m2.1.1.2.1.cmml">⁢
                                                </mo>
                                                <mi id="S4.SS8.p1.2.m2.1.1.2.3" xref="S4.SS8.p1.2.m2.1.1.2.3.cmml">e
                                                </mi>
                                            </mrow>
                                            <mo id="S4.SS8.p1.2.m2.1.1.1" xref="S4.SS8.p1.2.m2.1.1.1.cmml">−</mo>
                                            <mn id="S4.SS8.p1.2.m2.1.1.3" xref="S4.SS8.p1.2.m2.1.1.3.cmml">4</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.2.m2.1b">
                                            <apply id="S4.SS8.p1.2.m2.1.1.cmml" xref="S4.SS8.p1.2.m2.1.1">
                                                <minus id="S4.SS8.p1.2.m2.1.1.1.cmml" xref="S4.SS8.p1.2.m2.1.1.1">
                                                </minus>
                                                <apply id="S4.SS8.p1.2.m2.1.1.2.cmml" xref="S4.SS8.p1.2.m2.1.1.2">
                                                    <times id="S4.SS8.p1.2.m2.1.1.2.1.cmml"
                                                        xref="S4.SS8.p1.2.m2.1.1.2.1"></times>
                                                    <cn id="S4.SS8.p1.2.m2.1.1.2.2.cmml" type="integer"
                                                        xref="S4.SS8.p1.2.m2.1.1.2.2">4</cn>
                                                    <ci id="S4.SS8.p1.2.m2.1.1.2.3.cmml" xref="S4.SS8.p1.2.m2.1.1.2.3">
                                                        𝑒</ci>
                                                </apply>
                                                <cn id="S4.SS8.p1.2.m2.1.1.3.cmml" type="integer"
                                                    xref="S4.SS8.p1.2.m2.1.1.3">4</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.2.m2.1c">4e-4
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.2.m2.1d">4 italic_e
                                            - 4</annotation>
                                    </semantics>
                                </math> for all models. The choice of matching learning rate between token and <span
                                    class="ltx_text ltx_font_smallcaps" id="S4.SS8.p1.7.3">B</span>LT models follows a
                                hyperparameter search between <math alttext="1e-3" class="ltx_Math" display="inline"
                                    id="S4.SS8.p1.3.m3.1">
                                    <semantics id="S4.SS8.p1.3.m3.1a">
                                        <mrow id="S4.SS8.p1.3.m3.1.1" xref="S4.SS8.p1.3.m3.1.1.cmml">
                                            <mrow id="S4.SS8.p1.3.m3.1.1.2" xref="S4.SS8.p1.3.m3.1.1.2.cmml">
                                                <mn id="S4.SS8.p1.3.m3.1.1.2.2" xref="S4.SS8.p1.3.m3.1.1.2.2.cmml">1
                                                </mn>
                                                <mo id="S4.SS8.p1.3.m3.1.1.2.1" xref="S4.SS8.p1.3.m3.1.1.2.1.cmml">⁢
                                                </mo>
                                                <mi id="S4.SS8.p1.3.m3.1.1.2.3" xref="S4.SS8.p1.3.m3.1.1.2.3.cmml">e
                                                </mi>
                                            </mrow>
                                            <mo id="S4.SS8.p1.3.m3.1.1.1" xref="S4.SS8.p1.3.m3.1.1.1.cmml">−</mo>
                                            <mn id="S4.SS8.p1.3.m3.1.1.3" xref="S4.SS8.p1.3.m3.1.1.3.cmml">3</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.3.m3.1b">
                                            <apply id="S4.SS8.p1.3.m3.1.1.cmml" xref="S4.SS8.p1.3.m3.1.1">
                                                <minus id="S4.SS8.p1.3.m3.1.1.1.cmml" xref="S4.SS8.p1.3.m3.1.1.1">
                                                </minus>
                                                <apply id="S4.SS8.p1.3.m3.1.1.2.cmml" xref="S4.SS8.p1.3.m3.1.1.2">
                                                    <times id="S4.SS8.p1.3.m3.1.1.2.1.cmml"
                                                        xref="S4.SS8.p1.3.m3.1.1.2.1"></times>
                                                    <cn id="S4.SS8.p1.3.m3.1.1.2.2.cmml" type="integer"
                                                        xref="S4.SS8.p1.3.m3.1.1.2.2">1</cn>
                                                    <ci id="S4.SS8.p1.3.m3.1.1.2.3.cmml" xref="S4.SS8.p1.3.m3.1.1.2.3">
                                                        𝑒</ci>
                                                </apply>
                                                <cn id="S4.SS8.p1.3.m3.1.1.3.cmml" type="integer"
                                                    xref="S4.SS8.p1.3.m3.1.1.3">3</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.3.m3.1c">1e-3
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.3.m3.1d">1 italic_e
                                            - 3</annotation>
                                    </semantics>
                                </math> and <math alttext="1e-4" class="ltx_Math" display="inline"
                                    id="S4.SS8.p1.4.m4.1">
                                    <semantics id="S4.SS8.p1.4.m4.1a">
                                        <mrow id="S4.SS8.p1.4.m4.1.1" xref="S4.SS8.p1.4.m4.1.1.cmml">
                                            <mrow id="S4.SS8.p1.4.m4.1.1.2" xref="S4.SS8.p1.4.m4.1.1.2.cmml">
                                                <mn id="S4.SS8.p1.4.m4.1.1.2.2" xref="S4.SS8.p1.4.m4.1.1.2.2.cmml">1
                                                </mn>
                                                <mo id="S4.SS8.p1.4.m4.1.1.2.1" xref="S4.SS8.p1.4.m4.1.1.2.1.cmml">⁢
                                                </mo>
                                                <mi id="S4.SS8.p1.4.m4.1.1.2.3" xref="S4.SS8.p1.4.m4.1.1.2.3.cmml">e
                                                </mi>
                                            </mrow>
                                            <mo id="S4.SS8.p1.4.m4.1.1.1" xref="S4.SS8.p1.4.m4.1.1.1.cmml">−</mo>
                                            <mn id="S4.SS8.p1.4.m4.1.1.3" xref="S4.SS8.p1.4.m4.1.1.3.cmml">4</mn>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.4.m4.1b">
                                            <apply id="S4.SS8.p1.4.m4.1.1.cmml" xref="S4.SS8.p1.4.m4.1.1">
                                                <minus id="S4.SS8.p1.4.m4.1.1.1.cmml" xref="S4.SS8.p1.4.m4.1.1.1">
                                                </minus>
                                                <apply id="S4.SS8.p1.4.m4.1.1.2.cmml" xref="S4.SS8.p1.4.m4.1.1.2">
                                                    <times id="S4.SS8.p1.4.m4.1.1.2.1.cmml"
                                                        xref="S4.SS8.p1.4.m4.1.1.2.1"></times>
                                                    <cn id="S4.SS8.p1.4.m4.1.1.2.2.cmml" type="integer"
                                                        xref="S4.SS8.p1.4.m4.1.1.2.2">1</cn>
                                                    <ci id="S4.SS8.p1.4.m4.1.1.2.3.cmml" xref="S4.SS8.p1.4.m4.1.1.2.3">
                                                        𝑒</ci>
                                                </apply>
                                                <cn id="S4.SS8.p1.4.m4.1.1.3.cmml" type="integer"
                                                    xref="S4.SS8.p1.4.m4.1.1.3">4</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.4.m4.1c">1e-4
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.4.m4.1d">1 italic_e
                                            - 4</annotation>
                                    </semantics>
                                </math> at 400M and 1B model scales showing the same learning rate is optimal.
                                For scaling trends on Llama-2 data, we use training batch-sizes as recommended by <cite
                                    class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>
                                or its equivalent in bytes. For optimization, we use the AdamW optimizer <cite
                                    class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib31" title="">2017</a>)</cite>
                                with <math alttext="\beta_{1}" class="ltx_Math" display="inline" id="S4.SS8.p1.5.m5.1">
                                    <semantics id="S4.SS8.p1.5.m5.1a">
                                        <msub id="S4.SS8.p1.5.m5.1.1" xref="S4.SS8.p1.5.m5.1.1.cmml">
                                            <mi id="S4.SS8.p1.5.m5.1.1.2" xref="S4.SS8.p1.5.m5.1.1.2.cmml">β</mi>
                                            <mn id="S4.SS8.p1.5.m5.1.1.3" xref="S4.SS8.p1.5.m5.1.1.3.cmml">1</mn>
                                        </msub><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.5.m5.1b">
                                            <apply id="S4.SS8.p1.5.m5.1.1.cmml" xref="S4.SS8.p1.5.m5.1.1">
                                                <csymbol cd="ambiguous" id="S4.SS8.p1.5.m5.1.1.1.cmml"
                                                    xref="S4.SS8.p1.5.m5.1.1">subscript</csymbol>
                                                <ci id="S4.SS8.p1.5.m5.1.1.2.cmml" xref="S4.SS8.p1.5.m5.1.1.2">𝛽</ci>
                                                <cn id="S4.SS8.p1.5.m5.1.1.3.cmml" type="integer"
                                                    xref="S4.SS8.p1.5.m5.1.1.3">1</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.5.m5.1c">\beta_{1}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.5.m5.1d">italic_β
                                            start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> set to 0.9 and <math alttext="\beta_{2}" class="ltx_Math" display="inline"
                                    id="S4.SS8.p1.6.m6.1">
                                    <semantics id="S4.SS8.p1.6.m6.1a">
                                        <msub id="S4.SS8.p1.6.m6.1.1" xref="S4.SS8.p1.6.m6.1.1.cmml">
                                            <mi id="S4.SS8.p1.6.m6.1.1.2" xref="S4.SS8.p1.6.m6.1.1.2.cmml">β</mi>
                                            <mn id="S4.SS8.p1.6.m6.1.1.3" xref="S4.SS8.p1.6.m6.1.1.3.cmml">2</mn>
                                        </msub><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.6.m6.1b">
                                            <apply id="S4.SS8.p1.6.m6.1.1.cmml" xref="S4.SS8.p1.6.m6.1.1">
                                                <csymbol cd="ambiguous" id="S4.SS8.p1.6.m6.1.1.1.cmml"
                                                    xref="S4.SS8.p1.6.m6.1.1">subscript</csymbol>
                                                <ci id="S4.SS8.p1.6.m6.1.1.2.cmml" xref="S4.SS8.p1.6.m6.1.1.2">𝛽</ci>
                                                <cn id="S4.SS8.p1.6.m6.1.1.3.cmml" type="integer"
                                                    xref="S4.SS8.p1.6.m6.1.1.3">2</cn>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.6.m6.1c">\beta_{2}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.6.m6.1d">italic_β
                                            start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation>
                                    </semantics>
                                </math> to 0.95, with an <math alttext="\epsilon=10^{-8}" class="ltx_Math"
                                    display="inline" id="S4.SS8.p1.7.m7.1">
                                    <semantics id="S4.SS8.p1.7.m7.1a">
                                        <mrow id="S4.SS8.p1.7.m7.1.1" xref="S4.SS8.p1.7.m7.1.1.cmml">
                                            <mi id="S4.SS8.p1.7.m7.1.1.2" xref="S4.SS8.p1.7.m7.1.1.2.cmml">ϵ</mi>
                                            <mo id="S4.SS8.p1.7.m7.1.1.1" xref="S4.SS8.p1.7.m7.1.1.1.cmml">=</mo>
                                            <msup id="S4.SS8.p1.7.m7.1.1.3" xref="S4.SS8.p1.7.m7.1.1.3.cmml">
                                                <mn id="S4.SS8.p1.7.m7.1.1.3.2" xref="S4.SS8.p1.7.m7.1.1.3.2.cmml">10
                                                </mn>
                                                <mrow id="S4.SS8.p1.7.m7.1.1.3.3" xref="S4.SS8.p1.7.m7.1.1.3.3.cmml">
                                                    <mo id="S4.SS8.p1.7.m7.1.1.3.3a" xref="S4.SS8.p1.7.m7.1.1.3.3.cmml">
                                                        −</mo>
                                                    <mn id="S4.SS8.p1.7.m7.1.1.3.3.2"
                                                        xref="S4.SS8.p1.7.m7.1.1.3.3.2.cmml">8</mn>
                                                </mrow>
                                            </msup>
                                        </mrow><annotation-xml encoding="MathML-Content" id="S4.SS8.p1.7.m7.1b">
                                            <apply id="S4.SS8.p1.7.m7.1.1.cmml" xref="S4.SS8.p1.7.m7.1.1">
                                                <eq id="S4.SS8.p1.7.m7.1.1.1.cmml" xref="S4.SS8.p1.7.m7.1.1.1"></eq>
                                                <ci id="S4.SS8.p1.7.m7.1.1.2.cmml" xref="S4.SS8.p1.7.m7.1.1.2">italic-ϵ
                                                </ci>
                                                <apply id="S4.SS8.p1.7.m7.1.1.3.cmml" xref="S4.SS8.p1.7.m7.1.1.3">
                                                    <csymbol cd="ambiguous" id="S4.SS8.p1.7.m7.1.1.3.1.cmml"
                                                        xref="S4.SS8.p1.7.m7.1.1.3">superscript</csymbol>
                                                    <cn id="S4.SS8.p1.7.m7.1.1.3.2.cmml" type="integer"
                                                        xref="S4.SS8.p1.7.m7.1.1.3.2">10</cn>
                                                    <apply id="S4.SS8.p1.7.m7.1.1.3.3.cmml"
                                                        xref="S4.SS8.p1.7.m7.1.1.3.3">
                                                        <minus id="S4.SS8.p1.7.m7.1.1.3.3.1.cmml"
                                                            xref="S4.SS8.p1.7.m7.1.1.3.3"></minus>
                                                        <cn id="S4.SS8.p1.7.m7.1.1.3.3.2.cmml" type="integer"
                                                            xref="S4.SS8.p1.7.m7.1.1.3.3.2">8</cn>
                                                    </apply>
                                                </apply>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S4.SS8.p1.7.m7.1c">\epsilon=10^{-8}
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S4.SS8.p1.7.m7.1d">italic_ϵ =
                                            10 start_POSTSUPERSCRIPT - 8 end_POSTSUPERSCRIPT</annotation>
                                    </semantics>
                                </math>. We use a linear warm-up of 2000 steps with an cosine decay schedule of the
                                learning rate to 0, we apply a weight decay of 0.1, and global gradient clipping at a
                                threshold of 1.0.</p>
                        </div>
                    </section>
                </section>
                <section class="ltx_section" id="S5">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">5 </span>Scaling Trends
                    </h2>
                    <div class="ltx_para" id="S5.p1">
                        <p class="ltx_p" id="S5.p1.1">We present a holistic picture of the scaling trends of byte-level
                            models that can inform further scaling of <span class="ltx_text ltx_font_smallcaps"
                                id="S5.p1.1.1">B</span>LT models.
                            Our scaling study aims to address the limitations of previous research on byte-level models
                            in the following ways: (a) We compare trends for the compute-optimal training regime, (b) We
                            train matching 8B models on non-trivial amounts of training data (up to 1T tokens/4T bytes)
                            and evaluate on downstream tasks, and (c) We measure scaling trends in inference-cost
                            controlled settings.
                            In a later section, we will investigate specific advantages from modeling byte-sequences.
                        </p>
                    </div>
                    <figure class="ltx_figure" id="S5.F6">
                        <div class="ltx_flex_figure">
                            <div class="ltx_flex_cell ltx_flex_size_2">
                                <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.1"><img
                                        alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="582"
                                        id="S5.F6.1.g1" src="x6.png" width="830" />
                                </figure>
                            </div>
                            <div class="ltx_flex_cell ltx_flex_size_2">
                                <figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.2"><img
                                        alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="582"
                                        id="S5.F6.2.g1" src="x7.png" width="830" />
                                </figure>
                            </div>
                        </div>
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S5.F6.8.1.1" style="font-size:90%;">Figure 6</span>:
                            </span><span class="ltx_text" id="S5.F6.9.2" style="font-size:90%;">Scaling trends for <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.F6.9.2.1">B</span>LT models with
                                different architectural choices, as well as for baseline BPE token-based models. We
                                train models at multiple scales from 1B up to 8B parameters for the optimal number of
                                tokens as computed by <cite class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib13"
                                        title="">2024</a>)</cite> and report bits-per-byte on a sample from the training
                                distribution. <span class="ltx_text ltx_font_smallcaps" id="S5.F6.9.2.2">B</span>LT
                                models perform on par with state-of-the-art tokenizer-based models such as Llama 3, at
                                scale. PS denotes patch size. We illustrate separate architecture improvements on
                                space-patching (<span class="ltx_text ltx_font_bold" id="S5.F6.9.2.3">left</span>) and
                                combine them with dynamic patching (<span class="ltx_text ltx_font_bold"
                                    id="S5.F6.9.2.4">right</span>).</span></figcaption>
                    </figure>
                    <section class="ltx_subsection" id="S5.SS1">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">5.1 </span>Parameter Matched Compute Optimal
                            Scaling Trends
                        </h3>
                        <div class="ltx_para" id="S5.SS1.p1">
                            <p class="ltx_p" id="S5.SS1.p1.1">Using the Llama 2 dataset, we train various <span
                                    class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.1">compute-optimal</span> <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.2">bpe</span> and <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.3">B</span>LT models across four
                                different sizes, ranging from 1B to 8B parameters. We then plot the training <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.4">flop</span>s against language
                                modeling performance on a representative subset of the training data mixture.
                                The <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.5">bpe</span> models are
                                trained using the optimal ratio of model parameters to training data, as determined by
                                Llama 3 <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>.
                                This <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.6">compute-optimal</span>
                                setup is theoretically designed to achieve the best performance on the training dataset
                                within a given training budget <cite class="ltx_cite ltx_citemacro_citep">(Hoffmann et
                                    al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib21"
                                        title="">2022</a>)</cite>, providing a robust baseline for our model.
                                For each <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.7">bpe</span> model,
                                we also train a corresponding <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p1.1.8">B</span>LT model on the same data, using a Latent Transformer
                                that matches the size and architecture of the corresponding <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p1.1.9">bpe</span> Transformer.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS1.p2">
                            <p class="ltx_p" id="S5.SS1.p2.1">As illustrated in <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.F6"
                                    title="Figure 6 ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 6</span></a> (right), <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.1">B</span>LT models either
                                match or outperform their <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p2.1.2">bpe</span> counterparts and this trend holds as we scale model
                                size and <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.3">flop</span>s. To
                                the best of our knowledge, <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p2.1.4">B</span>LT is the first byte-level Transformer architecture to
                                achieve matching scaling trends with BPE-based models at compute optimal regimes. This
                                therefore validates our assumption that the optimal ratio of parameters to training
                                compute for <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.5">bpe</span> also
                                applies to <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p2.1.6">B</span>LT, or
                                at least it is not too far off.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS1.p3">
                            <p class="ltx_p" id="S5.SS1.p3.1">Both architectural improvements and dynamic patching are
                                crucial to match <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.1.1">bpe</span>
                                scaling trends. In <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.F6"
                                    title="Figure 6 ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 6</span></a> (left), we compare
                                space-patching-based models against Llama 3. We approximate SpaceByte <cite
                                    class="ltx_cite ltx_citemacro_citep">(Slagle, <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#bib.bib39" title="">2024</a>)</cite>
                                using <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.1.2">B</span>LT
                                space-patching without n-gram embeddings and cross-attention.
                                Although SpaceByte improves over Megabyte, it remains far from Llama 3. In <a
                                    class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.F6"
                                    title="Figure 6 ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 6</span></a> (right), we illustrate the
                                improvements from both architectural changes and dynamic patching. <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p3.1.3">B</span>LT models perform on
                                par with state-of-the-art tokenizer-based models such as Llama 3, at scale.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS1.p4">
                            <p class="ltx_p" id="S5.SS1.p4.1">We also observe the effects of the choice of tokenizer on
                                performance for tokenizer-based models, i.e., models trained with the Llama-3 tokenizer
                                outperform those trained using the Llama-2 tokenizer on the same training data.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS1.p5">
                            <p class="ltx_p" id="S5.SS1.p5.1">Finally, our <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p5.1.1">B</span>LT architecture trends between Llama 2 and 3 when using
                                significantly larger patch sizes. The <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p5.1.2">bpe</span> tokenizers of Llama 2 and 3 have an average token size
                                of 3.7 and 4.4 bytes. In contrast, <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p5.1.3">B</span>LT can achieve similar scaling trends with an average
                                patch size of 6 and even 8 bytes. Inference <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p5.1.4">flop</span> are inversely proportional to the average patch size,
                                so using a patch size of 8 bytes would lead to nearly 50% inference <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.5">flop</span> savings.
                                Models with larger patch sizes also seem to perform better as we scale model and data
                                size. <span class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.6">B</span>LT with patch
                                size of 8 starts at a significantly worse point compared to <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS1.p5.1.7">bpe</span> Llama 2 at 1B but
                                ends up better than <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS1.p5.1.8">bpe</span> at 7B scale. This suggests that such patch sizes might
                                perform better at even larger scales and possibly that even larger ones could be
                                feasible as model size and training compute grow.</p>
                        </div>
                    </section>
                    <section class="ltx_subsection" id="S5.SS2">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">5.2 </span>Beyond Compute Optimal Task Evaluations
                        </h3>
                        <div class="ltx_para" id="S5.SS2.p1">
                            <p class="ltx_p" id="S5.SS2.p1.1">To assess scaling properties further, we train an 8B <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS2.p1.1.1">B</span>LT model beyond the
                                compute optimal ratio on the <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS2.p1.1.2">B</span>LT-1T dataset, a larger higher-quality dataset, and
                                measure performance on a suite of standard classification and generation benchmarks. For
                                evaluation, we select the following common sense reasoning, world knowledge, and code
                                generation tasks:</p>
                        </div>
                        <section class="ltx_paragraph" id="S5.SS2.SSS0.Px1">
                            <h5 class="ltx_title ltx_title_paragraph">Classification tasks</h5>
                            <div class="ltx_para" id="S5.SS2.SSS0.Px1.p1">
                                <p class="ltx_p" id="S5.SS2.SSS0.Px1.p1.1">include ARC-Easy (0-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib10"
                                            title="">2018</a>)</cite>, Arc-Challenge (0-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Clark et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib10"
                                            title="">2018</a>)</cite>, HellaSwag (0-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Zellers et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib49"
                                            title="">2019</a>)</cite>, PIQA (0-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Bisk et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib4"
                                            title="">2020</a>)</cite>, and MMLU (5-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib20"
                                            title="">2020</a>)</cite>. We employ a prompt-scoring method, calculating
                                    the likelihood over choice characters, and report the average accuracy.</p>
                            </div>
                        </section>
                        <section class="ltx_paragraph" id="S5.SS2.SSS0.Px2">
                            <h5 class="ltx_title ltx_title_paragraph">Coding related generation tasks:</h5>
                            <div class="ltx_para" id="S5.SS2.SSS0.Px2.p1">
                                <p class="ltx_p" id="S5.SS2.SSS0.Px2.p1.1">We report pass@1 scores on MBPP (3-shot)
                                    <cite class="ltx_cite ltx_citemacro_citep">(Austin et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib2"
                                            title="">2021</a>)</cite> and HumanEval (0-shot) <cite
                                        class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib6"
                                            title="">2021</a>)</cite>, to evaluate the ability of LLMs to generate
                                    Python code.</p>
                            </div>
                            <figure class="ltx_table" id="S5.T1">
                                <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle"
                                    id="S5.T1.2">
                                    <thead class="ltx_thead">
                                        <tr class="ltx_tr" id="S5.T1.2.1.1">
                                            <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T1.2.1.1.1"></th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S5.T1.2.1.1.2">
                                                <table class="ltx_tabular ltx_align_middle" id="S5.T1.2.1.1.2.1">
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.2.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.2.1.1.1">Llama 3</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.2.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.2.1.2.1">1T Tokens</td>
                                                    </tr>
                                                </table>
                                            </th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S5.T1.2.1.1.3">
                                                <table class="ltx_tabular ltx_align_middle" id="S5.T1.2.1.1.3.1">
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.3.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.3.1.1.1">
                                                            <span class="ltx_text ltx_font_smallcaps"
                                                                id="S5.T1.2.1.1.3.1.1.1.1">B</span>LT-Space
                                                        </td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.3.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.3.1.2.1">6T Bytes</td>
                                                    </tr>
                                                </table>
                                            </th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S5.T1.2.1.1.4">
                                                <table class="ltx_tabular ltx_align_middle" id="S5.T1.2.1.1.4.1">
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.4.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.4.1.1.1">
                                                            <span class="ltx_text ltx_font_smallcaps"
                                                                id="S5.T1.2.1.1.4.1.1.1.1">B</span>LT-Entropy
                                                        </td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S5.T1.2.1.1.4.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S5.T1.2.1.1.4.1.2.1">4.5T Bytes</td>
                                                    </tr>
                                                </table>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="ltx_tbody">
                                        <tr class="ltx_tr" id="S5.T1.2.2.1">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                                id="S5.T1.2.2.1.1"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.2.1.1.1">Arc-E</span></th>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.2.1.2">77.6
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.2.1.3">75.4
                                            </td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"
                                                id="S5.T1.2.2.1.4"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.2.1.4.1">79.6</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.3.2">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.3.2.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.3.2.1.1">Arc-C</span>
                                            </th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.3.2.2"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.3.2.2.1">53.3</span></td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.3.2.3">49.8</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.3.2.4">52.1</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.4.3">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.4.3.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.4.3.1.1">HellaSwag</span>
                                            </th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.4.3.2">79.1</td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.4.3.3">79.6</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.4.3.4"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.4.3.4.1">80.6</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.5.4">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.5.4.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.5.4.1.1">PIQA</span></th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.5.4.2">80.7</td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.5.4.3"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.5.4.3.1">81.1</span></td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.5.4.4">80.6</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.6.5">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.6.5.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.6.5.1.1">MMLU</span></th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.6.5.2"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.6.5.2.1">58.1</span></td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.6.5.3">54.8</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.6.5.4">57.4</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.7.6">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.7.6.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.7.6.1.1">MBPP</span></th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.7.6.2">40.2</td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.7.6.3">37.6</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.7.6.4"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.7.6.4.1">41.8</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.8.7">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.2.8.7.1"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.8.7.1.1">HumanEval</span>
                                            </th>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.8.7.2">31.1</td>
                                            <td class="ltx_td ltx_align_center" id="S5.T1.2.8.7.3">27.4</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.2.8.7.4"><span
                                                    class="ltx_text ltx_font_bold" id="S5.T1.2.8.7.4.1">35.4</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.9.8">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                                id="S5.T1.2.9.8.1"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.9.8.1.1">Average</span></th>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.9.8.2">60.0
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.2.9.8.3">58.0
                                            </td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"
                                                id="S5.T1.2.9.8.4"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.9.8.4.1">61.1</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S5.T1.2.10.9">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"
                                                id="S5.T1.2.10.9.1"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.10.9.1.1">Bytes/Patch on Train Mix</span></th>
                                            <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"
                                                id="S5.T1.2.10.9.2">4.4</td>
                                            <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"
                                                id="S5.T1.2.10.9.3"><span class="ltx_text ltx_font_bold"
                                                    id="S5.T1.2.10.9.3.1">6.1</span></td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"
                                                id="S5.T1.2.10.9.4">4.5</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                            class="ltx_text" id="S5.T1.9.1.1" style="font-size:90%;">Table 1</span>:
                                    </span><span class="ltx_text" id="S5.T1.10.2" style="font-size:90%;">Comparison of
                                        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.10.2.1">flop</span>-matched
                                        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.10.2.2">B</span>LT <span
                                            class="ltx_text ltx_font_bold" id="S5.T1.10.2.3">8B</span> models trained on
                                        the <span class="ltx_text ltx_font_smallcaps" id="S5.T1.10.2.4">B</span>LT-1T
                                        dataset comprising high-quality tokens of text and code from publicly available
                                        sources, with baseline models using the Llama 3 tokenizer. <span
                                            class="ltx_text ltx_font_smallcaps" id="S5.T1.10.2.5">B</span>LT performs
                                        better than Llama 3 on average, and depending on the patching scheme, achieves
                                        significant <span class="ltx_text ltx_font_smallcaps"
                                            id="S5.T1.10.2.6">flop</span>s savings with a minor reduction in
                                        performance.</span></figcaption>
                            </figure>
                            <div class="ltx_para" id="S5.SS2.SSS0.Px2.p2">
                                <p class="ltx_p" id="S5.SS2.SSS0.Px2.p2.1">In <a class="ltx_ref ltx_refmacro_autoref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.T1"
                                        title="Table 1 ‣ Coding related generation tasks: ‣ 5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">Table 1</span></a>, we compare three models
                                    trained on the <span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p2.1.1">B</span>LT-1T dataset: a <span
                                        class="ltx_text ltx_font_smallcaps" id="S5.SS2.SSS0.Px2.p2.1.2">bpe</span> Llama
                                    3 tokenizer-based model,<span class="ltx_note ltx_role_footnote" id="footnote6"><sup
                                            class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span
                                                class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span
                                                    class="ltx_tag ltx_tag_note">6</span>We choose the Llama 3 tokenizer
                                                with its 128k vocabulary as it performs better than Llama 2’s 32k
                                                vocabulary.</span></span></span> and two variants of the <span
                                        class="ltx_text ltx_font_smallcaps" id="S5.SS2.SSS0.Px2.p2.1.3">B</span>LT
                                    model. One employing a space-patching scheme (<span
                                        class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p2.1.4">B</span>LT-Space) and another utilizing an
                                    entropy-based patching scheme (<span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p2.1.5">B</span>LT-Entropy). with approx. monotonicity
                                    constraint and reset the context of the entropy model with new lines (as discussed
                                    in <a class="ltx_ref ltx_refmacro_autoref"
                                        href="https://arxiv.org/html/2412.09871v1#S4.SS4"
                                        title="4.4 Entropy Model Context ‣ 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">subsection 4.4</span></a>). All three models
                                    are trained with an equivalent <span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p2.1.6">flop</span> budget. However, with <span
                                        class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p2.1.7">B</span>LT-Entropy we additionally make an inference
                                    time adjustment of the entropy threshold from 0.6 to 0.1 which we find to improve
                                    task performance at the cost of more inference steps.</p>
                            </div>
                            <div class="ltx_para" id="S5.SS2.SSS0.Px2.p3">
                                <p class="ltx_p" id="S5.SS2.SSS0.Px2.p3.1">The <span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p3.1.1">B</span>LT-Entropy model outperforms the Llama 3
                                    model on 4 out of 7 tasks while being trained on the same number of bytes. This
                                    improvement is like due to a combination of (1) a better use of training compute via
                                    dynamic patching, and (2) the direct modeling of byte-level information as opposed
                                    to tokens.</p>
                            </div>
                            <div class="ltx_para" id="S5.SS2.SSS0.Px2.p4">
                                <p class="ltx_p" id="S5.SS2.SSS0.Px2.p4.1">On the other hand, <span
                                        class="ltx_text ltx_font_smallcaps" id="S5.SS2.SSS0.Px2.p4.1.1">B</span>LT-Space
                                    underperforms the Llama 3 tokenizer on all but one task, but it achieves a
                                    significant reduction in inference <span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p4.1.2">flop</span>s with its larger average patch size of 6
                                    bytes.
                                    In comparison, the <span class="ltx_text ltx_font_smallcaps"
                                        id="S5.SS2.SSS0.Px2.p4.1.3">bpe</span> and entropy-patching based models have
                                    roughly equivalent average patch size of approximately 4.5 bytes on the training
                                    data mix. With the same training budget, the larger patch size model covers 30% more
                                    data than the other two models which might push <span
                                        class="ltx_text ltx_font_smallcaps" id="S5.SS2.SSS0.Px2.p4.1.4">B</span>LT
                                    further away from the compute-optimal point.</p>
                            </div>
                            <figure class="ltx_table" id="S5.T2">
                                <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.2"
                                    style="width:433.6pt;height:44.4pt;vertical-align:-0.8pt;"><span
                                        class="ltx_transformed_inner"
                                        style="transform:translate(-51.7pt,5.2pt) scale(0.807442822025978,0.807442822025978) ;">
                                        <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.2.1">
                                            <thead class="ltx_thead">
                                                <tr class="ltx_tr" id="S5.T2.2.1.1.1">
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.1">Llama 2</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.2">Llama 3</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.3">Entropy ps=6</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.4">Entropy ps=8</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.5">Inference <span
                                                            class="ltx_text ltx_font_smallcaps"
                                                            id="S5.T2.2.1.1.1.5.1">flop</span>s</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.6">Compute Optimal (Bytes)</th>
                                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                                        id="S5.T2.2.1.1.1.7">Crossover (Bytes)</th>
                                                </tr>
                                            </thead>
                                            <tbody class="ltx_tbody">
                                                <tr class="ltx_tr" id="S5.T2.2.1.2.1">
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.1">
                                                        470m</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.2">
                                                        450m</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.3">
                                                        610m (1.2x)</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.4">
                                                        760m (1.6x)</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.5">
                                                        3.1E8</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.6">
                                                        50B</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.2.1.2.1.7">
                                                        150B</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S5.T2.2.1.3.2">
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.1">3.6B</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.2">3.9B</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.3">5.2B (1.3x)</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.4">6.6B (1.7x)</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.5">2.1E9</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.6">400B</td>
                                                    <td class="ltx_td ltx_align_left ltx_border_bb"
                                                        id="S5.T2.2.1.3.2.7">1T</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </span></div>
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                            class="ltx_text" id="S5.T2.5.1.1" style="font-size:90%;">Table 2</span>:
                                    </span><span class="ltx_text" id="S5.T2.6.2" style="font-size:90%;">Details of
                                        models used in the fixed-inference scaling study. We report non-embedding
                                        parameters for each model and their relative number compared to Llama 2. We pick
                                        model sizes with equal inference <span class="ltx_text ltx_font_smallcaps"
                                            id="S5.T2.6.2.1">flop</span>s per byte. We also indicate BPE’s
                                        compute-optimal training data quantity and the crossover point where <span
                                            class="ltx_text ltx_font_smallcaps" id="S5.T2.6.2.2">B</span>LT surpasses
                                        BPE as seen in <a class="ltx_ref ltx_refmacro_autoref"
                                            href="https://arxiv.org/html/2412.09871v1#S1.F1"
                                            title="Figure 1 ‣ 1 Introduction ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                                class="ltx_text ltx_ref_tag">Figure 1</span></a> (both expressed in
                                        bytes of training data). This point is achieved at much smaller scales compared
                                        to many modern training budgets.</span></figcaption>
                            </figure>
                        </section>
                    </section>
                    <section class="ltx_subsection" id="S5.SS3">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">5.3 </span>Patches Scale Better Than Tokens
                        </h3>
                        <div class="ltx_para" id="S5.SS3.p1">
                            <p class="ltx_p" id="S5.SS3.p1.1">With <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p1.1.1">B</span>LT models, we can simultaneously increase model size and
                                patch size while maintaining the same training and inference <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS3.p1.1.2">flop</span> budget and
                                keeping the amount of training data constant. Arbitrarily increasing the patch size is a
                                unique feature of patch-based models which break free of the efficiency tradeoffs of
                                fixed-vocabulary token-based models, as discussed in Section <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S2.SS4"
                                    title="2.4 The Byte-Pair Encoding (BPE) Tokenizer and Incremental Patching ‣ 2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">2.4</span></a>. Longer patch sizes save compute,
                                which can be reallocated to grow the size of the global latent transformer, because it
                                is run less often.</p>
                        </div>
                        <figure class="ltx_table" id="S5.T3">
                            <table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T3.2">
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S5.T3.2.1.1">
                                        <td class="ltx_td ltx_border_tt" id="S5.T3.2.1.1.1"></td>
                                        <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.2.1.1.2">
                                            <table class="ltx_tabular ltx_align_middle" id="S5.T3.2.1.1.2.1">
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.2.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.2.1.1.1">Llama 3</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.2.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.2.1.2.1">(1T tokens)</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.2.1.1.3">
                                            <table class="ltx_tabular ltx_align_middle" id="S5.T3.2.1.1.3.1">
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.3.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.3.1.1.1">Llama 3.1</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.3.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.3.1.2.1">(16T tokens)</td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.2.1.1.4">
                                            <table class="ltx_tabular ltx_align_middle" id="S5.T3.2.1.1.4.1">
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.4.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.4.1.1.1">
                                                        <span class="ltx_text ltx_font_smallcaps"
                                                            id="S5.T3.2.1.1.4.1.1.1.1">B</span>LT
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S5.T3.2.1.1.4.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S5.T3.2.1.1.4.1.2.1">(1T tokens)</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.2.2">
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.2.2.2.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.2.2.1.1">HellaSwag
                                                Original</span></td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.2.2.2">79.1</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.2.2.3"><em
                                                class="ltx_emph ltx_font_italic" id="S5.T3.2.2.2.3.1">80.7</em></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T3.2.2.2.4">
                                            <span class="ltx_text ltx_font_bold" id="S5.T3.2.2.2.4.1">80.6</span></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.3.3">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.3.3.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.3.3.1.1">HellaSwag Noise
                                                Avg.</span></td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.3.3.2">56.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.3.3.3">64.3</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.3.3.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.3.3.4.1">64.3</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.4.4">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.4.4.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.4.4.1.1">- AntSpeak</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.4.4.2">45.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.4.4.3"><em
                                                class="ltx_emph ltx_font_italic" id="S5.T3.2.4.4.3.1">61.3</em></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.4.4.4"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.4.4.4.1">57.9</span></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.5.5">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.5.5.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.5.5.1.1">- Drop</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.5.5.2">53.8</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.5.5.3">57.3</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.5.5.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.5.5.4.1">58.2</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.6.6">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.6.6.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.6.6.1.1">- RandomCase</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.6.6.2">55.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.6.6.3">65.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.6.6.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.6.6.4.1">65.7</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.7.7">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.7.7.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.7.7.1.1">- Repeat</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.7.7.2">57.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.7.7.3">61.5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.7.7.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.7.7.4.1">66.6</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.8.8">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.8.8.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.8.8.1.1">- UpperCase</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.8.8.2">72.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.8.8.3">76.5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.8.8.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.8.8.4.1">77.3</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.9.9">
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.2.9.9.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.9.9.1.1">Phonology-G2P</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.9.9.2">11.8</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.9.9.3"><em
                                                class="ltx_emph ltx_font_italic" id="S5.T3.2.9.9.3.1">18.9</em></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T3.2.9.9.4">
                                            <span class="ltx_text ltx_font_bold" id="S5.T3.2.9.9.4.1">13.0</span></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.10.10">
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.2.10.10.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.10.10.1.1">CUTE</span></td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.10.10.2">27.5</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.2.10.10.3">20.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"
                                            id="S5.T3.2.10.10.4"><em class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.10.10.4.1">54.1</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.11.11">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.11.11.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.11.11.1.1">- Contains
                                                Char</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.11.11.2">0.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.11.11.3">0.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.11.11.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.11.11.4.1">55.9</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.12.12">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.12.12.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.12.12.1.1">- Contains
                                                Word</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.12.12.2">55.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.12.12.3">21.6</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.12.12.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.12.12.4.1">73.5</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.13.13">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.13.13.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.13.13.1.1">- Del Char</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.13.13.2">34.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.13.13.3">34.3</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.13.13.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.13.13.4.1">35.9</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.14.14">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.14.14.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.14.14.1.1">- Del Word</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.14.14.2"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.14.14.2.1">75.5</span></td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.14.14.3"><em
                                                class="ltx_emph ltx_font_italic" id="S5.T3.2.14.14.3.1">84.5</em></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.14.14.4">56.1</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.15.15">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.15.15.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.15.15.1.1">- Ins Char</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.15.15.2">7.5</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.15.15.3">0.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.15.15.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.15.15.4.1">7.6</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.16.16">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.16.16.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.16.16.1.1">- Ins Word</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.16.16.2"><span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.16.16.2.1">33.5</span></td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.16.16.3"><em
                                                class="ltx_emph ltx_font_italic" id="S5.T3.2.16.16.3.1">63.3</em></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.16.16.4">31.2</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.17.17">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.17.17.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.17.17.1.1">-
                                                Orthography</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.17.17.2">43.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.17.17.3">0.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.17.17.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.17.17.4.1">52.4</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.18.18">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.18.18.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.18.18.1.1">- Semantic</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.18.18.2">65</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.18.18.3">0.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.18.18.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.18.18.4.1">90.5</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.19.19">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.19.19.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.19.19.1.1">- Spelling</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.19.19.2">1.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.19.19.3">-</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.19.19.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.19.19.4.1">99.9</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.20.20">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.20.20.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.20.20.1.1">- Spelling
                                                Inverse</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.20.20.2">30.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.20.20.3">3.6</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.20.20.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.20.20.4.1">99.9</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.21.21">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.21.21.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.21.21.1.1">- Substitute
                                                Char</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.21.21.2">0.4</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.21.21.3">1.2</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.21.21.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.21.21.4.1">48.7</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.22.22">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.22.22.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.22.22.1.1">- Substitute
                                                Word</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.22.22.2">16.4</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.22.22.3">6.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.22.22.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.22.22.4.1">72.8</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.23.23">
                                        <td class="ltx_td ltx_align_left" id="S5.T3.2.23.23.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.23.23.1.1">- Swap Char</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.23.23.2">2.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T3.2.23.23.3">2.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.2.23.23.4"><em
                                                class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.23.23.4.1">11.5</em></td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T3.2.24.24">
                                        <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.2.24.24.1"> <span
                                                class="ltx_text ltx_font_bold" id="S5.T3.2.24.24.1.1">- Swap Word</span>
                                        </td>
                                        <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.2.24.24.2">20.1</td>
                                        <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.2.24.24.3">4.1</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"
                                            id="S5.T3.2.24.24.4"><em class="ltx_emph ltx_font_bold ltx_font_italic"
                                                id="S5.T3.2.24.24.4.1">21</em></td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S5.T3.5.1.1" style="font-size:90%;">Table 3</span>:
                                </span><span class="ltx_text" id="S5.T3.6.2" style="font-size:90%;">We compare our 8B
                                    <span class="ltx_text ltx_font_smallcaps" id="S5.T3.6.2.1">B</span>LT model to 8B
                                    BPE Llama 3 trained on 1T tokens on tasks that assess robustness to noise and
                                    awareness of the constituents of language (best result bold). We also report the
                                    performance of Llama 3.1 on the same tasks and underline best result overall. <span
                                        class="ltx_text ltx_font_smallcaps" id="S5.T3.6.2.2">B</span>LT outperforms the
                                    Llama 3 BPE model by a large margin and even improves over Llama 3.1 in many tasks
                                    indicating that the byte-level awareness is not something that can easily be
                                    obtained with more data.</span></figcaption>
                        </figure>
                        <div class="ltx_para" id="S5.SS3.p2">
                            <p class="ltx_p" id="S5.SS3.p2.1">We conduct a fixed inference scaling study to test the
                                hypothesis that larger models taking fewer steps on larger patches might perform better
                                than smaller models taking more steps. Starting from model sizes of 400m and 3.6B
                                parameters with the Llama 2 tokenizer, we find <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p2.1.1">flop</span> equivalent models with the Llama 3 tokenizer and
                                <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p2.1.2">B</span>LT-Entropy models
                                with average patch sizes of 6 and 8 bytes on the training datamix (see <a
                                    class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.T2"
                                    title="Table 2 ‣ Coding related generation tasks: ‣ 5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Table 2</span></a> for model details). For patch
                                size 8 models, we use 3 encoder layers instead of 1. We train each model for various
                                training <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p2.1.3">flop</span>
                                budgets.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS3.p3">
                            <p class="ltx_p" id="S5.SS3.p3.1"><a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S1.F1"
                                    title="Figure 1 ‣ 1 Introduction ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 1</span></a> shows that <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS3.p3.1.1">B</span>LT models achieve
                                better scaling trends than tokenization-based architectures for both inference <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS3.p3.1.2">flop</span> classes. In both
                                cases, BPE models perform better with small training budgets and are quickly surpassed
                                by <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p3.1.3">B</span>LT, not far
                                beyond the compute-optimal regime. In practice, it can be preferable to spend more
                                during the one-time pretraining to achieve a better performing model with a fixed
                                inference budget. A perfect example of this is the class of 8B models, like Llama 3.1,
                                which has been trained on two orders of magnitude more data than what is compute-optimal
                                for that model size.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS3.p4">
                            <p class="ltx_p" id="S5.SS3.p4.1">The crossover point where <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS3.p4.1.1">B</span>LT improves over
                                token-based models has shifted slightly closer to the compute-optimal point when moving
                                to the larger <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p4.1.2">flop</span>
                                class models (from 3x down to 2.5x the compute optimal budget). Similarly, the larger
                                patch size 8 model has steeper scaling trend in the larger <span
                                    class="ltx_text ltx_font_smallcaps" id="S5.SS3.p4.1.3">flop</span> class overtaking
                                the other models sooner.
                                As discussed in Section <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.SS1"
                                    title="5.1 Parameter Matched Compute Optimal Scaling Trends ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">5.1</span></a>, larger patch sizes appear to
                                perform closer to BPE models at larger model scales. We attribute this, in part, to the
                                decreasing share of total <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p4.1.4">flop</span>s used by the byte-level Encoder and Decoder modules
                                which seem to scale slower than the Latent Transformer. When growing total parameters
                                20x from 400M to 8B, we only roughly double <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p4.1.5">B</span>LT’s local model parameters. This is important as larger
                                patch sizes only affect <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p4.1.6">flop</span>s from the patch Latent Transformer and not the
                                byte-level modules. In fact, that is why the <span class="ltx_text ltx_font_smallcaps"
                                    id="S5.SS3.p4.1.7">B</span>LT-Entropy ps=8 went from 1.6x to 1.7x of the Llama 2
                                model size when moving to the larger model scale.</p>
                        </div>
                        <div class="ltx_para" id="S5.SS3.p5">
                            <p class="ltx_p" id="S5.SS3.p5.1">In summary, our patch-length scaling study demonstrates
                                that the <span class="ltx_text ltx_font_smallcaps" id="S5.SS3.p5.1.1">B</span>LT
                                patch-based architecture can achieve better scaling trends by simultaneously increasing
                                both patch and model size. Such trends seem to persist and even improve at larger model
                                scales.</p>
                        </div>
                        <figure class="ltx_table" id="S5.T4">
                            <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.2">
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S5.T4.2.2">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"
                                            id="S5.T4.2.2.3">Language</th>
                                        <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T4.1.1.1">
                                            Language <math alttext="\rightarrow" class="ltx_Math" display="inline"
                                                id="S5.T4.1.1.1.m1.1">
                                                <semantics id="S5.T4.1.1.1.m1.1a">
                                                    <mo id="S5.T4.1.1.1.m1.1.1" stretchy="false"
                                                        xref="S5.T4.1.1.1.m1.1.1.cmml">→</mo><annotation-xml
                                                        encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b">
                                                        <ci id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1">→
                                                        </ci>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">
                                                        \rightarrow</annotation>
                                                    <annotation encoding="application/x-llamapun"
                                                        id="S5.T4.1.1.1.m1.1d">→</annotation>
                                                </semantics>
                                            </math> English</td>
                                        <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T4.2.2.2">
                                            English <math alttext="\rightarrow" class="ltx_Math" display="inline"
                                                id="S5.T4.2.2.2.m1.1">
                                                <semantics id="S5.T4.2.2.2.m1.1a">
                                                    <mo id="S5.T4.2.2.2.m1.1.1" stretchy="false"
                                                        xref="S5.T4.2.2.2.m1.1.1.cmml">→</mo><annotation-xml
                                                        encoding="MathML-Content" id="S5.T4.2.2.2.m1.1b">
                                                        <ci id="S5.T4.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.m1.1.1">→
                                                        </ci>
                                                    </annotation-xml>
                                                    <annotation encoding="application/x-tex" id="S5.T4.2.2.2.m1.1c">
                                                        \rightarrow</annotation>
                                                    <annotation encoding="application/x-llamapun"
                                                        id="S5.T4.2.2.2.m1.1d">→</annotation>
                                                </semantics>
                                            </math> Language</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.3.1">
                                        <th class="ltx_td ltx_th ltx_th_row ltx_border_t" id="S5.T4.2.3.1.1"></th>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.3.1.2">Llama 3</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.3.1.3">
                                            <span class="ltx_text ltx_font_smallcaps" id="S5.T4.2.3.1.3.1">B</span>LT
                                        </td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.3.1.4">Llama 3</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T4.2.3.1.5">
                                            <span class="ltx_text ltx_font_smallcaps" id="S5.T4.2.3.1.5.1">B</span>LT
                                        </td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.4.2">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S5.T4.2.4.2.1"><span class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.4.2.1.1">Arabic</span></th>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.4.2.2">22.3</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.4.2.3">24.6</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.4.2.4">10.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T4.2.4.2.5">
                                            8.8</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.5.3">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.5.3.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.5.3.1.1">German</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.5.3.2">41.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.5.3.3">42.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.5.3.4">29.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.5.3.5">31.2</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.6.4">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.6.4.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.6.4.1.1">Hindi</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.6.4.2">20.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.6.4.3">20.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.6.4.4">7.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.6.4.5">7.2</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.7.5">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.7.5.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.7.5.1.1">Italian</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.7.5.2">34.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.7.5.3">33.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.7.5.4">24.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.7.5.5">26.2</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.8.6">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.8.6.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.8.6.1.1">Vietnamese</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.8.6.2">31.2</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.8.6.3">31.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.8.6.4">28.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.8.6.5">23.7</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.9.7">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.9.7.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.9.7.1.1">Thai</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.9.7.2">17.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.9.7.3">18.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.9.7.4">10.5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.9.7.5">7.7</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.10.8">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S5.T4.2.10.8.1"><span class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.10.8.1.1">Armenian</span></th>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.10.8.2">1.7</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.10.8.3">6.3</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.2.10.8.4">0.6</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"
                                            id="S5.T4.2.10.8.5">0.9</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.11.9">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.11.9.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.11.9.1.1">Amharic</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.11.9.2">1.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.11.9.3">3.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.11.9.4">0.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.11.9.5">0.5</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.12.10">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.12.10.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.12.10.1.1">Assamese</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.12.10.2">2.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.12.10.3">5.4</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.12.10.4">0.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.12.10.5">1.6</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.13.11">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.13.11.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.13.11.1.1">Bengali</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.13.11.2">4.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.13.11.3">12.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.13.11.4">1.7</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.13.11.5">4.1</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.14.12">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.14.12.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.14.12.1.1">Bosnian</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.14.12.2">36.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.14.12.3">37.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.14.12.4">16.9</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.14.12.5">19.6</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.15.13">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.15.13.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.15.13.1.1">Cebuano</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.15.13.2">18.2</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.15.13.3">20.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.15.13.4">5.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.15.13.5">9.1</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.16.14">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.16.14.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.16.14.1.1">Georgian</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.16.14.2">1.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.16.14.3">7.4</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.16.14.4">1.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.16.14.5">2.5</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.17.15">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.17.15.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.17.15.1.1">Gujarati</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.17.15.2">2.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.17.15.3">5.8</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.17.15.4">1.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.17.15.5">2.2</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.18.16">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.18.16.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.18.16.1.1">Hausa</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.18.16.2">5.75</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.18.16.3">5.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.18.16.4">1.2</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.18.16.5">1.3</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.19.17">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.19.17.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.19.17.1.1">Icelandic</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.19.17.2">16.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.19.17.3">17.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.19.17.4">4.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.19.17.5">5.3</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.20.18">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.20.18.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.20.18.1.1">Kannada</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.20.18.2">1.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.20.18.3">3.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.20.18.4">0.7</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.20.18.5">1.7</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.21.19">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.21.19.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.21.19.1.1">Kazakh</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.21.19.2">5.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.21.19.3">7.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.21.19.4">1.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.21.19.5">2.6</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.22.20">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.22.20.1"><span
                                                class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.22.20.1.1">Kabuverdianu</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.22.20.2">20.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.22.20.3">20.9</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.22.20.4">5.1</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.22.20.5">6.8</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.23.21">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.23.21.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.23.21.1.1">Khmer</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.23.21.2">4.4</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.23.21.3">9.5</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.23.21.4">0.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.23.21.5">0.8</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.24.22">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.24.22.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.24.22.1.1">Kyrgyz</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.24.22.2">4.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.24.22.3">5.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.24.22.4">0.9</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.24.22.5">2.0</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.25.23">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.25.23.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.25.23.1.1">Malayalam</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.25.23.2">1.8</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.25.23.3">3.5</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.25.23.4">0.7</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.25.23.5">1.4</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.26.24">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.26.24.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.26.24.1.1">Odia</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.26.24.2">1.6</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.26.24.3">2.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.26.24.4">0.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.26.24.5">1.1</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.27.25">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.27.25.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.27.25.1.1">Somali</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.27.25.2">5.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.27.25.3">5.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.27.25.4">1.1</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.27.25.5">1.4</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.28.26">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.28.26.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.28.26.1.1">Swahili</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.28.26.2">10.1</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.28.26.3">12.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.28.26.4">1.4</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.28.26.5">2.3</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.29.27">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.29.27.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.29.27.1.1">Urdu</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.29.27.2">9.3</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.29.27.3">9.5</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.29.27.4">2.0</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.29.27.5">1.4</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.30.28">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T4.2.30.28.1"><span
                                                class="ltx_text ltx_font_bold" id="S5.T4.2.30.28.1.1">Zulu</span></th>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.30.28.2">4.7</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.30.28.3">5.0</td>
                                        <td class="ltx_td ltx_align_center" id="S5.T4.2.30.28.4">0.6</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T4.2.30.28.5">0.5</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S5.T4.2.31.29">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t"
                                            id="S5.T4.2.31.29.1"><span class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.31.29.1.1">Overall Average</span></th>
                                        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"
                                            id="S5.T4.2.31.29.2">12.1</td>
                                        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"
                                            id="S5.T4.2.31.29.3"><span class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.31.29.3.1">14.0</span></td>
                                        <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"
                                            id="S5.T4.2.31.29.4">5.9</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t"
                                            id="S5.T4.2.31.29.5"><span class="ltx_text ltx_font_bold"
                                                id="S5.T4.2.31.29.5.1">6.4</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S5.T4.5.1.1" style="font-size:90%;">Table 4</span>:
                                </span><span class="ltx_text" id="S5.T4.6.2" style="font-size:90%;">Performance of 8B
                                    <span class="ltx_text ltx_font_smallcaps" id="S5.T4.6.2.1">B</span>LT and 8B Llama 3
                                    trained for 1T tokens on translating into and from six widely-used languages and
                                    twenty one lower resource languages with various scripts from the FLORES-101
                                    benchmark <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a
                                            class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib17"
                                            title="">2022</a>)</cite>. </span></figcaption>
                        </figure>
                    </section>
                </section>
                <section class="ltx_section" id="S6">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">6 </span>Byte Modeling Improves Robustness
                    </h2>
                    <div class="ltx_para" id="S6.p1">
                        <p class="ltx_p" id="S6.p1.1">We also measure the robustness of <span
                                class="ltx_text ltx_font_smallcaps" id="S6.p1.1.1">B</span>LT compared to token-based
                            models that lack direct byte-level information, and present an approach to byte-ify
                            pretrained token-based models.</p>
                    </div>
                    <section class="ltx_subsection" id="S6.SS1">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">6.1 </span>Character-Level Tasks
                        </h3>
                        <div class="ltx_para" id="S6.SS1.p1">
                            <p class="ltx_p" id="S6.SS1.p1.1">A very early motivation for training byte-level models was
                                to take advantage of their robustness to byte level noise in the input, and also to
                                exploit their awareness of the constituents of tokens, which current tokenizer-based
                                models struggle with. To measure these phenomena, we perform additional evaluations on
                                benchmarks that evaluate both robustness to input noise as well as awareness of
                                characters, both English and multi-lingual, including digits and phonemes. We present
                                these results in Table <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.T3"
                                    title="Table 3 ‣ 5.3 Patches Scale Better Than Tokens ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">3</span></a>.</p>
                        </div>
                        <section class="ltx_paragraph" id="S6.SS1.SSS0.Px1">
                            <h5 class="ltx_title ltx_title_paragraph">Noisy Data</h5>
                            <div class="ltx_para" id="S6.SS1.SSS0.Px1.p1">
                                <p class="ltx_p" id="S6.SS1.SSS0.Px1.p1.1">We create noised versions of the benchmark
                                    classification tasks described in Section <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.SS2"
                                        title="5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">5.2</span></a>, to compare the robustness of
                                    tokenizer-based models with that of <span class="ltx_text ltx_font_smallcaps"
                                        id="S6.SS1.SSS0.Px1.p1.1.1">B</span>LT.
                                    We employ five distinct character-level noising strategies to introduce variations
                                    in the text: (a) <span class="ltx_text ltx_font_italic"
                                        id="S6.SS1.SSS0.Px1.p1.1.2">AntSpeak</span>: This strategy converts the entire
                                    text into uppercase, space-separated characters. (b) <span
                                        class="ltx_text ltx_font_italic" id="S6.SS1.SSS0.Px1.p1.1.3">Drop</span>:
                                    Randomly removes 10% of the characters from the text. (c) <span
                                        class="ltx_text ltx_font_italic" id="S6.SS1.SSS0.Px1.p1.1.4">RandomCase</span>:
                                    Converts 50% of the characters to uppercase and 50% to lowercase randomly throughout
                                    the text. (d) <span class="ltx_text ltx_font_italic"
                                        id="S6.SS1.SSS0.Px1.p1.1.5">Repeat</span>: Repeats 20% of the characters up to a
                                    maximum of four times. (e) <span class="ltx_text ltx_font_italic"
                                        id="S6.SS1.SSS0.Px1.p1.1.6">UpperCase</span>: Transforms all characters in the
                                    text to uppercase.
                                    During evaluation, we apply each noising strategy to either the prompt, completion,
                                    or both as separate tasks and report the average scores. In Table <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.T3"
                                        title="Table 3 ‣ 5.3 Patches Scale Better Than Tokens ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">3</span></a> we report results on noised
                                    HellaSwag <cite class="ltx_cite ltx_citemacro_citep">(Zellers et al., <a
                                            class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib49"
                                            title="">2019</a>)</cite> and find that <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px1.p1.1.7">B</span>LT
                                    indeed outperforms tokenizer-based models across the board in terms of robustness,
                                    with an average advantage of 8 points over the model trained on the same data, and
                                    even improves over the Llama 3.1 model trained on a much larger dataset.</p>
                            </div>
                        </section>
                        <section class="ltx_paragraph" id="S6.SS1.SSS0.Px2">
                            <h5 class="ltx_title ltx_title_paragraph">Phonology - Grapheme-to-Phoneme (G2P)</h5>
                            <div class="ltx_para" id="S6.SS1.SSS0.Px2.p1">
                                <p class="ltx_p" id="S6.SS1.SSS0.Px2.p1.1">We assess <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px2.p1.1.1">B</span>LT’s
                                    capability to map a sequence of graphemes (characters representing a word) into a
                                    transcription of that word’s pronunciation (phonemes). In Table <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.T3"
                                        title="Table 3 ‣ 5.3 Patches Scale Better Than Tokens ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">3</span></a>, we present the results of the G2P
                                    task in a 5-shot setting using Phonology Bench <cite
                                        class="ltx_cite ltx_citemacro_citep">(Suvarna et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib42"
                                            title="">2024</a>)</cite> and find that <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px2.p1.1.2">B</span>LT
                                    outperforms the baseline Llama 3 1T tokenizer-based model on this task.</p>
                            </div>
                            <figure class="ltx_figure" id="S6.F7">
                                <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.F7.2"
                                    style="width:433.6pt;height:190.1pt;vertical-align:-1.0pt;"><span
                                        class="ltx_transformed_inner"
                                        style="transform:translate(-6.7pt,2.9pt) scale(0.970234325608972,0.970234325608972) ;">
                                        <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.F7.2.1">
                                            <thead class="ltx_thead">
                                                <tr class="ltx_tr" id="S6.F7.2.1.1.1">
                                                    <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt"
                                                        id="S6.F7.2.1.1.1.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.1.1.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.1.1.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_bold"
                                                                    id="S6.F7.2.1.1.1.1.1.1.1">Task</span></span>
                                                        </span>
                                                    </th>
                                                    <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt"
                                                        id="S6.F7.2.1.1.1.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.1.1.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.1.1.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_bold"
                                                                    id="S6.F7.2.1.1.1.2.1.1.1">Prompt</span></span>
                                                        </span>
                                                    </th>
                                                    <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_tt"
                                                        id="S6.F7.2.1.1.1.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.1.1.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.1.1.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_bold"
                                                                    id="S6.F7.2.1.1.1.3.1.1.1">Llama</span> 3</span>
                                                        </span>
                                                    </th>
                                                    <th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt"
                                                        id="S6.F7.2.1.1.1.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.1.1.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.1.1.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_bold ltx_font_smallcaps"
                                                                    id="S6.F7.2.1.1.1.4.1.1.1">B<span
                                                                        class="ltx_text ltx_font_upright"
                                                                        id="S6.F7.2.1.1.1.4.1.1.1.1">LT</span></span></span>
                                                        </span>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="ltx_tbody">
                                                <tr class="ltx_tr" id="S6.F7.2.1.2.1">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.2.1.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.2.1.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.2.1.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.2.1.1.1.1.1">Substitute
                                                                    Word</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.2.1.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.2.1.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.2.1.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.2.1.2.1.1.1">Question: Substitute "
                                                                    and " with " internet " in " She went to the kitchen
                                                                    and saw two cereals. ". Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.2.1.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.2.1.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.2.1.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.2.1.3.1.1.1">She went to the kitchen
                                                                    and saw two cereals.</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"
                                                        id="S6.F7.2.1.2.1.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.2.1.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.2.1.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.2.1.4.1.1.1">She went to the kitchen
                                                                    internet saw two cereals.</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S6.F7.2.1.3.2">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.3.2.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.3.2.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.3.2.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.3.2.1.1.1.1">Swap Char</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.3.2.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.3.2.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.3.2.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.3.2.2.1.1.1">Question: Swap " h " and
                                                                    " a " in " that ". Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.3.2.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.3.2.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.3.2.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.3.2.3.1.1.1">that</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"
                                                        id="S6.F7.2.1.3.2.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.3.2.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.3.2.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.3.2.4.1.1.1">taht</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S6.F7.2.1.4.3">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.4.3.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.4.3.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.4.3.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.4.3.1.1.1.1">Substitute
                                                                    Char</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.4.3.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.4.3.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.4.3.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.4.3.2.1.1.1">Question: Substitute " a
                                                                    " with " m " in " page ". Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.4.3.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.4.3.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.4.3.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.4.3.3.1.1.1">-</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"
                                                        id="S6.F7.2.1.4.3.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.4.3.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.4.3.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.4.3.4.1.1.1">pmge</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S6.F7.2.1.5.4">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.5.4.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.5.4.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.5.4.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.5.4.1.1.1.1">Semantic
                                                                    Similarity</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.5.4.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.5.4.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.5.4.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.5.4.2.1.1.1">Question: More
                                                                    semantically related to " are ": " seem ", " acre ".
                                                                    Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.5.4.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.5.4.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.5.4.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.5.4.3.1.1.1">acre</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"
                                                        id="S6.F7.2.1.5.4.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.5.4.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.5.4.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.5.4.4.1.1.1">seem</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S6.F7.2.1.6.5">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.6.5.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.6.5.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.6.5.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.6.5.1.1.1.1">Orthographic
                                                                    Similarity</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.6.5.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.6.5.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.6.5.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.6.5.2.1.1.1">Question: Closer in
                                                                    Levenshtein distance to " time ": " timber ", "
                                                                    period ". Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.6.5.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.6.5.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.6.5.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.6.5.3.1.1.1">period</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"
                                                        id="S6.F7.2.1.6.5.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.6.5.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.6.5.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.6.5.4.1.1.1">timber</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr class="ltx_tr" id="S6.F7.2.1.7.6">
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.7.6.1">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.7.6.1.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.7.6.1.1.1"
                                                                style="width:52.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.7.6.1.1.1.1">Insert Char</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.7.6.2">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.7.6.2.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.7.6.2.1.1"
                                                                style="width:216.8pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.7.6.2.1.1.1">Question: Add an " z "
                                                                    after every " n " in " not ". Answer:</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r ltx_border_t"
                                                        id="S6.F7.2.1.7.6.3">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.7.6.3.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.7.6.3.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.7.6.3.1.1.1">znotz</span></span>
                                                        </span>
                                                    </td>
                                                    <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t"
                                                        id="S6.F7.2.1.7.6.4">
                                                        <span class="ltx_inline-block ltx_align_top"
                                                            id="S6.F7.2.1.7.6.4.1">
                                                            <span class="ltx_p" id="S6.F7.2.1.7.6.4.1.1"
                                                                style="width:65.0pt;"><span
                                                                    class="ltx_text ltx_font_typewriter"
                                                                    id="S6.F7.2.1.7.6.4.1.1.1">nzot</span></span>
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </span></div>
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                            class="ltx_text" id="S6.F7.5.1.1" style="font-size:90%;">Figure 7</span>:
                                    </span><span class="ltx_text" id="S6.F7.6.2" style="font-size:90%;">Output responses
                                        from Llama 3 and <span class="ltx_text ltx_font_smallcaps"
                                            id="S6.F7.6.2.1">B</span>LT models for various tasks from CUTE benchmark.
                                        <span class="ltx_text ltx_font_smallcaps" id="S6.F7.6.2.2">B</span>LT model
                                        performs better on sequence manipulation tasks compared to the tokenizer-based
                                        Llama 3 model. Note that few-shot examples are not shown in the above prompts to
                                        maintain clarity.</span></figcaption>
                            </figure>
                        </section>
                        <section class="ltx_paragraph" id="S6.SS1.SSS0.Px3">
                            <h5 class="ltx_title ltx_title_paragraph">CUTE</h5>
                            <div class="ltx_para" id="S6.SS1.SSS0.Px3.p1">
                                <p class="ltx_p" id="S6.SS1.SSS0.Px3.p1.1">To assess character-level understanding, we
                                    evaluate <span class="ltx_text ltx_font_smallcaps"
                                        id="S6.SS1.SSS0.Px3.p1.1.1">B</span>LT on the CUTE benchmark <cite
                                        class="ltx_cite ltx_citemacro_citep">(Edman et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib14"
                                            title="">2024</a>)</cite>, which comprises several tasks that are broadly
                                    classified into three categories: understanding composition, understanding
                                    orthographic similarity, and ability to manipulate sequences. This benchmark poses a
                                    significant challenge for most tokenizer-based models, as they appear to possess
                                    knowledge of their tokens’ spellings but struggle to effectively utilize this
                                    information to manipulate text. Table <a class="ltx_ref"
                                        href="https://arxiv.org/html/2412.09871v1#S5.T3"
                                        title="Table 3 ‣ 5.3 Patches Scale Better Than Tokens ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">3</span></a> shows that <span
                                        class="ltx_text ltx_font_smallcaps"
                                        id="S6.SS1.SSS0.Px3.p1.1.2">B</span>LT-Entropy outperforms both BPE Llama 3
                                    models by more than 25 points on this benchmark. In particular, our model
                                    demonstrates exceptional proficiency in character manipulation tasks achieving 99.9%
                                    on both spelling tasks. Such large improvements despite <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px3.p1.1.3">B</span>LT
                                    having been trained on 16x less data than Llama 3.1 indicates that character level
                                    information is hard to learn for BPE models.
                                    Figure <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6.F7"
                                        title="Figure 7 ‣ Phonology - Grapheme-to-Phoneme (G2P) ‣ 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">7</span></a> illustrates a few such scenarios
                                    where Llama 3 tokenizer model struggles but our <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px3.p1.1.4">B</span>LT model
                                    performs well.
                                    Word deletion and insertion are the only two tasks where BPE performs better. Such
                                    word manipulation might not be straightforward for a byte-level model but the gap is
                                    not too wide and building from characters to words could be easier than the other
                                    way around. We use the same evaluation setup in all tasks and the original prompts
                                    from Huggingface. BPE models might benefit from additional prompt engineering.</p>
                            </div>
                        </section>
                        <section class="ltx_paragraph" id="S6.SS1.SSS0.Px4">
                            <h5 class="ltx_title ltx_title_paragraph">Low Resource Machine Translation</h5>
                            <div class="ltx_para" id="S6.SS1.SSS0.Px4.p1">
                                <p class="ltx_p" id="S6.SS1.SSS0.Px4.p1.1">We evaluate <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px4.p1.1.1">B</span>LT on
                                    translating into and out of six popular language families and twenty one lower
                                    resource languages with various scripts from the FLORES-101 benchmark <cite
                                        class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib17"
                                            title="">2022</a>)</cite> and report SentencePiece BLEU in Table <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5.T4"
                                        title="Table 4 ‣ 5.3 Patches Scale Better Than Tokens ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                            class="ltx_text ltx_ref_tag">4</span></a>.
                                    Our results demonstrate that <span class="ltx_text ltx_font_smallcaps"
                                        id="S6.SS1.SSS0.Px4.p1.1.2">B</span>LT outperforms a model trained with the
                                    Llama 3 tokenizer, achieving a 2-point overall advantage in translating into English
                                    and a 0.5-point advantage in translating from English. In popular language pairs,
                                    <span class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px4.p1.1.3">B</span>LT
                                    performs comparably to or slightly better than Llama 3. However, <span
                                        class="ltx_text ltx_font_smallcaps" id="S6.SS1.SSS0.Px4.p1.1.4">B</span>LT
                                    outperforms Llama 3 on numerous language pairs within lower-resource language
                                    families, underscoring the effectiveness of byte modeling for generalizing to
                                    long-tail byte sequences.</p>
                            </div>
                            <figure class="ltx_table" id="S6.T5">
                                <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle"
                                    id="S6.T5.2">
                                    <thead class="ltx_thead">
                                        <tr class="ltx_tr" id="S6.T5.2.1.1">
                                            <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S6.T5.2.1.1.1"></th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S6.T5.2.1.1.2">
                                                <table class="ltx_tabular ltx_align_middle" id="S6.T5.2.1.1.2.1">
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.2.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.2.1.1.1">Llama 3</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.2.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.2.1.2.1">8B</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.2.1.3">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.2.1.3.1">(220B tokens)</td>
                                                    </tr>
                                                </table>
                                            </th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S6.T5.2.1.1.3">
                                                <table class="ltx_tabular ltx_align_middle" id="S6.T5.2.1.1.3.1">
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.3.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.3.1.1.1">
                                                            <span class="ltx_text ltx_font_smallcaps"
                                                                id="S6.T5.2.1.1.3.1.1.1.1">B</span>LT
                                                        </td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.3.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.3.1.2.1">8B</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.3.1.3">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.3.1.3.1">(220B tokens)</td>
                                                    </tr>
                                                </table>
                                            </th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S6.T5.2.1.1.4">
                                                <table class="ltx_tabular ltx_align_middle" id="S6.T5.2.1.1.4.1">
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.4.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.4.1.1.1">
                                                            <span class="ltx_text ltx_font_smallcaps"
                                                                id="S6.T5.2.1.1.4.1.1.1.1">B</span>LT from Llama 3.1
                                                        </td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.4.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.4.1.2.1">8B</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.4.1.3">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.4.1.3.1">(220B tokens)</td>
                                                    </tr>
                                                </table>
                                            </th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                id="S6.T5.2.1.1.5">
                                                <table class="ltx_tabular ltx_align_middle" id="S6.T5.2.1.1.5.1">
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.5.1.1">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.5.1.1.1">Llama 3.1</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.5.1.2">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.5.1.2.1">8B</td>
                                                    </tr>
                                                    <tr class="ltx_tr" id="S6.T5.2.1.1.5.1.3">
                                                        <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                            id="S6.T5.2.1.1.5.1.3.1">(15T tokens)</td>
                                                    </tr>
                                                </table>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="ltx_tbody">
                                        <tr class="ltx_tr" id="S6.T5.2.2.1">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                                id="S6.T5.2.2.1.1"><span class="ltx_text ltx_font_bold"
                                                    id="S6.T5.2.2.1.1.1">Arc-E</span></th>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.2.2.1.2">67.4
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.2.2.1.3">66.8
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_t" id="S6.T5.2.2.1.4">66.6
                                            </td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"
                                                id="S6.T5.2.2.1.5">83.4</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.3.2">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.2.3.2.1"><span
                                                    class="ltx_text ltx_font_bold" id="S6.T5.2.3.2.1.1">Arc-C</span>
                                            </th>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.3.2.2">40.4</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.3.2.3">38.8</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.3.2.4">45.8</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.3.2.5">55.2</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.4.3">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.2.4.3.1"><span
                                                    class="ltx_text ltx_font_bold" id="S6.T5.2.4.3.1.1">HellaSwag</span>
                                            </th>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.4.3.2">71.2</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.4.3.3">72.2</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.4.3.4">76.1</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.4.3.5">80.7</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.5.4">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.2.5.4.1"><span
                                                    class="ltx_text ltx_font_bold" id="S6.T5.2.5.4.1.1">PIQA</span></th>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.5.4.2">77.0</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.5.4.3">78.2</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.5.4.4">77.4</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.5.4.5">80.7</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.6.5">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.2.6.5.1"><span
                                                    class="ltx_text ltx_font_bold" id="S6.T5.2.6.5.1.1">MMLU</span></th>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.6.5.2">26.5</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.6.5.3">25.2</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.6.5.4">63.7</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.6.5.5">66.3</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.7.6">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S6.T5.2.7.6.1"><span
                                                    class="ltx_text ltx_font_bold" id="S6.T5.2.7.6.1.1">MBPP</span></th>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.7.6.2">11.8</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.7.6.3">10.0</td>
                                            <td class="ltx_td ltx_align_center" id="S6.T5.2.7.6.4">38.2</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center" id="S6.T5.2.7.6.5">47.2</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S6.T5.2.8.7">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                                id="S6.T5.2.8.7.1"><span class="ltx_text ltx_font_bold"
                                                    id="S6.T5.2.8.7.1.1">HumanEval</span></th>
                                            <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.2.8.7.2">9.2
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.2.8.7.3">7.3
                                            </td>
                                            <td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T5.2.8.7.4">34.2
                                            </td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"
                                                id="S6.T5.2.8.7.5">37.2</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                            class="ltx_text" id="S6.T5.4.1.1" style="font-size:90%;">Table 5</span>:
                                    </span><span class="ltx_text" id="S6.T5.5.2" style="font-size:90%;">Initializing the
                                        global transformer model of <span class="ltx_text ltx_font_smallcaps"
                                            id="S6.T5.5.2.1">B</span>LT from the non-embedding parameters of Llama 3
                                        improves performance on several benchmark tasks. First three models trained on
                                        the Llama 2 data for compute-optimal steps.</span></figcaption>
                            </figure>
                        </section>
                    </section>
                    <section class="ltx_subsection" id="S6.SS2">
                        <h3 class="ltx_title ltx_title_subsection">
                            <span class="ltx_tag ltx_tag_subsection">6.2 </span>Training <span
                                class="ltx_text ltx_font_smallcaps" id="S6.SS2.1.1">B</span>LT from Llama 3
                        </h3>
                        <div class="ltx_para" id="S6.SS2.p1">
                            <p class="ltx_p" id="S6.SS2.p1.1">We explore a workflow where <span
                                    class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.1">B</span>LT models can
                                leverage existing pre-trained tokenizer-based models for better and faster training
                                convergence, acheived by initializing the global transformer parameters of <span
                                    class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.2">B</span>LT with those of a
                                pre-trained Llama 3.1 model. Subsequently, we update the weights of the global
                                transformer using one-tenth the learning rate employed for the local encoder and local
                                decoder model, for Llama 3 optimal number of steps, and present a comparison with a
                                baseline <span class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.3">B</span>LT in
                                Table <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6.T5"
                                    title="Table 5 ‣ Low Resource Machine Translation ‣ 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">5</span></a>. It is evident that <span
                                    class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.4">B</span>LT from Llama 3.1
                                significantly outperforms both the Llama 3 and <span class="ltx_text ltx_font_smallcaps"
                                    id="S6.SS2.p1.1.5">B</span>LT baselines, which were trained with the same number of
                                <span class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.6">flop</span>s. Moreover,
                                when compared to our <span class="ltx_text ltx_font_smallcaps"
                                    id="S6.SS2.p1.1.7">B</span>LT-Entropy model (as presented in Table <a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5.T1"
                                    title="Table 1 ‣ Coding related generation tasks: ‣ 5.2 Beyond Compute Optimal Task Evaluations ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">1</span></a>), which was trained on a significantly
                                larger dataset (1T tokens), <span class="ltx_text ltx_font_smallcaps"
                                    id="S6.SS2.p1.1.8">B</span>LT from Llama 3.1 still achieves superior performance on
                                MMLU task, suggesting that it can be an effective approach in significantly reducing the
                                training <span class="ltx_text ltx_font_smallcaps" id="S6.SS2.p1.1.9">flop</span>s.</p>
                        </div>
                        <div class="ltx_para" id="S6.SS2.p2">
                            <p class="ltx_p" id="S6.SS2.p2.1">This setup can also be viewed as transforming
                                tokenizer-based models into tokenizer-free ones, effectively converting a pre-trained
                                LLaMA 3.1 model into a <span class="ltx_text ltx_font_smallcaps"
                                    id="S6.SS2.p2.1.1">B</span>LT model. To provide a comprehensive comparison, we
                                include the original LLaMA 3.1 model trained on 15T tokens in Table <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S6.T5"
                                    title="Table 5 ‣ Low Resource Machine Translation ‣ 6.1 Character-Level Tasks ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">5</span></a> and evaluate it against the <span
                                    class="ltx_text ltx_font_smallcaps" id="S6.SS2.p2.1.2">B</span>LT derived from LLaMA
                                3. Our model experiences a slight performance decline on MMLU and HumanEval, but a more
                                significant drop on other tasks. This suggests that further work is needed to fully
                                leverage the pre-trained model and improve upon its performance, particularly in terms
                                of optimizing data mixtures and other hyperparameters.</p>
                        </div>
                    </section>
                </section>
                <section class="ltx_section" id="S7">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">7 </span>Ablations and Discussion
                    </h2>
                    <div class="ltx_para" id="S7.p1">
                        <p class="ltx_p" id="S7.p1.1">In this section, we discuss ablations justifying architectural
                            choices for <span class="ltx_text ltx_font_smallcaps" id="S7.p1.1.1">B</span>LT and the
                            patching scheme and hyper-parameters for the <span class="ltx_text ltx_font_smallcaps"
                                id="S7.p1.1.2">B</span>LT 8B parameter model trained on the <span
                                class="ltx_text ltx_font_smallcaps" id="S7.p1.1.3">B</span>LT-1T dataset.</p>
                    </div>
                    <figure class="ltx_figure" id="S7.F8"><img alt="Refer to caption"
                            class="ltx_graphics ltx_centering ltx_img_landscape" height="362" id="S7.F8.g1" src="x8.png"
                            width="498" />
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S7.F8.4.1.1" style="font-size:90%;">Figure 8</span>:
                            </span><span class="ltx_text" id="S7.F8.5.2" style="font-size:90%;">Variation of language
                                modeling performance in bits-per-byte (bpb) with training <span
                                    class="ltx_text ltx_font_smallcaps" id="S7.F8.5.2.1">flop</span>s for 400m and 1b
                                <span class="ltx_text ltx_font_smallcaps" id="S7.F8.5.2.2">B</span>LT models patched
                                with entropy models of different sizes and context windows. Both dimensions improve
                                scaling performance, with diminishing returns beyond 50m parameter entropy models with a
                                context of 512 bytes.</span></figcaption>
                    </figure>
                    <section class="ltx_paragraph" id="S7.SS0.SSS0.Px1">
                        <h5 class="ltx_title ltx_title_paragraph">Entropy Model Hyper-parameters</h5>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px1.p1">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px1.p1.2">To study the effect of varying entropy model size
                                and context window length on scaling performance, we train byte-level entropy
                                transformer models of different model sizes between 1m and 100m parameters, with varying
                                context window lengths from 64 to 512. We plot bpb vs training <span
                                    class="ltx_text ltx_font_smallcaps" id="S7.SS0.SSS0.Px1.p1.2.1">flop</span> scaling
                                law curves, created using our <math alttext="400m" class="ltx_Math" display="inline"
                                    id="S7.SS0.SSS0.Px1.p1.1.m1.1">
                                    <semantics id="S7.SS0.SSS0.Px1.p1.1.m1.1a">
                                        <mrow id="S7.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">
                                            <mn id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.2"
                                                xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">400</mn>
                                            <mo id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.1"
                                                xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">⁢</mo>
                                            <mi id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.3"
                                                xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">m</mi>
                                        </mrow><annotation-xml encoding="MathML-Content"
                                            id="S7.SS0.SSS0.Px1.p1.1.m1.1b">
                                            <apply id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"
                                                xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1">
                                                <times id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml"
                                                    xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.1"></times>
                                                <cn id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer"
                                                    xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.2">400</cn>
                                                <ci id="S7.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"
                                                    xref="S7.SS0.SSS0.Px1.p1.1.m1.1.1.3">𝑚</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S7.SS0.SSS0.Px1.p1.1.m1.1c">400m
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S7.SS0.SSS0.Px1.p1.1.m1.1d">
                                            400 italic_m</annotation>
                                    </semantics>
                                </math> and <math alttext="1b" class="ltx_Math" display="inline"
                                    id="S7.SS0.SSS0.Px1.p1.2.m2.1">
                                    <semantics id="S7.SS0.SSS0.Px1.p1.2.m2.1a">
                                        <mrow id="S7.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">
                                            <mn id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.2"
                                                xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">1</mn>
                                            <mo id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.1"
                                                xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml">⁢</mo>
                                            <mi id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.3"
                                                xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml">b</mi>
                                        </mrow><annotation-xml encoding="MathML-Content"
                                            id="S7.SS0.SSS0.Px1.p1.2.m2.1b">
                                            <apply id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"
                                                xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1">
                                                <times id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml"
                                                    xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.1"></times>
                                                <cn id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" type="integer"
                                                    xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.2">1</cn>
                                                <ci id="S7.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"
                                                    xref="S7.SS0.SSS0.Px1.p1.2.m2.1.1.3">𝑏</ci>
                                            </apply>
                                        </annotation-xml>
                                        <annotation encoding="application/x-tex" id="S7.SS0.SSS0.Px1.p1.2.m2.1c">1b
                                        </annotation>
                                        <annotation encoding="application/x-llamapun" id="S7.SS0.SSS0.Px1.p1.2.m2.1d">1
                                            italic_b</annotation>
                                    </semantics>
                                </math> <span class="ltx_text ltx_font_smallcaps" id="S7.SS0.SSS0.Px1.p1.2.2">B</span>LT
                                models trained on the Llama-2 dataset and present them in <a
                                    class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S7.F8"
                                    title="Figure 8 ‣ 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Figure 8</span></a>. We find that scaling
                                performance is positively correlated with both these dimensions of the entropy model,
                                with diminishing returns when we scale beyond 50m parameters.</p>
                        </div>
                    </section>
                    <section class="ltx_paragraph" id="S7.SS0.SSS0.Px2">
                        <h5 class="ltx_title ltx_title_paragraph">Types of Patching</h5>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px2.p1">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px2.p1.1">We ablate the four different patching schemes,
                                introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S2"
                                    title="2 Patching: From Individual Bytes to Groups of Bytes ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">2</span></a> i.e. 1) Strided Patching with a stride
                                of 4 and 6, 2) Patching on whitepsace, 3) BPE Tokenizer patching based on the Llama 3
                                tokenizer, and 4) Entropy based patching using a small byte <span
                                    class="ltx_text ltx_font_smallcaps" id="S7.SS0.SSS0.Px2.p1.1.1">llm</span>.</p>
                        </div>
                        <figure class="ltx_table" id="S7.T6">
                            <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T6.2">
                                <thead class="ltx_thead">
                                    <tr class="ltx_tr" id="S7.T6.2.1.1">
                                        <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S7.T6.2.1.1.1"></th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                            id="S7.T6.2.1.1.2">
                                            <table class="ltx_tabular ltx_align_middle" id="S7.T6.2.1.1.2.1">
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.2.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.2.1.1.1">Llama 3</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.2.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.2.1.2.1">BPE</td>
                                                </tr>
                                            </table>
                                        </th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                            id="S7.T6.2.1.1.3">
                                            <table class="ltx_tabular ltx_align_middle" id="S7.T6.2.1.1.3.1">
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.3.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.3.1.1.1">Space Patching</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.3.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.3.1.2.1">
                                                        <span class="ltx_text ltx_font_smallcaps"
                                                            id="S7.T6.2.1.1.3.1.2.1.1">B</span>LT
                                                    </td>
                                                </tr>
                                            </table>
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                            id="S7.T6.2.1.1.4">
                                            <table class="ltx_tabular ltx_align_middle" id="S7.T6.2.1.1.4.1">
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.4.1.1">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.4.1.1.1">Entropy</td>
                                                </tr>
                                                <tr class="ltx_tr" id="S7.T6.2.1.1.4.1.2">
                                                    <td class="ltx_td ltx_nopad_r ltx_align_center"
                                                        id="S7.T6.2.1.1.4.1.2.1">
                                                        <span class="ltx_text ltx_font_smallcaps"
                                                            id="S7.T6.2.1.1.4.1.2.1.1">B</span>LT
                                                    </td>
                                                </tr>
                                            </table>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S7.T6.2.2.1">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T6.2.2.1.1"><span class="ltx_text ltx_font_bold"
                                                id="S7.T6.2.2.1.1.1">Arc-E</span></th>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.2.2.1.2">67.4</td>
                                        <td class="ltx_td ltx_align_center ltx_border_t" id="S7.T6.2.2.1.3">67.2</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S7.T6.2.2.1.4">
                                            68.9</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T6.2.3.2">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.2.3.2.1"><span
                                                class="ltx_text ltx_font_bold" id="S7.T6.2.3.2.1.1">Arc-C</span></th>
                                        <td class="ltx_td ltx_align_center" id="S7.T6.2.3.2.2">40.5</td>
                                        <td class="ltx_td ltx_align_center" id="S7.T6.2.3.2.3">37.6</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T6.2.3.2.4">38.3</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T6.2.4.3">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T6.2.4.3.1"><span
                                                class="ltx_text ltx_font_bold" id="S7.T6.2.4.3.1.1">HellaSwag</span>
                                        </th>
                                        <td class="ltx_td ltx_align_center" id="S7.T6.2.4.3.2">71.3</td>
                                        <td class="ltx_td ltx_align_center" id="S7.T6.2.4.3.3">70.8</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center" id="S7.T6.2.4.3.4">72.7</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T6.2.5.4">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T6.2.5.4.1"><span class="ltx_text ltx_font_bold"
                                                id="S7.T6.2.5.4.1.1">PIQA</span></th>
                                        <td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T6.2.5.4.2">77.0</td>
                                        <td class="ltx_td ltx_align_center ltx_border_bb" id="S7.T6.2.5.4.3">76.5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"
                                            id="S7.T6.2.5.4.4">77.6</td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S7.T6.4.1.1" style="font-size:90%;">Table 6</span>:
                                </span><span class="ltx_text" id="S7.T6.5.2" style="font-size:90%;">Benchmark
                                    evaluations of two patching schemes for 8b <span class="ltx_text ltx_font_smallcaps"
                                        id="S7.T6.5.2.1">B</span>LT models and BPE Llama3 baseline. These models are
                                    trained on the Llama 2 data for the optimal number of steps as determined by <cite
                                        class="ltx_cite ltx_citemacro_cite">Dubey et al. (<a class="ltx_ref"
                                            href="https://arxiv.org/html/2412.09871v1#bib.bib13"
                                            title="">2024</a>)</cite>.
                                </span></figcaption>
                        </figure>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px2.p2">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px2.p2.1">While dynamic patching reduces the effective
                                length of sequences, we control for the sequence length to maintain a similar context
                                length for all patching schemes. All the models see the same number of bytes in each
                                sequence during training and inference in expectation to prevent any confounding factors
                                from being able to model larger contexts. Figure <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S5.F6"
                                    title="Figure 6 ‣ 5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">6</span></a> highlights the results of these
                                ablations. All the remaining patching schemes outperform static patching, with space
                                patching being a very close competitor to dynamic entropy based patching.</p>
                        </div>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px2.p3">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px2.p3.1">In <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S7.T6"
                                    title="Table 6 ‣ Types of Patching ‣ 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Table 6</span></a>, we present benchmark
                                evaluations for <span class="ltx_text ltx_font_smallcaps"
                                    id="S7.SS0.SSS0.Px2.p3.1.1">B</span>LT models comparing tokenizer-based models,
                                space patching, and entropy-based patching, trained on the Llama 2 dataset for an
                                optimal number of steps <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a
                                        class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib13"
                                        title="">2024</a>)</cite>. Although space patching is a simpler strategy that
                                does not involve running an entropy model on the fly during training, we find that the
                                gains we observed using entropy-based patching on scaling trends (Section <a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S5"
                                    title="5 Scaling Trends ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">5</span></a>) do indeed carry forward even to
                                downstream benchmark tasks.<span class="ltx_note ltx_role_footnote" id="footnote7"><sup
                                        class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span
                                            class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span
                                                class="ltx_tag ltx_tag_note">7</span>Space patching results are from
                                            earlier runs without cross-attention, but similar trends are observed even
                                            with cross-attention.</span></span></span></p>
                        </div>
                        <figure class="ltx_table" id="S7.T7">
                            <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T7.2">
                                <thead class="ltx_thead">
                                    <tr class="ltx_tr" id="S7.T7.2.1.1">
                                        <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S7.T7.2.1.1.1"></th>
                                        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"
                                            id="S7.T7.2.1.1.2"></th>
                                        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"
                                            id="S7.T7.2.1.1.3"></th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                            colspan="4" id="S7.T7.2.1.1.4">BPB</th>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.2.2">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T7.2.2.2.1">Cross Attn. Dec.</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T7.2.2.2.2">Cross Attn. Enc.</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T7.2.2.2.3">Pooling Init</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T7.2.2.2.4">Wikipedia</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T7.2.2.2.5">CC</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T7.2.2.2.6">Github</th>
                                        <th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T7.2.2.2.7">Train Dist</th>
                                    </tr>
                                </thead>
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S7.T7.2.3.1">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T7.2.3.1.1">-</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T7.2.3.1.2">All Layers</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T7.2.3.1.3">False</th>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T7.2.3.1.4">0.830</td>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T7.2.3.1.5">0.915</td>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T7.2.3.1.6"><span
                                                class="ltx_text ltx_font_bold" id="S7.T7.2.3.1.6.1">0.442</span></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S7.T7.2.3.1.7">
                                            0.891</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.4.2">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.4.2.1">-</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.4.2.2">Last
                                            Layer</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.4.2.3">False
                                        </th>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.4.2.4">0.836</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.4.2.5">0.906</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.4.2.6">0.447</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T7.2.4.2.7">0.886</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.5.3">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.5.3.1">-</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.5.3.2">-</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.5.3.3">-</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.5.3.4">0.833</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.5.3.5">0.892</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.5.3.6">0.446</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T7.2.5.3.7">0.866</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.6.4">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.6.4.1">First
                                            Layer</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.6.4.2">Last
                                            Layer</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.6.4.3">True
                                        </th>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.6.4.4">0.825</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.6.4.5">0.883</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.6.4.6">0.443</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T7.2.6.4.7">0.861</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.7.5">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.7.5.1">All
                                            Layers</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.7.5.2">Last
                                            Layer</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S7.T7.2.7.5.3">True
                                        </th>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.7.5.4"><span
                                                class="ltx_text ltx_font_bold" id="S7.T7.2.7.5.4.1">0.823</span></td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.7.5.5">0.871</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T7.2.7.5.6">0.443</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T7.2.7.5.7">0.846</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T7.2.8.6">
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T7.2.8.6.1">All Layers</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T7.2.8.6.2">All Layers</th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T7.2.8.6.3">True</th>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T7.2.8.6.4">0.828</td>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T7.2.8.6.5"><span
                                                class="ltx_text ltx_font_bold" id="S7.T7.2.8.6.5.1">0.868</span></td>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T7.2.8.6.6">0.443</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S7.T7.2.8.6.7">
                                            <span class="ltx_text ltx_font_bold" id="S7.T7.2.8.6.7.1">0.844</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S7.T7.4.1.1" style="font-size:90%;">Table 7</span>:
                                </span><span class="ltx_text" id="S7.T7.5.2" style="font-size:90%;">Ablations on the use
                                    of Cross Attention for a 1B <span class="ltx_text ltx_font_smallcaps"
                                        id="S7.T7.5.2.1">B</span>LT model trained on 100B bytes. We report bits-per-byte
                                    (bpb) on different datasets. We also report bpb on a random sample of the training
                                    data (denoted as Train Dist.) The Cross Attn. Enc. and Dec. columns denote which
                                    transformer layers the cross-attention block is applied after (or before for the
                                    decoder) in the local encoder and decoder respectively.
                                </span></figcaption>
                        </figure>
                        <figure class="ltx_table" id="S7.T8">
                            <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S7.T8.2">
                                <thead class="ltx_thead">
                                    <tr class="ltx_tr" id="S7.T8.2.1.1">
                                        <th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S7.T8.2.1.1.1"></th>
                                        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"
                                            id="S7.T8.2.1.1.2"></th>
                                        <th class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_tt"
                                            id="S7.T8.2.1.1.3"></th>
                                        <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                            colspan="4" id="S7.T8.2.1.1.4">BPB</th>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.2.2">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T8.2.2.2.1">Ngram Sizes</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T8.2.2.2.2">Per Ngram Vocab</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row"
                                            id="S7.T8.2.2.2.3">Total Vocab</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T8.2.2.2.4">Wikipedia</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T8.2.2.2.5">CC</th>
                                        <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T8.2.2.2.6">Github</th>
                                        <th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                            id="S7.T8.2.2.2.7">Train Dist</th>
                                    </tr>
                                </thead>
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S7.T8.2.3.1">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T8.2.3.1.1">-</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T8.2.3.1.2">-</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"
                                            id="S7.T8.2.3.1.3">-</th>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T8.2.3.1.4">0.892</td>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T8.2.3.1.5">0.867</td>
                                        <td class="ltx_td ltx_align_right ltx_border_t" id="S7.T8.2.3.1.6">0.506</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S7.T8.2.3.1.7">
                                            0.850</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.4.2">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.4.2.1">6,7,8
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.4.2.2">100k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.4.2.3">300k</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.4.2.4">0.873</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.4.2.5">0.860</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.4.2.6">0.499</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.4.2.7">0.842</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.5.3">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.5.3.1">6,7,8
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.5.3.2">200k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.5.3.3">600k</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.5.3.4">0.862</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.5.3.5">0.856</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.5.3.6">0.492</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.5.3.7">0.838</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.6.4">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.6.4.1">3,4,5
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.6.4.2">100k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.6.4.3">300k</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.6.4.4">0.859</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.6.4.5">0.855</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.6.4.6">0.491</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.6.4.7">0.837</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.7.5">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.7.5.1">6,7,8
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.7.5.2">400k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.7.5.3">1M</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.7.5.4">0.855</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.7.5.5">0.853</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.7.5.6">0.491</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.7.5.7">0.834</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.8.6">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.8.6.1">3,4,5
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.8.6.2">200k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.8.6.3">600k</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.8.6.4">0.850</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.8.6.5">0.852</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.8.6.6">0.485</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.8.6.7">0.833</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.9.7">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.9.7.1">
                                            3,4,5,6,7,8</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.9.7.2">100k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.9.7.3">600k</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.9.7.4">0.850</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.9.7.5">0.852</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.9.7.6">0.486</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.9.7.7">0.833</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.10.8">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.10.8.1">3,4,5
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.10.8.2">400k
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.10.8.3">1M</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.10.8.4">0.844</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.10.8.5">0.851</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.10.8.6">0.483</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.10.8.7">0.832</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.11.9">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.11.9.1">
                                            3,4,5,6,7,8</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.11.9.2">200k
                                        </th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S7.T8.2.11.9.3">1M</th>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.11.9.4">0.840</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.11.9.5">0.849</td>
                                        <td class="ltx_td ltx_align_right" id="S7.T8.2.11.9.6">0.481</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T8.2.11.9.7">0.830</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T8.2.12.10">
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T8.2.12.10.1">3,4,5,6,7,8</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T8.2.12.10.2">400k</th>
                                        <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                            id="S7.T8.2.12.10.3">2M</th>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T8.2.12.10.4"><span
                                                class="ltx_text ltx_font_bold" id="S7.T8.2.12.10.4.1">0.831</span></td>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T8.2.12.10.5"><span
                                                class="ltx_text ltx_font_bold" id="S7.T8.2.12.10.5.1">0.846</span></td>
                                        <td class="ltx_td ltx_align_right ltx_border_bb" id="S7.T8.2.12.10.6"><span
                                                class="ltx_text ltx_font_bold" id="S7.T8.2.12.10.6.1">0.478</span></td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb"
                                            id="S7.T8.2.12.10.7"><span class="ltx_text ltx_font_bold"
                                                id="S7.T8.2.12.10.7.1">0.826</span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S7.T8.4.1.1" style="font-size:90%;">Table 8</span>:
                                </span><span class="ltx_text" id="S7.T8.5.2" style="font-size:90%;">Ablations on the use
                                    of n-gram hash embedding tables for a 1B <span class="ltx_text ltx_font_smallcaps"
                                        id="S7.T8.5.2.1">B</span>LT model trained on 100B bytes. We find that hash
                                    n-gram embeddings are very effective with very large improvements in BPB.
                                    The most significant parameter is the per-ngram vocab size and that smaller ngram
                                    sizes are more impactful than larger ones.
                                </span></figcaption>
                        </figure>
                    </section>
                    <section class="ltx_paragraph" id="S7.SS0.SSS0.Px3">
                        <h5 class="ltx_title ltx_title_paragraph">Cross-Attention</h5>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px3.p1">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px3.p1.1">In <a class="ltx_ref ltx_refmacro_autoref"
                                    href="https://arxiv.org/html/2412.09871v1#S7.T7"
                                    title="Table 7 ‣ Types of Patching ‣ 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">Table 7</span></a>, we ablate including
                                cross-attention at various points in the encoder and decoder of <span
                                    class="ltx_text ltx_font_smallcaps" id="S7.SS0.SSS0.Px3.p1.1.1">B</span>LT.
                                For the encoder cross-attention we test initializing the queries with 1) the same
                                learned embedding for every global state, 2) a hash embedding of the bytes in the patch,
                                and 3) pooling of the encoder hidden representation of the patch bytes at the given
                                encoder layer.</p>
                        </div>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px3.p2">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px3.p2.1">We find that using cross-attention in the <span
                                    class="ltx_text ltx_font_italic" id="S7.SS0.SSS0.Px3.p2.1.1">decoder</span> is most
                                effective. In the encoder, there is a slight improvement in using cross-attention but
                                only with pooling initialization of queries. Additionally, we find that cross-attention
                                helps particularly on Common-Crawl and especially with larger patch sizes.</p>
                        </div>
                    </section>
                    <section class="ltx_paragraph" id="S7.SS0.SSS0.Px4">
                        <h5 class="ltx_title ltx_title_paragraph">n-gram Hash Embeddings</h5>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px4.p1">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px4.p1.1">We ablate settings of 0, 100K, 200K and 400K
                                n-gram hash embedding vocabularies and present results in Table <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S7.T8"
                                    title="Table 8 ‣ Types of Patching ‣ 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">8</span></a>. We find that hash embeddings help on
                                all domains, but particularly on Wikipedia and Github (0.04 bpb difference compared to
                                0.01 bpb difference after 15k steps at 8B).
                                At 8B scale going from 500K to 300K hashes changed performance by 0.001 bpb on 15k
                                steps. This indicates that hashes are vital to bringing the performance of <span
                                    class="ltx_text ltx_font_smallcaps" id="S7.SS0.SSS0.Px4.p1.1.1">B</span>LT to match
                                those of tokenizer based models, however, after 300K hashes, there are diminishing
                                returns. Additionally, it appears that the gains are largely complementary with
                                cross-attention as they provide improvements on different datasets.</p>
                        </div>
                        <figure class="ltx_table" id="S7.T9">
                            <table class="ltx_tabular ltx_centering ltx_align_middle" id="S7.T9.2">
                                <tbody class="ltx_tbody">
                                    <tr class="ltx_tr" id="S7.T9.2.1.1">
                                        <td class="ltx_td ltx_align_left ltx_border_tt" id="S7.T9.2.1.1.1">Ngram
                                            Embeddings</td>
                                        <td class="ltx_td ltx_align_left ltx_border_tt" id="S7.T9.2.1.1.2">Encoder
                                            Layers</td>
                                        <td class="ltx_td ltx_align_left ltx_border_tt" id="S7.T9.2.1.1.3">Decoder
                                            Layers</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_tt" id="S7.T9.2.1.1.4">
                                            Train Dist BPB</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T9.2.2.2">
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.2.2.1">False</td>
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.2.2.2">1</td>
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.2.2.3">9</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S7.T9.2.2.2.4">
                                            0.850</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T9.2.3.3">
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.3.3.1">False</td>
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.3.3.2">5</td>
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.3.3.3">5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T9.2.3.3.4">0.843</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T9.2.4.4">
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.4.4.1">True</td>
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.4.4.2">5</td>
                                        <td class="ltx_td ltx_align_left ltx_border_t" id="S7.T9.2.4.4.3">5</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S7.T9.2.4.4.4">
                                            0.844</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T9.2.5.5">
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.5.5.1">True</td>
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.5.5.2">3</td>
                                        <td class="ltx_td ltx_align_left" id="S7.T9.2.5.5.3">7</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right" id="S7.T9.2.5.5.4">0.824</td>
                                    </tr>
                                    <tr class="ltx_tr" id="S7.T9.2.6.6">
                                        <td class="ltx_td ltx_align_left ltx_border_bb" id="S7.T9.2.6.6.1">True</td>
                                        <td class="ltx_td ltx_align_left ltx_border_bb" id="S7.T9.2.6.6.2">1</td>
                                        <td class="ltx_td ltx_align_left ltx_border_bb" id="S7.T9.2.6.6.3">9</td>
                                        <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S7.T9.2.6.6.4">
                                            0.822</td>
                                    </tr>
                                </tbody>
                            </table>
                            <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                        class="ltx_text" id="S7.T9.3.1.1" style="font-size:90%;">Table 9</span>:
                                </span><span class="ltx_text" id="S7.T9.4.2" style="font-size:90%;">
                                    When paired with hash n-gram embeddings, a light-weight local encoder is sufficient.
                                    More layers can then be allocated to the decoder for the same cost.
                                </span></figcaption>
                        </figure>
                    </section>
                    <section class="ltx_paragraph" id="S7.SS0.SSS0.Px5">
                        <h5 class="ltx_title ltx_title_paragraph">Local Model Hyperparamaters</h5>
                        <div class="ltx_para" id="S7.SS0.SSS0.Px5.p1">
                            <p class="ltx_p" id="S7.SS0.SSS0.Px5.p1.1">In Table <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#S7.T9"
                                    title="Table 9 ‣ n-gram Hash Embeddings ‣ 7 Ablations and Discussion ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                        class="ltx_text ltx_ref_tag">9</span></a>, we ablate various settings for the
                                number of layers in the local encoder and decoder. When paired with hash n-gram
                                embeddings, <span class="ltx_text ltx_font_smallcaps"
                                    id="S7.SS0.SSS0.Px5.p1.1.1">B</span>LT works well with an encoder that is extremely
                                light-weight i.e. just one layer, and with a heavier decoder.</p>
                        </div>
                    </section>
                </section>
                <section class="ltx_section" id="S8">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">8 </span>Related Work
                    </h2>
                    <div class="ltx_para" id="S8.p1">
                        <p class="ltx_p" id="S8.p1.1"><span class="ltx_text ltx_font_bold"
                                id="S8.p1.1.1">Character-Level RNNs:</span> Character Language Modeling has been a
                            popular task ever since the early days of neural models <cite
                                class="ltx_cite ltx_citemacro_citep">(Sutskever et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib41" title="">2011</a>; Mikolov et
                                al., <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib32"
                                    title="">2012</a>; Graves, <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib18" title="">2013</a>)</cite> owing
                            to their flexibility of modeling out of vocabulary words organically without resorting to
                            back-off methods. <cite class="ltx_cite ltx_citemacro_cite">Kim et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib26" title="">2016</a>)</cite> also
                            train a model that processes characters only on the input side using convolutional and
                            highway networks that feed into LSTM-based RNNs and are able to match performance with the
                            RNN based state-of-the-art language models of the time on English and outperform them on
                            morphologically rich languages, another sought-after advantage of character-level LLMs.
                            <cite class="ltx_cite ltx_citemacro_cite">Kenter et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib25" title="">2018</a>)</cite> do
                            machine comprehension using byte-level LSTM models that outperformed word-level models again
                            on morphologically-rich Turkish and Russian languages. Along similar lines, <cite
                                class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib51" title="">2015</a>)</cite> used
                            character-based convolutional models for classification tasks, which outperformed word-level
                            models for certain tasks. <cite class="ltx_cite ltx_citemacro_citet">Chung et al. (<a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib8"
                                    title="">2019</a>)</cite> use hierarchical LSTM models using boundary-detectors at
                            each level to discover the latent hierarchy in text, to further improve performance on
                            character level language modeling. ByteNet by <cite
                                class="ltx_cite ltx_citemacro_cite">Kalchbrenner et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib23" title="">2016</a>)</cite> uses
                            CNN based layers on characters as opposed to attention for machine translation.</p>
                    </div>
                    <div class="ltx_para" id="S8.p2">
                        <p class="ltx_p" id="S8.p2.1"><span class="ltx_text ltx_font_bold"
                                id="S8.p2.1.1">Character-Level Transformers:</span> The development of transformer
                            models using attention <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib44"
                                    title="">2017</a>)</cite> together with subword tokenization <cite
                                class="ltx_cite ltx_citemacro_citep">(Sennrich et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib37" title="">2016</a>)</cite>,
                            significantly improved the performance of neural models on language modeling and benchmark
                            tasks. However, word and sub-word units implicitly define an inductive bias for the level of
                            abstraction models should operate on. To combine the successes of transformer models with
                            the initial promising results on character language modeling, <cite
                                class="ltx_cite ltx_citemacro_citet">Al-Rfou et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib1" title="">2019</a>)</cite> use
                            very deep transformers, and with the help of auxiliary losses, train transformer-based
                            models that outperformed previous LSTM based character <span
                                class="ltx_text ltx_font_smallcaps" id="S8.p2.1.2">llm</span>s. However, they still saw
                            a significant gap from word level LLMs. GPT-2 <cite
                                class="ltx_cite ltx_citemacro_citep">(Radford et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib36" title="">2019</a>)</cite> also
                            observed that on large scale datasets like the 1 billion word benchmark, byte-level LMs were
                            not competitive with word-level LMs.</p>
                    </div>
                    <div class="ltx_para" id="S8.p3">
                        <p class="ltx_p" id="S8.p3.1">While <cite class="ltx_cite ltx_citemacro_cite">Choe et al. (<a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib7"
                                    title="">2019</a>)</cite> demonstrated that byte-level <span
                                class="ltx_text ltx_font_smallcaps" id="S8.p3.1.1">llm</span>s based on transformers can
                            outperform subword level LLMs with comparable parameters, the models take up much more
                            compute and take much longer to train. Similarly, <cite
                                class="ltx_cite ltx_citemacro_cite">El Boukkouri et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib15" title="">2020</a>)</cite> train
                            a BERT model (CharFormer) that builds word representations by applying convolutions on
                            character embeddings, and demonstrate improvements on the medical domain, but they also
                            expend much more compute in doing so. <cite class="ltx_cite ltx_citemacro_cite">Clark et al.
                                (<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib9"
                                    title="">2022</a>)</cite> develop CANINE, a 150M parameter encoder-only model that
                            operates directly on character sequences. CANINE uses a deep transformer stack at its core
                            similar in spirit to our global model, and a combination of a local transformer and strided
                            convolutions to downsample the input characters, and outperforms the equivalent token-level
                            encoder-only model (mBERT) on downstream multilingual tasks. ByT5 <cite
                                class="ltx_cite ltx_citemacro_citep">(Xue et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib47" title="">2022</a>)</cite>
                            explored approaches for byte-level encoder decoder models, that do not use any kind of
                            patching operations. While their model exhibited improved robustness to noise, and was
                            competitive with tokenizer-based models with 4x less data, the lack of patching meant that
                            the models needed to compute expensive attention operations over every byte, which was
                            extremely compute heavy. Directly modeling bytes instead of subword units increases the
                            sequence length of the input making it challenging to efficiently scale byte level models.
                            Recently, using the Mamba Architecture <cite class="ltx_cite ltx_citemacro_citep">(Gu and
                                Dao, <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib19"
                                    title="">2023</a>)</cite>, which can maintain a fixed-size memory state over a very
                            large context length, <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a
                                    class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib45"
                                    title="">2024</a>)</cite> train a byte-level Mamba architecture also without using
                            patching, and are able to outperform byte-level transformer models in a <span
                                class="ltx_text ltx_font_smallcaps" id="S8.p3.1.2">flop</span> controlled setting at the
                            350M parameter scale in terms of bits-per-byte on several datasets.</p>
                    </div>
                    <div class="ltx_para" id="S8.p4">
                        <p class="ltx_p" id="S8.p4.1"><span class="ltx_text ltx_font_bold" id="S8.p4.1.1">Patching-based
                                approaches:</span> The effective use of patching can bring down the otherwise inflated
                            number of <span class="ltx_text ltx_font_smallcaps" id="S8.p4.1.2">flop</span>s expended by
                            byte-level LLMs while potentially retaining performance, and many works demonstrated initial
                            successes at a small scale of model size and number of training bytes. <cite
                                class="ltx_cite ltx_citemacro_cite">Nawrot et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib33" title="">2022</a>)</cite>
                            experiment with static patching based downsampling and upsampling and develop the hourglass
                            transformer which outperforms other byte-level baselines at the 150M scale. <cite
                                class="ltx_cite ltx_citemacro_cite">Nawrot et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib34" title="">2023</a>)</cite>
                            further improve this with the help of dynamic patching schemes, including a
                            boundary-predictor that is learned in an end-to-end fashion, a boundary-predictor supervised
                            using certain tokenizers, as well as an entropy-based patching model similar to <span
                                class="ltx_text ltx_font_smallcaps" id="S8.p4.1.3">B</span>LT, and show that this
                            approach can outperform the vanilla transformers of the time on language modeling tasks at a
                            40M parameter scale on 400M tokens. <cite class="ltx_cite ltx_citemacro_cite">Lester et al.
                                (<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib27"
                                    title="">2024</a>)</cite> investigate training on sequences compressed using
                            arithmetic coding to achieve compression rates beyond what BPE can achieve, and by using a
                            equal-info windows technique, are able to outperform byte-level baselines on language
                            modeling tasks, but underperform subword baselines.</p>
                    </div>
                    <div class="ltx_para" id="S8.p5">
                        <p class="ltx_p" id="S8.p5.1">Our work draws inspiration and is most closely related to MegaByte
                            <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib48" title="">2023</a>)</cite>,
                            which is a decoder only causal LLM that uses a fixed static patching and concatenation of
                            representations to convert bytes to patches, and uses a local model on the decoder side to
                            convert from patches back into bytes. They demonstrate that MegaByte can match
                            tokenizer-based models at a 1B parameter scale on a dataset of 400B bytes. We ablate
                            MegaByte in all our experiments and find that static patching lags behind the current
                            state-of-the-art compute optimally trained tokenizer based models in a <span
                                class="ltx_text ltx_font_smallcaps" id="S8.p5.1.1">flop</span> controlled setting and we
                            demonstrate how <span class="ltx_text ltx_font_smallcaps" id="S8.p5.1.2">B</span>LT bridges
                            this gap. <cite class="ltx_cite ltx_citemacro_cite">Slagle (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib39" title="">2024</a>)</cite> make
                            the same observation about MegaByte and suggest extending the static patching method to
                            patching on whitespaces and other space-like bytes, and also add a local encoder model. They
                            find improvements over tokenized-based transformer models in a compute controlled setting on
                            some domains such as Github and arXiv at the 1B parameter scale. We also report experiments
                            with this model, and show that further architectural improvements are needed to scale up
                            byte-level models even further and truly match current state-of-the-art token-based models
                            such as Llama 3.</p>
                    </div>
                </section>
                <section class="ltx_section" id="S9">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">9 </span>Limitations and Future Work
                    </h2>
                    <div class="ltx_para" id="S9.p1">
                        <p class="ltx_p" id="S9.p1.1">In this work, for the purposes of architectural choices, we train
                            models for the optimal number of steps as determined for Llama 3 <cite
                                class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib13" title="">2024</a>)</cite>.
                            However, these scaling laws were calculated for BPE-level transformers and may lead to
                            suboptimal (data, parameter sizes) ratios in the case of <span
                                class="ltx_text ltx_font_smallcaps" id="S9.p1.1.1">B</span>LT. We leave for future work
                            the calculation of scaling laws for <span class="ltx_text ltx_font_smallcaps"
                                id="S9.p1.1.2">B</span>LT potentially leading to even more favorable scaling trends for
                            our architecture. Additionally, many of these experiments were conducted at scales upto 1B
                            parameters, and it is possible for the optimal architectural choices to change as we scale
                            to 8B parameters and beyond, which may unlock improved performance for larger scales.</p>
                    </div>
                    <div class="ltx_para" id="S9.p2">
                        <p class="ltx_p" id="S9.p2.1">Existing transformer libraries and codebases are designed to be
                            highly efficient for tokenizer-based transformer architectures. While we present theoretical
                            <span class="ltx_text ltx_font_smallcaps" id="S9.p2.1.1">flop</span> matched experiments and
                            also use certain efficient implementations (such as FlexAttention) to handle layers that
                            deviate from the vanilla transformer architecture, our implementations may yet not be at
                            parity with tokenizer-based models in terms of wall-clock time and may benefit from further
                            optimizations.</p>
                    </div>
                    <div class="ltx_para" id="S9.p3">
                        <p class="ltx_p" id="S9.p3.1">While <span class="ltx_text ltx_font_smallcaps"
                                id="S9.p3.1.1">B</span>LT uses a separately trained entropy model for patching, learning
                            the patching model in an end-to-end fashion can be an interesting direction for future work.
                            In Section <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S6.SS2"
                                title="6.2 Training BLT from Llama 3 ‣ 6 Byte Modeling Improves Robustness ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">6.2</span></a>, we present initial experiments showing
                            indications of success for “byte-ifying” tokenizer-based models such as Llama 3 that are
                            trained on more than 10T tokens, by initializing and freezing the global transformer with
                            their weights. Further work in this direction may uncover methods that not only retain the
                            benefits of bytefying, but also push performance beyond that of these tokenizer-based models
                            without training them from scratch.</p>
                    </div>
                </section>
                <section class="ltx_section" id="S10">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">10 </span>Conclusion
                    </h2>
                    <div class="ltx_para" id="S10.p1">
                        <p class="ltx_p" id="S10.p1.1">This paper presents the Byte Latent Transformer (<span
                                class="ltx_text ltx_font_bold" id="S10.p1.1.1">BLT</span>), a new architecture that
                            redefines the conventional dependency on fixed-vocabulary tokenization in large language
                            models. By introducing a dynamic, learnable method for grouping bytes into patches, <span
                                class="ltx_text ltx_font_smallcaps" id="S10.p1.1.2">B</span>LT effectively allocates
                            computational resources based on data complexity, leading to significant improvements in
                            both efficiency and robustness. Our extensive scaling study demonstrates that <span
                                class="ltx_text ltx_font_smallcaps" id="S10.p1.1.3">B</span>LT models can match the
                            performance of tokenization-based models like Llama 3 at scales up to 8B and 4T bytes, and
                            can trade minor losses in evaluation metrics for up to 50% reductions in inference <span
                                class="ltx_text ltx_font_smallcaps" id="S10.p1.1.4">flop</span>s.
                            Furthermore, <span class="ltx_text ltx_font_smallcaps" id="S10.p1.1.5">B</span>LT unlocks a
                            new dimension for scaling, allowing simultaneous increases in model and patch size within a
                            fixed inference budget. This new paradigm becomes advantageous for compute regimes commonly
                            encountered in practical settings.
                            While directly engaging with raw byte data, <span class="ltx_text ltx_font_smallcaps"
                                id="S10.p1.1.6">B</span>LT also improves the model’s ability to handle the long-tail of
                            data, offering significant improvements in robustness to noisy inputs and a deeper
                            understanding of sub-word structures.
                            Overall, these results position <span class="ltx_text ltx_font_smallcaps"
                                id="S10.p1.1.7">B</span>LT as a promising alternative to traditional tokenization-based
                            approaches, providing a scalable and robust framework for more efficient and adaptable
                            language models.</p>
                    </div>
                </section>
                <section class="ltx_section" id="Sx1">
                    <h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
                    <div class="ltx_para" id="Sx1.p1">
                        <p class="ltx_p" id="Sx1.p1.1">We would like to thank Kalyan Saladi for help with everything
                            relating to pre-training infrastructure; Gabriel Synnaeve, Ammar Rizvi, Jacob Kahn, Michel
                            Meyer for helping organize resources for scaling up <span
                                class="ltx_text ltx_font_smallcaps" id="Sx1.p1.1.1">B</span>LT; Badr Youbi Idirissi,
                            Mathurin Videau, and Jade Copet for invaluable discussions and feedback about <span
                                class="ltx_text ltx_font_smallcaps" id="Sx1.p1.1.2">B</span>LT, for access to the Lingua
                            framework for open-sourcing code for <span class="ltx_text ltx_font_smallcaps"
                                id="Sx1.p1.1.3">B</span>LT, and for help preparing the <span
                                class="ltx_text ltx_font_smallcaps" id="Sx1.p1.1.4">B</span>LT-1T dataset used in this
                            paper; Omer Levy, who was actively involved in the early stages of the project and provided
                            valuable feedback and ideas; Driss Guessous for help with FlexAttention; and Sida Wang,
                            Melanie Sclar, Amanda Bertsch, and Hunter Lang for feedback and discussions.</p>
                    </div>
                </section>
                <section class="ltx_section" id="Sx2">
                    <h2 class="ltx_title ltx_title_section">Contributors</h2>
                    <div class="ltx_para" id="Sx2.p1">
                        <p class="ltx_p" id="Sx2.p1.1">In this section, we list individual contributions.</p>
                    </div>
                    <section class="ltx_paragraph" id="Sx2.SS0.SSS0.Px1">
                        <h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Core Contributors:</h5>
                        <div class="ltx_para" id="Sx2.SS0.SSS0.Px1.p1">
                            <p class="ltx_p" id="Sx2.SS0.SSS0.Px1.p1.1">Artidoro Pagnoni, Srinivasan Iyer, Ramakanth
                                Pasunuru, Pedro Rodriguez, John Nguyen, Gargi Ghosh (Project Lead)</p>
                        </div>
                    </section>
                    <section class="ltx_paragraph" id="Sx2.SS0.SSS0.Px2">
                        <h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Core Advising Group:</h5>
                        <div class="ltx_para" id="Sx2.SS0.SSS0.Px2.p1">
                            <p class="ltx_p" id="Sx2.SS0.SSS0.Px2.p1.1">Mike Lewis, Ari Holtzman, Luke Zettlemoyer</p>
                        </div>
                    </section>
                    <section class="ltx_paragraph" id="Sx2.SS0.SSS0.Px3">
                        <h5 class="ltx_title ltx_font_bold ltx_title_paragraph">Advisors and Contributors:</h5>
                        <div class="ltx_para" id="Sx2.SS0.SSS0.Px3.p1">
                            <p class="ltx_p" id="Sx2.SS0.SSS0.Px3.p1.1">Jason Weston, Benjamin Muller, Margaret Li,
                                Chunting Zhou, Lili Yu</p>
                        </div>
                        <div class="ltx_pagination ltx_role_newpage"></div>
                        <div class="ltx_pagination ltx_role_newpage"></div>
                    </section>
                </section>
                <section class="ltx_bibliography" id="bib">
                    <h2 class="ltx_title ltx_title_bibliography">References</h2>
                    <ul class="ltx_biblist">
                        <li class="ltx_bibitem" id="bib.bib1">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Al-Rfou et al. (2019)</span>
                            <span class="ltx_bibblock">
                                Rami Al-Rfou, Dokook Choe, Noah Constant, Mandy Guo, and Llion Jones.

                            </span>
                            <span class="ltx_bibblock">Character-level language modeling with deeper self-attention.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib1.1.1">Association for the Advancement of Artificial Intelligence</em>,
                                volume 33, pages 3159–3166, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib2">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et al. (2021)</span>
                            <span class="ltx_bibblock">
                                Jacob Austin, Augustus Odena, Maxwell Nye, Maarten Bosma, Henryk Michalewski, David
                                Dohan, Ellen Jiang, Carrie Cai, Michael Terry, Quoc Le, and Charles Sutton.

                            </span>
                            <span class="ltx_bibblock">Program synthesis with large language models, 2021.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib3">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2010)</span>
                            <span class="ltx_bibblock">
                                Bing Bai, Jason Weston, David Grangier, Ronan Collobert, Kunihiko Sadamasa, Yanjun Qi,
                                Olivier Chapelle, and Kilian Weinberger.

                            </span>
                            <span class="ltx_bibblock">Learning to rank with (a lot of) word features.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib3.1.1">Information retrieval</em>, 13:291–314, 2010.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib4">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bisk et al. (2020)</span>
                            <span class="ltx_bibblock">
                                Yonatan Bisk, Rowan Zellers, Jianfeng Gao, Yejin Choi, et al.

                            </span>
                            <span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib4.1.1">Association for the Advancement of Artificial Intelligence</em>,
                                pages 7432–7439, 2020.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib5">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casson (2023)</span>
                            <span class="ltx_bibblock">
                                Adam Casson.

                            </span>
                            <span class="ltx_bibblock">Transformer flops, 2023.

                            </span>
                            <span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter"
                                    href="https://www.adamcasson.com/posts/transformer-flops"
                                    title="">https://www.adamcasson.com/posts/transformer-flops</a>.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib6">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
                            <span class="ltx_bibblock">
                                Mark Chen, Jerry Tworek, Heewoo Jun, Qiming Yuan, Henrique Ponde de Oliveira Pinto,
                                Jared Kaplan, Harri Edwards, Yuri Burda, Nicholas Joseph, Greg Brockman, Alex Ray, Raul
                                Puri, Gretchen Krueger, Michael Petrov, Heidy Khlaaf, Girish Sastry, Pamela Mishkin,
                                Brooke Chan, Scott Gray, Nick Ryder, Mikhail Pavlov, Alethea Power, Lukasz Kaiser,
                                Mohammad Bavarian, Clemens Winter, Philippe Tillet, Felipe Petroski Such, Dave Cummings,
                                Matthias Plappert, Fotios Chantzis, Elizabeth Barnes, Ariel Herbert-Voss, William Hebgen
                                Guss, Alex Nichol, Alex Paino, Nikolas Tezak, Jie Tang, Igor Babuschkin, Suchir Balaji,
                                Shantanu Jain, William Saunders, Christopher Hesse, Andrew N. Carr, Jan Leike, Josh
                                Achiam, Vedant Misra, Evan Morikawa, Alec Radford, Matthew Knight, Miles Brundage, Mira
                                Murati, Katie Mayer, Peter Welinder, Bob McGrew, Dario Amodei, Sam McCandlish, Ilya
                                Sutskever, and Wojciech Zaremba.

                            </span>
                            <span class="ltx_bibblock">Evaluating large language models trained on code, 2021.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib7">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choe et al. (2019)</span>
                            <span class="ltx_bibblock">
                                Dokook Choe, Rami Al-Rfou, Mandy Guo, Heeyoung Lee, and Noah Constant.

                            </span>
                            <span class="ltx_bibblock">Bridging the gap for tokenizer-free language models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib7.1.1">arXiv</em>, abs/1908.10322, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib8">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2019)</span>
                            <span class="ltx_bibblock">
                                Junyoung Chung, Sungjin Ahn, and Yoshua Bengio.

                            </span>
                            <span class="ltx_bibblock">Hierarchical multiscale recurrent neural networks.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib8.1.1">Proceedings of the International Conference on Learning
                                    Representations</em>, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib9">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Jonathan H Clark, Dan Garrette, Iulia Turc, and John Wieting.

                            </span>
                            <span class="ltx_bibblock">Canine: Pre-training an efficient tokenization-free encoder for
                                language representation.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib9.1.1">Transactions of the Association for Computational
                                    Linguistics</em>, 10:73–91, 2022.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib10">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2018)</span>
                            <span class="ltx_bibblock">
                                Peter Clark, Isaac Cowhey, Oren Etzioni, Tushar Khot, Ashish Sabharwal, Carissa
                                Schoenick, and Oyvind Tafjord.

                            </span>
                            <span class="ltx_bibblock">Think you have solved question answering? Try ARC, the AI2
                                reasoning challenge.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib10.1.1">arXiv</em>, 2018.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib11">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dagan et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Gautier Dagan, Gabriel Synnaeve, and Baptiste Roziere.

                            </span>
                            <span class="ltx_bibblock">Getting the most out of your tokenizer for pre-training and
                                domain adaptation.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib11.1.1">Forty-first International Conference on Machine Learning</em>,
                                2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib12">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dao et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.

                            </span>
                            <span class="ltx_bibblock">FlashAttention: Fast and memory-efficient exact attention with
                                io-awareness.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib12.1.1">Proceedings of Advances in Neural Information Processing
                                    Systems</em>, 35, 2022.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib13">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha
                                Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

                            </span>
                            <span class="ltx_bibblock">The llama 3 herd of models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib13.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib14">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edman et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Lukas Edman, Helmut Schmid, and Alexander Fraser.

                            </span>
                            <span class="ltx_bibblock">CUTE: Measuring llms’ understanding of their tokens.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib14.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib15">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">El Boukkouri et al. (2020)</span>
                            <span class="ltx_bibblock">
                                Hicham El Boukkouri, Olivier Ferret, Thomas Lavergne, Hiroshi Noji, Pierre Zweigenbaum,
                                and Jun’ichi Tsujii.

                            </span>
                            <span class="ltx_bibblock">CharacterBERT: Reconciling elmo and bert for word-level
                                open-vocabulary representations from characters.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib15.1.1">Proceedings of International Conference on Computational
                                    Linguistics</em>, 2020.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib16">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gage (1994)</span>
                            <span class="ltx_bibblock">
                                Philip Gage.

                            </span>
                            <span class="ltx_bibblock">A new algorithm for data compression.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">The C
                                    Users Journal</em>, 12(2):23–38, 1994.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib17">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Naman Goyal, Cynthia Gao, Vishrav Chaudhary, Peng-Jen Chen, Guillaume Wenzek, Da Ju,
                                Sanjana Krishnan, Marc’Aurelio Ranzato, Francisco Guzmán, and Angela Fan.

                            </span>
                            <span class="ltx_bibblock">The Flores-101 evaluation benchmark for low-resource and
                                multilingual machine translation.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib17.1.1">Transactions of the Association for Computational
                                    Linguistics</em>, 10:522–538, 2022.

                            </span>
                            <span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.1162/tacl_a_00474"
                                    title="">10.1162/tacl_a_00474</a>.

                            </span>
                            <span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter"
                                    href="https://aclanthology.org/2022.tacl-1.30"
                                    title="">https://aclanthology.org/2022.tacl-1.30</a>.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib18">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves (2013)</span>
                            <span class="ltx_bibblock">
                                Alex Graves.

                            </span>
                            <span class="ltx_bibblock">Generating sequences with recurrent neural networks.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib18.1.1">arXiv</em>, 2013.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib19">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
                            <span class="ltx_bibblock">
                                Albert Gu and Tri Dao.

                            </span>
                            <span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib19.1.1">arXiv</em>, 2023.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib20">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et al. (2020)</span>
                            <span class="ltx_bibblock">
                                Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and
                                Jacob Steinhardt.

                            </span>
                            <span class="ltx_bibblock">Measuring massive multitask language understanding.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib20.1.1">Proceedings of the International Conference on Learning
                                    Representations</em>, 2020.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib21">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hoffmann et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza
                                Rutherford, Diego de Las Casas, Lisa Anne Hendricks, Johannes Welbl, Aidan Clark, et al.

                            </span>
                            <span class="ltx_bibblock">Training compute-optimal large language models.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib21.1.1">Proceedings of Advances in Neural Information Processing
                                    Systems</em>, 2022.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib22">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaegle et al. (2021)</span>
                            <span class="ltx_bibblock">
                                Andrew Jaegle, Felix Gimeno, Andy Brock, Oriol Vinyals, Andrew Zisserman, and Joao
                                Carreira.

                            </span>
                            <span class="ltx_bibblock">Perceiver: General perception with iterative attention.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib22.1.1">Proceedings of the International Conference of Machine
                                    Learning</em>. PMLR, 2021.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib23">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalchbrenner et al. (2016)</span>
                            <span class="ltx_bibblock">
                                Nal Kalchbrenner, Lasse Espeholt, Karen Simonyan, Aäron van den Oord, Alexander Graves,
                                and Koray Kavukcuoglu.

                            </span>
                            <span class="ltx_bibblock">Neural machine translation in linear time.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib23.1.1">arXiv</em>, 2016.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib24">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et al. (2020)</span>
                            <span class="ltx_bibblock">
                                Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B Brown, Benjamin Chess, Rewon Child,
                                Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei.

                            </span>
                            <span class="ltx_bibblock">Scaling laws for neural language models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib24.1.1">arXiv</em>, 2020.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib25">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kenter et al. (2018)</span>
                            <span class="ltx_bibblock">
                                Tom Kenter, Llion Jones, and Daniel Hewlett.

                            </span>
                            <span class="ltx_bibblock">Byte-level machine reading across morphologically varied
                                languages.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib25.1.1">Association for the Advancement of Artificial Intelligence</em>,
                                2018.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib26">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2016)</span>
                            <span class="ltx_bibblock">
                                Yoon Kim, Yacine Jernite, David Sontag, and Alexander Rush.

                            </span>
                            <span class="ltx_bibblock">Character-aware neural language models.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib26.1.1">Association for the Advancement of Artificial Intelligence</em>,
                                2016.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib27">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Brian Lester, Jaehoon Lee, Alex Alemi, Jeffrey Pennington, Adam Roberts, Jascha
                                Sohl-Dickstein, and Noah Constant.

                            </span>
                            <span class="ltx_bibblock">Training llms over neurally compressed text.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib27.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib28">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Jeffrey Li, Alex Fang, Georgios Smyrnis, Maor Ivgi, Matt Jordan, Samir Gadre, Hritik
                                Bansal, Etash Guha, Sedrick Keh, Kushal Arora, et al.

                            </span>
                            <span class="ltx_bibblock">Datacomp-lm: In search of the next generation of training sets
                                for language models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib28.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib29">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2023)</span>
                            <span class="ltx_bibblock">
                                Davis Liang, Hila Gonen, Yuning Mao, Rui Hou, Naman Goyal, Marjan Ghazvininejad, Luke
                                Zettlemoyer, and Madian Khabsa.

                            </span>
                            <span class="ltx_bibblock">Xlm-v: Overcoming the vocabulary bottleneck in multilingual
                                masked language models.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib29.1.1">Proceedings of Empirical Methods in Natural Language
                                    Processing</em>, 2023.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib30">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Limisiewicz et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Tomasz Limisiewicz, Terra Blevins, Hila Gonen, Orevaoghene Ahia, and Luke Zettlemoyer.

                            </span>
                            <span class="ltx_bibblock">Myte: Morphology-driven byte encoding for better and fairer
                                multilingual language modeling.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib30.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib31">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)</span>
                            <span class="ltx_bibblock">
                                Ilya Loshchilov and Frank Hutter.

                            </span>
                            <span class="ltx_bibblock">Decoupled weight decay regularization.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib31.1.1">arXiv</em>, 2017.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib32">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al. (2012)</span>
                            <span class="ltx_bibblock">
                                Tomáš Mikolov, Ilya Sutskever, Anoop Deoras, Hai-Son Le, Stefan Kombrink, and Jan
                                Cernocky.

                            </span>
                            <span class="ltx_bibblock">Subword language modeling with neural networks.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">preprint
                                    (http://www. fit. vutbr. cz/imikolov/rnnlm/char. pdf)</em>, 8(67), 2012.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib33">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nawrot et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Piotr Nawrot, Szymon Tworkowski, Michał Tyrolski, Lukasz Kaiser, Yuhuai Wu, Christian
                                Szegedy, and Henryk Michalewski.

                            </span>
                            <span class="ltx_bibblock">Hierarchical transformers are more efficient language models.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib33.1.1">Conference of the North American Chapter of the Association for
                                    Computational Linguistics</em>. Association for Computational Linguistics, 2022.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib34">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nawrot et al. (2023)</span>
                            <span class="ltx_bibblock">
                                Piotr Nawrot, Jan Chorowski, Adrian Lancucki, and Edoardo Maria Ponti.

                            </span>
                            <span class="ltx_bibblock">Efficient transformers with dynamic token pooling.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib34.1.1">Proceedings of the Association for Computational
                                    Linguistics</em>. Association for Computational Linguistics, 2023.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib35">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Aleksandar Petrov, Emanuele La Malfa, Philip Torr, and Adel Bibi.

                            </span>
                            <span class="ltx_bibblock">Language model tokenizers introduce unfairness between languages.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib35.1.1">Proceedings of Advances in Neural Information Processing
                                    Systems</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib36">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
                            <span class="ltx_bibblock">
                                Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.

                            </span>
                            <span class="ltx_bibblock">Language models are unsupervised multitask learners.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">OpenAI
                                    blog</em>, 1(8):9, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib37">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016)</span>
                            <span class="ltx_bibblock">
                                Rico Sennrich, Barry Haddow, and Alexandra Birch.

                            </span>
                            <span class="ltx_bibblock">Neural machine translation of rare words with subword units.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib37.1.1">Proceedings of the Association for Computational
                                    Linguistics</em>. Association for Computational Linguistics, 2016.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib38">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2020)</span>
                            <span class="ltx_bibblock">
                                Noam Shazeer.

                            </span>
                            <span class="ltx_bibblock">GLU variants improve transformer.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib38.1.1">arXiv</em>, 2020.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib39">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Slagle (2024)</span>
                            <span class="ltx_bibblock">
                                Kevin Slagle.

                            </span>
                            <span class="ltx_bibblock">Spacebyte: Towards deleting tokenization from large language
                                modeling.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib39.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib40">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2021)</span>
                            <span class="ltx_bibblock">
                                Jianlin Su, Yu Lu, Shengfeng Pan, Ahmed Murtadha, Bo Wen, and Yunfeng Liu.

                            </span>
                            <span class="ltx_bibblock">RoFormer: Enhanced transformer with rotary position embedding.
                                arxiv e-prints, art.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib40.1.1">arXiv</em>, 2021.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib41">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2011)</span>
                            <span class="ltx_bibblock">
                                Ilya Sutskever, James Martens, and Geoffrey E Hinton.

                            </span>
                            <span class="ltx_bibblock">Generating text with recurrent neural networks.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib41.1.1">Proceedings of the International Conference of Machine
                                    Learning</em>, pages 1017–1024, 2011.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib42">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suvarna et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Ashima Suvarna, Harshita Khandelwal, and Nanyun Peng.

                            </span>
                            <span class="ltx_bibblock">Phonologybench: Evaluating phonological skills of large language
                                models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib42.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib43">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
                            <span class="ltx_bibblock">
                                Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei,
                                Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

                            </span>
                            <span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib43.1.1">arXiv</em>, 2023.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib44">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
                            <span class="ltx_bibblock">
                                Ashish Vaswani, Noam M. Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N.
                                Gomez, Lukasz Kaiser, and Illia Polosukhin.

                            </span>
                            <span class="ltx_bibblock">Attention is all you need.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Neural
                                    Information Processing Systems</em>, 2017.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib45">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Junxiong Wang, Tushaar Gangavarapu, Jing Nathan Yan, and Alexander M Rush.

                            </span>
                            <span class="ltx_bibblock">Mambabyte: Token-free selective state space model.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib45.1.1">arXiv</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib46">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2024)</span>
                            <span class="ltx_bibblock">
                                Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis
                                Martin, Rashi Rungta, Karthik Abinav Sankararaman, Barlas Oguz, et al.

                            </span>
                            <span class="ltx_bibblock">Effective long-context scaling of foundation models.

                            </span>
                            <span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic"
                                    id="bib.bib46.1.1">Conference of the North American Chapter of the Association for
                                    Computational Linguistics</em>, 2024.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib47">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xue et al. (2022)</span>
                            <span class="ltx_bibblock">
                                Linting Xue, Aditya Barua, Noah Constant, Rami Al-Rfou, Sharan Narang, Mihir Kale, Adam
                                Roberts, and Colin Raffel.

                            </span>
                            <span class="ltx_bibblock">Byt5: Towards a token-free future with pre-trained byte-to-byte
                                models.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib47.1.1">Transactions of the Association for Computational
                                    Linguistics</em>, 10:291–306, 2022.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib48">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
                            <span class="ltx_bibblock">
                                Lili Yu, Dániel Simig, Colin Flaherty, Armen Aghajanyan, Luke Zettlemoyer, and Mike
                                Lewis.

                            </span>
                            <span class="ltx_bibblock">Megabyte: Predicting million-byte sequences with multiscale
                                transformers.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib48.1.1">Proceedings of Advances in Neural Information Processing
                                    Systems</em>, 2023.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib49">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zellers et al. (2019)</span>
                            <span class="ltx_bibblock">
                                Rowan Zellers, Ari Holtzman, Yonatan Bisk, Ali Farhadi, and Yejin Choi.

                            </span>
                            <span class="ltx_bibblock">Hellaswag: Can a machine really finish your sentence?

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib49.1.1">arXiv</em>, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib50">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Sennrich (2019)</span>
                            <span class="ltx_bibblock">
                                Biao Zhang and Rico Sennrich.

                            </span>
                            <span class="ltx_bibblock">Root mean square layer normalization.

                            </span>
                            <span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic"
                                    id="bib.bib50.1.1">Proceedings of Advances in Neural Information Processing
                                    Systems</em>, 32, 2019.

                            </span>
                        </li>
                        <li class="ltx_bibitem" id="bib.bib51">
                            <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2015)</span>
                            <span class="ltx_bibblock">
                                Xiang Zhang, Junbo Zhao, and Yann LeCun.

                            </span>
                            <span class="ltx_bibblock">Character-level convolutional networks for text classification.

                            </span>
                            <span class="ltx_bibblock">In C. Cortes, N. Lawrence, D. Lee, M. Sugiyama, and R. Garnett,
                                editors, <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of Advances
                                    in Neural Information Processing Systems</em>, volume 28. Curran Associates, Inc.,
                                2015.

                            </span>
                            <span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter"
                                    href="https://proceedings.neurips.cc/paper_files/paper/2015/file/250cf8b51c773f3f8dc8b4be867a9a02-Paper.pdf"
                                    title="">https://proceedings.neurips.cc/paper_files/paper/2015/file/250cf8b51c773f3f8dc8b4be867a9a02-Paper.pdf</a>.

                            </span>
                        </li>
                    </ul>
                </section>
                <div class="ltx_pagination ltx_role_newpage"></div>
                <div class="ltx_pagination ltx_role_newpage"></div>
                <div class="ltx_para" id="p5">
                    <span class="ltx_ERROR undefined" id="p5.1">\beginappendix</span>
                </div>
                <section class="ltx_section" id="S11">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">11 </span>Model Hyper Parameters
                    </h2>
                    <div class="ltx_para" id="S11.p1">
                        <p class="ltx_p" id="S11.p1.1">Table <a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S11.T10"
                                title="Table 10 ‣ 11 Model Hyper Parameters ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">10</span></a> shows different hyper parameter settings
                            for <span class="ltx_text ltx_font_smallcaps" id="S11.p1.1.1">B</span>LT models.</p>
                    </div>
                    <figure class="ltx_table" id="S11.T10">
                        <div class="ltx_inline-block ltx_transformed_outer" id="S11.T10.6"
                            style="width:433.6pt;height:96.4pt;vertical-align:-0.0pt;"><span
                                class="ltx_transformed_inner"
                                style="transform:translate(-66.6pt,14.8pt) scale(0.765052999516244,0.765052999516244) ;">
                                <table class="ltx_tabular ltx_align_middle" id="S11.T10.6.6">
                                    <tbody class="ltx_tbody">
                                        <tr class="ltx_tr" id="S11.T10.6.6.7.1">
                                            <td class="ltx_td ltx_border_tt" id="S11.T10.6.6.7.1.1"></td>
                                            <td class="ltx_td ltx_border_tt" id="S11.T10.6.6.7.1.2"></td>
                                            <td class="ltx_td ltx_align_center ltx_border_tt" colspan="4"
                                                id="S11.T10.6.6.7.1.3">Encoder</td>
                                            <td class="ltx_td ltx_align_center ltx_border_tt" colspan="4"
                                                id="S11.T10.6.6.7.1.4">Global Latent Transf.</td>
                                            <td class="ltx_td ltx_align_center ltx_border_tt" colspan="4"
                                                id="S11.T10.6.6.7.1.5">Decoder</td>
                                            <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2"
                                                id="S11.T10.6.6.7.1.6">Cross-Attn.</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.6">
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.7">Model</td>
                                            <td class="ltx_td" id="S11.T10.6.6.6.8"></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.1.1.1.1"><math
                                                    alttext="l_{\mathcal{E}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.1.1.1.1.m1.1">
                                                    <semantics id="S11.T10.1.1.1.1.m1.1a">
                                                        <msub id="S11.T10.1.1.1.1.m1.1.1"
                                                            xref="S11.T10.1.1.1.1.m1.1.1.cmml">
                                                            <mi id="S11.T10.1.1.1.1.m1.1.1.2"
                                                                xref="S11.T10.1.1.1.1.m1.1.1.2.cmml">l</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.1.1.1.1.m1.1.1.3"
                                                                xref="S11.T10.1.1.1.1.m1.1.1.3.cmml">ℰ</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.1.1.1.1.m1.1b">
                                                            <apply id="S11.T10.1.1.1.1.m1.1.1.cmml"
                                                                xref="S11.T10.1.1.1.1.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.1.1.1.1.m1.1.1.1.cmml"
                                                                    xref="S11.T10.1.1.1.1.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.1.1.1.1.m1.1.1.2.cmml"
                                                                    xref="S11.T10.1.1.1.1.m1.1.1.2">𝑙</ci>
                                                                <ci id="S11.T10.1.1.1.1.m1.1.1.3.cmml"
                                                                    xref="S11.T10.1.1.1.1.m1.1.1.3">ℰ</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.1.1.1.1.m1.1c">l_{\mathcal{E}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.1.1.1.1.m1.1d">italic_l start_POSTSUBSCRIPT
                                                            caligraphic_E end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.9">#heads</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.2.2.2.2"><math
                                                    alttext="h_{\mathcal{E}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.2.2.2.2.m1.1">
                                                    <semantics id="S11.T10.2.2.2.2.m1.1a">
                                                        <msub id="S11.T10.2.2.2.2.m1.1.1"
                                                            xref="S11.T10.2.2.2.2.m1.1.1.cmml">
                                                            <mi id="S11.T10.2.2.2.2.m1.1.1.2"
                                                                xref="S11.T10.2.2.2.2.m1.1.1.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.2.2.2.2.m1.1.1.3"
                                                                xref="S11.T10.2.2.2.2.m1.1.1.3.cmml">ℰ</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.2.2.2.2.m1.1b">
                                                            <apply id="S11.T10.2.2.2.2.m1.1.1.cmml"
                                                                xref="S11.T10.2.2.2.2.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.2.2.2.2.m1.1.1.1.cmml"
                                                                    xref="S11.T10.2.2.2.2.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.2.2.2.2.m1.1.1.2.cmml"
                                                                    xref="S11.T10.2.2.2.2.m1.1.1.2">ℎ</ci>
                                                                <ci id="S11.T10.2.2.2.2.m1.1.1.3.cmml"
                                                                    xref="S11.T10.2.2.2.2.m1.1.1.3">ℰ</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.2.2.2.2.m1.1c">h_{\mathcal{E}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.2.2.2.2.m1.1d">italic_h start_POSTSUBSCRIPT
                                                            caligraphic_E end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.10">#Params</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.3.3.3.3"><math
                                                    alttext="l_{\mathcal{G}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.3.3.3.3.m1.1">
                                                    <semantics id="S11.T10.3.3.3.3.m1.1a">
                                                        <msub id="S11.T10.3.3.3.3.m1.1.1"
                                                            xref="S11.T10.3.3.3.3.m1.1.1.cmml">
                                                            <mi id="S11.T10.3.3.3.3.m1.1.1.2"
                                                                xref="S11.T10.3.3.3.3.m1.1.1.2.cmml">l</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.3.3.3.3.m1.1.1.3"
                                                                xref="S11.T10.3.3.3.3.m1.1.1.3.cmml">𝒢</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.3.3.3.3.m1.1b">
                                                            <apply id="S11.T10.3.3.3.3.m1.1.1.cmml"
                                                                xref="S11.T10.3.3.3.3.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.3.3.3.3.m1.1.1.1.cmml"
                                                                    xref="S11.T10.3.3.3.3.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.3.3.3.3.m1.1.1.2.cmml"
                                                                    xref="S11.T10.3.3.3.3.m1.1.1.2">𝑙</ci>
                                                                <ci id="S11.T10.3.3.3.3.m1.1.1.3.cmml"
                                                                    xref="S11.T10.3.3.3.3.m1.1.1.3">𝒢</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.3.3.3.3.m1.1c">l_{\mathcal{G}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.3.3.3.3.m1.1d">italic_l start_POSTSUBSCRIPT
                                                            caligraphic_G end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.11">#heads</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.4.4.4.4"><math
                                                    alttext="h_{\mathcal{G}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.4.4.4.4.m1.1">
                                                    <semantics id="S11.T10.4.4.4.4.m1.1a">
                                                        <msub id="S11.T10.4.4.4.4.m1.1.1"
                                                            xref="S11.T10.4.4.4.4.m1.1.1.cmml">
                                                            <mi id="S11.T10.4.4.4.4.m1.1.1.2"
                                                                xref="S11.T10.4.4.4.4.m1.1.1.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.4.4.4.4.m1.1.1.3"
                                                                xref="S11.T10.4.4.4.4.m1.1.1.3.cmml">𝒢</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.4.4.4.4.m1.1b">
                                                            <apply id="S11.T10.4.4.4.4.m1.1.1.cmml"
                                                                xref="S11.T10.4.4.4.4.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.4.4.4.4.m1.1.1.1.cmml"
                                                                    xref="S11.T10.4.4.4.4.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.4.4.4.4.m1.1.1.2.cmml"
                                                                    xref="S11.T10.4.4.4.4.m1.1.1.2">ℎ</ci>
                                                                <ci id="S11.T10.4.4.4.4.m1.1.1.3.cmml"
                                                                    xref="S11.T10.4.4.4.4.m1.1.1.3">𝒢</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.4.4.4.4.m1.1c">h_{\mathcal{G}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.4.4.4.4.m1.1d">italic_h start_POSTSUBSCRIPT
                                                            caligraphic_G end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.12">#Params</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.5.5.5.5"><math
                                                    alttext="l_{\mathcal{D}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.5.5.5.5.m1.1">
                                                    <semantics id="S11.T10.5.5.5.5.m1.1a">
                                                        <msub id="S11.T10.5.5.5.5.m1.1.1"
                                                            xref="S11.T10.5.5.5.5.m1.1.1.cmml">
                                                            <mi id="S11.T10.5.5.5.5.m1.1.1.2"
                                                                xref="S11.T10.5.5.5.5.m1.1.1.2.cmml">l</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.5.5.5.5.m1.1.1.3"
                                                                xref="S11.T10.5.5.5.5.m1.1.1.3.cmml">𝒟</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.5.5.5.5.m1.1b">
                                                            <apply id="S11.T10.5.5.5.5.m1.1.1.cmml"
                                                                xref="S11.T10.5.5.5.5.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.5.5.5.5.m1.1.1.1.cmml"
                                                                    xref="S11.T10.5.5.5.5.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.5.5.5.5.m1.1.1.2.cmml"
                                                                    xref="S11.T10.5.5.5.5.m1.1.1.2">𝑙</ci>
                                                                <ci id="S11.T10.5.5.5.5.m1.1.1.3.cmml"
                                                                    xref="S11.T10.5.5.5.5.m1.1.1.3">𝒟</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.5.5.5.5.m1.1c">l_{\mathcal{D}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.5.5.5.5.m1.1d">italic_l start_POSTSUBSCRIPT
                                                            caligraphic_D end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.13">#heads</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.6"><math
                                                    alttext="h_{\mathcal{D}}" class="ltx_Math" display="inline"
                                                    id="S11.T10.6.6.6.6.m1.1">
                                                    <semantics id="S11.T10.6.6.6.6.m1.1a">
                                                        <msub id="S11.T10.6.6.6.6.m1.1.1"
                                                            xref="S11.T10.6.6.6.6.m1.1.1.cmml">
                                                            <mi id="S11.T10.6.6.6.6.m1.1.1.2"
                                                                xref="S11.T10.6.6.6.6.m1.1.1.2.cmml">h</mi>
                                                            <mi class="ltx_font_mathcaligraphic"
                                                                id="S11.T10.6.6.6.6.m1.1.1.3"
                                                                xref="S11.T10.6.6.6.6.m1.1.1.3.cmml">𝒟</mi>
                                                        </msub><annotation-xml encoding="MathML-Content"
                                                            id="S11.T10.6.6.6.6.m1.1b">
                                                            <apply id="S11.T10.6.6.6.6.m1.1.1.cmml"
                                                                xref="S11.T10.6.6.6.6.m1.1.1">
                                                                <csymbol cd="ambiguous"
                                                                    id="S11.T10.6.6.6.6.m1.1.1.1.cmml"
                                                                    xref="S11.T10.6.6.6.6.m1.1.1">subscript</csymbol>
                                                                <ci id="S11.T10.6.6.6.6.m1.1.1.2.cmml"
                                                                    xref="S11.T10.6.6.6.6.m1.1.1.2">ℎ</ci>
                                                                <ci id="S11.T10.6.6.6.6.m1.1.1.3.cmml"
                                                                    xref="S11.T10.6.6.6.6.m1.1.1.3">𝒟</ci>
                                                            </apply>
                                                        </annotation-xml>
                                                        <annotation encoding="application/x-tex"
                                                            id="S11.T10.6.6.6.6.m1.1c">h_{\mathcal{D}}</annotation>
                                                        <annotation encoding="application/x-llamapun"
                                                            id="S11.T10.6.6.6.6.m1.1d">italic_h start_POSTSUBSCRIPT
                                                            caligraphic_D end_POSTSUBSCRIPT</annotation>
                                                    </semantics>
                                                </math></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.14">#Params</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.15">#heads</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.6.16">k</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.8.2">
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.1"><span
                                                    class="ltx_text ltx_font_bold" id="S11.T10.6.6.8.2.1.1">400M</span>
                                            </td>
                                            <td class="ltx_td ltx_border_t" id="S11.T10.6.6.8.2.2"></td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.3">1</td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.4">12
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.5">768
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.6">7M
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.7">24
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.8">10
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.9">1280
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.10">470M
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.11">7
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.12">12
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.13">768
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.14">50M
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.15">10
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S11.T10.6.6.8.2.16">2
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.9.3">
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.1"><span
                                                    class="ltx_text ltx_font_bold" id="S11.T10.6.6.9.3.1.1">1B</span>
                                            </td>
                                            <td class="ltx_td" id="S11.T10.6.6.9.3.2"></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.3">1</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.4">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.5">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.6">12M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.7">25</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.8">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.9">2048</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.10">1B</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.11">9</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.12">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.13">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.14">113M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.15">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.9.3.16">2</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.10.4">
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.1"><span
                                                    class="ltx_text ltx_font_bold" id="S11.T10.6.6.10.4.1.1">2B</span>
                                            </td>
                                            <td class="ltx_td" id="S11.T10.6.6.10.4.2"></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.3">1</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.4">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.5">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.6">12M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.7">26</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.8">20</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.9">2560</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.10">2B</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.11">9</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.12">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.13">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.14">113M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.15">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.10.4.16">3</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.11.5">
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.1"><span
                                                    class="ltx_text ltx_font_bold" id="S11.T10.6.6.11.5.1.1">4B</span>
                                            </td>
                                            <td class="ltx_td" id="S11.T10.6.6.11.5.2"></td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.3">1</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.4">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.5">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.6">12M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.7">36</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.8">24</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.9">3072</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.10">4.1B</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.11">9</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.12">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.13">1024</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.14">113M</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.15">16</td>
                                            <td class="ltx_td ltx_align_left" id="S11.T10.6.6.11.5.16">3</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S11.T10.6.6.12.6">
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.1">
                                                <span class="ltx_text ltx_font_bold" id="S11.T10.6.6.12.6.1.1">8B</span>
                                            </td>
                                            <td class="ltx_td ltx_border_bb" id="S11.T10.6.6.12.6.2"></td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.3">1
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.4">20
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.5">1280
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.6">20M
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.7">32
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.8">32
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.9">4096
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.10">
                                                6.4B</td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.11">6
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.12">20
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.13">
                                                1280</td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.14">
                                                120M</td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.15">20
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S11.T10.6.6.12.6.16">4
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </span></div>
                        <figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text"
                                    id="S11.T10.10.1.1" style="font-size:90%;">Table 10</span>: </span><span
                                class="ltx_text" id="S11.T10.11.2" style="font-size:90%;">Architectural hyper-parameters
                                for different <span class="ltx_text ltx_font_smallcaps" id="S11.T10.11.2.1">B</span>LT
                                model sizes that we train for <span class="ltx_text ltx_font_smallcaps"
                                    id="S11.T10.11.2.2">flop</span>-controlled experiments described in this paper.
                            </span></figcaption>
                    </figure>
                </section>
                <section class="ltx_section" id="S12">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">12 </span>FLOPs Equations
                    </h2>
                    <div class="ltx_para" id="S12.p1">
                        <p class="ltx_p" id="S12.p1.1">Here, we provide the equations used for <span
                                class="ltx_text ltx_font_smallcaps" id="S12.p1.1.1">flop</span> computation for the
                            forward-pass of transformer and <span class="ltx_text ltx_font_smallcaps"
                                id="S12.p1.1.2">B</span>LT models based on <cite
                                class="ltx_cite ltx_citemacro_cite">Hoffmann et al. (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib21" title="">2022</a>); Kaplan et
                                al. (<a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#bib.bib24"
                                    title="">2020</a>); Casson (<a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib5" title="">2023</a>)</cite>. We
                            assume that the backward pass uses twice as much <span class="ltx_text ltx_font_smallcaps"
                                id="S12.p1.1.3">flop</span>s as the forward pass.</p>
                    </div>
                    <figure class="ltx_table" id="S12.T11">
                        <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S12.T11.11">
                            <thead class="ltx_thead">
                                <tr class="ltx_tr" id="S12.T11.11.12.1">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"
                                        id="S12.T11.11.12.1.1">Operation</th>
                                    <th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"
                                        id="S12.T11.11.12.1.2">
                                        <span class="ltx_text ltx_font_smallcaps" id="S12.T11.11.12.1.2.1">flop</span>s
                                        per token/byte
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="ltx_tbody">
                                <tr class="ltx_tr" id="S12.T11.2.2">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S12.T11.1.1.1">
                                        Attention <math alttext="(l,h_{k},n_{heads},m)" class="ltx_Math"
                                            display="inline" id="S12.T11.1.1.1.m1.4">
                                            <semantics id="S12.T11.1.1.1.m1.4a">
                                                <mrow id="S12.T11.1.1.1.m1.4.4.2" xref="S12.T11.1.1.1.m1.4.4.3.cmml">
                                                    <mo id="S12.T11.1.1.1.m1.4.4.2.3" stretchy="false"
                                                        xref="S12.T11.1.1.1.m1.4.4.3.cmml">(</mo>
                                                    <mi id="S12.T11.1.1.1.m1.1.1" xref="S12.T11.1.1.1.m1.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.1.1.1.m1.4.4.2.4"
                                                        xref="S12.T11.1.1.1.m1.4.4.3.cmml">,</mo>
                                                    <msub id="S12.T11.1.1.1.m1.3.3.1.1"
                                                        xref="S12.T11.1.1.1.m1.3.3.1.1.cmml">
                                                        <mi id="S12.T11.1.1.1.m1.3.3.1.1.2"
                                                            xref="S12.T11.1.1.1.m1.3.3.1.1.2.cmml">h</mi>
                                                        <mi id="S12.T11.1.1.1.m1.3.3.1.1.3"
                                                            xref="S12.T11.1.1.1.m1.3.3.1.1.3.cmml">k</mi>
                                                    </msub>
                                                    <mo id="S12.T11.1.1.1.m1.4.4.2.5"
                                                        xref="S12.T11.1.1.1.m1.4.4.3.cmml">,</mo>
                                                    <msub id="S12.T11.1.1.1.m1.4.4.2.2"
                                                        xref="S12.T11.1.1.1.m1.4.4.2.2.cmml">
                                                        <mi id="S12.T11.1.1.1.m1.4.4.2.2.2"
                                                            xref="S12.T11.1.1.1.m1.4.4.2.2.2.cmml">n</mi>
                                                        <mrow id="S12.T11.1.1.1.m1.4.4.2.2.3"
                                                            xref="S12.T11.1.1.1.m1.4.4.2.2.3.cmml">
                                                            <mi id="S12.T11.1.1.1.m1.4.4.2.2.3.2"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.2.cmml">h</mi>
                                                            <mo id="S12.T11.1.1.1.m1.4.4.2.2.3.1"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.1.1.1.m1.4.4.2.2.3.3"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.3.cmml">e</mi>
                                                            <mo id="S12.T11.1.1.1.m1.4.4.2.2.3.1a"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.1.1.1.m1.4.4.2.2.3.4"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.4.cmml">a</mi>
                                                            <mo id="S12.T11.1.1.1.m1.4.4.2.2.3.1b"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.1.1.1.m1.4.4.2.2.3.5"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.5.cmml">d</mi>
                                                            <mo id="S12.T11.1.1.1.m1.4.4.2.2.3.1c"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.1.1.1.m1.4.4.2.2.3.6"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3.6.cmml">s</mi>
                                                        </mrow>
                                                    </msub>
                                                    <mo id="S12.T11.1.1.1.m1.4.4.2.6"
                                                        xref="S12.T11.1.1.1.m1.4.4.3.cmml">,</mo>
                                                    <mi id="S12.T11.1.1.1.m1.2.2" xref="S12.T11.1.1.1.m1.2.2.cmml">m
                                                    </mi>
                                                    <mo id="S12.T11.1.1.1.m1.4.4.2.7" stretchy="false"
                                                        xref="S12.T11.1.1.1.m1.4.4.3.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.1.1.1.m1.4b">
                                                    <vector id="S12.T11.1.1.1.m1.4.4.3.cmml"
                                                        xref="S12.T11.1.1.1.m1.4.4.2">
                                                        <ci id="S12.T11.1.1.1.m1.1.1.cmml" xref="S12.T11.1.1.1.m1.1.1">
                                                            𝑙</ci>
                                                        <apply id="S12.T11.1.1.1.m1.3.3.1.1.cmml"
                                                            xref="S12.T11.1.1.1.m1.3.3.1.1">
                                                            <csymbol cd="ambiguous" id="S12.T11.1.1.1.m1.3.3.1.1.1.cmml"
                                                                xref="S12.T11.1.1.1.m1.3.3.1.1">subscript</csymbol>
                                                            <ci id="S12.T11.1.1.1.m1.3.3.1.1.2.cmml"
                                                                xref="S12.T11.1.1.1.m1.3.3.1.1.2">ℎ</ci>
                                                            <ci id="S12.T11.1.1.1.m1.3.3.1.1.3.cmml"
                                                                xref="S12.T11.1.1.1.m1.3.3.1.1.3">𝑘</ci>
                                                        </apply>
                                                        <apply id="S12.T11.1.1.1.m1.4.4.2.2.cmml"
                                                            xref="S12.T11.1.1.1.m1.4.4.2.2">
                                                            <csymbol cd="ambiguous" id="S12.T11.1.1.1.m1.4.4.2.2.1.cmml"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2">subscript</csymbol>
                                                            <ci id="S12.T11.1.1.1.m1.4.4.2.2.2.cmml"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.2">𝑛</ci>
                                                            <apply id="S12.T11.1.1.1.m1.4.4.2.2.3.cmml"
                                                                xref="S12.T11.1.1.1.m1.4.4.2.2.3">
                                                                <times id="S12.T11.1.1.1.m1.4.4.2.2.3.1.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.1"></times>
                                                                <ci id="S12.T11.1.1.1.m1.4.4.2.2.3.2.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.2">ℎ</ci>
                                                                <ci id="S12.T11.1.1.1.m1.4.4.2.2.3.3.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.3">𝑒</ci>
                                                                <ci id="S12.T11.1.1.1.m1.4.4.2.2.3.4.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.4">𝑎</ci>
                                                                <ci id="S12.T11.1.1.1.m1.4.4.2.2.3.5.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.5">𝑑</ci>
                                                                <ci id="S12.T11.1.1.1.m1.4.4.2.2.3.6.cmml"
                                                                    xref="S12.T11.1.1.1.m1.4.4.2.2.3.6">𝑠</ci>
                                                            </apply>
                                                        </apply>
                                                        <ci id="S12.T11.1.1.1.m1.2.2.cmml" xref="S12.T11.1.1.1.m1.2.2">
                                                            𝑚</ci>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.1.1.1.m1.4c">
                                                    (l,h_{k},n_{heads},m)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.1.1.1.m1.4d">(
                                                    italic_l , italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ,
                                                    italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d
                                                    italic_s end_POSTSUBSCRIPT , italic_m )</annotation>
                                            </semantics>
                                        </math>
                                    </th>
                                    <td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S12.T11.2.2.2"><math
                                            alttext="4\times l\times h_{k}\times n_{heads}\times\frac{m+1}{2}"
                                            class="ltx_Math" display="inline" id="S12.T11.2.2.2.m1.1">
                                            <semantics id="S12.T11.2.2.2.m1.1a">
                                                <mrow id="S12.T11.2.2.2.m1.1.1" xref="S12.T11.2.2.2.m1.1.1.cmml">
                                                    <mn id="S12.T11.2.2.2.m1.1.1.2" xref="S12.T11.2.2.2.m1.1.1.2.cmml">4
                                                    </mn>
                                                    <mo id="S12.T11.2.2.2.m1.1.1.1" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.2.2.2.m1.1.1.1.cmml">×</mo>
                                                    <mi id="S12.T11.2.2.2.m1.1.1.3" xref="S12.T11.2.2.2.m1.1.1.3.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.2.2.2.m1.1.1.1a" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.2.2.2.m1.1.1.1.cmml">×</mo>
                                                    <msub id="S12.T11.2.2.2.m1.1.1.4"
                                                        xref="S12.T11.2.2.2.m1.1.1.4.cmml">
                                                        <mi id="S12.T11.2.2.2.m1.1.1.4.2"
                                                            xref="S12.T11.2.2.2.m1.1.1.4.2.cmml">h</mi>
                                                        <mi id="S12.T11.2.2.2.m1.1.1.4.3"
                                                            xref="S12.T11.2.2.2.m1.1.1.4.3.cmml">k</mi>
                                                    </msub>
                                                    <mo id="S12.T11.2.2.2.m1.1.1.1b" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.2.2.2.m1.1.1.1.cmml">×</mo>
                                                    <msub id="S12.T11.2.2.2.m1.1.1.5"
                                                        xref="S12.T11.2.2.2.m1.1.1.5.cmml">
                                                        <mi id="S12.T11.2.2.2.m1.1.1.5.2"
                                                            xref="S12.T11.2.2.2.m1.1.1.5.2.cmml">n</mi>
                                                        <mrow id="S12.T11.2.2.2.m1.1.1.5.3"
                                                            xref="S12.T11.2.2.2.m1.1.1.5.3.cmml">
                                                            <mi id="S12.T11.2.2.2.m1.1.1.5.3.2"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.2.cmml">h</mi>
                                                            <mo id="S12.T11.2.2.2.m1.1.1.5.3.1"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.2.2.2.m1.1.1.5.3.3"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.3.cmml">e</mi>
                                                            <mo id="S12.T11.2.2.2.m1.1.1.5.3.1a"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.2.2.2.m1.1.1.5.3.4"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.4.cmml">a</mi>
                                                            <mo id="S12.T11.2.2.2.m1.1.1.5.3.1b"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.2.2.2.m1.1.1.5.3.5"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.5.cmml">d</mi>
                                                            <mo id="S12.T11.2.2.2.m1.1.1.5.3.1c"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.2.2.2.m1.1.1.5.3.6"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3.6.cmml">s</mi>
                                                        </mrow>
                                                    </msub>
                                                    <mo id="S12.T11.2.2.2.m1.1.1.1c" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.2.2.2.m1.1.1.1.cmml">×</mo>
                                                    <mfrac id="S12.T11.2.2.2.m1.1.1.6"
                                                        xref="S12.T11.2.2.2.m1.1.1.6.cmml">
                                                        <mrow id="S12.T11.2.2.2.m1.1.1.6.2"
                                                            xref="S12.T11.2.2.2.m1.1.1.6.2.cmml">
                                                            <mi id="S12.T11.2.2.2.m1.1.1.6.2.2"
                                                                xref="S12.T11.2.2.2.m1.1.1.6.2.2.cmml">m</mi>
                                                            <mo id="S12.T11.2.2.2.m1.1.1.6.2.1"
                                                                xref="S12.T11.2.2.2.m1.1.1.6.2.1.cmml">+</mo>
                                                            <mn id="S12.T11.2.2.2.m1.1.1.6.2.3"
                                                                xref="S12.T11.2.2.2.m1.1.1.6.2.3.cmml">1</mn>
                                                        </mrow>
                                                        <mn id="S12.T11.2.2.2.m1.1.1.6.3"
                                                            xref="S12.T11.2.2.2.m1.1.1.6.3.cmml">2</mn>
                                                    </mfrac>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.2.2.2.m1.1b">
                                                    <apply id="S12.T11.2.2.2.m1.1.1.cmml" xref="S12.T11.2.2.2.m1.1.1">
                                                        <times id="S12.T11.2.2.2.m1.1.1.1.cmml"
                                                            xref="S12.T11.2.2.2.m1.1.1.1"></times>
                                                        <cn id="S12.T11.2.2.2.m1.1.1.2.cmml" type="integer"
                                                            xref="S12.T11.2.2.2.m1.1.1.2">4</cn>
                                                        <ci id="S12.T11.2.2.2.m1.1.1.3.cmml"
                                                            xref="S12.T11.2.2.2.m1.1.1.3">𝑙</ci>
                                                        <apply id="S12.T11.2.2.2.m1.1.1.4.cmml"
                                                            xref="S12.T11.2.2.2.m1.1.1.4">
                                                            <csymbol cd="ambiguous" id="S12.T11.2.2.2.m1.1.1.4.1.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.4">subscript</csymbol>
                                                            <ci id="S12.T11.2.2.2.m1.1.1.4.2.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.4.2">ℎ</ci>
                                                            <ci id="S12.T11.2.2.2.m1.1.1.4.3.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.4.3">𝑘</ci>
                                                        </apply>
                                                        <apply id="S12.T11.2.2.2.m1.1.1.5.cmml"
                                                            xref="S12.T11.2.2.2.m1.1.1.5">
                                                            <csymbol cd="ambiguous" id="S12.T11.2.2.2.m1.1.1.5.1.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.5">subscript</csymbol>
                                                            <ci id="S12.T11.2.2.2.m1.1.1.5.2.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.2">𝑛</ci>
                                                            <apply id="S12.T11.2.2.2.m1.1.1.5.3.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.5.3">
                                                                <times id="S12.T11.2.2.2.m1.1.1.5.3.1.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.1"></times>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.5.3.2.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.2">ℎ</ci>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.5.3.3.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.3">𝑒</ci>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.5.3.4.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.4">𝑎</ci>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.5.3.5.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.5">𝑑</ci>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.5.3.6.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.5.3.6">𝑠</ci>
                                                            </apply>
                                                        </apply>
                                                        <apply id="S12.T11.2.2.2.m1.1.1.6.cmml"
                                                            xref="S12.T11.2.2.2.m1.1.1.6">
                                                            <divide id="S12.T11.2.2.2.m1.1.1.6.1.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.6"></divide>
                                                            <apply id="S12.T11.2.2.2.m1.1.1.6.2.cmml"
                                                                xref="S12.T11.2.2.2.m1.1.1.6.2">
                                                                <plus id="S12.T11.2.2.2.m1.1.1.6.2.1.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.6.2.1"></plus>
                                                                <ci id="S12.T11.2.2.2.m1.1.1.6.2.2.cmml"
                                                                    xref="S12.T11.2.2.2.m1.1.1.6.2.2">𝑚</ci>
                                                                <cn id="S12.T11.2.2.2.m1.1.1.6.2.3.cmml" type="integer"
                                                                    xref="S12.T11.2.2.2.m1.1.1.6.2.3">1</cn>
                                                            </apply>
                                                            <cn id="S12.T11.2.2.2.m1.1.1.6.3.cmml" type="integer"
                                                                xref="S12.T11.2.2.2.m1.1.1.6.3">2</cn>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.2.2.2.m1.1c">
                                                    4\times l\times h_{k}\times n_{heads}\times\frac{m+1}{2}
                                                </annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.2.2.2.m1.1d">4
                                                    × italic_l × italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT
                                                    × italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d
                                                    italic_s end_POSTSUBSCRIPT × divide start_ARG italic_m + 1 end_ARG
                                                    start_ARG 2 end_ARG</annotation>
                                            </semantics>
                                        </math></td>
                                </tr>
                                <tr class="ltx_tr" id="S12.T11.4.4">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S12.T11.3.3.1">QKVO <math
                                            alttext="(l,h,r)" class="ltx_Math" display="inline" id="S12.T11.3.3.1.m1.3">
                                            <semantics id="S12.T11.3.3.1.m1.3a">
                                                <mrow id="S12.T11.3.3.1.m1.3.4.2" xref="S12.T11.3.3.1.m1.3.4.1.cmml">
                                                    <mo id="S12.T11.3.3.1.m1.3.4.2.1" stretchy="false"
                                                        xref="S12.T11.3.3.1.m1.3.4.1.cmml">(</mo>
                                                    <mi id="S12.T11.3.3.1.m1.1.1" xref="S12.T11.3.3.1.m1.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.3.3.1.m1.3.4.2.2"
                                                        xref="S12.T11.3.3.1.m1.3.4.1.cmml">,</mo>
                                                    <mi id="S12.T11.3.3.1.m1.2.2" xref="S12.T11.3.3.1.m1.2.2.cmml">h
                                                    </mi>
                                                    <mo id="S12.T11.3.3.1.m1.3.4.2.3"
                                                        xref="S12.T11.3.3.1.m1.3.4.1.cmml">,</mo>
                                                    <mi id="S12.T11.3.3.1.m1.3.3" xref="S12.T11.3.3.1.m1.3.3.cmml">r
                                                    </mi>
                                                    <mo id="S12.T11.3.3.1.m1.3.4.2.4" stretchy="false"
                                                        xref="S12.T11.3.3.1.m1.3.4.1.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.3.3.1.m1.3b">
                                                    <vector id="S12.T11.3.3.1.m1.3.4.1.cmml"
                                                        xref="S12.T11.3.3.1.m1.3.4.2">
                                                        <ci id="S12.T11.3.3.1.m1.1.1.cmml" xref="S12.T11.3.3.1.m1.1.1">
                                                            𝑙</ci>
                                                        <ci id="S12.T11.3.3.1.m1.2.2.cmml" xref="S12.T11.3.3.1.m1.2.2">ℎ
                                                        </ci>
                                                        <ci id="S12.T11.3.3.1.m1.3.3.cmml" xref="S12.T11.3.3.1.m1.3.3">
                                                            𝑟</ci>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.3.3.1.m1.3c">
                                                    (l,h,r)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.3.3.1.m1.3d">(
                                                    italic_l , italic_h , italic_r )</annotation>
                                            </semantics>
                                        </math>
                                    </th>
                                    <td class="ltx_td ltx_nopad_r ltx_align_left" id="S12.T11.4.4.2"><math
                                            alttext="(r\times 2+2)\times 2\times l\times h^{2}" class="ltx_Math"
                                            display="inline" id="S12.T11.4.4.2.m1.1">
                                            <semantics id="S12.T11.4.4.2.m1.1a">
                                                <mrow id="S12.T11.4.4.2.m1.1.1" xref="S12.T11.4.4.2.m1.1.1.cmml">
                                                    <mrow id="S12.T11.4.4.2.m1.1.1.1.1"
                                                        xref="S12.T11.4.4.2.m1.1.1.1.1.1.cmml">
                                                        <mo id="S12.T11.4.4.2.m1.1.1.1.1.2" stretchy="false"
                                                            xref="S12.T11.4.4.2.m1.1.1.1.1.1.cmml">(</mo>
                                                        <mrow id="S12.T11.4.4.2.m1.1.1.1.1.1"
                                                            xref="S12.T11.4.4.2.m1.1.1.1.1.1.cmml">
                                                            <mrow id="S12.T11.4.4.2.m1.1.1.1.1.1.2"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.cmml">
                                                                <mi id="S12.T11.4.4.2.m1.1.1.1.1.1.2.2"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.2.cmml">r</mi>
                                                                <mo id="S12.T11.4.4.2.m1.1.1.1.1.1.2.1" lspace="0.222em"
                                                                    rspace="0.222em"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.1.cmml">×</mo>
                                                                <mn id="S12.T11.4.4.2.m1.1.1.1.1.1.2.3"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.3.cmml">2</mn>
                                                            </mrow>
                                                            <mo id="S12.T11.4.4.2.m1.1.1.1.1.1.1"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.1.cmml">+</mo>
                                                            <mn id="S12.T11.4.4.2.m1.1.1.1.1.1.3"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.3.cmml">2</mn>
                                                        </mrow>
                                                        <mo id="S12.T11.4.4.2.m1.1.1.1.1.3" rspace="0.055em"
                                                            stretchy="false" xref="S12.T11.4.4.2.m1.1.1.1.1.1.cmml">)
                                                        </mo>
                                                    </mrow>
                                                    <mo id="S12.T11.4.4.2.m1.1.1.2" rspace="0.222em"
                                                        xref="S12.T11.4.4.2.m1.1.1.2.cmml">×</mo>
                                                    <mn id="S12.T11.4.4.2.m1.1.1.3" xref="S12.T11.4.4.2.m1.1.1.3.cmml">2
                                                    </mn>
                                                    <mo id="S12.T11.4.4.2.m1.1.1.2a" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.4.4.2.m1.1.1.2.cmml">×</mo>
                                                    <mi id="S12.T11.4.4.2.m1.1.1.4" xref="S12.T11.4.4.2.m1.1.1.4.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.4.4.2.m1.1.1.2b" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.4.4.2.m1.1.1.2.cmml">×</mo>
                                                    <msup id="S12.T11.4.4.2.m1.1.1.5"
                                                        xref="S12.T11.4.4.2.m1.1.1.5.cmml">
                                                        <mi id="S12.T11.4.4.2.m1.1.1.5.2"
                                                            xref="S12.T11.4.4.2.m1.1.1.5.2.cmml">h</mi>
                                                        <mn id="S12.T11.4.4.2.m1.1.1.5.3"
                                                            xref="S12.T11.4.4.2.m1.1.1.5.3.cmml">2</mn>
                                                    </msup>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.4.4.2.m1.1b">
                                                    <apply id="S12.T11.4.4.2.m1.1.1.cmml" xref="S12.T11.4.4.2.m1.1.1">
                                                        <times id="S12.T11.4.4.2.m1.1.1.2.cmml"
                                                            xref="S12.T11.4.4.2.m1.1.1.2"></times>
                                                        <apply id="S12.T11.4.4.2.m1.1.1.1.1.1.cmml"
                                                            xref="S12.T11.4.4.2.m1.1.1.1.1">
                                                            <plus id="S12.T11.4.4.2.m1.1.1.1.1.1.1.cmml"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.1"></plus>
                                                            <apply id="S12.T11.4.4.2.m1.1.1.1.1.1.2.cmml"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.2">
                                                                <times id="S12.T11.4.4.2.m1.1.1.1.1.1.2.1.cmml"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.1"></times>
                                                                <ci id="S12.T11.4.4.2.m1.1.1.1.1.1.2.2.cmml"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.2">𝑟</ci>
                                                                <cn id="S12.T11.4.4.2.m1.1.1.1.1.1.2.3.cmml"
                                                                    type="integer"
                                                                    xref="S12.T11.4.4.2.m1.1.1.1.1.1.2.3">2</cn>
                                                            </apply>
                                                            <cn id="S12.T11.4.4.2.m1.1.1.1.1.1.3.cmml" type="integer"
                                                                xref="S12.T11.4.4.2.m1.1.1.1.1.1.3">2</cn>
                                                        </apply>
                                                        <cn id="S12.T11.4.4.2.m1.1.1.3.cmml" type="integer"
                                                            xref="S12.T11.4.4.2.m1.1.1.3">2</cn>
                                                        <ci id="S12.T11.4.4.2.m1.1.1.4.cmml"
                                                            xref="S12.T11.4.4.2.m1.1.1.4">𝑙</ci>
                                                        <apply id="S12.T11.4.4.2.m1.1.1.5.cmml"
                                                            xref="S12.T11.4.4.2.m1.1.1.5">
                                                            <csymbol cd="ambiguous" id="S12.T11.4.4.2.m1.1.1.5.1.cmml"
                                                                xref="S12.T11.4.4.2.m1.1.1.5">superscript</csymbol>
                                                            <ci id="S12.T11.4.4.2.m1.1.1.5.2.cmml"
                                                                xref="S12.T11.4.4.2.m1.1.1.5.2">ℎ</ci>
                                                            <cn id="S12.T11.4.4.2.m1.1.1.5.3.cmml" type="integer"
                                                                xref="S12.T11.4.4.2.m1.1.1.5.3">2</cn>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.4.4.2.m1.1c">
                                                    (r\times 2+2)\times 2\times l\times h^{2}</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.4.4.2.m1.1d">(
                                                    italic_r × 2 + 2 ) × 2 × italic_l × italic_h start_POSTSUPERSCRIPT 2
                                                    end_POSTSUPERSCRIPT</annotation>
                                            </semantics>
                                        </math></td>
                                </tr>
                                <tr class="ltx_tr" id="S12.T11.6.6">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S12.T11.5.5.1">Feed-forward
                                        <math alttext="(l,h,d_{ff})" class="ltx_Math" display="inline"
                                            id="S12.T11.5.5.1.m1.3">
                                            <semantics id="S12.T11.5.5.1.m1.3a">
                                                <mrow id="S12.T11.5.5.1.m1.3.3.1" xref="S12.T11.5.5.1.m1.3.3.2.cmml">
                                                    <mo id="S12.T11.5.5.1.m1.3.3.1.2" stretchy="false"
                                                        xref="S12.T11.5.5.1.m1.3.3.2.cmml">(</mo>
                                                    <mi id="S12.T11.5.5.1.m1.1.1" xref="S12.T11.5.5.1.m1.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.5.5.1.m1.3.3.1.3"
                                                        xref="S12.T11.5.5.1.m1.3.3.2.cmml">,</mo>
                                                    <mi id="S12.T11.5.5.1.m1.2.2" xref="S12.T11.5.5.1.m1.2.2.cmml">h
                                                    </mi>
                                                    <mo id="S12.T11.5.5.1.m1.3.3.1.4"
                                                        xref="S12.T11.5.5.1.m1.3.3.2.cmml">,</mo>
                                                    <msub id="S12.T11.5.5.1.m1.3.3.1.1"
                                                        xref="S12.T11.5.5.1.m1.3.3.1.1.cmml">
                                                        <mi id="S12.T11.5.5.1.m1.3.3.1.1.2"
                                                            xref="S12.T11.5.5.1.m1.3.3.1.1.2.cmml">d</mi>
                                                        <mrow id="S12.T11.5.5.1.m1.3.3.1.1.3"
                                                            xref="S12.T11.5.5.1.m1.3.3.1.1.3.cmml">
                                                            <mi id="S12.T11.5.5.1.m1.3.3.1.1.3.2"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1.3.2.cmml">f</mi>
                                                            <mo id="S12.T11.5.5.1.m1.3.3.1.1.3.1"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.5.5.1.m1.3.3.1.1.3.3"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1.3.3.cmml">f</mi>
                                                        </mrow>
                                                    </msub>
                                                    <mo id="S12.T11.5.5.1.m1.3.3.1.5" stretchy="false"
                                                        xref="S12.T11.5.5.1.m1.3.3.2.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.5.5.1.m1.3b">
                                                    <vector id="S12.T11.5.5.1.m1.3.3.2.cmml"
                                                        xref="S12.T11.5.5.1.m1.3.3.1">
                                                        <ci id="S12.T11.5.5.1.m1.1.1.cmml" xref="S12.T11.5.5.1.m1.1.1">
                                                            𝑙</ci>
                                                        <ci id="S12.T11.5.5.1.m1.2.2.cmml" xref="S12.T11.5.5.1.m1.2.2">ℎ
                                                        </ci>
                                                        <apply id="S12.T11.5.5.1.m1.3.3.1.1.cmml"
                                                            xref="S12.T11.5.5.1.m1.3.3.1.1">
                                                            <csymbol cd="ambiguous" id="S12.T11.5.5.1.m1.3.3.1.1.1.cmml"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1">subscript</csymbol>
                                                            <ci id="S12.T11.5.5.1.m1.3.3.1.1.2.cmml"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1.2">𝑑</ci>
                                                            <apply id="S12.T11.5.5.1.m1.3.3.1.1.3.cmml"
                                                                xref="S12.T11.5.5.1.m1.3.3.1.1.3">
                                                                <times id="S12.T11.5.5.1.m1.3.3.1.1.3.1.cmml"
                                                                    xref="S12.T11.5.5.1.m1.3.3.1.1.3.1"></times>
                                                                <ci id="S12.T11.5.5.1.m1.3.3.1.1.3.2.cmml"
                                                                    xref="S12.T11.5.5.1.m1.3.3.1.1.3.2">𝑓</ci>
                                                                <ci id="S12.T11.5.5.1.m1.3.3.1.1.3.3.cmml"
                                                                    xref="S12.T11.5.5.1.m1.3.3.1.1.3.3">𝑓</ci>
                                                            </apply>
                                                        </apply>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.5.5.1.m1.3c">
                                                    (l,h,d_{ff})</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.5.5.1.m1.3d">(
                                                    italic_l , italic_h , italic_d start_POSTSUBSCRIPT italic_f italic_f
                                                    end_POSTSUBSCRIPT )</annotation>
                                            </semantics>
                                        </math>
                                    </th>
                                    <td class="ltx_td ltx_nopad_r ltx_align_left" id="S12.T11.6.6.2"><math
                                            alttext="2\times l\times 2\times h\times d_{ff}h" class="ltx_Math"
                                            display="inline" id="S12.T11.6.6.2.m1.1">
                                            <semantics id="S12.T11.6.6.2.m1.1a">
                                                <mrow id="S12.T11.6.6.2.m1.1.1" xref="S12.T11.6.6.2.m1.1.1.cmml">
                                                    <mrow id="S12.T11.6.6.2.m1.1.1.2"
                                                        xref="S12.T11.6.6.2.m1.1.1.2.cmml">
                                                        <mn id="S12.T11.6.6.2.m1.1.1.2.2"
                                                            xref="S12.T11.6.6.2.m1.1.1.2.2.cmml">2</mn>
                                                        <mo id="S12.T11.6.6.2.m1.1.1.2.1" lspace="0.222em"
                                                            rspace="0.222em" xref="S12.T11.6.6.2.m1.1.1.2.1.cmml">×</mo>
                                                        <mi id="S12.T11.6.6.2.m1.1.1.2.3"
                                                            xref="S12.T11.6.6.2.m1.1.1.2.3.cmml">l</mi>
                                                        <mo id="S12.T11.6.6.2.m1.1.1.2.1a" lspace="0.222em"
                                                            rspace="0.222em" xref="S12.T11.6.6.2.m1.1.1.2.1.cmml">×</mo>
                                                        <mn id="S12.T11.6.6.2.m1.1.1.2.4"
                                                            xref="S12.T11.6.6.2.m1.1.1.2.4.cmml">2</mn>
                                                        <mo id="S12.T11.6.6.2.m1.1.1.2.1b" lspace="0.222em"
                                                            rspace="0.222em" xref="S12.T11.6.6.2.m1.1.1.2.1.cmml">×</mo>
                                                        <mi id="S12.T11.6.6.2.m1.1.1.2.5"
                                                            xref="S12.T11.6.6.2.m1.1.1.2.5.cmml">h</mi>
                                                        <mo id="S12.T11.6.6.2.m1.1.1.2.1c" lspace="0.222em"
                                                            rspace="0.222em" xref="S12.T11.6.6.2.m1.1.1.2.1.cmml">×</mo>
                                                        <msub id="S12.T11.6.6.2.m1.1.1.2.6"
                                                            xref="S12.T11.6.6.2.m1.1.1.2.6.cmml">
                                                            <mi id="S12.T11.6.6.2.m1.1.1.2.6.2"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.6.2.cmml">d</mi>
                                                            <mrow id="S12.T11.6.6.2.m1.1.1.2.6.3"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.6.3.cmml">
                                                                <mi id="S12.T11.6.6.2.m1.1.1.2.6.3.2"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6.3.2.cmml">f</mi>
                                                                <mo id="S12.T11.6.6.2.m1.1.1.2.6.3.1"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6.3.1.cmml">⁢</mo>
                                                                <mi id="S12.T11.6.6.2.m1.1.1.2.6.3.3"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6.3.3.cmml">f</mi>
                                                            </mrow>
                                                        </msub>
                                                    </mrow>
                                                    <mo id="S12.T11.6.6.2.m1.1.1.1" xref="S12.T11.6.6.2.m1.1.1.1.cmml">⁢
                                                    </mo>
                                                    <mi id="S12.T11.6.6.2.m1.1.1.3" xref="S12.T11.6.6.2.m1.1.1.3.cmml">h
                                                    </mi>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.6.6.2.m1.1b">
                                                    <apply id="S12.T11.6.6.2.m1.1.1.cmml" xref="S12.T11.6.6.2.m1.1.1">
                                                        <times id="S12.T11.6.6.2.m1.1.1.1.cmml"
                                                            xref="S12.T11.6.6.2.m1.1.1.1"></times>
                                                        <apply id="S12.T11.6.6.2.m1.1.1.2.cmml"
                                                            xref="S12.T11.6.6.2.m1.1.1.2">
                                                            <times id="S12.T11.6.6.2.m1.1.1.2.1.cmml"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.1"></times>
                                                            <cn id="S12.T11.6.6.2.m1.1.1.2.2.cmml" type="integer"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.2">2</cn>
                                                            <ci id="S12.T11.6.6.2.m1.1.1.2.3.cmml"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.3">𝑙</ci>
                                                            <cn id="S12.T11.6.6.2.m1.1.1.2.4.cmml" type="integer"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.4">2</cn>
                                                            <ci id="S12.T11.6.6.2.m1.1.1.2.5.cmml"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.5">ℎ</ci>
                                                            <apply id="S12.T11.6.6.2.m1.1.1.2.6.cmml"
                                                                xref="S12.T11.6.6.2.m1.1.1.2.6">
                                                                <csymbol cd="ambiguous"
                                                                    id="S12.T11.6.6.2.m1.1.1.2.6.1.cmml"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6">subscript</csymbol>
                                                                <ci id="S12.T11.6.6.2.m1.1.1.2.6.2.cmml"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6.2">𝑑</ci>
                                                                <apply id="S12.T11.6.6.2.m1.1.1.2.6.3.cmml"
                                                                    xref="S12.T11.6.6.2.m1.1.1.2.6.3">
                                                                    <times id="S12.T11.6.6.2.m1.1.1.2.6.3.1.cmml"
                                                                        xref="S12.T11.6.6.2.m1.1.1.2.6.3.1"></times>
                                                                    <ci id="S12.T11.6.6.2.m1.1.1.2.6.3.2.cmml"
                                                                        xref="S12.T11.6.6.2.m1.1.1.2.6.3.2">𝑓</ci>
                                                                    <ci id="S12.T11.6.6.2.m1.1.1.2.6.3.3.cmml"
                                                                        xref="S12.T11.6.6.2.m1.1.1.2.6.3.3">𝑓</ci>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                        <ci id="S12.T11.6.6.2.m1.1.1.3.cmml"
                                                            xref="S12.T11.6.6.2.m1.1.1.3">ℎ</ci>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.6.6.2.m1.1c">
                                                    2\times l\times 2\times h\times d_{ff}h</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.6.6.2.m1.1d">2
                                                    × italic_l × 2 × italic_h × italic_d start_POSTSUBSCRIPT italic_f
                                                    italic_f end_POSTSUBSCRIPT italic_h</annotation>
                                            </semantics>
                                        </math></td>
                                </tr>
                                <tr class="ltx_tr" id="S12.T11.8.8">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S12.T11.7.7.1">De-Embedding
                                        <math alttext="(h,V)" class="ltx_Math" display="inline" id="S12.T11.7.7.1.m1.2">
                                            <semantics id="S12.T11.7.7.1.m1.2a">
                                                <mrow id="S12.T11.7.7.1.m1.2.3.2" xref="S12.T11.7.7.1.m1.2.3.1.cmml">
                                                    <mo id="S12.T11.7.7.1.m1.2.3.2.1" stretchy="false"
                                                        xref="S12.T11.7.7.1.m1.2.3.1.cmml">(</mo>
                                                    <mi id="S12.T11.7.7.1.m1.1.1" xref="S12.T11.7.7.1.m1.1.1.cmml">h
                                                    </mi>
                                                    <mo id="S12.T11.7.7.1.m1.2.3.2.2"
                                                        xref="S12.T11.7.7.1.m1.2.3.1.cmml">,</mo>
                                                    <mi id="S12.T11.7.7.1.m1.2.2" xref="S12.T11.7.7.1.m1.2.2.cmml">V
                                                    </mi>
                                                    <mo id="S12.T11.7.7.1.m1.2.3.2.3" stretchy="false"
                                                        xref="S12.T11.7.7.1.m1.2.3.1.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.7.7.1.m1.2b">
                                                    <interval closure="open" id="S12.T11.7.7.1.m1.2.3.1.cmml"
                                                        xref="S12.T11.7.7.1.m1.2.3.2">
                                                        <ci id="S12.T11.7.7.1.m1.1.1.cmml" xref="S12.T11.7.7.1.m1.1.1">ℎ
                                                        </ci>
                                                        <ci id="S12.T11.7.7.1.m1.2.2.cmml" xref="S12.T11.7.7.1.m1.2.2">
                                                            𝑉</ci>
                                                    </interval>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.7.7.1.m1.2c">(h,V)
                                                </annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.7.7.1.m1.2d">(
                                                    italic_h , italic_V )</annotation>
                                            </semantics>
                                        </math>
                                    </th>
                                    <td class="ltx_td ltx_nopad_r ltx_align_left" id="S12.T11.8.8.2"><math
                                            alttext="2\times h\times|V|" class="ltx_Math" display="inline"
                                            id="S12.T11.8.8.2.m1.1">
                                            <semantics id="S12.T11.8.8.2.m1.1a">
                                                <mrow id="S12.T11.8.8.2.m1.1.2" xref="S12.T11.8.8.2.m1.1.2.cmml">
                                                    <mn id="S12.T11.8.8.2.m1.1.2.2" xref="S12.T11.8.8.2.m1.1.2.2.cmml">2
                                                    </mn>
                                                    <mo id="S12.T11.8.8.2.m1.1.2.1" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.8.8.2.m1.1.2.1.cmml">×</mo>
                                                    <mi id="S12.T11.8.8.2.m1.1.2.3" xref="S12.T11.8.8.2.m1.1.2.3.cmml">h
                                                    </mi>
                                                    <mo id="S12.T11.8.8.2.m1.1.2.1a" lspace="0.222em" rspace="0.222em"
                                                        xref="S12.T11.8.8.2.m1.1.2.1.cmml">×</mo>
                                                    <mrow id="S12.T11.8.8.2.m1.1.2.4.2"
                                                        xref="S12.T11.8.8.2.m1.1.2.4.1.cmml">
                                                        <mo id="S12.T11.8.8.2.m1.1.2.4.2.1" stretchy="false"
                                                            xref="S12.T11.8.8.2.m1.1.2.4.1.1.cmml">|</mo>
                                                        <mi id="S12.T11.8.8.2.m1.1.1" xref="S12.T11.8.8.2.m1.1.1.cmml">V
                                                        </mi>
                                                        <mo id="S12.T11.8.8.2.m1.1.2.4.2.2" stretchy="false"
                                                            xref="S12.T11.8.8.2.m1.1.2.4.1.1.cmml">|</mo>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.8.8.2.m1.1b">
                                                    <apply id="S12.T11.8.8.2.m1.1.2.cmml" xref="S12.T11.8.8.2.m1.1.2">
                                                        <times id="S12.T11.8.8.2.m1.1.2.1.cmml"
                                                            xref="S12.T11.8.8.2.m1.1.2.1"></times>
                                                        <cn id="S12.T11.8.8.2.m1.1.2.2.cmml" type="integer"
                                                            xref="S12.T11.8.8.2.m1.1.2.2">2</cn>
                                                        <ci id="S12.T11.8.8.2.m1.1.2.3.cmml"
                                                            xref="S12.T11.8.8.2.m1.1.2.3">ℎ</ci>
                                                        <apply id="S12.T11.8.8.2.m1.1.2.4.1.cmml"
                                                            xref="S12.T11.8.8.2.m1.1.2.4.2">
                                                            <abs id="S12.T11.8.8.2.m1.1.2.4.1.1.cmml"
                                                                xref="S12.T11.8.8.2.m1.1.2.4.2.1"></abs>
                                                            <ci id="S12.T11.8.8.2.m1.1.1.cmml"
                                                                xref="S12.T11.8.8.2.m1.1.1">𝑉</ci>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.8.8.2.m1.1c">
                                                    2\times h\times|V|</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.8.8.2.m1.1d">2
                                                    × italic_h × | italic_V |</annotation>
                                            </semantics>
                                        </math></td>
                                </tr>
                                <tr class="ltx_tr" id="S12.T11.11.11">
                                    <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"
                                        id="S12.T11.9.9.1">Cross-Attention <math alttext="(l,h_{k},n_{heads},p,r)"
                                            class="ltx_Math" display="inline" id="S12.T11.9.9.1.m1.5">
                                            <semantics id="S12.T11.9.9.1.m1.5a">
                                                <mrow id="S12.T11.9.9.1.m1.5.5.2" xref="S12.T11.9.9.1.m1.5.5.3.cmml">
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.3" stretchy="false"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">(</mo>
                                                    <mi id="S12.T11.9.9.1.m1.1.1" xref="S12.T11.9.9.1.m1.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.4"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">,</mo>
                                                    <msub id="S12.T11.9.9.1.m1.4.4.1.1"
                                                        xref="S12.T11.9.9.1.m1.4.4.1.1.cmml">
                                                        <mi id="S12.T11.9.9.1.m1.4.4.1.1.2"
                                                            xref="S12.T11.9.9.1.m1.4.4.1.1.2.cmml">h</mi>
                                                        <mi id="S12.T11.9.9.1.m1.4.4.1.1.3"
                                                            xref="S12.T11.9.9.1.m1.4.4.1.1.3.cmml">k</mi>
                                                    </msub>
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.5"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">,</mo>
                                                    <msub id="S12.T11.9.9.1.m1.5.5.2.2"
                                                        xref="S12.T11.9.9.1.m1.5.5.2.2.cmml">
                                                        <mi id="S12.T11.9.9.1.m1.5.5.2.2.2"
                                                            xref="S12.T11.9.9.1.m1.5.5.2.2.2.cmml">n</mi>
                                                        <mrow id="S12.T11.9.9.1.m1.5.5.2.2.3"
                                                            xref="S12.T11.9.9.1.m1.5.5.2.2.3.cmml">
                                                            <mi id="S12.T11.9.9.1.m1.5.5.2.2.3.2"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.2.cmml">h</mi>
                                                            <mo id="S12.T11.9.9.1.m1.5.5.2.2.3.1"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.9.9.1.m1.5.5.2.2.3.3"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.3.cmml">e</mi>
                                                            <mo id="S12.T11.9.9.1.m1.5.5.2.2.3.1a"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.9.9.1.m1.5.5.2.2.3.4"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.4.cmml">a</mi>
                                                            <mo id="S12.T11.9.9.1.m1.5.5.2.2.3.1b"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.9.9.1.m1.5.5.2.2.3.5"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.5.cmml">d</mi>
                                                            <mo id="S12.T11.9.9.1.m1.5.5.2.2.3.1c"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.9.9.1.m1.5.5.2.2.3.6"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3.6.cmml">s</mi>
                                                        </mrow>
                                                    </msub>
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.6"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">,</mo>
                                                    <mi id="S12.T11.9.9.1.m1.2.2" xref="S12.T11.9.9.1.m1.2.2.cmml">p
                                                    </mi>
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.7"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">,</mo>
                                                    <mi id="S12.T11.9.9.1.m1.3.3" xref="S12.T11.9.9.1.m1.3.3.cmml">r
                                                    </mi>
                                                    <mo id="S12.T11.9.9.1.m1.5.5.2.8" stretchy="false"
                                                        xref="S12.T11.9.9.1.m1.5.5.3.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.9.9.1.m1.5b">
                                                    <vector id="S12.T11.9.9.1.m1.5.5.3.cmml"
                                                        xref="S12.T11.9.9.1.m1.5.5.2">
                                                        <ci id="S12.T11.9.9.1.m1.1.1.cmml" xref="S12.T11.9.9.1.m1.1.1">
                                                            𝑙</ci>
                                                        <apply id="S12.T11.9.9.1.m1.4.4.1.1.cmml"
                                                            xref="S12.T11.9.9.1.m1.4.4.1.1">
                                                            <csymbol cd="ambiguous" id="S12.T11.9.9.1.m1.4.4.1.1.1.cmml"
                                                                xref="S12.T11.9.9.1.m1.4.4.1.1">subscript</csymbol>
                                                            <ci id="S12.T11.9.9.1.m1.4.4.1.1.2.cmml"
                                                                xref="S12.T11.9.9.1.m1.4.4.1.1.2">ℎ</ci>
                                                            <ci id="S12.T11.9.9.1.m1.4.4.1.1.3.cmml"
                                                                xref="S12.T11.9.9.1.m1.4.4.1.1.3">𝑘</ci>
                                                        </apply>
                                                        <apply id="S12.T11.9.9.1.m1.5.5.2.2.cmml"
                                                            xref="S12.T11.9.9.1.m1.5.5.2.2">
                                                            <csymbol cd="ambiguous" id="S12.T11.9.9.1.m1.5.5.2.2.1.cmml"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2">subscript</csymbol>
                                                            <ci id="S12.T11.9.9.1.m1.5.5.2.2.2.cmml"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.2">𝑛</ci>
                                                            <apply id="S12.T11.9.9.1.m1.5.5.2.2.3.cmml"
                                                                xref="S12.T11.9.9.1.m1.5.5.2.2.3">
                                                                <times id="S12.T11.9.9.1.m1.5.5.2.2.3.1.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.1"></times>
                                                                <ci id="S12.T11.9.9.1.m1.5.5.2.2.3.2.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.2">ℎ</ci>
                                                                <ci id="S12.T11.9.9.1.m1.5.5.2.2.3.3.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.3">𝑒</ci>
                                                                <ci id="S12.T11.9.9.1.m1.5.5.2.2.3.4.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.4">𝑎</ci>
                                                                <ci id="S12.T11.9.9.1.m1.5.5.2.2.3.5.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.5">𝑑</ci>
                                                                <ci id="S12.T11.9.9.1.m1.5.5.2.2.3.6.cmml"
                                                                    xref="S12.T11.9.9.1.m1.5.5.2.2.3.6">𝑠</ci>
                                                            </apply>
                                                        </apply>
                                                        <ci id="S12.T11.9.9.1.m1.2.2.cmml" xref="S12.T11.9.9.1.m1.2.2">
                                                            𝑝</ci>
                                                        <ci id="S12.T11.9.9.1.m1.3.3.cmml" xref="S12.T11.9.9.1.m1.3.3">
                                                            𝑟</ci>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.9.9.1.m1.5c">
                                                    (l,h_{k},n_{heads},p,r)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.T11.9.9.1.m1.5d">(
                                                    italic_l , italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ,
                                                    italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d
                                                    italic_s end_POSTSUBSCRIPT , italic_p , italic_r )</annotation>
                                            </semantics>
                                        </math>
                                    </th>
                                    <td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="S12.T11.11.11.3">
                                        <span class="ltx_text" id="S12.T11.11.11.3.1">Attention</span><math
                                            alttext="(l,h_{k},n_{heads},p)" class="ltx_Math" display="inline"
                                            id="S12.T11.10.10.2.m1.4">
                                            <semantics id="S12.T11.10.10.2.m1.4a">
                                                <mrow id="S12.T11.10.10.2.m1.4.4.2"
                                                    xref="S12.T11.10.10.2.m1.4.4.3.cmml">
                                                    <mo id="S12.T11.10.10.2.m1.4.4.2.3" stretchy="false"
                                                        xref="S12.T11.10.10.2.m1.4.4.3.cmml">(</mo>
                                                    <mi id="S12.T11.10.10.2.m1.1.1" xref="S12.T11.10.10.2.m1.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.10.10.2.m1.4.4.2.4"
                                                        xref="S12.T11.10.10.2.m1.4.4.3.cmml">,</mo>
                                                    <msub id="S12.T11.10.10.2.m1.3.3.1.1"
                                                        xref="S12.T11.10.10.2.m1.3.3.1.1.cmml">
                                                        <mi id="S12.T11.10.10.2.m1.3.3.1.1.2"
                                                            xref="S12.T11.10.10.2.m1.3.3.1.1.2.cmml">h</mi>
                                                        <mi id="S12.T11.10.10.2.m1.3.3.1.1.3"
                                                            xref="S12.T11.10.10.2.m1.3.3.1.1.3.cmml">k</mi>
                                                    </msub>
                                                    <mo id="S12.T11.10.10.2.m1.4.4.2.5"
                                                        xref="S12.T11.10.10.2.m1.4.4.3.cmml">,</mo>
                                                    <msub id="S12.T11.10.10.2.m1.4.4.2.2"
                                                        xref="S12.T11.10.10.2.m1.4.4.2.2.cmml">
                                                        <mi id="S12.T11.10.10.2.m1.4.4.2.2.2"
                                                            xref="S12.T11.10.10.2.m1.4.4.2.2.2.cmml">n</mi>
                                                        <mrow id="S12.T11.10.10.2.m1.4.4.2.2.3"
                                                            xref="S12.T11.10.10.2.m1.4.4.2.2.3.cmml">
                                                            <mi id="S12.T11.10.10.2.m1.4.4.2.2.3.2"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.2.cmml">h</mi>
                                                            <mo id="S12.T11.10.10.2.m1.4.4.2.2.3.1"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.10.10.2.m1.4.4.2.2.3.3"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.3.cmml">e</mi>
                                                            <mo id="S12.T11.10.10.2.m1.4.4.2.2.3.1a"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.10.10.2.m1.4.4.2.2.3.4"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.4.cmml">a</mi>
                                                            <mo id="S12.T11.10.10.2.m1.4.4.2.2.3.1b"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.10.10.2.m1.4.4.2.2.3.5"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.5.cmml">d</mi>
                                                            <mo id="S12.T11.10.10.2.m1.4.4.2.2.3.1c"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.1.cmml">⁢</mo>
                                                            <mi id="S12.T11.10.10.2.m1.4.4.2.2.3.6"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3.6.cmml">s</mi>
                                                        </mrow>
                                                    </msub>
                                                    <mo id="S12.T11.10.10.2.m1.4.4.2.6"
                                                        xref="S12.T11.10.10.2.m1.4.4.3.cmml">,</mo>
                                                    <mi id="S12.T11.10.10.2.m1.2.2" xref="S12.T11.10.10.2.m1.2.2.cmml">p
                                                    </mi>
                                                    <mo id="S12.T11.10.10.2.m1.4.4.2.7" stretchy="false"
                                                        xref="S12.T11.10.10.2.m1.4.4.3.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.10.10.2.m1.4b">
                                                    <vector id="S12.T11.10.10.2.m1.4.4.3.cmml"
                                                        xref="S12.T11.10.10.2.m1.4.4.2">
                                                        <ci id="S12.T11.10.10.2.m1.1.1.cmml"
                                                            xref="S12.T11.10.10.2.m1.1.1">𝑙</ci>
                                                        <apply id="S12.T11.10.10.2.m1.3.3.1.1.cmml"
                                                            xref="S12.T11.10.10.2.m1.3.3.1.1">
                                                            <csymbol cd="ambiguous"
                                                                id="S12.T11.10.10.2.m1.3.3.1.1.1.cmml"
                                                                xref="S12.T11.10.10.2.m1.3.3.1.1">subscript</csymbol>
                                                            <ci id="S12.T11.10.10.2.m1.3.3.1.1.2.cmml"
                                                                xref="S12.T11.10.10.2.m1.3.3.1.1.2">ℎ</ci>
                                                            <ci id="S12.T11.10.10.2.m1.3.3.1.1.3.cmml"
                                                                xref="S12.T11.10.10.2.m1.3.3.1.1.3">𝑘</ci>
                                                        </apply>
                                                        <apply id="S12.T11.10.10.2.m1.4.4.2.2.cmml"
                                                            xref="S12.T11.10.10.2.m1.4.4.2.2">
                                                            <csymbol cd="ambiguous"
                                                                id="S12.T11.10.10.2.m1.4.4.2.2.1.cmml"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2">subscript</csymbol>
                                                            <ci id="S12.T11.10.10.2.m1.4.4.2.2.2.cmml"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.2">𝑛</ci>
                                                            <apply id="S12.T11.10.10.2.m1.4.4.2.2.3.cmml"
                                                                xref="S12.T11.10.10.2.m1.4.4.2.2.3">
                                                                <times id="S12.T11.10.10.2.m1.4.4.2.2.3.1.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.1"></times>
                                                                <ci id="S12.T11.10.10.2.m1.4.4.2.2.3.2.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.2">ℎ</ci>
                                                                <ci id="S12.T11.10.10.2.m1.4.4.2.2.3.3.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.3">𝑒</ci>
                                                                <ci id="S12.T11.10.10.2.m1.4.4.2.2.3.4.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.4">𝑎</ci>
                                                                <ci id="S12.T11.10.10.2.m1.4.4.2.2.3.5.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.5">𝑑</ci>
                                                                <ci id="S12.T11.10.10.2.m1.4.4.2.2.3.6.cmml"
                                                                    xref="S12.T11.10.10.2.m1.4.4.2.2.3.6">𝑠</ci>
                                                            </apply>
                                                        </apply>
                                                        <ci id="S12.T11.10.10.2.m1.2.2.cmml"
                                                            xref="S12.T11.10.10.2.m1.2.2">𝑝</ci>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.10.10.2.m1.4c">
                                                    (l,h_{k},n_{heads},p)</annotation>
                                                <annotation encoding="application/x-llamapun"
                                                    id="S12.T11.10.10.2.m1.4d">( italic_l , italic_h start_POSTSUBSCRIPT
                                                    italic_k end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT italic_h
                                                    italic_e italic_a italic_d italic_s end_POSTSUBSCRIPT , italic_p )
                                                </annotation>
                                            </semantics>
                                        </math> + <span class="ltx_text" id="S12.T11.11.11.3.2">QKVO</span><math
                                            alttext="(l,h_{k}\times n_{heads},r)" class="ltx_Math" display="inline"
                                            id="S12.T11.11.11.3.m2.3">
                                            <semantics id="S12.T11.11.11.3.m2.3a">
                                                <mrow id="S12.T11.11.11.3.m2.3.3.1"
                                                    xref="S12.T11.11.11.3.m2.3.3.2.cmml">
                                                    <mo id="S12.T11.11.11.3.m2.3.3.1.2" stretchy="false"
                                                        xref="S12.T11.11.11.3.m2.3.3.2.cmml">(</mo>
                                                    <mi id="S12.T11.11.11.3.m2.1.1" xref="S12.T11.11.11.3.m2.1.1.cmml">l
                                                    </mi>
                                                    <mo id="S12.T11.11.11.3.m2.3.3.1.3"
                                                        xref="S12.T11.11.11.3.m2.3.3.2.cmml">,</mo>
                                                    <mrow id="S12.T11.11.11.3.m2.3.3.1.1"
                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.cmml">
                                                        <msub id="S12.T11.11.11.3.m2.3.3.1.1.2"
                                                            xref="S12.T11.11.11.3.m2.3.3.1.1.2.cmml">
                                                            <mi id="S12.T11.11.11.3.m2.3.3.1.1.2.2"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.2.2.cmml">h</mi>
                                                            <mi id="S12.T11.11.11.3.m2.3.3.1.1.2.3"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.2.3.cmml">k</mi>
                                                        </msub>
                                                        <mo id="S12.T11.11.11.3.m2.3.3.1.1.1" lspace="0.222em"
                                                            rspace="0.222em" xref="S12.T11.11.11.3.m2.3.3.1.1.1.cmml">×
                                                        </mo>
                                                        <msub id="S12.T11.11.11.3.m2.3.3.1.1.3"
                                                            xref="S12.T11.11.11.3.m2.3.3.1.1.3.cmml">
                                                            <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.2"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.3.2.cmml">n</mi>
                                                            <mrow id="S12.T11.11.11.3.m2.3.3.1.1.3.3"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.cmml">
                                                                <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.3.2"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.2.cmml">h</mi>
                                                                <mo id="S12.T11.11.11.3.m2.3.3.1.1.3.3.1"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.1.cmml">⁢</mo>
                                                                <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.3.3"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.3.cmml">e</mi>
                                                                <mo id="S12.T11.11.11.3.m2.3.3.1.1.3.3.1a"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.1.cmml">⁢</mo>
                                                                <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.3.4"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.4.cmml">a</mi>
                                                                <mo id="S12.T11.11.11.3.m2.3.3.1.1.3.3.1b"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.1.cmml">⁢</mo>
                                                                <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.3.5"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.5.cmml">d</mi>
                                                                <mo id="S12.T11.11.11.3.m2.3.3.1.1.3.3.1c"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.1.cmml">⁢</mo>
                                                                <mi id="S12.T11.11.11.3.m2.3.3.1.1.3.3.6"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.6.cmml">s</mi>
                                                            </mrow>
                                                        </msub>
                                                    </mrow>
                                                    <mo id="S12.T11.11.11.3.m2.3.3.1.4"
                                                        xref="S12.T11.11.11.3.m2.3.3.2.cmml">,</mo>
                                                    <mi id="S12.T11.11.11.3.m2.2.2" xref="S12.T11.11.11.3.m2.2.2.cmml">r
                                                    </mi>
                                                    <mo id="S12.T11.11.11.3.m2.3.3.1.5" stretchy="false"
                                                        xref="S12.T11.11.11.3.m2.3.3.2.cmml">)</mo>
                                                </mrow><annotation-xml encoding="MathML-Content"
                                                    id="S12.T11.11.11.3.m2.3b">
                                                    <vector id="S12.T11.11.11.3.m2.3.3.2.cmml"
                                                        xref="S12.T11.11.11.3.m2.3.3.1">
                                                        <ci id="S12.T11.11.11.3.m2.1.1.cmml"
                                                            xref="S12.T11.11.11.3.m2.1.1">𝑙</ci>
                                                        <apply id="S12.T11.11.11.3.m2.3.3.1.1.cmml"
                                                            xref="S12.T11.11.11.3.m2.3.3.1.1">
                                                            <times id="S12.T11.11.11.3.m2.3.3.1.1.1.cmml"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.1"></times>
                                                            <apply id="S12.T11.11.11.3.m2.3.3.1.1.2.cmml"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.2">
                                                                <csymbol cd="ambiguous"
                                                                    id="S12.T11.11.11.3.m2.3.3.1.1.2.1.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.2">subscript
                                                                </csymbol>
                                                                <ci id="S12.T11.11.11.3.m2.3.3.1.1.2.2.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.2.2">ℎ</ci>
                                                                <ci id="S12.T11.11.11.3.m2.3.3.1.1.2.3.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.2.3">𝑘</ci>
                                                            </apply>
                                                            <apply id="S12.T11.11.11.3.m2.3.3.1.1.3.cmml"
                                                                xref="S12.T11.11.11.3.m2.3.3.1.1.3">
                                                                <csymbol cd="ambiguous"
                                                                    id="S12.T11.11.11.3.m2.3.3.1.1.3.1.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3">subscript
                                                                </csymbol>
                                                                <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.2.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.2">𝑛</ci>
                                                                <apply id="S12.T11.11.11.3.m2.3.3.1.1.3.3.cmml"
                                                                    xref="S12.T11.11.11.3.m2.3.3.1.1.3.3">
                                                                    <times id="S12.T11.11.11.3.m2.3.3.1.1.3.3.1.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.1"></times>
                                                                    <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.3.2.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.2">ℎ</ci>
                                                                    <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.3.3.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.3">𝑒</ci>
                                                                    <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.3.4.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.4">𝑎</ci>
                                                                    <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.3.5.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.5">𝑑</ci>
                                                                    <ci id="S12.T11.11.11.3.m2.3.3.1.1.3.3.6.cmml"
                                                                        xref="S12.T11.11.11.3.m2.3.3.1.1.3.3.6">𝑠</ci>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                        <ci id="S12.T11.11.11.3.m2.2.2.cmml"
                                                            xref="S12.T11.11.11.3.m2.2.2">𝑟</ci>
                                                    </vector>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.T11.11.11.3.m2.3c">
                                                    (l,h_{k}\times n_{heads},r)</annotation>
                                                <annotation encoding="application/x-llamapun"
                                                    id="S12.T11.11.11.3.m2.3d">( italic_l , italic_h start_POSTSUBSCRIPT
                                                    italic_k end_POSTSUBSCRIPT × italic_n start_POSTSUBSCRIPT italic_h
                                                    italic_e italic_a italic_d italic_s end_POSTSUBSCRIPT , italic_r )
                                                </annotation>
                                            </semantics>
                                        </math>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                    class="ltx_text" id="S12.T11.31.9.1" style="font-size:90%;">Table 11</span>:
                            </span><span class="ltx_text ltx_font_smallcaps" id="S12.T11.27.8"
                                style="font-size:90%;">flop<span class="ltx_text ltx_font_upright" id="S12.T11.27.8.9">s
                                    for operations used in transformer and </span>B<span
                                    class="ltx_text ltx_font_upright" id="S12.T11.27.8.8">LT models. <math alttext="l"
                                        class="ltx_Math" display="inline" id="S12.T11.20.1.1.m1.1">
                                        <semantics id="S12.T11.20.1.1.m1.1b">
                                            <mi id="S12.T11.20.1.1.m1.1.1" xref="S12.T11.20.1.1.m1.1.1.cmml">l</mi>
                                            <annotation-xml encoding="MathML-Content" id="S12.T11.20.1.1.m1.1c">
                                                <ci id="S12.T11.20.1.1.m1.1.1.cmml" xref="S12.T11.20.1.1.m1.1.1">𝑙</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.20.1.1.m1.1d">l
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.20.1.1.m1.1e">
                                                italic_l</annotation>
                                        </semantics>
                                    </math> corresponds to layers, <math alttext="h" class="ltx_Math" display="inline"
                                        id="S12.T11.21.2.2.m2.1">
                                        <semantics id="S12.T11.21.2.2.m2.1b">
                                            <mi id="S12.T11.21.2.2.m2.1.1" xref="S12.T11.21.2.2.m2.1.1.cmml">h</mi>
                                            <annotation-xml encoding="MathML-Content" id="S12.T11.21.2.2.m2.1c">
                                                <ci id="S12.T11.21.2.2.m2.1.1.cmml" xref="S12.T11.21.2.2.m2.1.1">ℎ</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.21.2.2.m2.1d">h
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.21.2.2.m2.1e">
                                                italic_h</annotation>
                                        </semantics>
                                    </math> is the hidden dimension (<math alttext="h_{k}" class="ltx_Math"
                                        display="inline" id="S12.T11.22.3.3.m3.1">
                                        <semantics id="S12.T11.22.3.3.m3.1b">
                                            <msub id="S12.T11.22.3.3.m3.1.1" xref="S12.T11.22.3.3.m3.1.1.cmml">
                                                <mi id="S12.T11.22.3.3.m3.1.1.2" xref="S12.T11.22.3.3.m3.1.1.2.cmml">h
                                                </mi>
                                                <mi id="S12.T11.22.3.3.m3.1.1.3" xref="S12.T11.22.3.3.m3.1.1.3.cmml">k
                                                </mi>
                                            </msub><annotation-xml encoding="MathML-Content" id="S12.T11.22.3.3.m3.1c">
                                                <apply id="S12.T11.22.3.3.m3.1.1.cmml" xref="S12.T11.22.3.3.m3.1.1">
                                                    <csymbol cd="ambiguous" id="S12.T11.22.3.3.m3.1.1.1.cmml"
                                                        xref="S12.T11.22.3.3.m3.1.1">subscript</csymbol>
                                                    <ci id="S12.T11.22.3.3.m3.1.1.2.cmml"
                                                        xref="S12.T11.22.3.3.m3.1.1.2">ℎ</ci>
                                                    <ci id="S12.T11.22.3.3.m3.1.1.3.cmml"
                                                        xref="S12.T11.22.3.3.m3.1.1.3">𝑘</ci>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.22.3.3.m3.1d">h_{k}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.22.3.3.m3.1e">
                                                italic_h start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> with <math alttext="n_{heads}" class="ltx_Math" display="inline"
                                        id="S12.T11.23.4.4.m4.1">
                                        <semantics id="S12.T11.23.4.4.m4.1b">
                                            <msub id="S12.T11.23.4.4.m4.1.1" xref="S12.T11.23.4.4.m4.1.1.cmml">
                                                <mi id="S12.T11.23.4.4.m4.1.1.2" xref="S12.T11.23.4.4.m4.1.1.2.cmml">n
                                                </mi>
                                                <mrow id="S12.T11.23.4.4.m4.1.1.3" xref="S12.T11.23.4.4.m4.1.1.3.cmml">
                                                    <mi id="S12.T11.23.4.4.m4.1.1.3.2"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.2.cmml">h</mi>
                                                    <mo id="S12.T11.23.4.4.m4.1.1.3.1"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S12.T11.23.4.4.m4.1.1.3.3"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.3.cmml">e</mi>
                                                    <mo id="S12.T11.23.4.4.m4.1.1.3.1b"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S12.T11.23.4.4.m4.1.1.3.4"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.4.cmml">a</mi>
                                                    <mo id="S12.T11.23.4.4.m4.1.1.3.1c"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S12.T11.23.4.4.m4.1.1.3.5"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.5.cmml">d</mi>
                                                    <mo id="S12.T11.23.4.4.m4.1.1.3.1d"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.1.cmml">⁢</mo>
                                                    <mi id="S12.T11.23.4.4.m4.1.1.3.6"
                                                        xref="S12.T11.23.4.4.m4.1.1.3.6.cmml">s</mi>
                                                </mrow>
                                            </msub><annotation-xml encoding="MathML-Content" id="S12.T11.23.4.4.m4.1c">
                                                <apply id="S12.T11.23.4.4.m4.1.1.cmml" xref="S12.T11.23.4.4.m4.1.1">
                                                    <csymbol cd="ambiguous" id="S12.T11.23.4.4.m4.1.1.1.cmml"
                                                        xref="S12.T11.23.4.4.m4.1.1">subscript</csymbol>
                                                    <ci id="S12.T11.23.4.4.m4.1.1.2.cmml"
                                                        xref="S12.T11.23.4.4.m4.1.1.2">𝑛</ci>
                                                    <apply id="S12.T11.23.4.4.m4.1.1.3.cmml"
                                                        xref="S12.T11.23.4.4.m4.1.1.3">
                                                        <times id="S12.T11.23.4.4.m4.1.1.3.1.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.1"></times>
                                                        <ci id="S12.T11.23.4.4.m4.1.1.3.2.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.2">ℎ</ci>
                                                        <ci id="S12.T11.23.4.4.m4.1.1.3.3.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.3">𝑒</ci>
                                                        <ci id="S12.T11.23.4.4.m4.1.1.3.4.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.4">𝑎</ci>
                                                        <ci id="S12.T11.23.4.4.m4.1.1.3.5.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.5">𝑑</ci>
                                                        <ci id="S12.T11.23.4.4.m4.1.1.3.6.cmml"
                                                            xref="S12.T11.23.4.4.m4.1.1.3.6">𝑠</ci>
                                                    </apply>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.23.4.4.m4.1d">n_{heads}
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.23.4.4.m4.1e">
                                                italic_n start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d
                                                italic_s end_POSTSUBSCRIPT</annotation>
                                        </semantics>
                                    </math> heads), <math alttext="m" class="ltx_Math" display="inline"
                                        id="S12.T11.24.5.5.m5.1">
                                        <semantics id="S12.T11.24.5.5.m5.1b">
                                            <mi id="S12.T11.24.5.5.m5.1.1" xref="S12.T11.24.5.5.m5.1.1.cmml">m</mi>
                                            <annotation-xml encoding="MathML-Content" id="S12.T11.24.5.5.m5.1c">
                                                <ci id="S12.T11.24.5.5.m5.1.1.cmml" xref="S12.T11.24.5.5.m5.1.1">𝑚</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.24.5.5.m5.1d">m
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.24.5.5.m5.1e">
                                                italic_m</annotation>
                                        </semantics>
                                    </math> is the context length, <math alttext="d_{ff}=4" class="ltx_Math"
                                        display="inline" id="S12.T11.25.6.6.m6.1">
                                        <semantics id="S12.T11.25.6.6.m6.1b">
                                            <mrow id="S12.T11.25.6.6.m6.1.1" xref="S12.T11.25.6.6.m6.1.1.cmml">
                                                <msub id="S12.T11.25.6.6.m6.1.1.2" xref="S12.T11.25.6.6.m6.1.1.2.cmml">
                                                    <mi id="S12.T11.25.6.6.m6.1.1.2.2"
                                                        xref="S12.T11.25.6.6.m6.1.1.2.2.cmml">d</mi>
                                                    <mrow id="S12.T11.25.6.6.m6.1.1.2.3"
                                                        xref="S12.T11.25.6.6.m6.1.1.2.3.cmml">
                                                        <mi id="S12.T11.25.6.6.m6.1.1.2.3.2"
                                                            xref="S12.T11.25.6.6.m6.1.1.2.3.2.cmml">f</mi>
                                                        <mo id="S12.T11.25.6.6.m6.1.1.2.3.1"
                                                            xref="S12.T11.25.6.6.m6.1.1.2.3.1.cmml">⁢</mo>
                                                        <mi id="S12.T11.25.6.6.m6.1.1.2.3.3"
                                                            xref="S12.T11.25.6.6.m6.1.1.2.3.3.cmml">f</mi>
                                                    </mrow>
                                                </msub>
                                                <mo id="S12.T11.25.6.6.m6.1.1.1" xref="S12.T11.25.6.6.m6.1.1.1.cmml">=
                                                </mo>
                                                <mn id="S12.T11.25.6.6.m6.1.1.3" xref="S12.T11.25.6.6.m6.1.1.3.cmml">4
                                                </mn>
                                            </mrow><annotation-xml encoding="MathML-Content" id="S12.T11.25.6.6.m6.1c">
                                                <apply id="S12.T11.25.6.6.m6.1.1.cmml" xref="S12.T11.25.6.6.m6.1.1">
                                                    <eq id="S12.T11.25.6.6.m6.1.1.1.cmml"
                                                        xref="S12.T11.25.6.6.m6.1.1.1"></eq>
                                                    <apply id="S12.T11.25.6.6.m6.1.1.2.cmml"
                                                        xref="S12.T11.25.6.6.m6.1.1.2">
                                                        <csymbol cd="ambiguous" id="S12.T11.25.6.6.m6.1.1.2.1.cmml"
                                                            xref="S12.T11.25.6.6.m6.1.1.2">subscript</csymbol>
                                                        <ci id="S12.T11.25.6.6.m6.1.1.2.2.cmml"
                                                            xref="S12.T11.25.6.6.m6.1.1.2.2">𝑑</ci>
                                                        <apply id="S12.T11.25.6.6.m6.1.1.2.3.cmml"
                                                            xref="S12.T11.25.6.6.m6.1.1.2.3">
                                                            <times id="S12.T11.25.6.6.m6.1.1.2.3.1.cmml"
                                                                xref="S12.T11.25.6.6.m6.1.1.2.3.1"></times>
                                                            <ci id="S12.T11.25.6.6.m6.1.1.2.3.2.cmml"
                                                                xref="S12.T11.25.6.6.m6.1.1.2.3.2">𝑓</ci>
                                                            <ci id="S12.T11.25.6.6.m6.1.1.2.3.3.cmml"
                                                                xref="S12.T11.25.6.6.m6.1.1.2.3.3">𝑓</ci>
                                                        </apply>
                                                    </apply>
                                                    <cn id="S12.T11.25.6.6.m6.1.1.3.cmml" type="integer"
                                                        xref="S12.T11.25.6.6.m6.1.1.3">4</cn>
                                                </apply>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.25.6.6.m6.1d">d_{ff}=4
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.25.6.6.m6.1e">
                                                italic_d start_POSTSUBSCRIPT italic_f italic_f end_POSTSUBSCRIPT = 4
                                            </annotation>
                                        </semantics>
                                    </math> is the feed-forward dimension multiplier, <math alttext="p" class="ltx_Math"
                                        display="inline" id="S12.T11.26.7.7.m7.1">
                                        <semantics id="S12.T11.26.7.7.m7.1b">
                                            <mi id="S12.T11.26.7.7.m7.1.1" xref="S12.T11.26.7.7.m7.1.1.cmml">p</mi>
                                            <annotation-xml encoding="MathML-Content" id="S12.T11.26.7.7.m7.1c">
                                                <ci id="S12.T11.26.7.7.m7.1.1.cmml" xref="S12.T11.26.7.7.m7.1.1">𝑝</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.26.7.7.m7.1d">p
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.26.7.7.m7.1e">
                                                italic_p</annotation>
                                        </semantics>
                                    </math> is the patch size, and <math alttext="r" class="ltx_Math" display="inline"
                                        id="S12.T11.27.8.8.m8.1">
                                        <semantics id="S12.T11.27.8.8.m8.1b">
                                            <mi id="S12.T11.27.8.8.m8.1.1" xref="S12.T11.27.8.8.m8.1.1.cmml">r</mi>
                                            <annotation-xml encoding="MathML-Content" id="S12.T11.27.8.8.m8.1c">
                                                <ci id="S12.T11.27.8.8.m8.1.1.cmml" xref="S12.T11.27.8.8.m8.1.1">𝑟</ci>
                                            </annotation-xml>
                                            <annotation encoding="application/x-tex" id="S12.T11.27.8.8.m8.1d">r
                                            </annotation>
                                            <annotation encoding="application/x-llamapun" id="S12.T11.27.8.8.m8.1e">
                                                italic_r</annotation>
                                        </semantics>
                                    </math> is the ratio of queries to keys.</span></span></figcaption>
                    </figure>
                    <div class="ltx_para" id="S12.p2">
                        <p class="ltx_p" id="S12.p2.6">For a transformer model with <math alttext="l" class="ltx_Math"
                                display="inline" id="S12.p2.1.m1.1">
                                <semantics id="S12.p2.1.m1.1a">
                                    <mi id="S12.p2.1.m1.1.1" xref="S12.p2.1.m1.1.1.cmml">l</mi><annotation-xml
                                        encoding="MathML-Content" id="S12.p2.1.m1.1b">
                                        <ci id="S12.p2.1.m1.1.1.cmml" xref="S12.p2.1.m1.1.1">𝑙</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.1.m1.1c">l</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.1.m1.1d">italic_l
                                    </annotation>
                                </semantics>
                            </math> layers, hidden dimension <math alttext="h" class="ltx_Math" display="inline"
                                id="S12.p2.2.m2.1">
                                <semantics id="S12.p2.2.m2.1a">
                                    <mi id="S12.p2.2.m2.1.1" xref="S12.p2.2.m2.1.1.cmml">h</mi><annotation-xml
                                        encoding="MathML-Content" id="S12.p2.2.m2.1b">
                                        <ci id="S12.p2.2.m2.1.1.cmml" xref="S12.p2.2.m2.1.1">ℎ</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.2.m2.1c">h</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.2.m2.1d">italic_h
                                    </annotation>
                                </semantics>
                            </math>, context length <math alttext="m" class="ltx_Math" display="inline"
                                id="S12.p2.3.m3.1">
                                <semantics id="S12.p2.3.m3.1a">
                                    <mi id="S12.p2.3.m3.1.1" xref="S12.p2.3.m3.1.1.cmml">m</mi><annotation-xml
                                        encoding="MathML-Content" id="S12.p2.3.m3.1b">
                                        <ci id="S12.p2.3.m3.1.1.cmml" xref="S12.p2.3.m3.1.1">𝑚</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.3.m3.1c">m</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.3.m3.1d">italic_m
                                    </annotation>
                                </semantics>
                            </math>, <math alttext="n_{heads}" class="ltx_Math" display="inline" id="S12.p2.4.m4.1">
                                <semantics id="S12.p2.4.m4.1a">
                                    <msub id="S12.p2.4.m4.1.1" xref="S12.p2.4.m4.1.1.cmml">
                                        <mi id="S12.p2.4.m4.1.1.2" xref="S12.p2.4.m4.1.1.2.cmml">n</mi>
                                        <mrow id="S12.p2.4.m4.1.1.3" xref="S12.p2.4.m4.1.1.3.cmml">
                                            <mi id="S12.p2.4.m4.1.1.3.2" xref="S12.p2.4.m4.1.1.3.2.cmml">h</mi>
                                            <mo id="S12.p2.4.m4.1.1.3.1" xref="S12.p2.4.m4.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S12.p2.4.m4.1.1.3.3" xref="S12.p2.4.m4.1.1.3.3.cmml">e</mi>
                                            <mo id="S12.p2.4.m4.1.1.3.1a" xref="S12.p2.4.m4.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S12.p2.4.m4.1.1.3.4" xref="S12.p2.4.m4.1.1.3.4.cmml">a</mi>
                                            <mo id="S12.p2.4.m4.1.1.3.1b" xref="S12.p2.4.m4.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S12.p2.4.m4.1.1.3.5" xref="S12.p2.4.m4.1.1.3.5.cmml">d</mi>
                                            <mo id="S12.p2.4.m4.1.1.3.1c" xref="S12.p2.4.m4.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S12.p2.4.m4.1.1.3.6" xref="S12.p2.4.m4.1.1.3.6.cmml">s</mi>
                                        </mrow>
                                    </msub><annotation-xml encoding="MathML-Content" id="S12.p2.4.m4.1b">
                                        <apply id="S12.p2.4.m4.1.1.cmml" xref="S12.p2.4.m4.1.1">
                                            <csymbol cd="ambiguous" id="S12.p2.4.m4.1.1.1.cmml" xref="S12.p2.4.m4.1.1">
                                                subscript</csymbol>
                                            <ci id="S12.p2.4.m4.1.1.2.cmml" xref="S12.p2.4.m4.1.1.2">𝑛</ci>
                                            <apply id="S12.p2.4.m4.1.1.3.cmml" xref="S12.p2.4.m4.1.1.3">
                                                <times id="S12.p2.4.m4.1.1.3.1.cmml" xref="S12.p2.4.m4.1.1.3.1"></times>
                                                <ci id="S12.p2.4.m4.1.1.3.2.cmml" xref="S12.p2.4.m4.1.1.3.2">ℎ</ci>
                                                <ci id="S12.p2.4.m4.1.1.3.3.cmml" xref="S12.p2.4.m4.1.1.3.3">𝑒</ci>
                                                <ci id="S12.p2.4.m4.1.1.3.4.cmml" xref="S12.p2.4.m4.1.1.3.4">𝑎</ci>
                                                <ci id="S12.p2.4.m4.1.1.3.5.cmml" xref="S12.p2.4.m4.1.1.3.5">𝑑</ci>
                                                <ci id="S12.p2.4.m4.1.1.3.6.cmml" xref="S12.p2.4.m4.1.1.3.6">𝑠</ci>
                                            </apply>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.4.m4.1c">n_{heads}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.4.m4.1d">italic_n
                                        start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d italic_s
                                        end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math> attention heads of dimension <math alttext="h_{k}" class="ltx_Math" display="inline"
                                id="S12.p2.5.m5.1">
                                <semantics id="S12.p2.5.m5.1a">
                                    <msub id="S12.p2.5.m5.1.1" xref="S12.p2.5.m5.1.1.cmml">
                                        <mi id="S12.p2.5.m5.1.1.2" xref="S12.p2.5.m5.1.1.2.cmml">h</mi>
                                        <mi id="S12.p2.5.m5.1.1.3" xref="S12.p2.5.m5.1.1.3.cmml">k</mi>
                                    </msub><annotation-xml encoding="MathML-Content" id="S12.p2.5.m5.1b">
                                        <apply id="S12.p2.5.m5.1.1.cmml" xref="S12.p2.5.m5.1.1">
                                            <csymbol cd="ambiguous" id="S12.p2.5.m5.1.1.1.cmml" xref="S12.p2.5.m5.1.1">
                                                subscript</csymbol>
                                            <ci id="S12.p2.5.m5.1.1.2.cmml" xref="S12.p2.5.m5.1.1.2">ℎ</ci>
                                            <ci id="S12.p2.5.m5.1.1.3.cmml" xref="S12.p2.5.m5.1.1.3">𝑘</ci>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.5.m5.1c">h_{k}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.5.m5.1d">italic_h
                                        start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math>, and a feed-forward multipler of <math alttext="d_{ff}" class="ltx_Math"
                                display="inline" id="S12.p2.6.m6.1">
                                <semantics id="S12.p2.6.m6.1a">
                                    <msub id="S12.p2.6.m6.1.1" xref="S12.p2.6.m6.1.1.cmml">
                                        <mi id="S12.p2.6.m6.1.1.2" xref="S12.p2.6.m6.1.1.2.cmml">d</mi>
                                        <mrow id="S12.p2.6.m6.1.1.3" xref="S12.p2.6.m6.1.1.3.cmml">
                                            <mi id="S12.p2.6.m6.1.1.3.2" xref="S12.p2.6.m6.1.1.3.2.cmml">f</mi>
                                            <mo id="S12.p2.6.m6.1.1.3.1" xref="S12.p2.6.m6.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S12.p2.6.m6.1.1.3.3" xref="S12.p2.6.m6.1.1.3.3.cmml">f</mi>
                                        </mrow>
                                    </msub><annotation-xml encoding="MathML-Content" id="S12.p2.6.m6.1b">
                                        <apply id="S12.p2.6.m6.1.1.cmml" xref="S12.p2.6.m6.1.1">
                                            <csymbol cd="ambiguous" id="S12.p2.6.m6.1.1.1.cmml" xref="S12.p2.6.m6.1.1">
                                                subscript</csymbol>
                                            <ci id="S12.p2.6.m6.1.1.2.cmml" xref="S12.p2.6.m6.1.1.2">𝑑</ci>
                                            <apply id="S12.p2.6.m6.1.1.3.cmml" xref="S12.p2.6.m6.1.1.3">
                                                <times id="S12.p2.6.m6.1.1.3.1.cmml" xref="S12.p2.6.m6.1.1.3.1"></times>
                                                <ci id="S12.p2.6.m6.1.1.3.2.cmml" xref="S12.p2.6.m6.1.1.3.2">𝑓</ci>
                                                <ci id="S12.p2.6.m6.1.1.3.3.cmml" xref="S12.p2.6.m6.1.1.3.3">𝑓</ci>
                                            </apply>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S12.p2.6.m6.1c">d_{ff}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S12.p2.6.m6.1d">italic_d
                                        start_POSTSUBSCRIPT italic_f italic_f end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math>, we compute <span class="ltx_text ltx_font_smallcaps" id="S12.p2.6.1">flop</span>s
                            as:</p>
                        <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx8">
                            <tbody id="S12.E19">
                                <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                    <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                    <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                            alttext="\displaystyle\text{Transformer-FLOPs}(l,h,m,n_{heads},h_{k},d_{ff},V)"
                                            class="ltx_Math" display="inline" id="S12.E19.m1.7">
                                            <semantics id="S12.E19.m1.7a">
                                                <mrow id="S12.E19.m1.7.7" xref="S12.E19.m1.7.7.cmml">
                                                    <mtext id="S12.E19.m1.7.7.5" xref="S12.E19.m1.7.7.5a.cmml">
                                                        Transformer-FLOPs</mtext>
                                                    <mo id="S12.E19.m1.7.7.4" xref="S12.E19.m1.7.7.4.cmml">⁢</mo>
                                                    <mrow id="S12.E19.m1.7.7.3.3" xref="S12.E19.m1.7.7.3.4.cmml">
                                                        <mo id="S12.E19.m1.7.7.3.3.4" stretchy="false"
                                                            xref="S12.E19.m1.7.7.3.4.cmml">(</mo>
                                                        <mi id="S12.E19.m1.1.1" xref="S12.E19.m1.1.1.cmml">l</mi>
                                                        <mo id="S12.E19.m1.7.7.3.3.5" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <mi id="S12.E19.m1.2.2" xref="S12.E19.m1.2.2.cmml">h</mi>
                                                        <mo id="S12.E19.m1.7.7.3.3.6" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <mi id="S12.E19.m1.3.3" xref="S12.E19.m1.3.3.cmml">m</mi>
                                                        <mo id="S12.E19.m1.7.7.3.3.7" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <msub id="S12.E19.m1.5.5.1.1.1"
                                                            xref="S12.E19.m1.5.5.1.1.1.cmml">
                                                            <mi id="S12.E19.m1.5.5.1.1.1.2"
                                                                xref="S12.E19.m1.5.5.1.1.1.2.cmml">n</mi>
                                                            <mrow id="S12.E19.m1.5.5.1.1.1.3"
                                                                xref="S12.E19.m1.5.5.1.1.1.3.cmml">
                                                                <mi id="S12.E19.m1.5.5.1.1.1.3.2"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.2.cmml">h</mi>
                                                                <mo id="S12.E19.m1.5.5.1.1.1.3.1"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.1.cmml">⁢</mo>
                                                                <mi id="S12.E19.m1.5.5.1.1.1.3.3"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.3.cmml">e</mi>
                                                                <mo id="S12.E19.m1.5.5.1.1.1.3.1a"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.1.cmml">⁢</mo>
                                                                <mi id="S12.E19.m1.5.5.1.1.1.3.4"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.4.cmml">a</mi>
                                                                <mo id="S12.E19.m1.5.5.1.1.1.3.1b"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.1.cmml">⁢</mo>
                                                                <mi id="S12.E19.m1.5.5.1.1.1.3.5"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.5.cmml">d</mi>
                                                                <mo id="S12.E19.m1.5.5.1.1.1.3.1c"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.1.cmml">⁢</mo>
                                                                <mi id="S12.E19.m1.5.5.1.1.1.3.6"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3.6.cmml">s</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo id="S12.E19.m1.7.7.3.3.8" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <msub id="S12.E19.m1.6.6.2.2.2"
                                                            xref="S12.E19.m1.6.6.2.2.2.cmml">
                                                            <mi id="S12.E19.m1.6.6.2.2.2.2"
                                                                xref="S12.E19.m1.6.6.2.2.2.2.cmml">h</mi>
                                                            <mi id="S12.E19.m1.6.6.2.2.2.3"
                                                                xref="S12.E19.m1.6.6.2.2.2.3.cmml">k</mi>
                                                        </msub>
                                                        <mo id="S12.E19.m1.7.7.3.3.9" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <msub id="S12.E19.m1.7.7.3.3.3"
                                                            xref="S12.E19.m1.7.7.3.3.3.cmml">
                                                            <mi id="S12.E19.m1.7.7.3.3.3.2"
                                                                xref="S12.E19.m1.7.7.3.3.3.2.cmml">d</mi>
                                                            <mrow id="S12.E19.m1.7.7.3.3.3.3"
                                                                xref="S12.E19.m1.7.7.3.3.3.3.cmml">
                                                                <mi id="S12.E19.m1.7.7.3.3.3.3.2"
                                                                    xref="S12.E19.m1.7.7.3.3.3.3.2.cmml">f</mi>
                                                                <mo id="S12.E19.m1.7.7.3.3.3.3.1"
                                                                    xref="S12.E19.m1.7.7.3.3.3.3.1.cmml">⁢</mo>
                                                                <mi id="S12.E19.m1.7.7.3.3.3.3.3"
                                                                    xref="S12.E19.m1.7.7.3.3.3.3.3.cmml">f</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo id="S12.E19.m1.7.7.3.3.10" xref="S12.E19.m1.7.7.3.4.cmml">,
                                                        </mo>
                                                        <mi id="S12.E19.m1.4.4" xref="S12.E19.m1.4.4.cmml">V</mi>
                                                        <mo id="S12.E19.m1.7.7.3.3.11" stretchy="false"
                                                            xref="S12.E19.m1.7.7.3.4.cmml">)</mo>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S12.E19.m1.7b">
                                                    <apply id="S12.E19.m1.7.7.cmml" xref="S12.E19.m1.7.7">
                                                        <times id="S12.E19.m1.7.7.4.cmml" xref="S12.E19.m1.7.7.4">
                                                        </times>
                                                        <ci id="S12.E19.m1.7.7.5a.cmml" xref="S12.E19.m1.7.7.5">
                                                            <mtext id="S12.E19.m1.7.7.5.cmml" xref="S12.E19.m1.7.7.5">
                                                                Transformer-FLOPs</mtext>
                                                        </ci>
                                                        <vector id="S12.E19.m1.7.7.3.4.cmml" xref="S12.E19.m1.7.7.3.3">
                                                            <ci id="S12.E19.m1.1.1.cmml" xref="S12.E19.m1.1.1">𝑙</ci>
                                                            <ci id="S12.E19.m1.2.2.cmml" xref="S12.E19.m1.2.2">ℎ</ci>
                                                            <ci id="S12.E19.m1.3.3.cmml" xref="S12.E19.m1.3.3">𝑚</ci>
                                                            <apply id="S12.E19.m1.5.5.1.1.1.cmml"
                                                                xref="S12.E19.m1.5.5.1.1.1">
                                                                <csymbol cd="ambiguous" id="S12.E19.m1.5.5.1.1.1.1.cmml"
                                                                    xref="S12.E19.m1.5.5.1.1.1">subscript</csymbol>
                                                                <ci id="S12.E19.m1.5.5.1.1.1.2.cmml"
                                                                    xref="S12.E19.m1.5.5.1.1.1.2">𝑛</ci>
                                                                <apply id="S12.E19.m1.5.5.1.1.1.3.cmml"
                                                                    xref="S12.E19.m1.5.5.1.1.1.3">
                                                                    <times id="S12.E19.m1.5.5.1.1.1.3.1.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.1"></times>
                                                                    <ci id="S12.E19.m1.5.5.1.1.1.3.2.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.2">ℎ</ci>
                                                                    <ci id="S12.E19.m1.5.5.1.1.1.3.3.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.3">𝑒</ci>
                                                                    <ci id="S12.E19.m1.5.5.1.1.1.3.4.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.4">𝑎</ci>
                                                                    <ci id="S12.E19.m1.5.5.1.1.1.3.5.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.5">𝑑</ci>
                                                                    <ci id="S12.E19.m1.5.5.1.1.1.3.6.cmml"
                                                                        xref="S12.E19.m1.5.5.1.1.1.3.6">𝑠</ci>
                                                                </apply>
                                                            </apply>
                                                            <apply id="S12.E19.m1.6.6.2.2.2.cmml"
                                                                xref="S12.E19.m1.6.6.2.2.2">
                                                                <csymbol cd="ambiguous" id="S12.E19.m1.6.6.2.2.2.1.cmml"
                                                                    xref="S12.E19.m1.6.6.2.2.2">subscript</csymbol>
                                                                <ci id="S12.E19.m1.6.6.2.2.2.2.cmml"
                                                                    xref="S12.E19.m1.6.6.2.2.2.2">ℎ</ci>
                                                                <ci id="S12.E19.m1.6.6.2.2.2.3.cmml"
                                                                    xref="S12.E19.m1.6.6.2.2.2.3">𝑘</ci>
                                                            </apply>
                                                            <apply id="S12.E19.m1.7.7.3.3.3.cmml"
                                                                xref="S12.E19.m1.7.7.3.3.3">
                                                                <csymbol cd="ambiguous" id="S12.E19.m1.7.7.3.3.3.1.cmml"
                                                                    xref="S12.E19.m1.7.7.3.3.3">subscript</csymbol>
                                                                <ci id="S12.E19.m1.7.7.3.3.3.2.cmml"
                                                                    xref="S12.E19.m1.7.7.3.3.3.2">𝑑</ci>
                                                                <apply id="S12.E19.m1.7.7.3.3.3.3.cmml"
                                                                    xref="S12.E19.m1.7.7.3.3.3.3">
                                                                    <times id="S12.E19.m1.7.7.3.3.3.3.1.cmml"
                                                                        xref="S12.E19.m1.7.7.3.3.3.3.1"></times>
                                                                    <ci id="S12.E19.m1.7.7.3.3.3.3.2.cmml"
                                                                        xref="S12.E19.m1.7.7.3.3.3.3.2">𝑓</ci>
                                                                    <ci id="S12.E19.m1.7.7.3.3.3.3.3.cmml"
                                                                        xref="S12.E19.m1.7.7.3.3.3.3.3">𝑓</ci>
                                                                </apply>
                                                            </apply>
                                                            <ci id="S12.E19.m1.4.4.cmml" xref="S12.E19.m1.4.4">𝑉</ci>
                                                        </vector>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.E19.m1.7c">
                                                    \displaystyle\text{Transformer-FLOPs}(l,h,m,n_{heads},h_{k},d_{ff},V)
                                                </annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.E19.m1.7d">
                                                    Transformer-FLOPs ( italic_l , italic_h , italic_m , italic_n
                                                    start_POSTSUBSCRIPT italic_h italic_e italic_a italic_d italic_s
                                                    end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT italic_k
                                                    end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT italic_f italic_f
                                                    end_POSTSUBSCRIPT , italic_V )</annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                            alttext="\displaystyle=\text{Feed-forward}(l,h,d_{ff})" class="ltx_Math"
                                            display="inline" id="S12.E19.m2.3">
                                            <semantics id="S12.E19.m2.3a">
                                                <mrow id="S12.E19.m2.3.3" xref="S12.E19.m2.3.3.cmml">
                                                    <mi id="S12.E19.m2.3.3.3" xref="S12.E19.m2.3.3.3.cmml"></mi>
                                                    <mo id="S12.E19.m2.3.3.2" xref="S12.E19.m2.3.3.2.cmml">=</mo>
                                                    <mrow id="S12.E19.m2.3.3.1" xref="S12.E19.m2.3.3.1.cmml">
                                                        <mtext id="S12.E19.m2.3.3.1.3" xref="S12.E19.m2.3.3.1.3a.cmml">
                                                            Feed-forward</mtext>
                                                        <mo id="S12.E19.m2.3.3.1.2" xref="S12.E19.m2.3.3.1.2.cmml">⁢
                                                        </mo>
                                                        <mrow id="S12.E19.m2.3.3.1.1.1"
                                                            xref="S12.E19.m2.3.3.1.1.2.cmml">
                                                            <mo id="S12.E19.m2.3.3.1.1.1.2" stretchy="false"
                                                                xref="S12.E19.m2.3.3.1.1.2.cmml">(</mo>
                                                            <mi id="S12.E19.m2.1.1" xref="S12.E19.m2.1.1.cmml">l</mi>
                                                            <mo id="S12.E19.m2.3.3.1.1.1.3"
                                                                xref="S12.E19.m2.3.3.1.1.2.cmml">,</mo>
                                                            <mi id="S12.E19.m2.2.2" xref="S12.E19.m2.2.2.cmml">h</mi>
                                                            <mo id="S12.E19.m2.3.3.1.1.1.4"
                                                                xref="S12.E19.m2.3.3.1.1.2.cmml">,</mo>
                                                            <msub id="S12.E19.m2.3.3.1.1.1.1"
                                                                xref="S12.E19.m2.3.3.1.1.1.1.cmml">
                                                                <mi id="S12.E19.m2.3.3.1.1.1.1.2"
                                                                    xref="S12.E19.m2.3.3.1.1.1.1.2.cmml">d</mi>
                                                                <mrow id="S12.E19.m2.3.3.1.1.1.1.3"
                                                                    xref="S12.E19.m2.3.3.1.1.1.1.3.cmml">
                                                                    <mi id="S12.E19.m2.3.3.1.1.1.1.3.2"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1.3.2.cmml">f</mi>
                                                                    <mo id="S12.E19.m2.3.3.1.1.1.1.3.1"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1.3.1.cmml">⁢</mo>
                                                                    <mi id="S12.E19.m2.3.3.1.1.1.1.3.3"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1.3.3.cmml">f</mi>
                                                                </mrow>
                                                            </msub>
                                                            <mo id="S12.E19.m2.3.3.1.1.1.5" stretchy="false"
                                                                xref="S12.E19.m2.3.3.1.1.2.cmml">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S12.E19.m2.3b">
                                                    <apply id="S12.E19.m2.3.3.cmml" xref="S12.E19.m2.3.3">
                                                        <eq id="S12.E19.m2.3.3.2.cmml" xref="S12.E19.m2.3.3.2"></eq>
                                                        <csymbol cd="latexml" id="S12.E19.m2.3.3.3.cmml"
                                                            xref="S12.E19.m2.3.3.3">absent</csymbol>
                                                        <apply id="S12.E19.m2.3.3.1.cmml" xref="S12.E19.m2.3.3.1">
                                                            <times id="S12.E19.m2.3.3.1.2.cmml"
                                                                xref="S12.E19.m2.3.3.1.2"></times>
                                                            <ci id="S12.E19.m2.3.3.1.3a.cmml" xref="S12.E19.m2.3.3.1.3">
                                                                <mtext id="S12.E19.m2.3.3.1.3.cmml"
                                                                    xref="S12.E19.m2.3.3.1.3">Feed-forward</mtext>
                                                            </ci>
                                                            <vector id="S12.E19.m2.3.3.1.1.2.cmml"
                                                                xref="S12.E19.m2.3.3.1.1.1">
                                                                <ci id="S12.E19.m2.1.1.cmml" xref="S12.E19.m2.1.1">𝑙
                                                                </ci>
                                                                <ci id="S12.E19.m2.2.2.cmml" xref="S12.E19.m2.2.2">ℎ
                                                                </ci>
                                                                <apply id="S12.E19.m2.3.3.1.1.1.1.cmml"
                                                                    xref="S12.E19.m2.3.3.1.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S12.E19.m2.3.3.1.1.1.1.1.cmml"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1">subscript
                                                                    </csymbol>
                                                                    <ci id="S12.E19.m2.3.3.1.1.1.1.2.cmml"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1.2">𝑑</ci>
                                                                    <apply id="S12.E19.m2.3.3.1.1.1.1.3.cmml"
                                                                        xref="S12.E19.m2.3.3.1.1.1.1.3">
                                                                        <times id="S12.E19.m2.3.3.1.1.1.1.3.1.cmml"
                                                                            xref="S12.E19.m2.3.3.1.1.1.1.3.1"></times>
                                                                        <ci id="S12.E19.m2.3.3.1.1.1.1.3.2.cmml"
                                                                            xref="S12.E19.m2.3.3.1.1.1.1.3.2">𝑓</ci>
                                                                        <ci id="S12.E19.m2.3.3.1.1.1.1.3.3.cmml"
                                                                            xref="S12.E19.m2.3.3.1.1.1.1.3.3">𝑓</ci>
                                                                    </apply>
                                                                </apply>
                                                            </vector>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.E19.m2.3c">
                                                    \displaystyle=\text{Feed-forward}(l,h,d_{ff})</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.E19.m2.3d">=
                                                    Feed-forward ( italic_l , italic_h , italic_d start_POSTSUBSCRIPT
                                                    italic_f italic_f end_POSTSUBSCRIPT )</annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
                                        <span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
                                </tr>
                            </tbody>
                            <tbody id="S12.E20">
                                <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                    <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                    <td class="ltx_td ltx_eqn_cell"></td>
                                    <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                            alttext="\displaystyle+\text{QKVO}(l,h,r=1)" class="ltx_Math"
                                            display="inline" id="S12.E20.m1.4">
                                            <semantics id="S12.E20.m1.4a">
                                                <mrow id="S12.E20.m1.4.4" xref="S12.E20.m1.4.4.cmml">
                                                    <mo id="S12.E20.m1.4.4a" xref="S12.E20.m1.4.4.cmml">+</mo>
                                                    <mrow id="S12.E20.m1.4.4.1" xref="S12.E20.m1.4.4.1.cmml">
                                                        <mtext id="S12.E20.m1.4.4.1.3" xref="S12.E20.m1.4.4.1.3a.cmml">
                                                            QKVO</mtext>
                                                        <mo id="S12.E20.m1.4.4.1.2" xref="S12.E20.m1.4.4.1.2.cmml">⁢
                                                        </mo>
                                                        <mrow id="S12.E20.m1.4.4.1.1.1"
                                                            xref="S12.E20.m1.4.4.1.1.1.1.cmml">
                                                            <mo id="S12.E20.m1.4.4.1.1.1.2" stretchy="false"
                                                                xref="S12.E20.m1.4.4.1.1.1.1.cmml">(</mo>
                                                            <mrow id="S12.E20.m1.4.4.1.1.1.1"
                                                                xref="S12.E20.m1.4.4.1.1.1.1.cmml">
                                                                <mrow id="S12.E20.m1.4.4.1.1.1.1.2.2"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.2.1.cmml">
                                                                    <mi id="S12.E20.m1.1.1" xref="S12.E20.m1.1.1.cmml">l
                                                                    </mi>
                                                                    <mo id="S12.E20.m1.4.4.1.1.1.1.2.2.1"
                                                                        xref="S12.E20.m1.4.4.1.1.1.1.2.1.cmml">,</mo>
                                                                    <mi id="S12.E20.m1.2.2" xref="S12.E20.m1.2.2.cmml">h
                                                                    </mi>
                                                                    <mo id="S12.E20.m1.4.4.1.1.1.1.2.2.2"
                                                                        xref="S12.E20.m1.4.4.1.1.1.1.2.1.cmml">,</mo>
                                                                    <mi id="S12.E20.m1.3.3" xref="S12.E20.m1.3.3.cmml">r
                                                                    </mi>
                                                                </mrow>
                                                                <mo id="S12.E20.m1.4.4.1.1.1.1.1"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.1.cmml">=</mo>
                                                                <mn id="S12.E20.m1.4.4.1.1.1.1.3"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.3.cmml">1</mn>
                                                            </mrow>
                                                            <mo id="S12.E20.m1.4.4.1.1.1.3" stretchy="false"
                                                                xref="S12.E20.m1.4.4.1.1.1.1.cmml">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S12.E20.m1.4b">
                                                    <apply id="S12.E20.m1.4.4.cmml" xref="S12.E20.m1.4.4">
                                                        <plus id="S12.E20.m1.4.4.2.cmml" xref="S12.E20.m1.4.4"></plus>
                                                        <apply id="S12.E20.m1.4.4.1.cmml" xref="S12.E20.m1.4.4.1">
                                                            <times id="S12.E20.m1.4.4.1.2.cmml"
                                                                xref="S12.E20.m1.4.4.1.2"></times>
                                                            <ci id="S12.E20.m1.4.4.1.3a.cmml" xref="S12.E20.m1.4.4.1.3">
                                                                <mtext id="S12.E20.m1.4.4.1.3.cmml"
                                                                    xref="S12.E20.m1.4.4.1.3">QKVO</mtext>
                                                            </ci>
                                                            <apply id="S12.E20.m1.4.4.1.1.1.1.cmml"
                                                                xref="S12.E20.m1.4.4.1.1.1">
                                                                <eq id="S12.E20.m1.4.4.1.1.1.1.1.cmml"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.1"></eq>
                                                                <list id="S12.E20.m1.4.4.1.1.1.1.2.1.cmml"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.2.2">
                                                                    <ci id="S12.E20.m1.1.1.cmml" xref="S12.E20.m1.1.1">
                                                                        𝑙</ci>
                                                                    <ci id="S12.E20.m1.2.2.cmml" xref="S12.E20.m1.2.2">ℎ
                                                                    </ci>
                                                                    <ci id="S12.E20.m1.3.3.cmml" xref="S12.E20.m1.3.3">
                                                                        𝑟</ci>
                                                                </list>
                                                                <cn id="S12.E20.m1.4.4.1.1.1.1.3.cmml" type="integer"
                                                                    xref="S12.E20.m1.4.4.1.1.1.1.3">1</cn>
                                                            </apply>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.E20.m1.4c">
                                                    \displaystyle+\text{QKVO}(l,h,r=1)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.E20.m1.4d">+ QKVO
                                                    ( italic_l , italic_h , italic_r = 1 )</annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
                                        <span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
                                </tr>
                            </tbody>
                            <tbody id="S12.E21">
                                <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                    <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                    <td class="ltx_td ltx_eqn_cell"></td>
                                    <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                            alttext="\displaystyle+\text{Attention}(l,h_{k},n_{heads},m)"
                                            class="ltx_Math" display="inline" id="S12.E21.m1.4">
                                            <semantics id="S12.E21.m1.4a">
                                                <mrow id="S12.E21.m1.4.4" xref="S12.E21.m1.4.4.cmml">
                                                    <mo id="S12.E21.m1.4.4a" xref="S12.E21.m1.4.4.cmml">+</mo>
                                                    <mrow id="S12.E21.m1.4.4.2" xref="S12.E21.m1.4.4.2.cmml">
                                                        <mtext id="S12.E21.m1.4.4.2.4" xref="S12.E21.m1.4.4.2.4a.cmml">
                                                            Attention</mtext>
                                                        <mo id="S12.E21.m1.4.4.2.3" xref="S12.E21.m1.4.4.2.3.cmml">⁢
                                                        </mo>
                                                        <mrow id="S12.E21.m1.4.4.2.2.2"
                                                            xref="S12.E21.m1.4.4.2.2.3.cmml">
                                                            <mo id="S12.E21.m1.4.4.2.2.2.3" stretchy="false"
                                                                xref="S12.E21.m1.4.4.2.2.3.cmml">(</mo>
                                                            <mi id="S12.E21.m1.1.1" xref="S12.E21.m1.1.1.cmml">l</mi>
                                                            <mo id="S12.E21.m1.4.4.2.2.2.4"
                                                                xref="S12.E21.m1.4.4.2.2.3.cmml">,</mo>
                                                            <msub id="S12.E21.m1.3.3.1.1.1.1"
                                                                xref="S12.E21.m1.3.3.1.1.1.1.cmml">
                                                                <mi id="S12.E21.m1.3.3.1.1.1.1.2"
                                                                    xref="S12.E21.m1.3.3.1.1.1.1.2.cmml">h</mi>
                                                                <mi id="S12.E21.m1.3.3.1.1.1.1.3"
                                                                    xref="S12.E21.m1.3.3.1.1.1.1.3.cmml">k</mi>
                                                            </msub>
                                                            <mo id="S12.E21.m1.4.4.2.2.2.5"
                                                                xref="S12.E21.m1.4.4.2.2.3.cmml">,</mo>
                                                            <msub id="S12.E21.m1.4.4.2.2.2.2"
                                                                xref="S12.E21.m1.4.4.2.2.2.2.cmml">
                                                                <mi id="S12.E21.m1.4.4.2.2.2.2.2"
                                                                    xref="S12.E21.m1.4.4.2.2.2.2.2.cmml">n</mi>
                                                                <mrow id="S12.E21.m1.4.4.2.2.2.2.3"
                                                                    xref="S12.E21.m1.4.4.2.2.2.2.3.cmml">
                                                                    <mi id="S12.E21.m1.4.4.2.2.2.2.3.2"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.2.cmml">h</mi>
                                                                    <mo id="S12.E21.m1.4.4.2.2.2.2.3.1"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.1.cmml">⁢</mo>
                                                                    <mi id="S12.E21.m1.4.4.2.2.2.2.3.3"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.3.cmml">e</mi>
                                                                    <mo id="S12.E21.m1.4.4.2.2.2.2.3.1a"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.1.cmml">⁢</mo>
                                                                    <mi id="S12.E21.m1.4.4.2.2.2.2.3.4"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.4.cmml">a</mi>
                                                                    <mo id="S12.E21.m1.4.4.2.2.2.2.3.1b"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.1.cmml">⁢</mo>
                                                                    <mi id="S12.E21.m1.4.4.2.2.2.2.3.5"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.5.cmml">d</mi>
                                                                    <mo id="S12.E21.m1.4.4.2.2.2.2.3.1c"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.1.cmml">⁢</mo>
                                                                    <mi id="S12.E21.m1.4.4.2.2.2.2.3.6"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3.6.cmml">s</mi>
                                                                </mrow>
                                                            </msub>
                                                            <mo id="S12.E21.m1.4.4.2.2.2.6"
                                                                xref="S12.E21.m1.4.4.2.2.3.cmml">,</mo>
                                                            <mi id="S12.E21.m1.2.2" xref="S12.E21.m1.2.2.cmml">m</mi>
                                                            <mo id="S12.E21.m1.4.4.2.2.2.7" stretchy="false"
                                                                xref="S12.E21.m1.4.4.2.2.3.cmml">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S12.E21.m1.4b">
                                                    <apply id="S12.E21.m1.4.4.cmml" xref="S12.E21.m1.4.4">
                                                        <plus id="S12.E21.m1.4.4.3.cmml" xref="S12.E21.m1.4.4"></plus>
                                                        <apply id="S12.E21.m1.4.4.2.cmml" xref="S12.E21.m1.4.4.2">
                                                            <times id="S12.E21.m1.4.4.2.3.cmml"
                                                                xref="S12.E21.m1.4.4.2.3"></times>
                                                            <ci id="S12.E21.m1.4.4.2.4a.cmml" xref="S12.E21.m1.4.4.2.4">
                                                                <mtext id="S12.E21.m1.4.4.2.4.cmml"
                                                                    xref="S12.E21.m1.4.4.2.4">Attention</mtext>
                                                            </ci>
                                                            <vector id="S12.E21.m1.4.4.2.2.3.cmml"
                                                                xref="S12.E21.m1.4.4.2.2.2">
                                                                <ci id="S12.E21.m1.1.1.cmml" xref="S12.E21.m1.1.1">𝑙
                                                                </ci>
                                                                <apply id="S12.E21.m1.3.3.1.1.1.1.cmml"
                                                                    xref="S12.E21.m1.3.3.1.1.1.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S12.E21.m1.3.3.1.1.1.1.1.cmml"
                                                                        xref="S12.E21.m1.3.3.1.1.1.1">subscript
                                                                    </csymbol>
                                                                    <ci id="S12.E21.m1.3.3.1.1.1.1.2.cmml"
                                                                        xref="S12.E21.m1.3.3.1.1.1.1.2">ℎ</ci>
                                                                    <ci id="S12.E21.m1.3.3.1.1.1.1.3.cmml"
                                                                        xref="S12.E21.m1.3.3.1.1.1.1.3">𝑘</ci>
                                                                </apply>
                                                                <apply id="S12.E21.m1.4.4.2.2.2.2.cmml"
                                                                    xref="S12.E21.m1.4.4.2.2.2.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S12.E21.m1.4.4.2.2.2.2.1.cmml"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2">subscript
                                                                    </csymbol>
                                                                    <ci id="S12.E21.m1.4.4.2.2.2.2.2.cmml"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.2">𝑛</ci>
                                                                    <apply id="S12.E21.m1.4.4.2.2.2.2.3.cmml"
                                                                        xref="S12.E21.m1.4.4.2.2.2.2.3">
                                                                        <times id="S12.E21.m1.4.4.2.2.2.2.3.1.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.1"></times>
                                                                        <ci id="S12.E21.m1.4.4.2.2.2.2.3.2.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.2">ℎ</ci>
                                                                        <ci id="S12.E21.m1.4.4.2.2.2.2.3.3.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.3">𝑒</ci>
                                                                        <ci id="S12.E21.m1.4.4.2.2.2.2.3.4.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.4">𝑎</ci>
                                                                        <ci id="S12.E21.m1.4.4.2.2.2.2.3.5.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.5">𝑑</ci>
                                                                        <ci id="S12.E21.m1.4.4.2.2.2.2.3.6.cmml"
                                                                            xref="S12.E21.m1.4.4.2.2.2.2.3.6">𝑠</ci>
                                                                    </apply>
                                                                </apply>
                                                                <ci id="S12.E21.m1.2.2.cmml" xref="S12.E21.m1.2.2">𝑚
                                                                </ci>
                                                            </vector>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.E21.m1.4c">
                                                    \displaystyle+\text{Attention}(l,h_{k},n_{heads},m)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.E21.m1.4d">+
                                                    Attention ( italic_l , italic_h start_POSTSUBSCRIPT italic_k
                                                    end_POSTSUBSCRIPT , italic_n start_POSTSUBSCRIPT italic_h italic_e
                                                    italic_a italic_d italic_s end_POSTSUBSCRIPT , italic_m )
                                                </annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
                                        <span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
                                </tr>
                            </tbody>
                            <tbody id="S12.E22">
                                <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                    <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                    <td class="ltx_td ltx_eqn_cell"></td>
                                    <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                            alttext="\displaystyle+\text{De-Embedding}(h,V)" class="ltx_Math"
                                            display="inline" id="S12.E22.m1.2">
                                            <semantics id="S12.E22.m1.2a">
                                                <mrow id="S12.E22.m1.2.3" xref="S12.E22.m1.2.3.cmml">
                                                    <mo id="S12.E22.m1.2.3a" xref="S12.E22.m1.2.3.cmml">+</mo>
                                                    <mrow id="S12.E22.m1.2.3.2" xref="S12.E22.m1.2.3.2.cmml">
                                                        <mtext id="S12.E22.m1.2.3.2.2" xref="S12.E22.m1.2.3.2.2a.cmml">
                                                            De-Embedding</mtext>
                                                        <mo id="S12.E22.m1.2.3.2.1" xref="S12.E22.m1.2.3.2.1.cmml">⁢
                                                        </mo>
                                                        <mrow id="S12.E22.m1.2.3.2.3.2"
                                                            xref="S12.E22.m1.2.3.2.3.1.cmml">
                                                            <mo id="S12.E22.m1.2.3.2.3.2.1" stretchy="false"
                                                                xref="S12.E22.m1.2.3.2.3.1.cmml">(</mo>
                                                            <mi id="S12.E22.m1.1.1" xref="S12.E22.m1.1.1.cmml">h</mi>
                                                            <mo id="S12.E22.m1.2.3.2.3.2.2"
                                                                xref="S12.E22.m1.2.3.2.3.1.cmml">,</mo>
                                                            <mi id="S12.E22.m1.2.2" xref="S12.E22.m1.2.2.cmml">V</mi>
                                                            <mo id="S12.E22.m1.2.3.2.3.2.3" stretchy="false"
                                                                xref="S12.E22.m1.2.3.2.3.1.cmml">)</mo>
                                                        </mrow>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S12.E22.m1.2b">
                                                    <apply id="S12.E22.m1.2.3.cmml" xref="S12.E22.m1.2.3">
                                                        <plus id="S12.E22.m1.2.3.1.cmml" xref="S12.E22.m1.2.3"></plus>
                                                        <apply id="S12.E22.m1.2.3.2.cmml" xref="S12.E22.m1.2.3.2">
                                                            <times id="S12.E22.m1.2.3.2.1.cmml"
                                                                xref="S12.E22.m1.2.3.2.1"></times>
                                                            <ci id="S12.E22.m1.2.3.2.2a.cmml" xref="S12.E22.m1.2.3.2.2">
                                                                <mtext id="S12.E22.m1.2.3.2.2.cmml"
                                                                    xref="S12.E22.m1.2.3.2.2">De-Embedding</mtext>
                                                            </ci>
                                                            <interval closure="open" id="S12.E22.m1.2.3.2.3.1.cmml"
                                                                xref="S12.E22.m1.2.3.2.3.2">
                                                                <ci id="S12.E22.m1.1.1.cmml" xref="S12.E22.m1.1.1">ℎ
                                                                </ci>
                                                                <ci id="S12.E22.m1.2.2.cmml" xref="S12.E22.m1.2.2">𝑉
                                                                </ci>
                                                            </interval>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S12.E22.m1.2c">
                                                    \displaystyle+\text{De-Embedding}(h,V)</annotation>
                                                <annotation encoding="application/x-llamapun" id="S12.E22.m1.2d">+
                                                    De-Embedding ( italic_h , italic_V )</annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
                                        <span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="ltx_para" id="S12.p3">
                        <p class="ltx_p" id="S12.p3.1">For <span class="ltx_text ltx_font_smallcaps"
                                id="S12.p3.1.1">B</span>LT models, we use the above-mentioned primitives together with
                            the <span class="ltx_text ltx_font_smallcaps" id="S12.p3.1.2">flop</span>s equation from
                            Section <a class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S4.SS5"
                                title="4.5 FLOPs Estimation ‣ 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">4.5</span></a> to compute total <span
                                class="ltx_text ltx_font_smallcaps" id="S12.p3.1.3">flop</span>s.</p>
                    </div>
                </section>
                <section class="ltx_section" id="S13">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">13 </span>Rolling Polynomial Hashing
                    </h2>
                    <div class="ltx_para" id="S13.p1">
                        <p class="ltx_p" id="S13.p1.3">Given a byte <math alttext="n" class="ltx_Math" display="inline"
                                id="S13.p1.1.m1.1">
                                <semantics id="S13.p1.1.m1.1a">
                                    <mi id="S13.p1.1.m1.1.1" xref="S13.p1.1.m1.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S13.p1.1.m1.1b">
                                        <ci id="S13.p1.1.m1.1.1.cmml" xref="S13.p1.1.m1.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S13.p1.1.m1.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S13.p1.1.m1.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math>-gram <math alttext="g_{i,n}=\{b_{i-n+1},\ldots,b_{i}\}" class="ltx_Math"
                                display="inline" id="S13.p1.2.m2.5">
                                <semantics id="S13.p1.2.m2.5a">
                                    <mrow id="S13.p1.2.m2.5.5" xref="S13.p1.2.m2.5.5.cmml">
                                        <msub id="S13.p1.2.m2.5.5.4" xref="S13.p1.2.m2.5.5.4.cmml">
                                            <mi id="S13.p1.2.m2.5.5.4.2" xref="S13.p1.2.m2.5.5.4.2.cmml">g</mi>
                                            <mrow id="S13.p1.2.m2.2.2.2.4" xref="S13.p1.2.m2.2.2.2.3.cmml">
                                                <mi id="S13.p1.2.m2.1.1.1.1" xref="S13.p1.2.m2.1.1.1.1.cmml">i</mi>
                                                <mo id="S13.p1.2.m2.2.2.2.4.1" xref="S13.p1.2.m2.2.2.2.3.cmml">,</mo>
                                                <mi id="S13.p1.2.m2.2.2.2.2" xref="S13.p1.2.m2.2.2.2.2.cmml">n</mi>
                                            </mrow>
                                        </msub>
                                        <mo id="S13.p1.2.m2.5.5.3" xref="S13.p1.2.m2.5.5.3.cmml">=</mo>
                                        <mrow id="S13.p1.2.m2.5.5.2.2" xref="S13.p1.2.m2.5.5.2.3.cmml">
                                            <mo id="S13.p1.2.m2.5.5.2.2.3" stretchy="false"
                                                xref="S13.p1.2.m2.5.5.2.3.cmml">{</mo>
                                            <msub id="S13.p1.2.m2.4.4.1.1.1" xref="S13.p1.2.m2.4.4.1.1.1.cmml">
                                                <mi id="S13.p1.2.m2.4.4.1.1.1.2" xref="S13.p1.2.m2.4.4.1.1.1.2.cmml">b
                                                </mi>
                                                <mrow id="S13.p1.2.m2.4.4.1.1.1.3" xref="S13.p1.2.m2.4.4.1.1.1.3.cmml">
                                                    <mrow id="S13.p1.2.m2.4.4.1.1.1.3.2"
                                                        xref="S13.p1.2.m2.4.4.1.1.1.3.2.cmml">
                                                        <mi id="S13.p1.2.m2.4.4.1.1.1.3.2.2"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.2.2.cmml">i</mi>
                                                        <mo id="S13.p1.2.m2.4.4.1.1.1.3.2.1"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.2.1.cmml">−</mo>
                                                        <mi id="S13.p1.2.m2.4.4.1.1.1.3.2.3"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.2.3.cmml">n</mi>
                                                    </mrow>
                                                    <mo id="S13.p1.2.m2.4.4.1.1.1.3.1"
                                                        xref="S13.p1.2.m2.4.4.1.1.1.3.1.cmml">+</mo>
                                                    <mn id="S13.p1.2.m2.4.4.1.1.1.3.3"
                                                        xref="S13.p1.2.m2.4.4.1.1.1.3.3.cmml">1</mn>
                                                </mrow>
                                            </msub>
                                            <mo id="S13.p1.2.m2.5.5.2.2.4" xref="S13.p1.2.m2.5.5.2.3.cmml">,</mo>
                                            <mi id="S13.p1.2.m2.3.3" mathvariant="normal" xref="S13.p1.2.m2.3.3.cmml">…
                                            </mi>
                                            <mo id="S13.p1.2.m2.5.5.2.2.5" xref="S13.p1.2.m2.5.5.2.3.cmml">,</mo>
                                            <msub id="S13.p1.2.m2.5.5.2.2.2" xref="S13.p1.2.m2.5.5.2.2.2.cmml">
                                                <mi id="S13.p1.2.m2.5.5.2.2.2.2" xref="S13.p1.2.m2.5.5.2.2.2.2.cmml">b
                                                </mi>
                                                <mi id="S13.p1.2.m2.5.5.2.2.2.3" xref="S13.p1.2.m2.5.5.2.2.2.3.cmml">i
                                                </mi>
                                            </msub>
                                            <mo id="S13.p1.2.m2.5.5.2.2.6" stretchy="false"
                                                xref="S13.p1.2.m2.5.5.2.3.cmml">}</mo>
                                        </mrow>
                                    </mrow><annotation-xml encoding="MathML-Content" id="S13.p1.2.m2.5b">
                                        <apply id="S13.p1.2.m2.5.5.cmml" xref="S13.p1.2.m2.5.5">
                                            <eq id="S13.p1.2.m2.5.5.3.cmml" xref="S13.p1.2.m2.5.5.3"></eq>
                                            <apply id="S13.p1.2.m2.5.5.4.cmml" xref="S13.p1.2.m2.5.5.4">
                                                <csymbol cd="ambiguous" id="S13.p1.2.m2.5.5.4.1.cmml"
                                                    xref="S13.p1.2.m2.5.5.4">subscript</csymbol>
                                                <ci id="S13.p1.2.m2.5.5.4.2.cmml" xref="S13.p1.2.m2.5.5.4.2">𝑔</ci>
                                                <list id="S13.p1.2.m2.2.2.2.3.cmml" xref="S13.p1.2.m2.2.2.2.4">
                                                    <ci id="S13.p1.2.m2.1.1.1.1.cmml" xref="S13.p1.2.m2.1.1.1.1">𝑖</ci>
                                                    <ci id="S13.p1.2.m2.2.2.2.2.cmml" xref="S13.p1.2.m2.2.2.2.2">𝑛</ci>
                                                </list>
                                            </apply>
                                            <set id="S13.p1.2.m2.5.5.2.3.cmml" xref="S13.p1.2.m2.5.5.2.2">
                                                <apply id="S13.p1.2.m2.4.4.1.1.1.cmml" xref="S13.p1.2.m2.4.4.1.1.1">
                                                    <csymbol cd="ambiguous" id="S13.p1.2.m2.4.4.1.1.1.1.cmml"
                                                        xref="S13.p1.2.m2.4.4.1.1.1">subscript</csymbol>
                                                    <ci id="S13.p1.2.m2.4.4.1.1.1.2.cmml"
                                                        xref="S13.p1.2.m2.4.4.1.1.1.2">𝑏</ci>
                                                    <apply id="S13.p1.2.m2.4.4.1.1.1.3.cmml"
                                                        xref="S13.p1.2.m2.4.4.1.1.1.3">
                                                        <plus id="S13.p1.2.m2.4.4.1.1.1.3.1.cmml"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.1"></plus>
                                                        <apply id="S13.p1.2.m2.4.4.1.1.1.3.2.cmml"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.2">
                                                            <minus id="S13.p1.2.m2.4.4.1.1.1.3.2.1.cmml"
                                                                xref="S13.p1.2.m2.4.4.1.1.1.3.2.1"></minus>
                                                            <ci id="S13.p1.2.m2.4.4.1.1.1.3.2.2.cmml"
                                                                xref="S13.p1.2.m2.4.4.1.1.1.3.2.2">𝑖</ci>
                                                            <ci id="S13.p1.2.m2.4.4.1.1.1.3.2.3.cmml"
                                                                xref="S13.p1.2.m2.4.4.1.1.1.3.2.3">𝑛</ci>
                                                        </apply>
                                                        <cn id="S13.p1.2.m2.4.4.1.1.1.3.3.cmml" type="integer"
                                                            xref="S13.p1.2.m2.4.4.1.1.1.3.3">1</cn>
                                                    </apply>
                                                </apply>
                                                <ci id="S13.p1.2.m2.3.3.cmml" xref="S13.p1.2.m2.3.3">…</ci>
                                                <apply id="S13.p1.2.m2.5.5.2.2.2.cmml" xref="S13.p1.2.m2.5.5.2.2.2">
                                                    <csymbol cd="ambiguous" id="S13.p1.2.m2.5.5.2.2.2.1.cmml"
                                                        xref="S13.p1.2.m2.5.5.2.2.2">subscript</csymbol>
                                                    <ci id="S13.p1.2.m2.5.5.2.2.2.2.cmml"
                                                        xref="S13.p1.2.m2.5.5.2.2.2.2">𝑏</ci>
                                                    <ci id="S13.p1.2.m2.5.5.2.2.2.3.cmml"
                                                        xref="S13.p1.2.m2.5.5.2.2.2.3">𝑖</ci>
                                                </apply>
                                            </set>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S13.p1.2.m2.5c">
                                        g_{i,n}=\{b_{i-n+1},\ldots,b_{i}\}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S13.p1.2.m2.5d">italic_g
                                        start_POSTSUBSCRIPT italic_i , italic_n end_POSTSUBSCRIPT = { italic_b
                                        start_POSTSUBSCRIPT italic_i - italic_n + 1 end_POSTSUBSCRIPT , … , italic_b
                                        start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation>
                                </semantics>
                            </math>, the rolling polynomial hash of <math alttext="g_{i,n}" class="ltx_Math"
                                display="inline" id="S13.p1.3.m3.2">
                                <semantics id="S13.p1.3.m3.2a">
                                    <msub id="S13.p1.3.m3.2.3" xref="S13.p1.3.m3.2.3.cmml">
                                        <mi id="S13.p1.3.m3.2.3.2" xref="S13.p1.3.m3.2.3.2.cmml">g</mi>
                                        <mrow id="S13.p1.3.m3.2.2.2.4" xref="S13.p1.3.m3.2.2.2.3.cmml">
                                            <mi id="S13.p1.3.m3.1.1.1.1" xref="S13.p1.3.m3.1.1.1.1.cmml">i</mi>
                                            <mo id="S13.p1.3.m3.2.2.2.4.1" xref="S13.p1.3.m3.2.2.2.3.cmml">,</mo>
                                            <mi id="S13.p1.3.m3.2.2.2.2" xref="S13.p1.3.m3.2.2.2.2.cmml">n</mi>
                                        </mrow>
                                    </msub><annotation-xml encoding="MathML-Content" id="S13.p1.3.m3.2b">
                                        <apply id="S13.p1.3.m3.2.3.cmml" xref="S13.p1.3.m3.2.3">
                                            <csymbol cd="ambiguous" id="S13.p1.3.m3.2.3.1.cmml" xref="S13.p1.3.m3.2.3">
                                                subscript</csymbol>
                                            <ci id="S13.p1.3.m3.2.3.2.cmml" xref="S13.p1.3.m3.2.3.2">𝑔</ci>
                                            <list id="S13.p1.3.m3.2.2.2.3.cmml" xref="S13.p1.3.m3.2.2.2.4">
                                                <ci id="S13.p1.3.m3.1.1.1.1.cmml" xref="S13.p1.3.m3.1.1.1.1">𝑖</ci>
                                                <ci id="S13.p1.3.m3.2.2.2.2.cmml" xref="S13.p1.3.m3.2.2.2.2">𝑛</ci>
                                            </list>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S13.p1.3.m3.2c">g_{i,n}</annotation>
                                    <annotation encoding="application/x-llamapun" id="S13.p1.3.m3.2d">italic_g
                                        start_POSTSUBSCRIPT italic_i , italic_n end_POSTSUBSCRIPT</annotation>
                                </semantics>
                            </math> is defined as:</p>
                        <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S15.EGx9">
                            <tbody id="S13.E23">
                                <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                                    <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                                    <td class="ltx_td ltx_align_right ltx_eqn_cell"><math
                                            alttext="\displaystyle\text{Hash}(g_{i,n})" class="ltx_Math"
                                            display="inline" id="S13.E23.m1.3">
                                            <semantics id="S13.E23.m1.3a">
                                                <mrow id="S13.E23.m1.3.3" xref="S13.E23.m1.3.3.cmml">
                                                    <mtext id="S13.E23.m1.3.3.3" xref="S13.E23.m1.3.3.3a.cmml">Hash
                                                    </mtext>
                                                    <mo id="S13.E23.m1.3.3.2" xref="S13.E23.m1.3.3.2.cmml">⁢</mo>
                                                    <mrow id="S13.E23.m1.3.3.1.1" xref="S13.E23.m1.3.3.1.1.1.cmml">
                                                        <mo id="S13.E23.m1.3.3.1.1.2" stretchy="false"
                                                            xref="S13.E23.m1.3.3.1.1.1.cmml">(</mo>
                                                        <msub id="S13.E23.m1.3.3.1.1.1"
                                                            xref="S13.E23.m1.3.3.1.1.1.cmml">
                                                            <mi id="S13.E23.m1.3.3.1.1.1.2"
                                                                xref="S13.E23.m1.3.3.1.1.1.2.cmml">g</mi>
                                                            <mrow id="S13.E23.m1.2.2.2.4"
                                                                xref="S13.E23.m1.2.2.2.3.cmml">
                                                                <mi id="S13.E23.m1.1.1.1.1"
                                                                    xref="S13.E23.m1.1.1.1.1.cmml">i</mi>
                                                                <mo id="S13.E23.m1.2.2.2.4.1"
                                                                    xref="S13.E23.m1.2.2.2.3.cmml">,</mo>
                                                                <mi id="S13.E23.m1.2.2.2.2"
                                                                    xref="S13.E23.m1.2.2.2.2.cmml">n</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo id="S13.E23.m1.3.3.1.1.3" stretchy="false"
                                                            xref="S13.E23.m1.3.3.1.1.1.cmml">)</mo>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S13.E23.m1.3b">
                                                    <apply id="S13.E23.m1.3.3.cmml" xref="S13.E23.m1.3.3">
                                                        <times id="S13.E23.m1.3.3.2.cmml" xref="S13.E23.m1.3.3.2">
                                                        </times>
                                                        <ci id="S13.E23.m1.3.3.3a.cmml" xref="S13.E23.m1.3.3.3">
                                                            <mtext id="S13.E23.m1.3.3.3.cmml" xref="S13.E23.m1.3.3.3">
                                                                Hash</mtext>
                                                        </ci>
                                                        <apply id="S13.E23.m1.3.3.1.1.1.cmml" xref="S13.E23.m1.3.3.1.1">
                                                            <csymbol cd="ambiguous" id="S13.E23.m1.3.3.1.1.1.1.cmml"
                                                                xref="S13.E23.m1.3.3.1.1">subscript</csymbol>
                                                            <ci id="S13.E23.m1.3.3.1.1.1.2.cmml"
                                                                xref="S13.E23.m1.3.3.1.1.1.2">𝑔</ci>
                                                            <list id="S13.E23.m1.2.2.2.3.cmml"
                                                                xref="S13.E23.m1.2.2.2.4">
                                                                <ci id="S13.E23.m1.1.1.1.1.cmml"
                                                                    xref="S13.E23.m1.1.1.1.1">𝑖</ci>
                                                                <ci id="S13.E23.m1.2.2.2.2.cmml"
                                                                    xref="S13.E23.m1.2.2.2.2">𝑛</ci>
                                                            </list>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S13.E23.m1.3c">
                                                    \displaystyle\text{Hash}(g_{i,n})</annotation>
                                                <annotation encoding="application/x-llamapun" id="S13.E23.m1.3d">Hash (
                                                    italic_g start_POSTSUBSCRIPT italic_i , italic_n end_POSTSUBSCRIPT )
                                                </annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_td ltx_align_left ltx_eqn_cell"><math
                                            alttext="\displaystyle=\sum_{j=1}^{n}b_{i-j+1}a^{j-1}" class="ltx_Math"
                                            display="inline" id="S13.E23.m2.1">
                                            <semantics id="S13.E23.m2.1a">
                                                <mrow id="S13.E23.m2.1.1" xref="S13.E23.m2.1.1.cmml">
                                                    <mi id="S13.E23.m2.1.1.2" xref="S13.E23.m2.1.1.2.cmml"></mi>
                                                    <mo id="S13.E23.m2.1.1.1" xref="S13.E23.m2.1.1.1.cmml">=</mo>
                                                    <mrow id="S13.E23.m2.1.1.3" xref="S13.E23.m2.1.1.3.cmml">
                                                        <mstyle displaystyle="true" id="S13.E23.m2.1.1.3.1"
                                                            xref="S13.E23.m2.1.1.3.1.cmml">
                                                            <munderover id="S13.E23.m2.1.1.3.1a"
                                                                xref="S13.E23.m2.1.1.3.1.cmml">
                                                                <mo id="S13.E23.m2.1.1.3.1.2.2" movablelimits="false"
                                                                    xref="S13.E23.m2.1.1.3.1.2.2.cmml">∑</mo>
                                                                <mrow id="S13.E23.m2.1.1.3.1.2.3"
                                                                    xref="S13.E23.m2.1.1.3.1.2.3.cmml">
                                                                    <mi id="S13.E23.m2.1.1.3.1.2.3.2"
                                                                        xref="S13.E23.m2.1.1.3.1.2.3.2.cmml">j</mi>
                                                                    <mo id="S13.E23.m2.1.1.3.1.2.3.1"
                                                                        xref="S13.E23.m2.1.1.3.1.2.3.1.cmml">=</mo>
                                                                    <mn id="S13.E23.m2.1.1.3.1.2.3.3"
                                                                        xref="S13.E23.m2.1.1.3.1.2.3.3.cmml">1</mn>
                                                                </mrow>
                                                                <mi id="S13.E23.m2.1.1.3.1.3"
                                                                    xref="S13.E23.m2.1.1.3.1.3.cmml">n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mrow id="S13.E23.m2.1.1.3.2" xref="S13.E23.m2.1.1.3.2.cmml">
                                                            <msub id="S13.E23.m2.1.1.3.2.2"
                                                                xref="S13.E23.m2.1.1.3.2.2.cmml">
                                                                <mi id="S13.E23.m2.1.1.3.2.2.2"
                                                                    xref="S13.E23.m2.1.1.3.2.2.2.cmml">b</mi>
                                                                <mrow id="S13.E23.m2.1.1.3.2.2.3"
                                                                    xref="S13.E23.m2.1.1.3.2.2.3.cmml">
                                                                    <mrow id="S13.E23.m2.1.1.3.2.2.3.2"
                                                                        xref="S13.E23.m2.1.1.3.2.2.3.2.cmml">
                                                                        <mi id="S13.E23.m2.1.1.3.2.2.3.2.2"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.2.2.cmml">i
                                                                        </mi>
                                                                        <mo id="S13.E23.m2.1.1.3.2.2.3.2.1"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.2.1.cmml">−
                                                                        </mo>
                                                                        <mi id="S13.E23.m2.1.1.3.2.2.3.2.3"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.2.3.cmml">j
                                                                        </mi>
                                                                    </mrow>
                                                                    <mo id="S13.E23.m2.1.1.3.2.2.3.1"
                                                                        xref="S13.E23.m2.1.1.3.2.2.3.1.cmml">+</mo>
                                                                    <mn id="S13.E23.m2.1.1.3.2.2.3.3"
                                                                        xref="S13.E23.m2.1.1.3.2.2.3.3.cmml">1</mn>
                                                                </mrow>
                                                            </msub>
                                                            <mo id="S13.E23.m2.1.1.3.2.1"
                                                                xref="S13.E23.m2.1.1.3.2.1.cmml">⁢</mo>
                                                            <msup id="S13.E23.m2.1.1.3.2.3"
                                                                xref="S13.E23.m2.1.1.3.2.3.cmml">
                                                                <mi id="S13.E23.m2.1.1.3.2.3.2"
                                                                    xref="S13.E23.m2.1.1.3.2.3.2.cmml">a</mi>
                                                                <mrow id="S13.E23.m2.1.1.3.2.3.3"
                                                                    xref="S13.E23.m2.1.1.3.2.3.3.cmml">
                                                                    <mi id="S13.E23.m2.1.1.3.2.3.3.2"
                                                                        xref="S13.E23.m2.1.1.3.2.3.3.2.cmml">j</mi>
                                                                    <mo id="S13.E23.m2.1.1.3.2.3.3.1"
                                                                        xref="S13.E23.m2.1.1.3.2.3.3.1.cmml">−</mo>
                                                                    <mn id="S13.E23.m2.1.1.3.2.3.3.3"
                                                                        xref="S13.E23.m2.1.1.3.2.3.3.3.cmml">1</mn>
                                                                </mrow>
                                                            </msup>
                                                        </mrow>
                                                    </mrow>
                                                </mrow><annotation-xml encoding="MathML-Content" id="S13.E23.m2.1b">
                                                    <apply id="S13.E23.m2.1.1.cmml" xref="S13.E23.m2.1.1">
                                                        <eq id="S13.E23.m2.1.1.1.cmml" xref="S13.E23.m2.1.1.1"></eq>
                                                        <csymbol cd="latexml" id="S13.E23.m2.1.1.2.cmml"
                                                            xref="S13.E23.m2.1.1.2">absent</csymbol>
                                                        <apply id="S13.E23.m2.1.1.3.cmml" xref="S13.E23.m2.1.1.3">
                                                            <apply id="S13.E23.m2.1.1.3.1.cmml"
                                                                xref="S13.E23.m2.1.1.3.1">
                                                                <csymbol cd="ambiguous" id="S13.E23.m2.1.1.3.1.1.cmml"
                                                                    xref="S13.E23.m2.1.1.3.1">superscript</csymbol>
                                                                <apply id="S13.E23.m2.1.1.3.1.2.cmml"
                                                                    xref="S13.E23.m2.1.1.3.1">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S13.E23.m2.1.1.3.1.2.1.cmml"
                                                                        xref="S13.E23.m2.1.1.3.1">subscript</csymbol>
                                                                    <sum id="S13.E23.m2.1.1.3.1.2.2.cmml"
                                                                        xref="S13.E23.m2.1.1.3.1.2.2"></sum>
                                                                    <apply id="S13.E23.m2.1.1.3.1.2.3.cmml"
                                                                        xref="S13.E23.m2.1.1.3.1.2.3">
                                                                        <eq id="S13.E23.m2.1.1.3.1.2.3.1.cmml"
                                                                            xref="S13.E23.m2.1.1.3.1.2.3.1"></eq>
                                                                        <ci id="S13.E23.m2.1.1.3.1.2.3.2.cmml"
                                                                            xref="S13.E23.m2.1.1.3.1.2.3.2">𝑗</ci>
                                                                        <cn id="S13.E23.m2.1.1.3.1.2.3.3.cmml"
                                                                            type="integer"
                                                                            xref="S13.E23.m2.1.1.3.1.2.3.3">1</cn>
                                                                    </apply>
                                                                </apply>
                                                                <ci id="S13.E23.m2.1.1.3.1.3.cmml"
                                                                    xref="S13.E23.m2.1.1.3.1.3">𝑛</ci>
                                                            </apply>
                                                            <apply id="S13.E23.m2.1.1.3.2.cmml"
                                                                xref="S13.E23.m2.1.1.3.2">
                                                                <times id="S13.E23.m2.1.1.3.2.1.cmml"
                                                                    xref="S13.E23.m2.1.1.3.2.1"></times>
                                                                <apply id="S13.E23.m2.1.1.3.2.2.cmml"
                                                                    xref="S13.E23.m2.1.1.3.2.2">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S13.E23.m2.1.1.3.2.2.1.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.2">subscript</csymbol>
                                                                    <ci id="S13.E23.m2.1.1.3.2.2.2.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.2.2">𝑏</ci>
                                                                    <apply id="S13.E23.m2.1.1.3.2.2.3.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.2.3">
                                                                        <plus id="S13.E23.m2.1.1.3.2.2.3.1.cmml"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.1"></plus>
                                                                        <apply id="S13.E23.m2.1.1.3.2.2.3.2.cmml"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.2">
                                                                            <minus id="S13.E23.m2.1.1.3.2.2.3.2.1.cmml"
                                                                                xref="S13.E23.m2.1.1.3.2.2.3.2.1">
                                                                            </minus>
                                                                            <ci id="S13.E23.m2.1.1.3.2.2.3.2.2.cmml"
                                                                                xref="S13.E23.m2.1.1.3.2.2.3.2.2">𝑖
                                                                            </ci>
                                                                            <ci id="S13.E23.m2.1.1.3.2.2.3.2.3.cmml"
                                                                                xref="S13.E23.m2.1.1.3.2.2.3.2.3">𝑗
                                                                            </ci>
                                                                        </apply>
                                                                        <cn id="S13.E23.m2.1.1.3.2.2.3.3.cmml"
                                                                            type="integer"
                                                                            xref="S13.E23.m2.1.1.3.2.2.3.3">1</cn>
                                                                    </apply>
                                                                </apply>
                                                                <apply id="S13.E23.m2.1.1.3.2.3.cmml"
                                                                    xref="S13.E23.m2.1.1.3.2.3">
                                                                    <csymbol cd="ambiguous"
                                                                        id="S13.E23.m2.1.1.3.2.3.1.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.3">superscript
                                                                    </csymbol>
                                                                    <ci id="S13.E23.m2.1.1.3.2.3.2.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.3.2">𝑎</ci>
                                                                    <apply id="S13.E23.m2.1.1.3.2.3.3.cmml"
                                                                        xref="S13.E23.m2.1.1.3.2.3.3">
                                                                        <minus id="S13.E23.m2.1.1.3.2.3.3.1.cmml"
                                                                            xref="S13.E23.m2.1.1.3.2.3.3.1"></minus>
                                                                        <ci id="S13.E23.m2.1.1.3.2.3.3.2.cmml"
                                                                            xref="S13.E23.m2.1.1.3.2.3.3.2">𝑗</ci>
                                                                        <cn id="S13.E23.m2.1.1.3.2.3.3.3.cmml"
                                                                            type="integer"
                                                                            xref="S13.E23.m2.1.1.3.2.3.3.3">1</cn>
                                                                    </apply>
                                                                </apply>
                                                            </apply>
                                                        </apply>
                                                    </apply>
                                                </annotation-xml>
                                                <annotation encoding="application/x-tex" id="S13.E23.m2.1c">
                                                    \displaystyle=\sum_{j=1}^{n}b_{i-j+1}a^{j-1}</annotation>
                                                <annotation encoding="application/x-llamapun" id="S13.E23.m2.1d">= ∑
                                                    start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT
                                                    start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_b
                                                    start_POSTSUBSCRIPT italic_i - italic_j + 1 end_POSTSUBSCRIPT
                                                    italic_a start_POSTSUPERSCRIPT italic_j - 1 end_POSTSUPERSCRIPT
                                                </annotation>
                                            </semantics>
                                        </math></td>
                                    <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
                                    <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
                                        <span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="ltx_p" id="S13.p1.4">Where <math alttext="a" class="ltx_Math" display="inline"
                                id="S13.p1.4.m1.1">
                                <semantics id="S13.p1.4.m1.1a">
                                    <mi id="S13.p1.4.m1.1.1" xref="S13.p1.4.m1.1.1.cmml">a</mi><annotation-xml
                                        encoding="MathML-Content" id="S13.p1.4.m1.1b">
                                        <ci id="S13.p1.4.m1.1.1.cmml" xref="S13.p1.4.m1.1.1">𝑎</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S13.p1.4.m1.1c">a</annotation>
                                    <annotation encoding="application/x-llamapun" id="S13.p1.4.m1.1d">italic_a
                                    </annotation>
                                </semantics>
                            </math> is chosen to be a 10-digit prime number.</p>
                    </div>
                </section>
                <section class="ltx_section" id="S14">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">14 </span>Frequency-based n-gram Embedddings
                    </h2>
                    <div class="ltx_para" id="S14.p1">
                        <p class="ltx_p" id="S14.p1.7">Prior to using hash n-gram embeddings in the final <span
                                class="ltx_text ltx_font_smallcaps" id="S14.p1.7.1">B</span>LT architecture, we also
                            experimented with frequency-based n-gram embeddings. For each <math
                                alttext="n\in\{1,2,3,4,5,6,7,8\}" class="ltx_Math" display="inline" id="S14.p1.1.m1.8">
                                <semantics id="S14.p1.1.m1.8a">
                                    <mrow id="S14.p1.1.m1.8.9" xref="S14.p1.1.m1.8.9.cmml">
                                        <mi id="S14.p1.1.m1.8.9.2" xref="S14.p1.1.m1.8.9.2.cmml">n</mi>
                                        <mo id="S14.p1.1.m1.8.9.1" xref="S14.p1.1.m1.8.9.1.cmml">∈</mo>
                                        <mrow id="S14.p1.1.m1.8.9.3.2" xref="S14.p1.1.m1.8.9.3.1.cmml">
                                            <mo id="S14.p1.1.m1.8.9.3.2.1" stretchy="false"
                                                xref="S14.p1.1.m1.8.9.3.1.cmml">{</mo>
                                            <mn id="S14.p1.1.m1.1.1" xref="S14.p1.1.m1.1.1.cmml">1</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.2" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.2.2" xref="S14.p1.1.m1.2.2.cmml">2</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.3" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.3.3" xref="S14.p1.1.m1.3.3.cmml">3</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.4" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.4.4" xref="S14.p1.1.m1.4.4.cmml">4</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.5" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.5.5" xref="S14.p1.1.m1.5.5.cmml">5</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.6" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.6.6" xref="S14.p1.1.m1.6.6.cmml">6</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.7" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.7.7" xref="S14.p1.1.m1.7.7.cmml">7</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.8" xref="S14.p1.1.m1.8.9.3.1.cmml">,</mo>
                                            <mn id="S14.p1.1.m1.8.8" xref="S14.p1.1.m1.8.8.cmml">8</mn>
                                            <mo id="S14.p1.1.m1.8.9.3.2.9" stretchy="false"
                                                xref="S14.p1.1.m1.8.9.3.1.cmml">}</mo>
                                        </mrow>
                                    </mrow><annotation-xml encoding="MathML-Content" id="S14.p1.1.m1.8b">
                                        <apply id="S14.p1.1.m1.8.9.cmml" xref="S14.p1.1.m1.8.9">
                                            <in id="S14.p1.1.m1.8.9.1.cmml" xref="S14.p1.1.m1.8.9.1"></in>
                                            <ci id="S14.p1.1.m1.8.9.2.cmml" xref="S14.p1.1.m1.8.9.2">𝑛</ci>
                                            <set id="S14.p1.1.m1.8.9.3.1.cmml" xref="S14.p1.1.m1.8.9.3.2">
                                                <cn id="S14.p1.1.m1.1.1.cmml" type="integer" xref="S14.p1.1.m1.1.1">1
                                                </cn>
                                                <cn id="S14.p1.1.m1.2.2.cmml" type="integer" xref="S14.p1.1.m1.2.2">2
                                                </cn>
                                                <cn id="S14.p1.1.m1.3.3.cmml" type="integer" xref="S14.p1.1.m1.3.3">3
                                                </cn>
                                                <cn id="S14.p1.1.m1.4.4.cmml" type="integer" xref="S14.p1.1.m1.4.4">4
                                                </cn>
                                                <cn id="S14.p1.1.m1.5.5.cmml" type="integer" xref="S14.p1.1.m1.5.5">5
                                                </cn>
                                                <cn id="S14.p1.1.m1.6.6.cmml" type="integer" xref="S14.p1.1.m1.6.6">6
                                                </cn>
                                                <cn id="S14.p1.1.m1.7.7.cmml" type="integer" xref="S14.p1.1.m1.7.7">7
                                                </cn>
                                                <cn id="S14.p1.1.m1.8.8.cmml" type="integer" xref="S14.p1.1.m1.8.8">8
                                                </cn>
                                            </set>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.1.m1.8c">n\in\{1,2,3,4,5,6,7,8\}
                                    </annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.1.m1.8d">italic_n ∈ { 1 , 2
                                        , 3 , 4 , 5 , 6 , 7 , 8 }</annotation>
                                </semantics>
                            </math> there is an embedding matrix <math alttext="E_{n}^{ngram}" class="ltx_Math"
                                display="inline" id="S14.p1.2.m2.1">
                                <semantics id="S14.p1.2.m2.1a">
                                    <msubsup id="S14.p1.2.m2.1.1" xref="S14.p1.2.m2.1.1.cmml">
                                        <mi id="S14.p1.2.m2.1.1.2.2" xref="S14.p1.2.m2.1.1.2.2.cmml">E</mi>
                                        <mi id="S14.p1.2.m2.1.1.2.3" xref="S14.p1.2.m2.1.1.2.3.cmml">n</mi>
                                        <mrow id="S14.p1.2.m2.1.1.3" xref="S14.p1.2.m2.1.1.3.cmml">
                                            <mi id="S14.p1.2.m2.1.1.3.2" xref="S14.p1.2.m2.1.1.3.2.cmml">n</mi>
                                            <mo id="S14.p1.2.m2.1.1.3.1" xref="S14.p1.2.m2.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S14.p1.2.m2.1.1.3.3" xref="S14.p1.2.m2.1.1.3.3.cmml">g</mi>
                                            <mo id="S14.p1.2.m2.1.1.3.1a" xref="S14.p1.2.m2.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S14.p1.2.m2.1.1.3.4" xref="S14.p1.2.m2.1.1.3.4.cmml">r</mi>
                                            <mo id="S14.p1.2.m2.1.1.3.1b" xref="S14.p1.2.m2.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S14.p1.2.m2.1.1.3.5" xref="S14.p1.2.m2.1.1.3.5.cmml">a</mi>
                                            <mo id="S14.p1.2.m2.1.1.3.1c" xref="S14.p1.2.m2.1.1.3.1.cmml">⁢</mo>
                                            <mi id="S14.p1.2.m2.1.1.3.6" xref="S14.p1.2.m2.1.1.3.6.cmml">m</mi>
                                        </mrow>
                                    </msubsup><annotation-xml encoding="MathML-Content" id="S14.p1.2.m2.1b">
                                        <apply id="S14.p1.2.m2.1.1.cmml" xref="S14.p1.2.m2.1.1">
                                            <csymbol cd="ambiguous" id="S14.p1.2.m2.1.1.1.cmml" xref="S14.p1.2.m2.1.1">
                                                superscript</csymbol>
                                            <apply id="S14.p1.2.m2.1.1.2.cmml" xref="S14.p1.2.m2.1.1">
                                                <csymbol cd="ambiguous" id="S14.p1.2.m2.1.1.2.1.cmml"
                                                    xref="S14.p1.2.m2.1.1">subscript</csymbol>
                                                <ci id="S14.p1.2.m2.1.1.2.2.cmml" xref="S14.p1.2.m2.1.1.2.2">𝐸</ci>
                                                <ci id="S14.p1.2.m2.1.1.2.3.cmml" xref="S14.p1.2.m2.1.1.2.3">𝑛</ci>
                                            </apply>
                                            <apply id="S14.p1.2.m2.1.1.3.cmml" xref="S14.p1.2.m2.1.1.3">
                                                <times id="S14.p1.2.m2.1.1.3.1.cmml" xref="S14.p1.2.m2.1.1.3.1"></times>
                                                <ci id="S14.p1.2.m2.1.1.3.2.cmml" xref="S14.p1.2.m2.1.1.3.2">𝑛</ci>
                                                <ci id="S14.p1.2.m2.1.1.3.3.cmml" xref="S14.p1.2.m2.1.1.3.3">𝑔</ci>
                                                <ci id="S14.p1.2.m2.1.1.3.4.cmml" xref="S14.p1.2.m2.1.1.3.4">𝑟</ci>
                                                <ci id="S14.p1.2.m2.1.1.3.5.cmml" xref="S14.p1.2.m2.1.1.3.5">𝑎</ci>
                                                <ci id="S14.p1.2.m2.1.1.3.6.cmml" xref="S14.p1.2.m2.1.1.3.6">𝑚</ci>
                                            </apply>
                                        </apply>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.2.m2.1c">E_{n}^{ngram}
                                    </annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.2.m2.1d">italic_E
                                        start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n
                                        italic_g italic_r italic_a italic_m end_POSTSUPERSCRIPT</annotation>
                                </semantics>
                            </math> that contains the most frequent byte-grams for the given <math alttext="n"
                                class="ltx_Math" display="inline" id="S14.p1.3.m3.1">
                                <semantics id="S14.p1.3.m3.1a">
                                    <mi id="S14.p1.3.m3.1.1" xref="S14.p1.3.m3.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p1.3.m3.1b">
                                        <ci id="S14.p1.3.m3.1.1.cmml" xref="S14.p1.3.m3.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.3.m3.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.3.m3.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math>.
                            Since it is intractable to store embeddings as <math alttext="n" class="ltx_Math"
                                display="inline" id="S14.p1.4.m4.1">
                                <semantics id="S14.p1.4.m4.1a">
                                    <mi id="S14.p1.4.m4.1.1" xref="S14.p1.4.m4.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p1.4.m4.1b">
                                        <ci id="S14.p1.4.m4.1.1.cmml" xref="S14.p1.4.m4.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.4.m4.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.4.m4.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math> grows, we only store embeddings for the most frequent <math alttext="100,000"
                                class="ltx_Math" display="inline" id="S14.p1.5.m5.2">
                                <semantics id="S14.p1.5.m5.2a">
                                    <mrow id="S14.p1.5.m5.2.3.2" xref="S14.p1.5.m5.2.3.1.cmml">
                                        <mn id="S14.p1.5.m5.1.1" xref="S14.p1.5.m5.1.1.cmml">100</mn>
                                        <mo id="S14.p1.5.m5.2.3.2.1" xref="S14.p1.5.m5.2.3.1.cmml">,</mo>
                                        <mn id="S14.p1.5.m5.2.2" xref="S14.p1.5.m5.2.2.cmml">000</mn>
                                    </mrow><annotation-xml encoding="MathML-Content" id="S14.p1.5.m5.2b">
                                        <list id="S14.p1.5.m5.2.3.1.cmml" xref="S14.p1.5.m5.2.3.2">
                                            <cn id="S14.p1.5.m5.1.1.cmml" type="integer" xref="S14.p1.5.m5.1.1">100</cn>
                                            <cn id="S14.p1.5.m5.2.2.cmml" type="integer" xref="S14.p1.5.m5.2.2">000</cn>
                                        </list>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.5.m5.2c">100,000</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.5.m5.2d">100 , 000
                                    </annotation>
                                </semantics>
                            </math> byte-grams for each byte-gram.
                            If a particular position <math alttext="i" class="ltx_Math" display="inline"
                                id="S14.p1.6.m6.1">
                                <semantics id="S14.p1.6.m6.1a">
                                    <mi id="S14.p1.6.m6.1.1" xref="S14.p1.6.m6.1.1.cmml">i</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p1.6.m6.1b">
                                        <ci id="S14.p1.6.m6.1.1.cmml" xref="S14.p1.6.m6.1.1">𝑖</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.6.m6.1c">i</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.6.m6.1d">italic_i
                                    </annotation>
                                </semantics>
                            </math> includes an <math alttext="n" class="ltx_Math" display="inline" id="S14.p1.7.m7.1">
                                <semantics id="S14.p1.7.m7.1a">
                                    <mi id="S14.p1.7.m7.1.1" xref="S14.p1.7.m7.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p1.7.m7.1b">
                                        <ci id="S14.p1.7.m7.1.1.cmml" xref="S14.p1.7.m7.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p1.7.m7.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p1.7.m7.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math>-gram present in the corresponding the embedding matrix, then this embedding is
                            passed to the next step, encoder multi-headed cross-attention. If a byte-gram is infrequent
                            and therefore not in the matrix, then its embedding is obtained from encoder hash embeddings
                            instead.</p>
                    </div>
                    <div class="ltx_para" id="S14.p2">
                        <p class="ltx_p" id="S14.p2.2">Since frequency-based <math alttext="n" class="ltx_Math"
                                display="inline" id="S14.p2.1.m1.1">
                                <semantics id="S14.p2.1.m1.1a">
                                    <mi id="S14.p2.1.m1.1.1" xref="S14.p2.1.m1.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p2.1.m1.1b">
                                        <ci id="S14.p2.1.m1.1.1.cmml" xref="S14.p2.1.m1.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p2.1.m1.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p2.1.m1.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math>-grams are limited by the vocabulary of the n-gram tables with infrequent n-grams not
                            being represented at all, we subsequently moved to hash-based <math alttext="n"
                                class="ltx_Math" display="inline" id="S14.p2.2.m2.1">
                                <semantics id="S14.p2.2.m2.1a">
                                    <mi id="S14.p2.2.m2.1.1" xref="S14.p2.2.m2.1.1.cmml">n</mi><annotation-xml
                                        encoding="MathML-Content" id="S14.p2.2.m2.1b">
                                        <ci id="S14.p2.2.m2.1.1.cmml" xref="S14.p2.2.m2.1.1">𝑛</ci>
                                    </annotation-xml>
                                    <annotation encoding="application/x-tex" id="S14.p2.2.m2.1c">n</annotation>
                                    <annotation encoding="application/x-llamapun" id="S14.p2.2.m2.1d">italic_n
                                    </annotation>
                                </semantics>
                            </math>-gram embeddings. See <a class="ltx_ref ltx_refmacro_autoref"
                                href="https://arxiv.org/html/2412.09871v1#S14.T12"
                                title="Table 12 ‣ 14 Frequency-based n-gram Embedddings ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">Table 12</span></a> for a comparison of hash and
                            frequency based n-gram embeddings.</p>
                    </div>
                    <figure class="ltx_table" id="S14.T12">
                        <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S14.T12.2"
                            style="width:433.6pt;height:265.9pt;vertical-align:-0.7pt;"><span
                                class="ltx_transformed_inner"
                                style="transform:translate(-92.2pt,56.4pt) scale(0.701696666811692,0.701696666811692) ;">
                                <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S14.T12.2.1">
                                    <tbody class="ltx_tbody">
                                        <tr class="ltx_tr" id="S14.T12.2.1.1.1">
                                            <td class="ltx_td ltx_border_tt" id="S14.T12.2.1.1.1.1"></td>
                                            <th class="ltx_td ltx_th ltx_th_column ltx_border_tt"
                                                id="S14.T12.2.1.1.1.2"></th>
                                            <th class="ltx_td ltx_th ltx_th_column ltx_border_tt"
                                                id="S14.T12.2.1.1.1.3"></th>
                                            <th class="ltx_td ltx_th ltx_th_column ltx_border_tt"
                                                id="S14.T12.2.1.1.1.4"></th>
                                            <th class="ltx_td ltx_th ltx_th_column ltx_border_tt"
                                                id="S14.T12.2.1.1.1.5"></th>
                                            <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"
                                                colspan="4" id="S14.T12.2.1.1.1.6">bpb</th>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.2.2">
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_column"
                                                id="S14.T12.2.1.2.2.1">Hash Ngram Sizes</th>
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_column"
                                                id="S14.T12.2.1.2.2.2">Per Hash Ngram Vocab</th>
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_column"
                                                id="S14.T12.2.1.2.2.3">Ngram Sizes</th>
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_column"
                                                id="S14.T12.2.1.2.2.4">Per Ngram Vocab</th>
                                            <th class="ltx_td ltx_align_left ltx_th ltx_th_column"
                                                id="S14.T12.2.1.2.2.5">Total Vocab</th>
                                            <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                                id="S14.T12.2.1.2.2.6">Wikipedia</th>
                                            <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                                id="S14.T12.2.1.2.2.7">CC</th>
                                            <th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                                id="S14.T12.2.1.2.2.8">Github</th>
                                            <th class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_t"
                                                id="S14.T12.2.1.2.2.9">Train Dist</th>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.3.3">
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S14.T12.2.1.3.3.1">-</td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S14.T12.2.1.3.3.2">-</td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S14.T12.2.1.3.3.3">-</td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S14.T12.2.1.3.3.4">-</td>
                                            <td class="ltx_td ltx_align_left ltx_border_t" id="S14.T12.2.1.3.3.5">-</td>
                                            <td class="ltx_td ltx_align_right ltx_border_t" id="S14.T12.2.1.3.3.6">0.892
                                            </td>
                                            <td class="ltx_td ltx_align_right ltx_border_t" id="S14.T12.2.1.3.3.7">0.867
                                            </td>
                                            <td class="ltx_td ltx_align_right ltx_border_t" id="S14.T12.2.1.3.3.8">0.506
                                            </td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t"
                                                id="S14.T12.2.1.3.3.9">0.850</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.4.4">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.4.4.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.4.4.2">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.4.4.3">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.4.4.4">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.4.4.5">300k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.4.4.6">0.878</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.4.4.7">0.860</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.4.4.8">0.497</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.4.4.9">0.843
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.5.5">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.5.5.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.5.5.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.5.5.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.5.5.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.5.5.5">300k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.5.5.6">0.873</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.5.5.7">0.860</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.5.5.8">0.499</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.5.5.9">0.842
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.6.6">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.6.6.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.6.6.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.6.6.3">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.6.6.4">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.6.6.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.6.6.6">0.868</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.6.6.7">0.857</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.6.6.8">0.494</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.6.6.9">0.839
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.7.7">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.7.7.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.7.7.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.7.7.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.7.7.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.7.7.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.7.7.6">0.862</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.7.7.7">0.856</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.7.7.8">0.492</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.7.7.9">0.838
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.8.8">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.8.8.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.8.8.2">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.8.8.3">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.8.8.4">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.8.8.5">300k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.8.8.6">0.862</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.8.8.7">0.856</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.8.8.8">0.491</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.8.8.9">0.837
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.9.9">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.9.9.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.9.9.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.9.9.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.9.9.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.9.9.5">300k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.9.9.6">0.859</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.9.9.7">0.855</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.9.9.8">0.491</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.9.9.9">0.837
                                            </td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.10.10">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.10.10.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.10.10.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.10.10.3">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.10.10.4">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.10.10.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.10.10.6">0.861</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.10.10.7">0.855</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.10.10.8">0.491</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.10.10.9">
                                                0.837</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.11.11">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.11.11.1">6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.11.11.2">400k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.11.11.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.11.11.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.11.11.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.11.11.6">0.855</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.11.11.7">0.853</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.11.11.8">0.491</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.11.11.9">
                                                0.834</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.12.12">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.12.12.1">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.12.12.2">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.12.12.3">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.12.12.4">50k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.12.12.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.12.12.6">0.855</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.12.12.7">0.853</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.12.12.8">0.488</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.12.12.9">
                                                0.834</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.13.13">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.13.13.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.13.13.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.13.13.3">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.13.13.4">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.13.13.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.13.13.6">0.851</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.13.13.7">0.853</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.13.13.8">0.486</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.13.13.9">
                                                0.834</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.14.14">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.14.14.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.14.14.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.14.14.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.14.14.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.14.14.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.14.14.6">0.850</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.14.14.7">0.852</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.14.14.8">0.485</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.14.14.9">
                                                0.833</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.15.15">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.15.15.1">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.15.15.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.15.15.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.15.15.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.15.15.5">600k</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.15.15.6">0.850</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.15.15.7">0.852</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.15.15.8">0.486</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.15.15.9">
                                                0.833</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.16.16">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.16.16.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.16.16.2">400k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.16.16.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.16.16.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.16.16.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.16.16.6">0.844</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.16.16.7">0.851</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.16.16.8">0.483</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.16.16.9">
                                                0.832</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.17.17">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.17.17.1">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.17.17.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.17.17.3">3,4,5</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.17.17.4">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.17.17.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.17.17.6">0.843</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.17.17.7">0.850</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.17.17.8">0.482</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.17.17.9">
                                                0.830</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.18.18">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.18.18.1">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.18.18.2">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.18.18.3">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.18.18.4">100k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.18.18.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.18.18.6">0.844</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.18.18.7">0.850</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.18.18.8">0.482</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.18.18.9">
                                                0.830</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.19.19">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.19.19.1">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.19.19.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.19.19.3">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.19.19.4">-</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.19.19.5">1M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.19.19.6">0.840</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.19.19.7">0.849</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.19.19.8">0.481</td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.19.19.9">
                                                0.830</td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.20.20">
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.20.20.1">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.20.20.2">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.20.20.3">3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.20.20.4">200k</td>
                                            <td class="ltx_td ltx_align_left" id="S14.T12.2.1.20.20.5">2M</td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.20.20.6"><span
                                                    class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.20.20.6.1">0.833</span></td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.20.20.7"><span
                                                    class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.20.20.7.1">0.846</span></td>
                                            <td class="ltx_td ltx_align_right" id="S14.T12.2.1.20.20.8"><span
                                                    class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.20.20.8.1">0.478</span></td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right" id="S14.T12.2.1.20.20.9">
                                                <span class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.20.20.9.1">0.826</span></td>
                                        </tr>
                                        <tr class="ltx_tr" id="S14.T12.2.1.21.21">
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S14.T12.2.1.21.21.1">
                                                3,4,5,6,7,8</td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S14.T12.2.1.21.21.2">
                                                400k</td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S14.T12.2.1.21.21.3">-
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S14.T12.2.1.21.21.4">-
                                            </td>
                                            <td class="ltx_td ltx_align_left ltx_border_bb" id="S14.T12.2.1.21.21.5">2M
                                            </td>
                                            <td class="ltx_td ltx_align_right ltx_border_bb" id="S14.T12.2.1.21.21.6">
                                                <span class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.21.21.6.1">0.831</span></td>
                                            <td class="ltx_td ltx_align_right ltx_border_bb" id="S14.T12.2.1.21.21.7">
                                                <span class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.21.21.7.1">0.846</span></td>
                                            <td class="ltx_td ltx_align_right ltx_border_bb" id="S14.T12.2.1.21.21.8">
                                                <span class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.21.21.8.1">0.478</span></td>
                                            <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb"
                                                id="S14.T12.2.1.21.21.9"><span class="ltx_text ltx_font_bold"
                                                    id="S14.T12.2.1.21.21.9.1">0.826</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </span></div>
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span
                                    class="ltx_text" id="S14.T12.4.1.1" style="font-size:90%;">Table 12</span>:
                            </span><span class="ltx_text" id="S14.T12.5.2" style="font-size:90%;">Ablations on the use
                                of frequency-based as well as hash-based n-gram embedding tables for a 1B <span
                                    class="ltx_text ltx_font_smallcaps" id="S14.T12.5.2.1">B</span>LT model trained on
                                100B bytes. </span></figcaption>
                    </figure>
                </section>
                <section class="ltx_section" id="S15">
                    <h2 class="ltx_title ltx_title_section">
                        <span class="ltx_tag ltx_tag_section">15 </span>Entropy Patching Example from MMLU
                    </h2>
                    <div class="ltx_para" id="S15.p1">
                        <p class="ltx_p" id="S15.p1.1">We illustrate how a few-shot example from a downstream task i.e.
                            MMLU <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref"
                                    href="https://arxiv.org/html/2412.09871v1#bib.bib20" title="">2020</a>)</cite>, is
                            patched using an entropy-model trained for use with <span
                                class="ltx_text ltx_font_smallcaps" id="S15.p1.1.1">B</span>LT models in Figure <a
                                class="ltx_ref" href="https://arxiv.org/html/2412.09871v1#S15.F9"
                                title="Figure 9 ‣ 15 Entropy Patching Example from MMLU ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">9</span></a>. Directly using the entropy model with the
                            full-context window causes repetitive patterns to be heavily patched. For example, “10
                            times, with an rms deviation of about” in the MMLU query is patched frequently the first
                            time it is encountered, but is part of very large patches the next three times, which,
                            although inference efficient, maybe undesirable for reasoning. One method that we use to
                            avoid such a “entropy” drift is by resetting the entropy context with new lines and using a
                            approximate monotonicity constraint (see Section <a class="ltx_ref"
                                href="https://arxiv.org/html/2412.09871v1#S4.SS4"
                                title="4.4 Entropy Model Context ‣ 4 Experimental Setup ‣ Byte Latent Transformer: Patches Scale Better Than Tokens"><span
                                    class="ltx_text ltx_ref_tag">4.4</span></a>).</p>
                    </div>
                    <figure class="ltx_figure" id="S15.F9"><img alt="Refer to caption"
                            class="ltx_graphics ltx_centering ltx_img_landscape" height="406" id="S15.F9.g1"
                            src="extracted/6066458/assets/patching.png" width="598" />
                        <figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span
                                    class="ltx_text" id="S15.F9.3.1.1" style="font-size:90%;">Figure 9</span>:
                            </span><span class="ltx_text" id="S15.F9.4.2" style="font-size:90%;">An example of default
                                entropy-based patching with global threshold during inference on <span
                                    class="ltx_text ltx_font_smallcaps" id="S15.F9.4.2.1">mmlu</span>. Green denotes the
                                prompt, Blue denotes the few-shot examples, and red denotes the question to be answered.
                                Note that the size of the patches for the repeated phrases in the answer choices is much
                                larger, which means that the global model is invoked significantly fewer times than its
                                tokenizer-based counterpart, with this inference patching scheme.</span></figcaption>
                    </figure>
                    <div class="ltx_pagination ltx_role_newpage"></div>
                </section>
            </article>
        </div>
        <footer class="ltx_page_footer">
            <div class="ltx_page_logo">Generated on Fri Dec 13 05:28:07 2024 by <a class="ltx_LaTeXML_logo"
                    href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span
                            class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span
                            class="ltx_font_smallcaps"
                            style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span
                        style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy"
                        src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" /></a>
            </div>
        </footer>
    </div>
</body>

</html>